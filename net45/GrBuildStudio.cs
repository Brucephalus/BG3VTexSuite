
// E:\Graphine Granite Toolset 5.0.7\GrBuildStudio.exe
// GrBuildStudio, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// Global type: <Module>
// Entry point: GrBuildStudio.Program.Main
// Architecture: x64
// Runtime: v4.0.30319
// Hash algorithm: SHA1

using System;
using System.CodeDom.Compiler;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Configuration;
using System.Diagnostics;
using System.Drawing;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Management;
using System.Net;
using System.Reflection;
using System.Resources;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Runtime.Versioning;
using System.Security.Cryptography;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading;
using System.Windows.Forms;
using System.Xml;
using System.Xml.Serialization;
using DevComponents.AdvTree;
using DevComponents.DotNetBar;
using DevComponents.DotNetBar.Controls;
using DevComponents.DotNetBar.Metro.ColorTables;
using DevComponents.Editors;
using Graphine.Core;
using GraphineLicenseManager;
using GraphineLicenseManager.Ed25519b;
using GrBuildLib;
using GrBuildLib.Tools;
using GrBuildStudio.Controls;
using GrBuildStudio.Properties;
using GrBuildStudio.Tools;
using Grim;
using Microsoft.Win32;
using Nixel;

[assembly: CompilationRelaxations(8)]
[assembly: RuntimeCompatibility(WrapNonExceptionThrows = true)]
[assembly: Debuggable(DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints)]
[assembly: AssemblyCompany("Graphine NV")]
[assembly: AssemblyProduct("Tile Set Studio")]
[assembly: AssemblyCopyright("Copyright Graphine NV Â© 2013-2017")]
[assembly: AssemblyInformationalVersion("5.0.7.34144")]
[assembly: AssemblyDescription("Generated by cholleme@ZELDA from master/9a8e2032016ca90aea9bc098289abc7dc1f56d8c")]
[assembly: AssemblyTitle("GrBuildStudio")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyTrademark("")]
[assembly: ComVisible(false)]
[assembly: Guid("5dd9b935-d4c1-480e-bc34-b8cac7b6fd0a")]
[assembly: AssemblyFileVersion("1.0.0.0")]
[assembly: TargetFramework(".NETFramework,Version=v4.5", FrameworkDisplayName = ".NET Framework 4.5")]
[assembly: AssemblyVersion("1.0.0.0")]
namespace GrBuildStudio
{
	internal class AboutBox : Form
	{
		private IContainer components;

		private TableLayoutPanel tableLayoutPanel;

		private PictureBox logoPictureBox;

		private Label labelProductName;

		private Label labelVersion;

		private Label labelCopyright;

		private TextBox textBoxDescription;

		private Button okButton;

		private LinkLabel linkSilk;

		private LinkLabel linkCompanyName;

		public AboutBox()
		{
			InitializeComponent();
			Text = $"About {AssemblyHelper.AssemblyProduct}";
			labelProductName.Text = AssemblyHelper.AssemblyProduct;
			labelVersion.Text = $"Version {AssemblyHelper.AssemblyInformationalVersion}";
			labelCopyright.Text = AssemblyHelper.AssemblyCopyright;
			linkCompanyName.Text = AssemblyHelper.AssemblyCompany;
			textBoxDescription.Text = AssemblyHelper.AssemblyDescription;
		}

		private void linkCompanyName_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
		{
			System.Diagnostics.Process.Start(new ProcessStartInfo("http://www.graphinesoftware.com"));
		}

		private void linkSilk_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
		{
			string text = "ToolLicenses.txt";
			string text2 = "Licenses";
			try
			{
				System.Diagnostics.Process.Start(new ProcessStartInfo(Path.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location), text2, text)));
			}
			catch (Exception)
			{
				MessageBox.Show("Please see the '" + text + "' file in the '" + text2 + "' directory in the tools install directory for more information.");
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.tableLayoutPanel = new System.Windows.Forms.TableLayoutPanel();
			this.logoPictureBox = new System.Windows.Forms.PictureBox();
			this.labelProductName = new System.Windows.Forms.Label();
			this.labelVersion = new System.Windows.Forms.Label();
			this.labelCopyright = new System.Windows.Forms.Label();
			this.linkCompanyName = new System.Windows.Forms.LinkLabel();
			this.textBoxDescription = new System.Windows.Forms.TextBox();
			this.okButton = new System.Windows.Forms.Button();
			this.linkSilk = new System.Windows.Forms.LinkLabel();
			this.tableLayoutPanel.SuspendLayout();
			((System.ComponentModel.ISupportInitialize)this.logoPictureBox).BeginInit();
			base.SuspendLayout();
			this.tableLayoutPanel.ColumnCount = 3;
			this.tableLayoutPanel.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 46.98413f));
			this.tableLayoutPanel.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 53.01587f));
			this.tableLayoutPanel.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Absolute, 85f));
			this.tableLayoutPanel.Controls.Add(this.logoPictureBox, 0, 0);
			this.tableLayoutPanel.Controls.Add(this.labelProductName, 1, 0);
			this.tableLayoutPanel.Controls.Add(this.labelVersion, 1, 1);
			this.tableLayoutPanel.Controls.Add(this.labelCopyright, 1, 2);
			this.tableLayoutPanel.Controls.Add(this.linkCompanyName, 1, 3);
			this.tableLayoutPanel.Controls.Add(this.textBoxDescription, 1, 4);
			this.tableLayoutPanel.Controls.Add(this.okButton, 2, 5);
			this.tableLayoutPanel.Controls.Add(this.linkSilk, 1, 5);
			this.tableLayoutPanel.Dock = System.Windows.Forms.DockStyle.Fill;
			this.tableLayoutPanel.Location = new System.Drawing.Point(9, 9);
			this.tableLayoutPanel.Name = "tableLayoutPanel";
			this.tableLayoutPanel.RowCount = 6;
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 10f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 10f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 10.68376f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 9.82906f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 50.98039f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 10.58823f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Absolute, 28f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Absolute, 20f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Absolute, 20f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Absolute, 20f));
			this.tableLayoutPanel.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Absolute, 20f));
			this.tableLayoutPanel.Size = new System.Drawing.Size(397, 255);
			this.tableLayoutPanel.TabIndex = 0;
			this.logoPictureBox.Dock = System.Windows.Forms.DockStyle.Fill;
			this.logoPictureBox.Image = GrBuildStudio.Properties.Resources.about_logo;
			this.logoPictureBox.Location = new System.Drawing.Point(3, 3);
			this.logoPictureBox.Name = "logoPictureBox";
			this.tableLayoutPanel.SetRowSpan(this.logoPictureBox, 6);
			this.logoPictureBox.Size = new System.Drawing.Size(140, 249);
			this.logoPictureBox.SizeMode = System.Windows.Forms.PictureBoxSizeMode.Zoom;
			this.logoPictureBox.TabIndex = 12;
			this.logoPictureBox.TabStop = false;
			this.tableLayoutPanel.SetColumnSpan(this.labelProductName, 2);
			this.labelProductName.Dock = System.Windows.Forms.DockStyle.Fill;
			this.labelProductName.Location = new System.Drawing.Point(152, 0);
			this.labelProductName.Margin = new System.Windows.Forms.Padding(6, 0, 3, 0);
			this.labelProductName.MaximumSize = new System.Drawing.Size(0, 17);
			this.labelProductName.Name = "labelProductName";
			this.labelProductName.Size = new System.Drawing.Size(242, 17);
			this.labelProductName.TabIndex = 19;
			this.labelProductName.Text = "Granite SDK by Graphine";
			this.labelProductName.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
			this.tableLayoutPanel.SetColumnSpan(this.labelVersion, 2);
			this.labelVersion.Dock = System.Windows.Forms.DockStyle.Fill;
			this.labelVersion.Location = new System.Drawing.Point(152, 24);
			this.labelVersion.Margin = new System.Windows.Forms.Padding(6, 0, 3, 0);
			this.labelVersion.MaximumSize = new System.Drawing.Size(0, 17);
			this.labelVersion.Name = "labelVersion";
			this.labelVersion.Size = new System.Drawing.Size(242, 17);
			this.labelVersion.TabIndex = 0;
			this.labelVersion.Text = "1.9";
			this.labelVersion.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
			this.tableLayoutPanel.SetColumnSpan(this.labelCopyright, 2);
			this.labelCopyright.Dock = System.Windows.Forms.DockStyle.Fill;
			this.labelCopyright.Location = new System.Drawing.Point(152, 48);
			this.labelCopyright.Margin = new System.Windows.Forms.Padding(6, 0, 3, 0);
			this.labelCopyright.MaximumSize = new System.Drawing.Size(0, 17);
			this.labelCopyright.Name = "labelCopyright";
			this.labelCopyright.Size = new System.Drawing.Size(242, 17);
			this.labelCopyright.TabIndex = 21;
			this.labelCopyright.Text = "Copyright (c) 2012-2013";
			this.labelCopyright.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
			this.linkCompanyName.AutoSize = true;
			this.tableLayoutPanel.SetColumnSpan(this.linkCompanyName, 2);
			this.linkCompanyName.Dock = System.Windows.Forms.DockStyle.Fill;
			this.linkCompanyName.Location = new System.Drawing.Point(152, 74);
			this.linkCompanyName.Margin = new System.Windows.Forms.Padding(6, 0, 3, 0);
			this.linkCompanyName.Name = "linkCompanyName";
			this.linkCompanyName.Size = new System.Drawing.Size(242, 24);
			this.linkCompanyName.TabIndex = 26;
			this.linkCompanyName.TabStop = true;
			this.linkCompanyName.Text = "Graphine Software";
			this.linkCompanyName.LinkClicked += new System.Windows.Forms.LinkLabelLinkClickedEventHandler(linkCompanyName_LinkClicked);
			this.tableLayoutPanel.SetColumnSpan(this.textBoxDescription, 2);
			this.textBoxDescription.Dock = System.Windows.Forms.DockStyle.Fill;
			this.textBoxDescription.Location = new System.Drawing.Point(152, 101);
			this.textBoxDescription.Margin = new System.Windows.Forms.Padding(6, 3, 3, 3);
			this.textBoxDescription.Multiline = true;
			this.textBoxDescription.Name = "textBoxDescription";
			this.textBoxDescription.ReadOnly = true;
			this.textBoxDescription.ScrollBars = System.Windows.Forms.ScrollBars.Both;
			this.textBoxDescription.Size = new System.Drawing.Size(242, 121);
			this.textBoxDescription.TabIndex = 23;
			this.textBoxDescription.TabStop = false;
			this.textBoxDescription.Text = "Description";
			this.okButton.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.okButton.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.okButton.Location = new System.Drawing.Point(319, 228);
			this.okButton.Name = "okButton";
			this.okButton.Size = new System.Drawing.Size(75, 24);
			this.okButton.TabIndex = 24;
			this.okButton.Text = "&OK";
			this.linkSilk.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.linkSilk.Location = new System.Drawing.Point(152, 232);
			this.linkSilk.Margin = new System.Windows.Forms.Padding(6, 0, 3, 10);
			this.linkSilk.Name = "linkSilk";
			this.linkSilk.Size = new System.Drawing.Size(156, 13);
			this.linkSilk.TabIndex = 25;
			this.linkSilk.TabStop = true;
			this.linkSilk.Text = "Third Party Licenses";
			this.linkSilk.LinkClicked += new System.Windows.Forms.LinkLabelLinkClickedEventHandler(linkSilk_LinkClicked);
			base.AcceptButton = this.okButton;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.ClientSize = new System.Drawing.Size(415, 273);
			base.Controls.Add(this.tableLayoutPanel);
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "AboutBox";
			base.Padding = new System.Windows.Forms.Padding(9);
			base.ShowIcon = false;
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "About";
			this.tableLayoutPanel.ResumeLayout(false);
			this.tableLayoutPanel.PerformLayout();
			((System.ComponentModel.ISupportInitialize)this.logoPictureBox).EndInit();
			base.ResumeLayout(false);
		}
	}
	public class AssetCustomSizeForm : Form
	{
		internal enum Mode
		{
			Pixels,
			Percent
		}

		internal class DualValue
		{
			private decimal absolute;

			private decimal percentage;

			public Mode ActiveMode { get; set; }

			public decimal BaseAbsoluteValue { get; private set; }

			public decimal Value
			{
				get
				{
					if (ActiveMode == Mode.Pixels)
					{
						return absolute;
					}
					return percentage;
				}
				set
				{
					if (ActiveMode == Mode.Pixels)
					{
						SetAbsolute(value);
					}
					else
					{
						SetPercentage(value);
					}
				}
			}

			public DualValue(decimal baseValue, decimal value, Mode startMode)
			{
				if (baseValue == 0.0m)
				{
					throw new ArgumentException();
				}
				BaseAbsoluteValue = baseValue;
				SetAbsolute(value);
				ActiveMode = startMode;
			}

			private void SetAbsolute(decimal value)
			{
				absolute = value;
				percentage = value * 100m / BaseAbsoluteValue;
			}

			private void SetPercentage(decimal value)
			{
				percentage = value;
				absolute = BaseAbsoluteValue * percentage / 100m;
			}

			public void Set(Mode mode, decimal value)
			{
				if (mode == Mode.Pixels)
				{
					SetAbsolute(value);
				}
				else
				{
					SetPercentage(value);
				}
			}

			public decimal Get(Mode mode)
			{
				if (mode == Mode.Pixels)
				{
					return absolute;
				}
				return percentage;
			}
		}

		public decimal MaximumTargetSize = decimal.MaxValue;

		private DualValue widthValue;

		private DualValue heightValue;

		private bool disableUpdates;

		private IContainer components;

		private NumericUpDown numericUpDownWidth;

		private NumericUpDown numericUpDownHeight;

		private Label label1;

		private Label label2;

		private CheckBox checkBoxAspect;

		private ComboBox comboBoxMethodWidth;

		private ComboBox comboBoxMethodHeight;

		private Label label3;

		private Label label4;

		private Label labelOldSize;

		private Label labelNewSize;

		private Button buttonOk;

		private Button buttonCancel;

		private Line line1;

		private Line line2;

		private Label labelOldAspect;

		private Label label6;

		private Label label7;

		private Label labelNewAspect;

		private CheckBox checkBoxCustom;

		private Button buttonReset;

		public Size TargetSize { get; set; }

		public Size OriginalSize { get; set; }

		public string Title { get; set; }

		public AssetCustomSizeForm()
		{
			InitializeComponent();
			disableUpdates = true;
			numericUpDownWidth.Minimum = 1m;
			numericUpDownWidth.Maximum = MaximumTargetSize;
			numericUpDownHeight.Minimum = 1m;
			numericUpDownHeight.Maximum = MaximumTargetSize;
			checkBoxAspect.Checked = true;
			disableUpdates = false;
		}

		private void AssetCustomSize_Load(object sender, EventArgs e)
		{
			Text = Title;
			disableUpdates = true;
			bool flag = TargetSize.Width > 0 || TargetSize.Height > 0;
			labelOldSize.Text = string.Format("{0} x {1}", new object[2] { OriginalSize.Width, OriginalSize.Height });
			labelOldAspect.Text = ((double)OriginalSize.Width / (double)OriginalSize.Height).ToString();
			comboBoxMethodHeight.SelectedIndex = 0;
			comboBoxMethodWidth.SelectedIndex = 0;
			checkBoxCustom.Checked = flag;
			widthValue = new DualValue(OriginalSize.Width, flag ? TargetSize.Width : OriginalSize.Width, Mode.Pixels);
			heightValue = new DualValue(OriginalSize.Height, flag ? TargetSize.Height : OriginalSize.Height, Mode.Pixels);
			numericUpDownWidth.Value = widthValue.Value;
			numericUpDownHeight.Value = heightValue.Value;
			UpdateControls();
			disableUpdates = false;
			UpdateValues();
		}

		private void SetWidth(decimal value)
		{
			widthValue.Value = value;
			numericUpDownWidth.Value = Math.Min(MaximumTargetSize, widthValue.Value);
		}

		private void SetHeight(decimal value)
		{
			heightValue.Value = value;
			numericUpDownHeight.Value = Math.Min(MaximumTargetSize, heightValue.Value);
		}

		private void SetWidth(Mode mode, decimal value)
		{
			widthValue.Set(mode, value);
			numericUpDownWidth.Value = Math.Min(MaximumTargetSize, widthValue.Value);
		}

		private void SetHeight(Mode mode, decimal value)
		{
			heightValue.Set(mode, value);
			numericUpDownHeight.Value = Math.Min(MaximumTargetSize, heightValue.Value);
		}

		private void UpdateControls()
		{
			bool @checked = checkBoxCustom.Checked;
			checkBoxAspect.Enabled = @checked;
			comboBoxMethodHeight.Enabled = @checked;
			comboBoxMethodWidth.Enabled = @checked;
			numericUpDownHeight.Enabled = @checked;
			numericUpDownWidth.Enabled = @checked;
		}

		private void UpdateValues()
		{
			bool @checked = checkBoxCustom.Checked;
			int num = (int)widthValue.Get(Mode.Pixels);
			int num2 = (int)heightValue.Get(Mode.Pixels);
			TargetSize = (@checked ? new Size(num, num2) : new Size(0, 0));
			labelNewSize.Text = string.Format("{0} x {1}", new object[2] { num, num2 });
			labelNewAspect.Text = ((double)num / (double)num2).ToString("G");
		}

		private void numericUpDownWidth_ValueChanged(object sender, EventArgs e)
		{
			if (!disableUpdates)
			{
				SetWidth(numericUpDownWidth.Value);
				if (checkBoxAspect.Checked)
				{
					disableUpdates = true;
					SetHeight(Mode.Percent, widthValue.Get(Mode.Percent));
					numericUpDownHeight.Value = heightValue.Value;
					disableUpdates = false;
				}
				UpdateValues();
			}
		}

		private void numericUpDownHeight_ValueChanged(object sender, EventArgs e)
		{
			if (!disableUpdates)
			{
				SetHeight(numericUpDownHeight.Value);
				if (checkBoxAspect.Checked)
				{
					disableUpdates = true;
					SetWidth(Mode.Percent, heightValue.Get(Mode.Percent));
					disableUpdates = false;
				}
				UpdateValues();
			}
		}

		private void comboBoxMethodWidth_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (!disableUpdates)
			{
				disableUpdates = true;
				Mode activeMode = widthValue.ActiveMode;
				widthValue.ActiveMode = (Mode)comboBoxMethodWidth.SelectedIndex;
				SetWidth(activeMode, numericUpDownWidth.Value);
				disableUpdates = false;
				UpdateValues();
			}
		}

		private void comboBoxMethodHeight_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (!disableUpdates)
			{
				disableUpdates = true;
				Mode activeMode = heightValue.ActiveMode;
				heightValue.ActiveMode = (Mode)comboBoxMethodHeight.SelectedIndex;
				SetHeight(activeMode, numericUpDownHeight.Value);
				disableUpdates = false;
				UpdateValues();
			}
		}

		private void checkBoxAspect_CheckedChanged(object sender, EventArgs e)
		{
			if (!disableUpdates)
			{
				if (checkBoxAspect.Checked)
				{
					disableUpdates = true;
					SetHeight(Mode.Percent, widthValue.Get(Mode.Percent));
					disableUpdates = false;
				}
				UpdateValues();
			}
		}

		private void buttonReset_Click(object sender, EventArgs e)
		{
			disableUpdates = true;
			SetWidth(Mode.Pixels, OriginalSize.Width);
			SetHeight(Mode.Pixels, OriginalSize.Height);
			comboBoxMethodWidth.SelectedIndex = 0;
			comboBoxMethodHeight.SelectedIndex = 0;
			checkBoxAspect.Checked = true;
			disableUpdates = false;
			UpdateValues();
		}

		private void checkBoxCustom_CheckedChanged(object sender, EventArgs e)
		{
			UpdateControls();
			if (!disableUpdates)
			{
				UpdateValues();
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.numericUpDownWidth = new System.Windows.Forms.NumericUpDown();
			this.numericUpDownHeight = new System.Windows.Forms.NumericUpDown();
			this.label1 = new System.Windows.Forms.Label();
			this.label2 = new System.Windows.Forms.Label();
			this.checkBoxAspect = new System.Windows.Forms.CheckBox();
			this.comboBoxMethodWidth = new System.Windows.Forms.ComboBox();
			this.comboBoxMethodHeight = new System.Windows.Forms.ComboBox();
			this.label3 = new System.Windows.Forms.Label();
			this.label4 = new System.Windows.Forms.Label();
			this.labelOldSize = new System.Windows.Forms.Label();
			this.labelNewSize = new System.Windows.Forms.Label();
			this.buttonOk = new System.Windows.Forms.Button();
			this.buttonCancel = new System.Windows.Forms.Button();
			this.line1 = new DevComponents.DotNetBar.Controls.Line();
			this.line2 = new DevComponents.DotNetBar.Controls.Line();
			this.labelOldAspect = new System.Windows.Forms.Label();
			this.label6 = new System.Windows.Forms.Label();
			this.label7 = new System.Windows.Forms.Label();
			this.labelNewAspect = new System.Windows.Forms.Label();
			this.checkBoxCustom = new System.Windows.Forms.CheckBox();
			this.buttonReset = new System.Windows.Forms.Button();
			((System.ComponentModel.ISupportInitialize)this.numericUpDownWidth).BeginInit();
			((System.ComponentModel.ISupportInitialize)this.numericUpDownHeight).BeginInit();
			base.SuspendLayout();
			this.numericUpDownWidth.Location = new System.Drawing.Point(119, 138);
			this.numericUpDownWidth.Name = "numericUpDownWidth";
			this.numericUpDownWidth.Size = new System.Drawing.Size(75, 20);
			this.numericUpDownWidth.TabIndex = 2;
			this.numericUpDownWidth.ValueChanged += new System.EventHandler(numericUpDownWidth_ValueChanged);
			this.numericUpDownHeight.Location = new System.Drawing.Point(119, 164);
			this.numericUpDownHeight.Name = "numericUpDownHeight";
			this.numericUpDownHeight.Size = new System.Drawing.Size(75, 20);
			this.numericUpDownHeight.TabIndex = 3;
			this.numericUpDownHeight.ValueChanged += new System.EventHandler(numericUpDownHeight_ValueChanged);
			this.label1.AutoSize = true;
			this.label1.Location = new System.Drawing.Point(41, 140);
			this.label1.Name = "label1";
			this.label1.Size = new System.Drawing.Size(38, 13);
			this.label1.TabIndex = 1;
			this.label1.Text = "Width:";
			this.label2.AutoSize = true;
			this.label2.Location = new System.Drawing.Point(41, 166);
			this.label2.Name = "label2";
			this.label2.Size = new System.Drawing.Size(41, 13);
			this.label2.TabIndex = 1;
			this.label2.Text = "Height:";
			this.checkBoxAspect.AutoSize = true;
			this.checkBoxAspect.Location = new System.Drawing.Point(21, 112);
			this.checkBoxAspect.Name = "checkBoxAspect";
			this.checkBoxAspect.Size = new System.Drawing.Size(124, 17);
			this.checkBoxAspect.TabIndex = 1;
			this.checkBoxAspect.Text = "Maintain aspect ratio";
			this.checkBoxAspect.UseVisualStyleBackColor = true;
			this.checkBoxAspect.CheckedChanged += new System.EventHandler(checkBoxAspect_CheckedChanged);
			this.comboBoxMethodWidth.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxMethodWidth.FormattingEnabled = true;
			this.comboBoxMethodWidth.Items.AddRange(new object[2] { "pixels", "percentage" });
			this.comboBoxMethodWidth.Location = new System.Drawing.Point(200, 137);
			this.comboBoxMethodWidth.Name = "comboBoxMethodWidth";
			this.comboBoxMethodWidth.Size = new System.Drawing.Size(90, 21);
			this.comboBoxMethodWidth.TabIndex = 4;
			this.comboBoxMethodWidth.SelectedIndexChanged += new System.EventHandler(comboBoxMethodWidth_SelectedIndexChanged);
			this.comboBoxMethodHeight.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxMethodHeight.FormattingEnabled = true;
			this.comboBoxMethodHeight.Items.AddRange(new object[2] { "pixels", "percentage" });
			this.comboBoxMethodHeight.Location = new System.Drawing.Point(200, 163);
			this.comboBoxMethodHeight.Name = "comboBoxMethodHeight";
			this.comboBoxMethodHeight.Size = new System.Drawing.Size(90, 21);
			this.comboBoxMethodHeight.TabIndex = 5;
			this.comboBoxMethodHeight.SelectedIndexChanged += new System.EventHandler(comboBoxMethodHeight_SelectedIndexChanged);
			this.label3.AutoSize = true;
			this.label3.Location = new System.Drawing.Point(18, 20);
			this.label3.Name = "label3";
			this.label3.Size = new System.Drawing.Size(68, 13);
			this.label3.TabIndex = 4;
			this.label3.Text = "Original Size:";
			this.label4.AutoSize = true;
			this.label4.Location = new System.Drawing.Point(18, 225);
			this.label4.Name = "label4";
			this.label4.Size = new System.Drawing.Size(55, 13);
			this.label4.TabIndex = 4;
			this.label4.Text = "New Size:";
			this.labelOldSize.AutoSize = true;
			this.labelOldSize.Location = new System.Drawing.Point(132, 20);
			this.labelOldSize.Name = "labelOldSize";
			this.labelOldSize.Size = new System.Drawing.Size(83, 13);
			this.labelOldSize.TabIndex = 4;
			this.labelOldSize.Text = "960 x 600 pixels";
			this.labelNewSize.AutoSize = true;
			this.labelNewSize.Location = new System.Drawing.Point(132, 225);
			this.labelNewSize.Name = "labelNewSize";
			this.labelNewSize.Size = new System.Drawing.Size(95, 13);
			this.labelNewSize.TabIndex = 4;
			this.labelNewSize.Text = "2048 x 2048 pixels";
			this.buttonOk.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonOk.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.buttonOk.Location = new System.Drawing.Point(179, 283);
			this.buttonOk.Name = "buttonOk";
			this.buttonOk.Size = new System.Drawing.Size(75, 23);
			this.buttonOk.TabIndex = 6;
			this.buttonOk.Text = "OK";
			this.buttonOk.UseVisualStyleBackColor = true;
			this.buttonCancel.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.buttonCancel.Location = new System.Drawing.Point(260, 283);
			this.buttonCancel.Name = "buttonCancel";
			this.buttonCancel.Size = new System.Drawing.Size(75, 23);
			this.buttonCancel.TabIndex = 7;
			this.buttonCancel.Text = "Cancel";
			this.buttonCancel.UseVisualStyleBackColor = true;
			this.line1.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.line1.Location = new System.Drawing.Point(12, 86);
			this.line1.Name = "line1";
			this.line1.Size = new System.Drawing.Size(323, 23);
			this.line1.TabIndex = 6;
			this.line1.Text = "line1";
			this.line2.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.line2.Location = new System.Drawing.Point(12, 194);
			this.line2.Name = "line2";
			this.line2.Size = new System.Drawing.Size(323, 23);
			this.line2.TabIndex = 6;
			this.line2.Text = "line1";
			this.labelOldAspect.AutoSize = true;
			this.labelOldAspect.Location = new System.Drawing.Point(132, 43);
			this.labelOldAspect.Name = "labelOldAspect";
			this.labelOldAspect.Size = new System.Drawing.Size(34, 13);
			this.labelOldAspect.TabIndex = 7;
			this.labelOldAspect.Text = "1.333";
			this.label6.AutoSize = true;
			this.label6.Location = new System.Drawing.Point(18, 43);
			this.label6.Name = "label6";
			this.label6.Size = new System.Drawing.Size(109, 13);
			this.label6.TabIndex = 8;
			this.label6.Text = "Original Aspect Ratio:";
			this.label7.AutoSize = true;
			this.label7.Location = new System.Drawing.Point(18, 248);
			this.label7.Name = "label7";
			this.label7.Size = new System.Drawing.Size(96, 13);
			this.label7.TabIndex = 8;
			this.label7.Text = "New Aspect Ratio:";
			this.labelNewAspect.AutoSize = true;
			this.labelNewAspect.Location = new System.Drawing.Point(132, 248);
			this.labelNewAspect.Name = "labelNewAspect";
			this.labelNewAspect.Size = new System.Drawing.Size(34, 13);
			this.labelNewAspect.TabIndex = 7;
			this.labelNewAspect.Text = "1.333";
			this.checkBoxCustom.AutoSize = true;
			this.checkBoxCustom.Location = new System.Drawing.Point(21, 70);
			this.checkBoxCustom.Name = "checkBoxCustom";
			this.checkBoxCustom.Size = new System.Drawing.Size(84, 17);
			this.checkBoxCustom.TabIndex = 10;
			this.checkBoxCustom.Text = "Custom Size";
			this.checkBoxCustom.UseVisualStyleBackColor = true;
			this.checkBoxCustom.CheckedChanged += new System.EventHandler(checkBoxCustom_CheckedChanged);
			this.buttonReset.Location = new System.Drawing.Point(287, 108);
			this.buttonReset.Name = "buttonReset";
			this.buttonReset.Size = new System.Drawing.Size(48, 23);
			this.buttonReset.TabIndex = 11;
			this.buttonReset.Text = "Reset";
			this.buttonReset.UseVisualStyleBackColor = true;
			this.buttonReset.Click += new System.EventHandler(buttonReset_Click);
			base.AcceptButton = this.buttonOk;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.CancelButton = this.buttonCancel;
			base.ClientSize = new System.Drawing.Size(347, 318);
			base.Controls.Add(this.buttonReset);
			base.Controls.Add(this.checkBoxCustom);
			base.Controls.Add(this.labelNewAspect);
			base.Controls.Add(this.label7);
			base.Controls.Add(this.labelOldAspect);
			base.Controls.Add(this.label6);
			base.Controls.Add(this.line2);
			base.Controls.Add(this.line1);
			base.Controls.Add(this.buttonCancel);
			base.Controls.Add(this.buttonOk);
			base.Controls.Add(this.label4);
			base.Controls.Add(this.labelNewSize);
			base.Controls.Add(this.labelOldSize);
			base.Controls.Add(this.label3);
			base.Controls.Add(this.comboBoxMethodHeight);
			base.Controls.Add(this.comboBoxMethodWidth);
			base.Controls.Add(this.checkBoxAspect);
			base.Controls.Add(this.label2);
			base.Controls.Add(this.label1);
			base.Controls.Add(this.numericUpDownHeight);
			base.Controls.Add(this.numericUpDownWidth);
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedToolWindow;
			base.Name = "AssetCustomSize";
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "Resize Asset";
			base.Load += new System.EventHandler(AssetCustomSize_Load);
			((System.ComponentModel.ISupportInitialize)this.numericUpDownWidth).EndInit();
			((System.ComponentModel.ISupportInitialize)this.numericUpDownHeight).EndInit();
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	public class AssetDetails : UserControl
	{
		public enum SelectionType
		{
			Asset,
			AssetGroup,
			Layer,
			Texture
		}

		public struct SelectionContext
		{
			public SelectionType Type { get; set; }

			public Guid ProjectId { get; set; }

			public Guid AssetId { get; set; }

			public string AssetGroupId { get; set; }

			public int LayerIndex { get; set; }

			public Texture Texture { get; set; }

			public SelectionContext(Guid projectId, Guid assetId)
			{
				this = default(SelectionContext);
				Type = SelectionType.Asset;
				ProjectId = projectId;
				AssetId = assetId;
			}

			public SelectionContext(Guid projectId, string assetGroupId)
			{
				this = default(SelectionContext);
				Type = SelectionType.AssetGroup;
				ProjectId = projectId;
				AssetGroupId = assetGroupId;
			}

			public SelectionContext(Guid projectId, Guid assetId, int layer)
			{
				this = default(SelectionContext);
				Type = SelectionType.Layer;
				ProjectId = projectId;
				AssetId = assetId;
				LayerIndex = layer;
			}

			public SelectionContext(Guid projectId, Guid assetId, int layer, Texture texture)
			{
				this = default(SelectionContext);
				Type = SelectionType.Texture;
				ProjectId = projectId;
				AssetId = assetId;
				LayerIndex = layer;
				Texture = texture;
			}
		}

		private class ScaleComboHelper
		{
			public struct Values
			{
				public AssetLayerResizeMode mode;

				public int targetWidth;

				public int targetHeight;

				public Values(AssetLayerResizeMode mode, int targetWidth, int targetHeight)
				{
					this.mode = mode;
					this.targetWidth = targetWidth;
					this.targetHeight = targetHeight;
				}
			}

			private enum ScaleValue
			{
				Automatic,
				RelativeToStackedTexture2,
				RelativeToStackedTexture4,
				RelativeToStackedTexture8,
				RelativeToSource2,
				RelativeToSource4,
				RelativeToSource8
			}

			private static string toString(ScaleValue value)
			{
				return (new string[7] { "Automatic", "1/2x of Stacked Texture", "1/4x of Stacked Texture", "1/8x of Stacked Texture", "1/2x of Source Texture", "1/4x of Source Texture", "1/8x of Source Texture" })[(int)value];
			}

			public static void FillCombo(ComboBox combo)
			{
				ComboBoxHelper.FillEnumComboBox<ScaleValue>(combo, toString);
			}

			public static Values GetComboValue(ComboBox combo)
			{
				return ComboBoxHelper.GetSelectedValue<ScaleValue>(combo) switch
				{
					ScaleValue.Automatic => new Values(AssetLayerResizeMode.Absolute, 0, 0), 
					ScaleValue.RelativeToSource2 => new Values(AssetLayerResizeMode.RelativeToSource, -1, -1), 
					ScaleValue.RelativeToSource4 => new Values(AssetLayerResizeMode.RelativeToSource, -2, -2), 
					ScaleValue.RelativeToSource8 => new Values(AssetLayerResizeMode.RelativeToSource, -3, -3), 
					ScaleValue.RelativeToStackedTexture2 => new Values(AssetLayerResizeMode.RelativeToStackedTexture, -1, -1), 
					ScaleValue.RelativeToStackedTexture4 => new Values(AssetLayerResizeMode.RelativeToStackedTexture, -2, -2), 
					ScaleValue.RelativeToStackedTexture8 => new Values(AssetLayerResizeMode.RelativeToStackedTexture, -3, -3), 
					_ => new Values(AssetLayerResizeMode.Absolute, 0, 0), 
				};
			}

			public static void SetComboValue(ComboBox combo, AssetLayerResizeMode mode, int targetWidth, int targetHeight)
			{
				ScaleValue tag = ScaleValue.Automatic;
				if (targetWidth != 0 || targetHeight != 0)
				{
					switch (mode)
					{
					case AssetLayerResizeMode.RelativeToStackedTexture:
						tag = targetWidth switch
						{
							-1 => ScaleValue.RelativeToStackedTexture2, 
							-2 => ScaleValue.RelativeToStackedTexture4, 
							-3 => ScaleValue.RelativeToStackedTexture8, 
							_ => ScaleValue.Automatic, 
						};
						break;
					case AssetLayerResizeMode.RelativeToSource:
						tag = targetWidth switch
						{
							-1 => ScaleValue.RelativeToSource2, 
							-2 => ScaleValue.RelativeToSource4, 
							-3 => ScaleValue.RelativeToSource8, 
							_ => ScaleValue.Automatic, 
						};
						break;
					}
				}
				ComboBoxHelper.SelectComboBoxItem(combo, tag);
			}
		}

		public delegate void AssetChangedEventHandler(object sender, Asset asset, ProjectBuilder builder);

		private SolutionModel model;

		private bool loading;

		private ChannelMerging.ChannelMask mask;

		private System.Windows.Forms.ToolTip toolTipTextureFileAbs = new System.Windows.Forms.ToolTip();

		private SelectionContext ActiveSelection;

		private IContainer components;

		private TabStrip tabStrip1;

		private TabItem tabItemLayerInfo;

		private TabItem tabItemAssetInfo;

		private Panel panel1;

		private LabelX labelX4;

		private LabelX labelLayerCount;

		private LabelX label4;

		private LabelX labelNaturalSize;

		private LabelX label1;

		private Panel panel2;

		private LabelX labelType;

		private LabelX labelX5;

		private ComboBox comboBoxFlip;

		private LabelX labelX1;

		private LabelX labelLayerName;

		private LabelX labelX3;

		private LabelX labelDataType;

		private LabelX labelX2;

		private ComboBox comboBoxQualty;

		private LabelX label13;

		private Panel panel3;

		private Button buttonShowTexture;

		private TabItem tabItemTextureInfo;

		private LabelX labelStatus;

		private ToolTip ToolTip;

		private LabelX labelInfo;

		private LabelX labelX6;

		private LabelX labelIcon;

		private LabelX labelAssetPanelGroupId;

		private LabelX labelX8;

		private Panel panel4;

		private LabelX labelGroupPanelGroupId;

		private LabelX labelX9;

		private TabItem tabItemGroupInfo;

		private LabelX labelStackedTextureCount;

		private LabelX labelX10;

		private LabelX labelX7;

		private LabelX labelAssetType;

		private LabelX labelX12;

		private LabelX labelGroupType;

		private LabelX labelX13;

		private ComboBox comboBoxBorderMethod;

		private LabelX labelX16;

		private ComboBox comboBoxMipMaps;

		private Button buttonSizeAsset;

		private LabelX labelX14;

		private LabelX labelTargetSize;

		private SwizzleControl swizzle0;

		private SwizzleControl swizzle1;

		private TextBoxX nameTextBox;

		private LabelX labelX17;

		private LabelX labelTextureFileAbs;

		private LabelX labelSwizzle1;

		private LabelX labelSwizzle0;

		private LabelX labelX11;

		private LabelX labelTextureFileModified;

		private LabelX labelTextureFileSize;

		private LabelX labelX18;

		private LabelX labelCodingProfile;

		private LabelX labelX15;

		private LabelX labelX19;

		private ComboBox comboBoxSizeMode;

		private InvertChannelsControl invertChannels0;

		private LabelX labelInvertChannel0;

		private LabelX labelInvertChannel1;

		private InvertChannelsControl invertChannels1;

		private LabelX labelInvertChannel3;

		private InvertChannelsControl invertChannels3;

		private SwizzleControl swizzle3;

		private LabelX labelSwizzle3;

		private LabelX labelInvertChannel2;

		private InvertChannelsControl invertChannels2;

		private SwizzleControl swizzle2;

		private LabelX labelSwizzle2;

		private LabelX labelMissingTextures;

		public bool ReadOnly { get; private set; }

		public Asset Asset { get; set; }

		public Texture Texture { get; private set; }

		public ProjectBuilder Builder { get; private set; }

		public int LayerIndex { get; private set; }

		public string AssetGroupId { get; private set; }

		private SelectionType Type { get; set; }

		public Guid ProjectId { get; private set; }

		private bool IsUpdatingAsset { get; set; }

		public event AssetChangedEventHandler AssetChanged;

		protected virtual void OnAssetChanged(Asset asset, ProjectBuilder builder)
		{
			IsUpdatingAsset = true;
			this.AssetChanged?.Invoke(this, asset, builder);
			IsUpdatingAsset = false;
		}

		public AssetDetails()
		{
			InitializeComponent();
			panel1.Dock = DockStyle.Fill;
			panel2.Dock = DockStyle.Fill;
			panel3.Dock = DockStyle.Fill;
			panel4.Dock = DockStyle.Fill;
			labelStatus.Dock = DockStyle.Top;
			UpdatePanelVisibility(hideAll: true);
		}

		public void Create(SolutionModel model)
		{
			this.model = model;
			model.ProjectAssetChanged += model_ProjectAssetChanged;
		}

		private void model_ProjectAssetChanged(object sender, Guid projectId, Asset asset)
		{
			if (sender != this && !IsUpdatingAsset && asset == Asset)
			{
				RefreshSelection();
			}
		}

		private string CapitalizeString(string qp)
		{
			if (qp.Length > 1)
			{
				return char.ToUpper(qp[0]) + qp.Substring(1);
			}
			return qp.ToUpper();
		}

		private void CreateQualityCombo()
		{
			comboBoxQualty.Items.Clear();
			comboBoxQualty.Enabled = !ReadOnly;
			foreach (string availableQualityProfile in GetAvailableQualityProfiles(Builder, Asset, LayerIndex))
			{
				comboBoxQualty.Items.Add(CapitalizeString(availableQualityProfile));
			}
			string text = Asset.AssetLayers[LayerIndex].QualityProfile;
			if (text == null || text.Length == 0)
			{
				text = "default";
			}
			comboBoxQualty.SelectedItem = CapitalizeString(text);
		}

		private void CreateSizeModeCombo()
		{
			ScaleComboHelper.FillCombo(comboBoxSizeMode);
			AssetLayer assetLayer = Asset.AssetLayers[LayerIndex];
			ScaleComboHelper.SetComboValue(comboBoxSizeMode, assetLayer.ResizeMode, assetLayer.TargetWidth, assetLayer.TargetHeight);
			int num = ((Asset.TargetWidth > 0) ? Asset.TargetWidth : Asset.Width);
			int num2 = ((Asset.TargetHeight > 0) ? Asset.TargetHeight : Asset.Height);
			bool flag = ExtraMath.IsPowerOfTwo((ulong)num) && ExtraMath.IsPowerOfTwo((ulong)num2);
			bool flag2 = Asset.AssetLayers.Count == 1;
			comboBoxSizeMode.Enabled = !ReadOnly && !flag2 && flag;
		}

		private List<T> EnumToList<T>()
		{
			List<T> list = new List<T>();
			Array values = System.Enum.GetValues(typeof(T));
			for (int i = 0; i < values.Length; i++)
			{
				list.Add((T)values.GetValue(i));
			}
			return list;
		}

		private void CreateFlipCombo()
		{
			comboBoxFlip.Items.Clear();
			comboBoxFlip.Enabled = !ReadOnly;
			foreach (Flip item in EnumToList<Flip>())
			{
				comboBoxFlip.Items.Add(item);
			}
			Flip flip = Asset.AssetLayers[LayerIndex].Flip;
			comboBoxFlip.SelectedItem = flip;
		}

		private void ClearCombos()
		{
			comboBoxQualty.Items.Clear();
			comboBoxQualty.Enabled = false;
			comboBoxFlip.Items.Clear();
			comboBoxFlip.Enabled = false;
		}

		private List<string> GetAvailableQualityProfiles(ProjectBuilder builder, Asset asset, int layerIdx)
		{
			DataType dataType = builder.ActiveProject.LayerConfiguration.Layers[layerIdx].DataType;
			return CodingProfileHelper.GetAvailableQualityProfiles(builder.ActiveProject.LayerConfiguration.Layers[layerIdx].CodingProfile, dataType, includeHidden: false, includeDefault: true);
		}

		private void LoadAssetGroup()
		{
			labelGroupPanelGroupId.Text = ((AssetGroupId == null || AssetGroupId.Length == 0) ? "none" : AssetGroupId);
			List<Asset> list = model.FindAssetGroupAsset(ProjectId, AssetGroupId);
			labelStackedTextureCount.Text = list.Count.ToString();
			if (list.Count > 0)
			{
				labelGroupType.Text = list[0].Type.ToString();
			}
			else
			{
				labelGroupType.Text = "Normal";
			}
		}

		private void LoadAsset()
		{
			LoadAssetGroup();
			ClearCombos();
			labelInfo.Text = GetAssetState(Asset);
			nameTextBox.Text = Asset.Name;
			nameTextBox.Enabled = !ReadOnly;
			buttonSizeAsset.Enabled = !ReadOnly;
			labelAssetPanelGroupId.Text = ((Asset.AssetGroupId == null || Asset.AssetGroupId.Length == 0) ? "none" : Asset.AssetGroupId);
			Size size = AssetTools.CalculateAssetSize(Asset);
			labelNaturalSize.Text = size.Width + " x " + size.Height;
			labelLayerCount.Text = Asset.AssetLayers.Count.ToString();
			labelAssetType.Text = ((Asset.Type == AssetType.CubeMap) ? "Cubemap Face" : Asset.Type.ToString());
			string text = string.Format("{0} x {1}", new object[2] { Asset.TargetWidth, Asset.TargetHeight });
			string text2 = string.Format("{0} x {1}", new object[2] { size.Width, size.Height });
			labelTargetSize.Text = ((Asset.TargetWidth != 0 && Asset.TargetHeight != 0) ? ("Custom: " + text) : ("Automatic: " + text2));
			CreateBorderMethodCombo();
		}

		private void CreateBorderMethodCombo()
		{
			comboBoxBorderMethod.Items.Clear();
			comboBoxBorderMethod.Enabled = !ReadOnly;
			string[] names = System.Enum.GetNames(typeof(AssetTilingMethod));
			foreach (string qp in names)
			{
				comboBoxBorderMethod.Items.Add(CapitalizeString(qp));
			}
			comboBoxBorderMethod.SelectedItem = Asset.TilingMethod.ToString();
			int num = ((Asset.TargetWidth > 0) ? Asset.TargetWidth : Asset.Width);
			int num2 = ((Asset.TargetHeight > 0) ? Asset.TargetHeight : Asset.Height);
			bool flag = ExtraMath.IsPowerOfTwo((ulong)num) && ExtraMath.IsPowerOfTwo((ulong)num2);
			bool flag2 = Asset.Type == AssetType.CubeMap;
			comboBoxBorderMethod.Enabled = !ReadOnly && flag && !flag2;
		}

		private string GetAssetState(Asset asset)
		{
			AssetState assetState = Builder.BuildStateSummary.AssetStates[asset.Id];
			string assetStateInfo = State.GetAssetStateInfo(assetState);
			labelIcon.Image = State.GetAssetIcon(assetState);
			return assetStateInfo;
		}

		private void LoadLayer()
		{
			LoadAsset();
			if (LayerIndex >= 0 || LayerIndex < Asset.AssetLayers.Count)
			{
				LayerDescription layerDescription = Builder.ActiveProject.LayerConfiguration.Layers[LayerIndex];
				AssetLayer assetLayer = Asset.AssetLayers[LayerIndex];
				DataType dataType = layerDescription.DataType;
				labelDataType.Text = dataType.ToString();
				labelLayerName.Text = layerDescription.LayerName;
				ProfileLoader.LoadCodingProfile(layerDescription.CodingProfile, out var profile);
				if (profile != null)
				{
					labelCodingProfile.Text = profile.DisplayName;
				}
				tabItemLayerInfo.Text = "Layer '" + layerDescription.LayerName + "'";
				Size size = AssetTools.CalculateAssetSize(Asset);
				string.Format("{0} x {1}", new object[2] { assetLayer.TargetWidth, assetLayer.TargetHeight });
				string.Format("{0} x {1}", new object[2] { size.Width, size.Height });
				CreateSizeModeCombo();
				CreateQualityCombo();
				CreateFlipCombo();
				SetupMasks();
				LoadSwizzleAndInvert();
				CreateMipMapsCombo();
				SetupType();
			}
		}

		private string GetType(int subIdx)
		{
			List<Texture> list = Asset.AssetLayers[LayerIndex].Textures.Where((Texture _tex) => _tex.SubIndex == subIdx).ToList();
			int count = list.Count;
			if (count == 0)
			{
				return "";
			}
			if (count == 1)
			{
				return "Single File";
			}
			if (count > 1)
			{
				if (Asset.UDimSettings[subIdx] == null)
				{
					return $"Tiled ({list.Count} files)";
				}
				return $"UDIM ({list.Count} patches)";
			}
			return "Unknown";
		}

		private void SetupMasks()
		{
			_ = Asset.AssetLayers[LayerIndex].Textures;
			AssetPackingMode packingMode = Asset.AssetLayers[LayerIndex].PackingMode;
			DataType dataType = Builder.ActiveProject.LayerConfiguration.Layers[LayerIndex].DataType;
			Dictionary<AssetPackingMode, ChannelMerging.ChannelMask> allMasks = new Dictionary<AssetPackingMode, ChannelMerging.ChannelMask>();
			ChannelMerging.GetAllChannelMasks(dataType, ref allMasks);
			if (allMasks.ContainsKey(packingMode))
			{
				mask = allMasks[packingMode];
			}
			else
			{
				mask = null;
			}
		}

		private void SetupType()
		{
			string text;
			if (GetType(0).Equals(string.Empty))
			{
				text = "Empty";
			}
			else if (mask != null)
			{
				text = "";
				for (int i = 0; i < 4; i++)
				{
					string text2 = mask.humanReadable[i];
					if (string.IsNullOrEmpty(text2))
					{
						continue;
					}
					string type = GetType(i);
					if (!string.IsNullOrEmpty(type))
					{
						if (i != 0)
						{
							text += ", ";
						}
						text += string.Format("{0}: {1}", new object[2] { text2, type });
					}
				}
			}
			else
			{
				text = GetType(0);
			}
			labelType.Text = text;
		}

		private void CreateMipMapsCombo()
		{
			comboBoxMipMaps.Enabled = !ReadOnly;
			comboBoxMipMaps.DataSource = System.Enum.GetValues(typeof(TextureMipSourceType));
			TextureMipSourceType mipSourceType = Asset.AssetLayers[LayerIndex].MipSourceType;
			comboBoxMipMaps.SelectedItem = mipSourceType;
		}

		private void LoadSwizzleAndInvert()
		{
			AssetLayer assetLayer = Asset.AssetLayers[LayerIndex];
			LayerDescription layerDescription = Builder.ActiveProject.LayerConfiguration.Layers[LayerIndex];
			SwizzleControl[] array = new SwizzleControl[4] { swizzle0, swizzle1, swizzle2, swizzle3 };
			LabelX[] array2 = new LabelX[4] { labelSwizzle0, labelSwizzle1, labelSwizzle2, labelSwizzle3 };
			InvertChannelsControl[] array3 = new InvertChannelsControl[4] { invertChannels0, invertChannels1, invertChannels2, invertChannels3 };
			LabelX[] array4 = new LabelX[4] { labelInvertChannel0, labelInvertChannel1, labelInvertChannel2, labelInvertChannel3 };
			int num = 28;
			int num2 = comboBoxMipMaps.Location.Y + num;
			int i;
			for (i = 0; i < 4; i++)
			{
				int numTextureChannels = AssetTools.GetNumTextureChannels(Asset, Builder, LayerIndex, i);
				string text = ((mask != null) ? mask.humanReadable[i] : string.Empty);
				string arg = ((!string.IsNullOrEmpty(text)) ? ("(" + text + ")") : string.Empty);
				string arg2 = (ChannelMerging.IsCombinedMode(assetLayer.PackingMode) ? i.ToString() : string.Empty);
				bool flag = assetLayer.Textures.Where((Texture _tex) => _tex.SubIndex == i).Count() > 0;
				if (flag)
				{
					array[i].Initialize(numTextureChannels, assetLayer.Swizzle[i], showPresetButton: true, Constants.SwizzlePresets);
					array[i].OnSwizzleChanged += comboBoxSwizzleX_SelectedIndexChanged;
					array2[i].Text = $"Swizzle {arg2} {arg}";
					array[i].Tag = i;
				}
				array2[i].Visible = flag;
				array[i].Visible = flag;
				array2[i].Location = new Point(array2[i].Location.X, num2);
				array[i].Location = new Point(array[i].Location.X, num2);
				num2 += num * (flag ? 1 : 0);
				if (flag)
				{
					string text2 = text;
					if (string.IsNullOrEmpty(text2))
					{
						text2 = ChannelMerging.GetDataTypeChannelNames(layerDescription.DataType);
					}
					array3[i].Initialize(numTextureChannels, text2, assetLayer.InvertChannels[i]);
					array3[i].ValuesChanged += invertChannels_ValuesChanged;
					array4[i].Text = $"Invert Channel {arg2} {arg}";
					array3[i].Tag = i;
				}
				array3[i].Visible = flag;
				array4[i].Visible = flag;
				array4[i].Location = new Point(array4[i].Location.X, num2);
				array3[i].Location = new Point(array3[i].Location.X, num2);
				num2 += num * (flag ? 1 : 0);
				array[i].Enabled = !ReadOnly;
				array3[i].Enabled = !ReadOnly;
			}
		}

		private void invertChannels_ValuesChanged(object sender, EventArgs e)
		{
			if (Asset == null || loading)
			{
				return;
			}
			InvertChannelsControl invertChannelsControl = (InvertChannelsControl)sender;
			int num = (int)invertChannelsControl.Tag;
			if (LayerIndex >= 0 && LayerIndex < Asset.AssetLayers.Count)
			{
				string invertValue = invertChannelsControl.InvertValue;
				if (Asset.AssetLayers[LayerIndex].InvertChannels[num] != invertValue)
				{
					Asset.AssetLayers[LayerIndex].InvertChannels[num] = invertValue;
					ChangeLayerState(CausingChanges.InputChanged);
					OnAssetChanged(Asset, Builder);
				}
			}
		}

		private void LoadTexture()
		{
			LoadLayer();
			try
			{
				string absolutePath = ShellTools.GetAbsolutePath(model.GetProjectAbsolutePath(ProjectId), Texture.Source);
				labelTextureFileAbs.Text = absolutePath;
				toolTipTextureFileAbs.SetToolTip(labelTextureFileAbs, absolutePath);
				FileInfo fileInfo = new FileInfo(absolutePath);
				labelTextureFileModified.Text = DateTimeManagement.Round(fileInfo.LastWriteTime).ToString("F");
				labelTextureFileSize.Text = Various.FormatBytes(fileInfo.Length);
			}
			catch
			{
				labelTextureFileAbs.Text = "";
				toolTipTextureFileAbs.SetToolTip(labelTextureFileAbs, "");
				labelTextureFileModified.Text = "unknown";
				labelTextureFileSize.Text = "unknown";
			}
		}

		private void SelectTabWithoutFocus(int index)
		{
			tabStrip1.SelectedTabIndex = index;
			UpdatePanelVisibility(hideAll: false);
		}

		private void RefreshSelection()
		{
			SetSelection(ActiveSelection);
		}

		public void SetSelection(SelectionContext selection)
		{
			if (model == null)
			{
				return;
			}
			ActiveSelection = selection;
			loading = true;
			LayerIndex = selection.LayerIndex;
			Texture = selection.Texture;
			AssetGroupId = selection.AssetGroupId;
			Builder = model.SolutionBuilder.GetProjectBuilder(selection.ProjectId);
			ProjectId = selection.ProjectId;
			Asset = model.FindAsset(selection.ProjectId, selection.AssetId);
			if (Asset == null && selection.Type != SelectionType.AssetGroup)
			{
				Clear();
				loading = false;
				return;
			}
			bool flag = false;
			if (selection.Type == SelectionType.AssetGroup)
			{
				List<Asset> list = model.FindAssetGroupAsset(ProjectId, AssetGroupId);
				if (list.Count > 0)
				{
					AssetState assetState = Builder.BuildStateSummary.AssetStates[list[0].Id];
					if (assetState != null)
					{
						flag = assetState.FailureState == FailureState.TextureNotFound || assetState.FailureState == FailureState.TextureInaccessible;
					}
				}
			}
			else
			{
				AssetState assetState2 = Builder.BuildStateSummary.AssetStates[Asset.Id];
				if (assetState2 != null)
				{
					flag = assetState2.FailureState == FailureState.TextureNotFound || assetState2.FailureState == FailureState.TextureInaccessible;
				}
			}
			ReadOnly = flag || Builder.ReadOnly;
			labelMissingTextures.Visible = flag;
			labelMissingTextures.Dock = DockStyle.Top;
			tabStrip1.Visible = true;
			if (selection.Type == SelectionType.AssetGroup)
			{
				LoadAssetGroup();
				tabItemAssetInfo.Visible = false;
				tabItemLayerInfo.Visible = false;
				tabItemTextureInfo.Visible = false;
				tabItemGroupInfo.Visible = AssetGroupId != null;
				SelectTabWithoutFocus(0);
			}
			else if (selection.Type == SelectionType.Asset)
			{
				LoadAsset();
				tabItemAssetInfo.Visible = true;
				tabItemLayerInfo.Visible = false;
				tabItemTextureInfo.Visible = false;
				tabItemGroupInfo.Visible = AssetGroupId != null;
				SelectTabWithoutFocus(1);
			}
			else if (selection.Type == SelectionType.Layer)
			{
				LoadLayer();
				tabItemAssetInfo.Visible = true;
				tabItemLayerInfo.Visible = true;
				tabItemTextureInfo.Visible = false;
				tabItemGroupInfo.Visible = AssetGroupId != null;
				SelectTabWithoutFocus(2);
			}
			else if (selection.Type == SelectionType.Texture)
			{
				LoadTexture();
				tabItemAssetInfo.Visible = true;
				tabItemLayerInfo.Visible = true;
				tabItemTextureInfo.Visible = true;
				tabItemGroupInfo.Visible = AssetGroupId != null;
				SelectTabWithoutFocus(3);
			}
			loading = false;
			labelStatus.Visible = false;
		}

		public void Clear()
		{
			Asset = null;
			nameTextBox.Text = "None selected";
			nameTextBox.Enabled = false;
			labelNaturalSize.Text = string.Empty;
			labelLayerName.Text = string.Empty;
			labelLayerCount.Text = string.Empty;
			labelType.Text = string.Empty;
			labelTextureFileAbs.Text = string.Empty;
			SelectTabWithoutFocus(0);
			tabItemLayerInfo.Visible = false;
			tabItemTextureInfo.Visible = false;
			tabStrip1.Visible = false;
			labelStatus.Visible = true;
			UpdatePanelVisibility(hideAll: true);
			ClearCombos();
		}

		private void comboBoxBorderMethod_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (Asset != null && !loading)
			{
				AssetTilingMethod result = AssetTilingMethod.Repeat;
				if (System.Enum.TryParse<AssetTilingMethod>(comboBoxBorderMethod.Text, ignoreCase: true, out result))
				{
					Asset.TilingMethod = result;
					ChangeLayerState(CausingChanges.GeneralChanges);
					OnAssetChanged(Asset, Builder);
				}
			}
		}

		private void comboBoxQualty_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (Asset != null && !loading && LayerIndex >= 0 && LayerIndex < Asset.AssetLayers.Count && Asset.AssetLayers[LayerIndex].QualityProfile != comboBoxQualty.Text.ToLower())
			{
				Asset.AssetLayers[LayerIndex].QualityProfile = comboBoxQualty.Text;
				ChangeLayerState(CausingChanges.CodingChanged);
				OnAssetChanged(Asset, Builder);
			}
		}

		private void ChangeAssetState(CausingChanges change)
		{
			Builder.BuildStateSummary.AssetStates[Asset.Id].Changes = change;
		}

		private void ChangeLayerState(CausingChanges change)
		{
			AssetState assetState = Builder.BuildStateSummary.AssetStates[Asset.Id];
			LayerAssetState layerAssetState = assetState.LayerStates[LayerIndex];
			assetState.Changes = change;
			layerAssetState.Changes = change;
		}

		private void comboBoxFlip_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (Asset != null && !loading && LayerIndex >= 0 && LayerIndex < Asset.AssetLayers.Count)
			{
				Flip flip = (Flip)comboBoxFlip.SelectedItem;
				if (Asset.AssetLayers[LayerIndex].Flip != flip)
				{
					Asset.AssetLayers[LayerIndex].Flip = flip;
					ChangeLayerState(CausingChanges.InputChanged);
					OnAssetChanged(Asset, Builder);
				}
			}
		}

		private void UpdatePanelVisibility(bool hideAll)
		{
			Panel[] array = new Panel[4] { panel4, panel1, panel2, panel3 };
			for (int i = 0; i < array.Length; i++)
			{
				array[i].Visible = !hideAll && tabStrip1.SelectedTabIndex == i;
			}
			if (!panel1.Visible && Asset != null)
			{
				nameTextBox.Text = Asset.Name;
			}
		}

		private void tabStrip1_SelectedTabChanged(object sender, TabStripTabChangedEventArgs e)
		{
			UpdatePanelVisibility(hideAll: false);
		}

		private void buttonShowTexture_Click(object sender, EventArgs e)
		{
			ShellTools.OpenExplorerAndSelect(labelTextureFileAbs.Text);
		}

		private void comboBoxSwizzleX_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (Asset != null && !loading && LayerIndex >= 0 && LayerIndex < Asset.AssetLayers.Count)
			{
				SwizzleControl obj = (SwizzleControl)sender;
				string swizzle = obj.Swizzle;
				int num = (int)obj.Tag;
				if (Asset.AssetLayers[LayerIndex].Swizzle[num] != swizzle)
				{
					Asset.AssetLayers[LayerIndex].Swizzle[num] = swizzle;
					ChangeLayerState(CausingChanges.InputChanged);
					OnAssetChanged(Asset, Builder);
				}
			}
		}

		private void comboBoxMipMaps_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (Asset != null && !loading && LayerIndex >= 0 && LayerIndex < Asset.AssetLayers.Count && System.Enum.TryParse<TextureMipSourceType>(comboBoxMipMaps.SelectedValue.ToString(), out var result) && Asset.AssetLayers[LayerIndex].MipSourceType != result)
			{
				Asset.AssetLayers[LayerIndex].MipSourceType = result;
				ChangeLayerState(CausingChanges.InputChanged);
				OnAssetChanged(Asset, Builder);
			}
		}

		private void buttonSize_Click(object sender, EventArgs e)
		{
			AssetCustomSizeForm assetCustomSizeForm = new AssetCustomSizeForm();
			assetCustomSizeForm.Title = "Resize Asset";
			Size size2 = (assetCustomSizeForm.OriginalSize = AssetTools.CalculateAssetSize(Asset));
			assetCustomSizeForm.TargetSize = new Size(Asset.TargetWidth, Asset.TargetHeight);
			if (assetCustomSizeForm.ShowDialog(this) == DialogResult.OK)
			{
				Size targetSize = assetCustomSizeForm.TargetSize;
				if (Asset.TargetWidth != targetSize.Width || Asset.TargetHeight != targetSize.Height)
				{
					Asset.TargetWidth = targetSize.Width;
					Asset.TargetHeight = targetSize.Height;
					LoadAsset();
					OnAssetChanged(Asset, Builder);
				}
			}
		}

		private void textBoxX1_KeyDown(object sender, KeyEventArgs e)
		{
			if (e.KeyCode == Keys.Return)
			{
				RenameAsset();
			}
		}

		private void RenameAsset()
		{
			if (Asset != null && model != null && !loading)
			{
				string text = nameTextBox.Text;
				if (Asset.Name != text)
				{
					model.RenameAsset(ProjectId, Asset.Id, text);
				}
			}
		}

		private void nameTextBox_Leave(object sender, EventArgs e)
		{
			RenameAsset();
		}

		private void comboBoxSizeMode_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (Asset != null && !loading && LayerIndex >= 0 && LayerIndex < Asset.AssetLayers.Count)
			{
				AssetLayer assetLayer = Asset.AssetLayers[LayerIndex];
				ScaleComboHelper.Values comboValue = ScaleComboHelper.GetComboValue(comboBoxSizeMode);
				ScaleComboHelper.Values values = new ScaleComboHelper.Values(assetLayer.ResizeMode, assetLayer.TargetWidth, assetLayer.TargetHeight);
				if (!comboValue.Equals(values))
				{
					assetLayer.ResizeMode = comboValue.mode;
					assetLayer.TargetWidth = comboValue.targetWidth;
					assetLayer.TargetHeight = comboValue.targetHeight;
					ChangeLayerState(CausingChanges.InputChanged);
					OnAssetChanged(Asset, Builder);
				}
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.components = new System.ComponentModel.Container();
			this.tabStrip1 = new DevComponents.DotNetBar.TabStrip();
			this.tabItemGroupInfo = new DevComponents.DotNetBar.TabItem(this.components);
			this.tabItemAssetInfo = new DevComponents.DotNetBar.TabItem(this.components);
			this.tabItemLayerInfo = new DevComponents.DotNetBar.TabItem(this.components);
			this.tabItemTextureInfo = new DevComponents.DotNetBar.TabItem(this.components);
			this.panel1 = new System.Windows.Forms.Panel();
			this.nameTextBox = new DevComponents.DotNetBar.Controls.TextBoxX();
			this.buttonSizeAsset = new System.Windows.Forms.Button();
			this.labelX14 = new DevComponents.DotNetBar.LabelX();
			this.labelTargetSize = new DevComponents.DotNetBar.LabelX();
			this.comboBoxBorderMethod = new System.Windows.Forms.ComboBox();
			this.labelX13 = new DevComponents.DotNetBar.LabelX();
			this.labelX7 = new DevComponents.DotNetBar.LabelX();
			this.labelAssetType = new DevComponents.DotNetBar.LabelX();
			this.labelAssetPanelGroupId = new DevComponents.DotNetBar.LabelX();
			this.labelX8 = new DevComponents.DotNetBar.LabelX();
			this.labelIcon = new DevComponents.DotNetBar.LabelX();
			this.labelX6 = new DevComponents.DotNetBar.LabelX();
			this.labelInfo = new DevComponents.DotNetBar.LabelX();
			this.labelX4 = new DevComponents.DotNetBar.LabelX();
			this.labelLayerCount = new DevComponents.DotNetBar.LabelX();
			this.label4 = new DevComponents.DotNetBar.LabelX();
			this.labelNaturalSize = new DevComponents.DotNetBar.LabelX();
			this.label1 = new DevComponents.DotNetBar.LabelX();
			this.comboBoxMipMaps = new System.Windows.Forms.ComboBox();
			this.labelX16 = new DevComponents.DotNetBar.LabelX();
			this.panel2 = new System.Windows.Forms.Panel();
			this.labelInvertChannel3 = new DevComponents.DotNetBar.LabelX();
			this.invertChannels3 = new GrBuildStudio.Controls.InvertChannelsControl();
			this.swizzle3 = new GrBuildStudio.Controls.SwizzleControl();
			this.labelSwizzle3 = new DevComponents.DotNetBar.LabelX();
			this.labelInvertChannel2 = new DevComponents.DotNetBar.LabelX();
			this.invertChannels2 = new GrBuildStudio.Controls.InvertChannelsControl();
			this.swizzle2 = new GrBuildStudio.Controls.SwizzleControl();
			this.labelSwizzle2 = new DevComponents.DotNetBar.LabelX();
			this.labelInvertChannel1 = new DevComponents.DotNetBar.LabelX();
			this.comboBoxSizeMode = new System.Windows.Forms.ComboBox();
			this.invertChannels1 = new GrBuildStudio.Controls.InvertChannelsControl();
			this.labelX19 = new DevComponents.DotNetBar.LabelX();
			this.labelCodingProfile = new DevComponents.DotNetBar.LabelX();
			this.labelInvertChannel0 = new DevComponents.DotNetBar.LabelX();
			this.swizzle1 = new GrBuildStudio.Controls.SwizzleControl();
			this.labelSwizzle1 = new DevComponents.DotNetBar.LabelX();
			this.labelX15 = new DevComponents.DotNetBar.LabelX();
			this.invertChannels0 = new GrBuildStudio.Controls.InvertChannelsControl();
			this.labelType = new DevComponents.DotNetBar.LabelX();
			this.labelX5 = new DevComponents.DotNetBar.LabelX();
			this.comboBoxFlip = new System.Windows.Forms.ComboBox();
			this.labelX1 = new DevComponents.DotNetBar.LabelX();
			this.labelLayerName = new DevComponents.DotNetBar.LabelX();
			this.labelSwizzle0 = new DevComponents.DotNetBar.LabelX();
			this.swizzle0 = new GrBuildStudio.Controls.SwizzleControl();
			this.labelX3 = new DevComponents.DotNetBar.LabelX();
			this.labelDataType = new DevComponents.DotNetBar.LabelX();
			this.labelX2 = new DevComponents.DotNetBar.LabelX();
			this.comboBoxQualty = new System.Windows.Forms.ComboBox();
			this.label13 = new DevComponents.DotNetBar.LabelX();
			this.panel3 = new System.Windows.Forms.Panel();
			this.labelTextureFileSize = new DevComponents.DotNetBar.LabelX();
			this.labelX18 = new DevComponents.DotNetBar.LabelX();
			this.labelTextureFileModified = new DevComponents.DotNetBar.LabelX();
			this.labelX11 = new DevComponents.DotNetBar.LabelX();
			this.labelTextureFileAbs = new DevComponents.DotNetBar.LabelX();
			this.labelX17 = new DevComponents.DotNetBar.LabelX();
			this.buttonShowTexture = new System.Windows.Forms.Button();
			this.labelStatus = new DevComponents.DotNetBar.LabelX();
			this.panel4 = new System.Windows.Forms.Panel();
			this.labelX12 = new DevComponents.DotNetBar.LabelX();
			this.labelGroupType = new DevComponents.DotNetBar.LabelX();
			this.labelStackedTextureCount = new DevComponents.DotNetBar.LabelX();
			this.labelX10 = new DevComponents.DotNetBar.LabelX();
			this.labelGroupPanelGroupId = new DevComponents.DotNetBar.LabelX();
			this.labelX9 = new DevComponents.DotNetBar.LabelX();
			this.labelMissingTextures = new DevComponents.DotNetBar.LabelX();
			this.ToolTip = new GrBuildStudio.ToolTip();
			this.panel1.SuspendLayout();
			this.panel2.SuspendLayout();
			this.panel3.SuspendLayout();
			this.panel4.SuspendLayout();
			base.SuspendLayout();
			this.tabStrip1.AutoSelectAttachedControl = true;
			this.tabStrip1.CanReorderTabs = false;
			this.tabStrip1.CloseButtonVisible = false;
			this.tabStrip1.ColorScheme.TabBackground = System.Drawing.Color.Transparent;
			this.tabStrip1.ColorScheme.TabBorder = System.Drawing.Color.Silver;
			this.tabStrip1.ColorScheme.TabItemBackground = System.Drawing.Color.Transparent;
			this.tabStrip1.ColorScheme.TabItemBackgroundColorBlend.AddRange(new DevComponents.DotNetBar.BackgroundColorBlend[4]
			{
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 0f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 0.45f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 0.45f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 1f)
			});
			this.tabStrip1.ColorScheme.TabItemHotBackgroundColorBlend.AddRange(new DevComponents.DotNetBar.BackgroundColorBlend[4]
			{
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.FromArgb(28, 151, 234), 0f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 0.45f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 0.45f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 1f)
			});
			this.tabStrip1.ColorScheme.TabItemSelectedBackground = System.Drawing.Color.Transparent;
			this.tabStrip1.ColorScheme.TabItemSelectedBackgroundColorBlend.AddRange(new DevComponents.DotNetBar.BackgroundColorBlend[4]
			{
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.FromArgb(0, 122, 204), 0f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 0.45f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 0.45f),
				new DevComponents.DotNetBar.BackgroundColorBlend(System.Drawing.Color.Empty, 1f)
			});
			this.tabStrip1.Dock = System.Windows.Forms.DockStyle.Top;
			this.tabStrip1.ForeColor = System.Drawing.Color.Black;
			this.tabStrip1.Location = new System.Drawing.Point(0, 0);
			this.tabStrip1.Name = "tabStrip1";
			this.tabStrip1.SelectedTab = this.tabItemGroupInfo;
			this.tabStrip1.ShowFocusRectangle = false;
			this.tabStrip1.Size = new System.Drawing.Size(1571, 27);
			this.tabStrip1.Style = DevComponents.DotNetBar.eTabStripStyle.VS2005;
			this.tabStrip1.TabAlignment = DevComponents.DotNetBar.eTabStripAlignment.Top;
			this.tabStrip1.TabIndex = 32;
			this.tabStrip1.TabLayoutType = DevComponents.DotNetBar.eTabLayoutType.FixedWithNavigationBox;
			this.tabStrip1.Tabs.Add(this.tabItemGroupInfo);
			this.tabStrip1.Tabs.Add(this.tabItemAssetInfo);
			this.tabStrip1.Tabs.Add(this.tabItemLayerInfo);
			this.tabStrip1.Tabs.Add(this.tabItemTextureInfo);
			this.tabStrip1.SelectedTabChanged += new DevComponents.DotNetBar.TabStrip.SelectedTabChangedEventHandler(tabStrip1_SelectedTabChanged);
			this.tabItemGroupInfo.Name = "tabItemGroupInfo";
			this.tabItemGroupInfo.Text = "Stacked Texture Group Info";
			this.tabItemAssetInfo.Name = "tabItemAssetInfo";
			this.tabItemAssetInfo.Text = "Stacked Texture Info";
			this.tabItemLayerInfo.Name = "tabItemLayerInfo";
			this.tabItemLayerInfo.Text = "Layer Info";
			this.tabItemTextureInfo.Name = "tabItemTextureInfo";
			this.tabItemTextureInfo.Text = "Texture Info";
			this.panel1.Controls.Add(this.nameTextBox);
			this.panel1.Controls.Add(this.buttonSizeAsset);
			this.panel1.Controls.Add(this.labelX14);
			this.panel1.Controls.Add(this.labelTargetSize);
			this.panel1.Controls.Add(this.comboBoxBorderMethod);
			this.panel1.Controls.Add(this.labelX13);
			this.panel1.Controls.Add(this.labelX7);
			this.panel1.Controls.Add(this.labelAssetType);
			this.panel1.Controls.Add(this.labelAssetPanelGroupId);
			this.panel1.Controls.Add(this.labelX8);
			this.panel1.Controls.Add(this.labelIcon);
			this.panel1.Controls.Add(this.labelX6);
			this.panel1.Controls.Add(this.labelInfo);
			this.panel1.Controls.Add(this.labelX4);
			this.panel1.Controls.Add(this.labelLayerCount);
			this.panel1.Controls.Add(this.label4);
			this.panel1.Controls.Add(this.labelNaturalSize);
			this.panel1.Controls.Add(this.label1);
			this.panel1.Location = new System.Drawing.Point(3, 33);
			this.panel1.Name = "panel1";
			this.panel1.Size = new System.Drawing.Size(372, 288);
			this.panel1.TabIndex = 33;
			this.nameTextBox.BackColor = System.Drawing.SystemColors.Window;
			this.nameTextBox.Border.Class = "TextBoxBorder";
			this.nameTextBox.Border.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.nameTextBox.ButtonCustom.Text = "Edit";
			this.nameTextBox.DisabledBackColor = System.Drawing.Color.White;
			this.nameTextBox.ForeColor = System.Drawing.Color.Black;
			this.nameTextBox.Location = new System.Drawing.Point(111, 20);
			this.nameTextBox.Name = "nameTextBox";
			this.nameTextBox.PreventEnterBeep = true;
			this.nameTextBox.Size = new System.Drawing.Size(181, 20);
			this.nameTextBox.TabIndex = 61;
			this.nameTextBox.KeyDown += new System.Windows.Forms.KeyEventHandler(textBoxX1_KeyDown);
			this.nameTextBox.Leave += new System.EventHandler(nameTextBox_Leave);
			this.buttonSizeAsset.Location = new System.Drawing.Point(257, 103);
			this.buttonSizeAsset.Name = "buttonSizeAsset";
			this.buttonSizeAsset.Size = new System.Drawing.Size(64, 23);
			this.buttonSizeAsset.TabIndex = 60;
			this.buttonSizeAsset.Text = "Set Size";
			this.buttonSizeAsset.UseVisualStyleBackColor = true;
			this.buttonSizeAsset.Click += new System.EventHandler(buttonSize_Click);
			this.labelX14.AutoSize = true;
			this.labelX14.BackColor = System.Drawing.Color.Transparent;
			this.labelX14.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX14.Location = new System.Drawing.Point(14, 107);
			this.labelX14.Name = "labelX14";
			this.labelX14.Size = new System.Drawing.Size(62, 15);
			this.labelX14.TabIndex = 59;
			this.labelX14.Text = "Target Size:";
			this.labelTargetSize.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelTargetSize.BackColor = System.Drawing.Color.Transparent;
			this.labelTargetSize.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelTargetSize.Location = new System.Drawing.Point(111, 104);
			this.labelTargetSize.Name = "labelTargetSize";
			this.labelTargetSize.Size = new System.Drawing.Size(144, 21);
			this.labelTargetSize.TabIndex = 58;
			this.labelTargetSize.Text = "Automatic";
			this.comboBoxBorderMethod.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxBorderMethod.FormattingEnabled = true;
			this.comboBoxBorderMethod.Items.AddRange(new object[2] { "Repeat", "Clamp" });
			this.comboBoxBorderMethod.Location = new System.Drawing.Point(111, 160);
			this.comboBoxBorderMethod.Name = "comboBoxBorderMethod";
			this.comboBoxBorderMethod.Size = new System.Drawing.Size(116, 21);
			this.ToolTip.SetSuperTooltip(this.comboBoxBorderMethod, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_OPTION_TILINGMETHOD", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.comboBoxBorderMethod.TabIndex = 49;
			this.comboBoxBorderMethod.SelectedIndexChanged += new System.EventHandler(comboBoxBorderMethod_SelectedIndexChanged);
			this.labelX13.AutoSize = true;
			this.labelX13.BackColor = System.Drawing.Color.Transparent;
			this.labelX13.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX13.Location = new System.Drawing.Point(14, 163);
			this.labelX13.Name = "labelX13";
			this.labelX13.Size = new System.Drawing.Size(32, 15);
			this.labelX13.TabIndex = 44;
			this.labelX13.Text = "Tiling:";
			this.labelX7.AutoSize = true;
			this.labelX7.BackColor = System.Drawing.Color.Transparent;
			this.labelX7.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX7.Location = new System.Drawing.Point(14, 191);
			this.labelX7.Name = "labelX7";
			this.labelX7.Size = new System.Drawing.Size(30, 15);
			this.labelX7.TabIndex = 42;
			this.labelX7.Text = "Type:";
			this.labelAssetType.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelAssetType.BackColor = System.Drawing.Color.Transparent;
			this.labelAssetType.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelAssetType.Location = new System.Drawing.Point(111, 188);
			this.labelAssetType.Name = "labelAssetType";
			this.labelAssetType.Size = new System.Drawing.Size(243, 21);
			this.labelAssetType.TabIndex = 41;
			this.labelAssetType.Text = "Cubemap";
			this.labelAssetPanelGroupId.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelAssetPanelGroupId.BackColor = System.Drawing.Color.Transparent;
			this.labelAssetPanelGroupId.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelAssetPanelGroupId.Location = new System.Drawing.Point(111, 48);
			this.labelAssetPanelGroupId.Name = "labelAssetPanelGroupId";
			this.labelAssetPanelGroupId.Size = new System.Drawing.Size(243, 21);
			this.labelAssetPanelGroupId.TabIndex = 40;
			this.labelAssetPanelGroupId.Text = "bluemarble";
			this.labelX8.AutoSize = true;
			this.labelX8.BackColor = System.Drawing.Color.Transparent;
			this.labelX8.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX8.Location = new System.Drawing.Point(14, 51);
			this.labelX8.Name = "labelX8";
			this.labelX8.Size = new System.Drawing.Size(36, 15);
			this.labelX8.TabIndex = 39;
			this.labelX8.Text = "Group:";
			this.labelIcon.BackColor = System.Drawing.Color.Transparent;
			this.labelIcon.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelIcon.Image = GrBuildStudio.Properties.Resources.asset_built;
			this.labelIcon.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
			this.labelIcon.Location = new System.Drawing.Point(84, 216);
			this.labelIcon.Name = "labelIcon";
			this.labelIcon.Size = new System.Drawing.Size(21, 27);
			this.labelIcon.TabIndex = 38;
			this.labelX6.AutoSize = true;
			this.labelX6.BackColor = System.Drawing.Color.Transparent;
			this.labelX6.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX6.Location = new System.Drawing.Point(14, 218);
			this.labelX6.Name = "labelX6";
			this.labelX6.Size = new System.Drawing.Size(31, 15);
			this.labelX6.TabIndex = 37;
			this.labelX6.Text = "State:";
			this.labelInfo.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelInfo.BackColor = System.Drawing.Color.Transparent;
			this.labelInfo.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelInfo.Location = new System.Drawing.Point(111, 220);
			this.labelInfo.Name = "labelInfo";
			this.labelInfo.RightToLeft = System.Windows.Forms.RightToLeft.No;
			this.labelInfo.Size = new System.Drawing.Size(243, 61);
			this.labelInfo.TabIndex = 36;
			this.labelInfo.Text = "The Stacked Texture needs Rebuilding.";
			this.labelInfo.TextLineAlignment = System.Drawing.StringAlignment.Near;
			this.labelInfo.WordWrap = true;
			this.labelX4.AutoSize = true;
			this.labelX4.BackColor = System.Drawing.Color.Transparent;
			this.labelX4.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX4.Location = new System.Drawing.Point(14, 135);
			this.labelX4.Name = "labelX4";
			this.labelX4.Size = new System.Drawing.Size(39, 15);
			this.labelX4.TabIndex = 35;
			this.labelX4.Text = "Layers:";
			this.labelLayerCount.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelLayerCount.BackColor = System.Drawing.Color.Transparent;
			this.labelLayerCount.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelLayerCount.Location = new System.Drawing.Point(111, 132);
			this.labelLayerCount.Name = "labelLayerCount";
			this.labelLayerCount.Size = new System.Drawing.Size(243, 21);
			this.labelLayerCount.TabIndex = 34;
			this.labelLayerCount.Text = "3";
			this.label4.AutoSize = true;
			this.label4.BackColor = System.Drawing.Color.Transparent;
			this.label4.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.label4.Location = new System.Drawing.Point(14, 79);
			this.label4.Name = "label4";
			this.label4.Size = new System.Drawing.Size(68, 15);
			this.label4.TabIndex = 33;
			this.label4.Text = "Original Size:";
			this.labelNaturalSize.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelNaturalSize.BackColor = System.Drawing.Color.Transparent;
			this.labelNaturalSize.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelNaturalSize.Location = new System.Drawing.Point(111, 76);
			this.labelNaturalSize.Name = "labelNaturalSize";
			this.labelNaturalSize.Size = new System.Drawing.Size(243, 21);
			this.labelNaturalSize.TabIndex = 31;
			this.labelNaturalSize.Text = "128 x 128";
			this.label1.AutoSize = true;
			this.label1.BackColor = System.Drawing.Color.Transparent;
			this.label1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.label1.Location = new System.Drawing.Point(14, 23);
			this.label1.Name = "label1";
			this.label1.Size = new System.Drawing.Size(35, 15);
			this.label1.TabIndex = 30;
			this.label1.Text = "Name:";
			this.comboBoxMipMaps.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxMipMaps.FormattingEnabled = true;
			this.comboBoxMipMaps.Location = new System.Drawing.Point(117, 216);
			this.comboBoxMipMaps.Name = "comboBoxMipMaps";
			this.comboBoxMipMaps.Size = new System.Drawing.Size(101, 21);
			this.ToolTip.SetSuperTooltip(this.comboBoxMipMaps, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_OPTION_MIPMAPSOURCE", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.comboBoxMipMaps.TabIndex = 55;
			this.comboBoxMipMaps.SelectedIndexChanged += new System.EventHandler(comboBoxMipMaps_SelectedIndexChanged);
			this.labelX16.AutoSize = true;
			this.labelX16.BackColor = System.Drawing.Color.Transparent;
			this.labelX16.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX16.Location = new System.Drawing.Point(10, 219);
			this.labelX16.Name = "labelX16";
			this.labelX16.Size = new System.Drawing.Size(85, 15);
			this.labelX16.TabIndex = 54;
			this.labelX16.Text = "Mip Map Source:";
			this.panel2.AutoScroll = true;
			this.panel2.AutoScrollMargin = new System.Drawing.Size(0, 16);
			this.panel2.Controls.Add(this.labelInvertChannel3);
			this.panel2.Controls.Add(this.invertChannels3);
			this.panel2.Controls.Add(this.swizzle3);
			this.panel2.Controls.Add(this.labelSwizzle3);
			this.panel2.Controls.Add(this.labelInvertChannel2);
			this.panel2.Controls.Add(this.invertChannels2);
			this.panel2.Controls.Add(this.swizzle2);
			this.panel2.Controls.Add(this.labelSwizzle2);
			this.panel2.Controls.Add(this.labelInvertChannel1);
			this.panel2.Controls.Add(this.comboBoxSizeMode);
			this.panel2.Controls.Add(this.invertChannels1);
			this.panel2.Controls.Add(this.labelX19);
			this.panel2.Controls.Add(this.labelCodingProfile);
			this.panel2.Controls.Add(this.labelInvertChannel0);
			this.panel2.Controls.Add(this.swizzle1);
			this.panel2.Controls.Add(this.labelSwizzle1);
			this.panel2.Controls.Add(this.labelX15);
			this.panel2.Controls.Add(this.comboBoxMipMaps);
			this.panel2.Controls.Add(this.invertChannels0);
			this.panel2.Controls.Add(this.labelX16);
			this.panel2.Controls.Add(this.labelType);
			this.panel2.Controls.Add(this.labelX5);
			this.panel2.Controls.Add(this.comboBoxFlip);
			this.panel2.Controls.Add(this.labelX1);
			this.panel2.Controls.Add(this.labelLayerName);
			this.panel2.Controls.Add(this.labelSwizzle0);
			this.panel2.Controls.Add(this.swizzle0);
			this.panel2.Controls.Add(this.labelX3);
			this.panel2.Controls.Add(this.labelDataType);
			this.panel2.Controls.Add(this.labelX2);
			this.panel2.Controls.Add(this.comboBoxQualty);
			this.panel2.Controls.Add(this.label13);
			this.panel2.Location = new System.Drawing.Point(381, 33);
			this.panel2.Name = "panel2";
			this.panel2.Size = new System.Drawing.Size(405, 508);
			this.panel2.TabIndex = 34;
			this.labelInvertChannel3.AutoSize = true;
			this.labelInvertChannel3.BackColor = System.Drawing.Color.Transparent;
			this.labelInvertChannel3.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelInvertChannel3.Location = new System.Drawing.Point(10, 440);
			this.labelInvertChannel3.Name = "labelInvertChannel3";
			this.labelInvertChannel3.Size = new System.Drawing.Size(86, 15);
			this.labelInvertChannel3.TabIndex = 76;
			this.labelInvertChannel3.Text = "Invert Channel 1:";
			this.invertChannels3.Location = new System.Drawing.Point(117, 440);
			this.invertChannels3.Name = "invertChannels3";
			this.invertChannels3.Size = new System.Drawing.Size(168, 16);
			this.invertChannels3.TabIndex = 75;
			this.swizzle3.Location = new System.Drawing.Point(117, 412);
			this.swizzle3.maxChannels = 0;
			this.swizzle3.Name = "swizzle3";
			this.swizzle3.Size = new System.Drawing.Size(172, 21);
			this.swizzle3.TabIndex = 73;
			this.labelSwizzle3.AutoSize = true;
			this.labelSwizzle3.BackColor = System.Drawing.Color.Transparent;
			this.labelSwizzle3.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelSwizzle3.Location = new System.Drawing.Point(10, 415);
			this.labelSwizzle3.Name = "labelSwizzle3";
			this.labelSwizzle3.Size = new System.Drawing.Size(43, 15);
			this.labelSwizzle3.TabIndex = 74;
			this.labelSwizzle3.Text = "Swizzle:";
			this.labelInvertChannel2.AutoSize = true;
			this.labelInvertChannel2.BackColor = System.Drawing.Color.Transparent;
			this.labelInvertChannel2.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelInvertChannel2.Location = new System.Drawing.Point(10, 385);
			this.labelInvertChannel2.Name = "labelInvertChannel2";
			this.labelInvertChannel2.Size = new System.Drawing.Size(86, 15);
			this.labelInvertChannel2.TabIndex = 72;
			this.labelInvertChannel2.Text = "Invert Channel 1:";
			this.invertChannels2.Location = new System.Drawing.Point(117, 384);
			this.invertChannels2.Name = "invertChannels2";
			this.invertChannels2.Size = new System.Drawing.Size(168, 16);
			this.invertChannels2.TabIndex = 71;
			this.swizzle2.Location = new System.Drawing.Point(117, 356);
			this.swizzle2.maxChannels = 0;
			this.swizzle2.Name = "swizzle2";
			this.swizzle2.Size = new System.Drawing.Size(172, 21);
			this.swizzle2.TabIndex = 69;
			this.labelSwizzle2.AutoSize = true;
			this.labelSwizzle2.BackColor = System.Drawing.Color.Transparent;
			this.labelSwizzle2.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelSwizzle2.Location = new System.Drawing.Point(10, 359);
			this.labelSwizzle2.Name = "labelSwizzle2";
			this.labelSwizzle2.Size = new System.Drawing.Size(43, 15);
			this.labelSwizzle2.TabIndex = 70;
			this.labelSwizzle2.Text = "Swizzle:";
			this.labelInvertChannel1.AutoSize = true;
			this.labelInvertChannel1.BackColor = System.Drawing.Color.Transparent;
			this.labelInvertChannel1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelInvertChannel1.Location = new System.Drawing.Point(10, 331);
			this.labelInvertChannel1.Name = "labelInvertChannel1";
			this.labelInvertChannel1.Size = new System.Drawing.Size(86, 15);
			this.labelInvertChannel1.TabIndex = 68;
			this.labelInvertChannel1.Text = "Invert Channel 1:";
			this.comboBoxSizeMode.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxSizeMode.FormattingEnabled = true;
			this.comboBoxSizeMode.Location = new System.Drawing.Point(117, 160);
			this.comboBoxSizeMode.Name = "comboBoxSizeMode";
			this.comboBoxSizeMode.Size = new System.Drawing.Size(172, 21);
			this.ToolTip.SetSuperTooltip(this.comboBoxSizeMode, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_OPTION_LAYER_TARGETSIZE", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.comboBoxSizeMode.TabIndex = 64;
			this.comboBoxSizeMode.SelectedIndexChanged += new System.EventHandler(comboBoxSizeMode_SelectedIndexChanged);
			this.invertChannels1.Location = new System.Drawing.Point(117, 328);
			this.invertChannels1.Name = "invertChannels1";
			this.invertChannels1.Size = new System.Drawing.Size(168, 16);
			this.invertChannels1.TabIndex = 67;
			this.labelX19.AutoSize = true;
			this.labelX19.BackColor = System.Drawing.Color.Transparent;
			this.labelX19.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX19.Location = new System.Drawing.Point(10, 163);
			this.labelX19.Name = "labelX19";
			this.labelX19.Size = new System.Drawing.Size(62, 15);
			this.labelX19.TabIndex = 62;
			this.labelX19.Text = "Target Size:";
			this.labelCodingProfile.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelCodingProfile.BackColor = System.Drawing.Color.Transparent;
			this.labelCodingProfile.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelCodingProfile.Location = new System.Drawing.Point(117, 76);
			this.labelCodingProfile.Name = "labelCodingProfile";
			this.labelCodingProfile.Size = new System.Drawing.Size(274, 21);
			this.labelCodingProfile.TabIndex = 59;
			this.labelCodingProfile.Text = "BC7";
			this.labelInvertChannel0.AutoSize = true;
			this.labelInvertChannel0.BackColor = System.Drawing.Color.Transparent;
			this.labelInvertChannel0.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelInvertChannel0.Location = new System.Drawing.Point(10, 275);
			this.labelInvertChannel0.Name = "labelInvertChannel0";
			this.labelInvertChannel0.Size = new System.Drawing.Size(86, 15);
			this.labelInvertChannel0.TabIndex = 66;
			this.labelInvertChannel0.Text = "Invert Channel 0:";
			this.swizzle1.Location = new System.Drawing.Point(117, 300);
			this.swizzle1.maxChannels = 0;
			this.swizzle1.Name = "swizzle1";
			this.swizzle1.Size = new System.Drawing.Size(172, 21);
			this.swizzle1.TabIndex = 57;
			this.labelSwizzle1.AutoSize = true;
			this.labelSwizzle1.BackColor = System.Drawing.Color.Transparent;
			this.labelSwizzle1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelSwizzle1.Location = new System.Drawing.Point(10, 303);
			this.labelSwizzle1.Name = "labelSwizzle1";
			this.labelSwizzle1.Size = new System.Drawing.Size(43, 15);
			this.labelSwizzle1.TabIndex = 58;
			this.labelSwizzle1.Text = "Swizzle:";
			this.labelX15.AutoSize = true;
			this.labelX15.BackColor = System.Drawing.Color.Transparent;
			this.labelX15.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX15.Location = new System.Drawing.Point(10, 79);
			this.labelX15.Name = "labelX15";
			this.labelX15.Size = new System.Drawing.Size(75, 15);
			this.labelX15.TabIndex = 58;
			this.labelX15.Text = "Coding Profile:";
			this.invertChannels0.Location = new System.Drawing.Point(117, 272);
			this.invertChannels0.Name = "invertChannels0";
			this.invertChannels0.Size = new System.Drawing.Size(168, 16);
			this.invertChannels0.TabIndex = 65;
			this.labelType.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelType.BackColor = System.Drawing.Color.Transparent;
			this.labelType.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelType.Location = new System.Drawing.Point(117, 188);
			this.labelType.Name = "labelType";
			this.labelType.Size = new System.Drawing.Size(238, 21);
			this.labelType.TabIndex = 47;
			this.labelType.Text = "Single File";
			this.labelX5.AutoSize = true;
			this.labelX5.BackColor = System.Drawing.Color.Transparent;
			this.labelX5.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX5.Location = new System.Drawing.Point(10, 191);
			this.labelX5.Name = "labelX5";
			this.labelX5.Size = new System.Drawing.Size(30, 15);
			this.labelX5.TabIndex = 46;
			this.labelX5.Text = "Type:";
			this.comboBoxFlip.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxFlip.FormattingEnabled = true;
			this.comboBoxFlip.Items.AddRange(new object[4] { "Lossless", "High", "Medium", "Low" });
			this.comboBoxFlip.Location = new System.Drawing.Point(117, 132);
			this.comboBoxFlip.Name = "comboBoxFlip";
			this.comboBoxFlip.Size = new System.Drawing.Size(140, 21);
			this.ToolTip.SetSuperTooltip(this.comboBoxFlip, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_OPTION_FLIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.comboBoxFlip.TabIndex = 45;
			this.comboBoxFlip.SelectedIndexChanged += new System.EventHandler(comboBoxFlip_SelectedIndexChanged);
			this.labelX1.AutoSize = true;
			this.labelX1.BackColor = System.Drawing.Color.Transparent;
			this.labelX1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX1.Location = new System.Drawing.Point(10, 135);
			this.labelX1.Name = "labelX1";
			this.labelX1.Size = new System.Drawing.Size(23, 15);
			this.labelX1.TabIndex = 44;
			this.labelX1.Text = "Flip:";
			this.labelLayerName.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelLayerName.BackColor = System.Drawing.Color.Transparent;
			this.labelLayerName.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelLayerName.Location = new System.Drawing.Point(117, 20);
			this.labelLayerName.Name = "labelLayerName";
			this.labelLayerName.Size = new System.Drawing.Size(274, 21);
			this.labelLayerName.TabIndex = 43;
			this.labelLayerName.Text = "Diffuse";
			this.labelSwizzle0.AutoSize = true;
			this.labelSwizzle0.BackColor = System.Drawing.Color.Transparent;
			this.labelSwizzle0.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelSwizzle0.Location = new System.Drawing.Point(10, 247);
			this.labelSwizzle0.Name = "labelSwizzle0";
			this.labelSwizzle0.Size = new System.Drawing.Size(43, 15);
			this.labelSwizzle0.TabIndex = 58;
			this.labelSwizzle0.Text = "Swizzle:";
			this.swizzle0.Location = new System.Drawing.Point(117, 244);
			this.swizzle0.maxChannels = 0;
			this.swizzle0.Name = "swizzle0";
			this.swizzle0.Size = new System.Drawing.Size(172, 21);
			this.swizzle0.TabIndex = 56;
			this.labelX3.AutoSize = true;
			this.labelX3.BackColor = System.Drawing.Color.Transparent;
			this.labelX3.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX3.Location = new System.Drawing.Point(10, 23);
			this.labelX3.Name = "labelX3";
			this.labelX3.Size = new System.Drawing.Size(71, 15);
			this.labelX3.TabIndex = 42;
			this.labelX3.Text = "Layer Name: ";
			this.labelDataType.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelDataType.BackColor = System.Drawing.Color.Transparent;
			this.labelDataType.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelDataType.Location = new System.Drawing.Point(117, 48);
			this.labelDataType.Name = "labelDataType";
			this.labelDataType.Size = new System.Drawing.Size(274, 21);
			this.labelDataType.TabIndex = 41;
			this.labelDataType.Text = "R8G8B8_SRGB";
			this.labelX2.AutoSize = true;
			this.labelX2.BackColor = System.Drawing.Color.Transparent;
			this.labelX2.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX2.Location = new System.Drawing.Point(10, 51);
			this.labelX2.Name = "labelX2";
			this.labelX2.Size = new System.Drawing.Size(66, 15);
			this.labelX2.TabIndex = 40;
			this.labelX2.Text = "Layer Type: ";
			this.comboBoxQualty.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxQualty.FormattingEnabled = true;
			this.comboBoxQualty.Items.AddRange(new object[4] { "Lossless", "High", "Medium", "Low" });
			this.comboBoxQualty.Location = new System.Drawing.Point(117, 104);
			this.comboBoxQualty.Name = "comboBoxQualty";
			this.comboBoxQualty.Size = new System.Drawing.Size(140, 21);
			this.ToolTip.SetSuperTooltip(this.comboBoxQualty, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_OPTION_QUALITYLEVEL", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.comboBoxQualty.TabIndex = 39;
			this.comboBoxQualty.SelectedIndexChanged += new System.EventHandler(comboBoxQualty_SelectedIndexChanged);
			this.label13.AutoSize = true;
			this.label13.BackColor = System.Drawing.Color.Transparent;
			this.label13.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.label13.Location = new System.Drawing.Point(10, 107);
			this.label13.Name = "label13";
			this.label13.Size = new System.Drawing.Size(40, 15);
			this.label13.TabIndex = 38;
			this.label13.Text = "Quality:";
			this.panel3.Controls.Add(this.labelTextureFileSize);
			this.panel3.Controls.Add(this.labelX18);
			this.panel3.Controls.Add(this.labelTextureFileModified);
			this.panel3.Controls.Add(this.labelX11);
			this.panel3.Controls.Add(this.labelTextureFileAbs);
			this.panel3.Controls.Add(this.labelX17);
			this.panel3.Controls.Add(this.buttonShowTexture);
			this.panel3.Location = new System.Drawing.Point(792, 33);
			this.panel3.Name = "panel3";
			this.panel3.Size = new System.Drawing.Size(372, 197);
			this.panel3.TabIndex = 36;
			this.labelTextureFileSize.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelTextureFileSize.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelTextureFileSize.ForeColor = System.Drawing.SystemColors.ControlText;
			this.labelTextureFileSize.Location = new System.Drawing.Point(108, 76);
			this.labelTextureFileSize.Name = "labelTextureFileSize";
			this.labelTextureFileSize.Size = new System.Drawing.Size(246, 20);
			this.labelTextureFileSize.TabIndex = 67;
			this.labelTextureFileSize.Text = "123KB";
			this.labelX18.BackColor = System.Drawing.Color.Transparent;
			this.labelX18.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX18.Location = new System.Drawing.Point(14, 76);
			this.labelX18.Name = "labelX18";
			this.labelX18.Size = new System.Drawing.Size(88, 20);
			this.labelX18.TabIndex = 66;
			this.labelX18.Text = "File Size:";
			this.labelTextureFileModified.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelTextureFileModified.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelTextureFileModified.ForeColor = System.Drawing.SystemColors.ControlText;
			this.labelTextureFileModified.Location = new System.Drawing.Point(108, 48);
			this.labelTextureFileModified.Name = "labelTextureFileModified";
			this.labelTextureFileModified.Size = new System.Drawing.Size(246, 20);
			this.labelTextureFileModified.TabIndex = 65;
			this.labelTextureFileModified.Text = "1 Januari 2016 16:22:01";
			this.labelX11.BackColor = System.Drawing.Color.Transparent;
			this.labelX11.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX11.Location = new System.Drawing.Point(14, 48);
			this.labelX11.Name = "labelX11";
			this.labelX11.Size = new System.Drawing.Size(88, 20);
			this.labelX11.TabIndex = 64;
			this.labelX11.Text = "File last modified:";
			this.labelTextureFileAbs.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelTextureFileAbs.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelTextureFileAbs.ForeColor = System.Drawing.SystemColors.ControlText;
			this.labelTextureFileAbs.Location = new System.Drawing.Point(108, 20);
			this.labelTextureFileAbs.Name = "labelTextureFileAbs";
			this.labelTextureFileAbs.Size = new System.Drawing.Size(223, 20);
			this.labelTextureFileAbs.TabIndex = 63;
			this.labelTextureFileAbs.Text = "world.topo.bathy.200412.3x21600x21600.A0.png";
			this.labelX17.BackColor = System.Drawing.Color.Transparent;
			this.labelX17.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX17.Location = new System.Drawing.Point(14, 20);
			this.labelX17.Name = "labelX17";
			this.labelX17.Size = new System.Drawing.Size(23, 20);
			this.labelX17.TabIndex = 39;
			this.labelX17.Text = "File:";
			this.buttonShowTexture.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.buttonShowTexture.Image = GrBuildStudio.Properties.Resources.magnifier;
			this.buttonShowTexture.Location = new System.Drawing.Point(330, 19);
			this.buttonShowTexture.Name = "buttonShowTexture";
			this.buttonShowTexture.Size = new System.Drawing.Size(26, 23);
			this.buttonShowTexture.TabIndex = 38;
			this.buttonShowTexture.UseVisualStyleBackColor = true;
			this.buttonShowTexture.Click += new System.EventHandler(buttonShowTexture_Click);
			this.labelStatus.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelStatus.Location = new System.Drawing.Point(0, 571);
			this.labelStatus.Name = "labelStatus";
			this.labelStatus.PaddingLeft = 10;
			this.labelStatus.PaddingTop = 10;
			this.labelStatus.Size = new System.Drawing.Size(338, 48);
			this.labelStatus.TabIndex = 38;
			this.labelStatus.Text = "Select one Stacked Texture to view details";
			this.panel4.Controls.Add(this.labelX12);
			this.panel4.Controls.Add(this.labelGroupType);
			this.panel4.Controls.Add(this.labelStackedTextureCount);
			this.panel4.Controls.Add(this.labelX10);
			this.panel4.Controls.Add(this.labelGroupPanelGroupId);
			this.panel4.Controls.Add(this.labelX9);
			this.panel4.Location = new System.Drawing.Point(1170, 33);
			this.panel4.Name = "panel4";
			this.panel4.Size = new System.Drawing.Size(369, 202);
			this.panel4.TabIndex = 39;
			this.labelX12.AutoSize = true;
			this.labelX12.BackColor = System.Drawing.Color.Transparent;
			this.labelX12.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX12.Location = new System.Drawing.Point(14, 79);
			this.labelX12.Name = "labelX12";
			this.labelX12.Size = new System.Drawing.Size(30, 15);
			this.labelX12.TabIndex = 46;
			this.labelX12.Text = "Type:";
			this.labelGroupType.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelGroupType.BackColor = System.Drawing.Color.Transparent;
			this.labelGroupType.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelGroupType.Location = new System.Drawing.Point(111, 76);
			this.labelGroupType.Name = "labelGroupType";
			this.labelGroupType.Size = new System.Drawing.Size(240, 21);
			this.labelGroupType.TabIndex = 45;
			this.labelGroupType.Text = "Cubemap";
			this.labelStackedTextureCount.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelStackedTextureCount.BackColor = System.Drawing.Color.Transparent;
			this.labelStackedTextureCount.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelStackedTextureCount.Location = new System.Drawing.Point(111, 48);
			this.labelStackedTextureCount.Name = "labelStackedTextureCount";
			this.labelStackedTextureCount.Size = new System.Drawing.Size(240, 21);
			this.labelStackedTextureCount.TabIndex = 44;
			this.labelStackedTextureCount.Text = "bluemarble";
			this.labelX10.AutoSize = true;
			this.labelX10.BackColor = System.Drawing.Color.Transparent;
			this.labelX10.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX10.Location = new System.Drawing.Point(14, 51);
			this.labelX10.Name = "labelX10";
			this.labelX10.Size = new System.Drawing.Size(88, 15);
			this.labelX10.TabIndex = 43;
			this.labelX10.Text = "Stacked Textures";
			this.labelGroupPanelGroupId.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelGroupPanelGroupId.BackColor = System.Drawing.Color.Transparent;
			this.labelGroupPanelGroupId.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelGroupPanelGroupId.Location = new System.Drawing.Point(111, 20);
			this.labelGroupPanelGroupId.Name = "labelGroupPanelGroupId";
			this.labelGroupPanelGroupId.Size = new System.Drawing.Size(240, 21);
			this.labelGroupPanelGroupId.TabIndex = 42;
			this.labelGroupPanelGroupId.Text = "bluemarble";
			this.labelX9.AutoSize = true;
			this.labelX9.BackColor = System.Drawing.Color.Transparent;
			this.labelX9.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX9.Location = new System.Drawing.Point(14, 23);
			this.labelX9.Name = "labelX9";
			this.labelX9.Size = new System.Drawing.Size(36, 15);
			this.labelX9.TabIndex = 41;
			this.labelX9.Text = "Group:";
			this.labelMissingTextures.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelMissingTextures.BackColor = System.Drawing.Color.Transparent;
			this.labelMissingTextures.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelMissingTextures.Image = GrBuildStudio.Properties.Resources.info;
			this.labelMissingTextures.ImageTextSpacing = 6;
			this.labelMissingTextures.Location = new System.Drawing.Point(19, 346);
			this.labelMissingTextures.Name = "labelMissingTextures";
			this.labelMissingTextures.RightToLeft = System.Windows.Forms.RightToLeft.No;
			this.labelMissingTextures.Size = new System.Drawing.Size(329, 61);
			this.labelMissingTextures.TabIndex = 0;
			this.labelMissingTextures.Text = "One or more textures are missing. Editing is disabled.";
			this.labelMissingTextures.WordWrap = true;
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			this.BackColor = System.Drawing.SystemColors.Control;
			base.Controls.Add(this.panel4);
			base.Controls.Add(this.labelStatus);
			base.Controls.Add(this.panel3);
			base.Controls.Add(this.panel2);
			base.Controls.Add(this.panel1);
			base.Controls.Add(this.tabStrip1);
			base.Controls.Add(this.labelMissingTextures);
			base.Name = "AssetDetails";
			base.Size = new System.Drawing.Size(1571, 544);
			this.panel1.ResumeLayout(false);
			this.panel1.PerformLayout();
			this.panel2.ResumeLayout(false);
			this.panel2.PerformLayout();
			this.panel3.ResumeLayout(false);
			this.panel4.ResumeLayout(false);
			this.panel4.PerformLayout();
			base.ResumeLayout(false);
		}
	}
	public enum QualityLevel
	{
		Default,
		Low,
		Medium,
		High,
		Uncompressed,
		Lossless
	}
	public enum FlipOption
	{
		None,
		Horizontal,
		Vertical,
		Both
	}
	public class LayerAssetImportDescription
	{
		public string Name { get; set; }

		public CombinedTextureSource FileSources { get; set; }

		public AssetPackingMode PackingMode { get; set; }

		public QualityLevel Quality { get; set; }

		public FlipOption Flip { get; set; }

		public TextureMipSourceType MipSourceType { get; set; }

		public ColorSpace ColorSpace { get; set; }

		public string[] Swizzle { get; set; }

		public LayerAssetImportDescription()
		{
			FileSources = new CombinedTextureSource();
			Swizzle = new string[4];
		}
	}
	public class AssetImportDescription
	{
		public string Name { get; set; }

		public AssetType Type { get; set; }

		public List<LayerAssetImportDescription> LayerAssets { get; private set; }

		public AssetImportDescription()
		{
			LayerAssets = new List<LayerAssetImportDescription>();
		}
	}
	public class LayerTemplateImportDescription
	{
		public string Name { get; set; }

		public List<LayerAssetImportDescription> LayerTemplates { get; private set; }

		public uint AssetBorder { get; set; }

		public LayerTemplateImportDescription()
		{
			LayerTemplates = new List<LayerAssetImportDescription>();
		}
	}
	public enum BuildErrorType
	{
		FatalError,
		Error,
		Warning,
		Info
	}
	public class BuildLogger
	{
		private class BuildLogContext
		{
			public int lastMessageIdx;

			public int fatalerrors;

			public int errors;

			public int warnings;

			public int infos;

			public int atlaserrors;
		}

		private BuildLoggerList list;

		private BuildLogContext context;

		public BuildLogger(BuildLoggerList list)
		{
			context = new BuildLogContext();
			this.list = list;
			Clear();
		}

		public bool ContainsErrors()
		{
			if (context.errors == 0)
			{
				return context.fatalerrors != 0;
			}
			return true;
		}

		public bool ContainsAtlassingErrors()
		{
			return context.atlaserrors != 0;
		}

		public void AddItem(BuildErrorType messageType, BuildProcess processId, BuildIssue buildIssue)
		{
			context.fatalerrors += ((messageType == BuildErrorType.FatalError) ? 1 : 0);
			context.errors += ((messageType == BuildErrorType.Error) ? 1 : 0);
			context.warnings += ((messageType == BuildErrorType.Warning) ? 1 : 0);
			context.infos += ((messageType == BuildErrorType.Info) ? 1 : 0);
			context.lastMessageIdx++;
			context.atlaserrors += (((messageType == BuildErrorType.FatalError || messageType == BuildErrorType.Error) && buildIssue is AtlasIssue) ? 1 : 0);
			list.AddItem(context.lastMessageIdx, messageType, processId, buildIssue);
		}

		public void AddInfoText(string message)
		{
			context.lastMessageIdx++;
			list.AddInfoText(context.lastMessageIdx, message);
		}

		public void AddErrorText(string message)
		{
			context.lastMessageIdx++;
			list.AddError(context.lastMessageIdx, message);
		}

		public void AddLogFinisher(string task = "building")
		{
			string message = string.Format("Finished " + task + " (Errors: {0}, Warnings: {1})", new object[2]
			{
				context.errors + context.fatalerrors,
				context.warnings
			});
			AddInfoText(message);
		}

		public void AddLogFinishCanceling()
		{
			string message = string.Format("Build canceled by user (Errors: {0}, Warnings: {1})", new object[2]
			{
				context.errors + context.fatalerrors,
				context.warnings
			});
			AddInfoText(message);
		}

		public void AddLogStarter()
		{
			string message = "Building...";
			AddInfoText(message);
		}

		public void Clear()
		{
			list.Clear();
		}
	}
	public class BuildLoggerReporter
	{
		private BuildLogger buildLogger;

		private ProjectBuilder builder;

		private BuildLoggerReportForm form;

		private FormMode formMode;

		public int ErrorCount { get; private set; }

		public int WarningCount { get; private set; }

		public int InfoCount { get; private set; }

		public bool HasErrors => ErrorCount > 0;

		public bool HasWarnings => WarningCount > 0;

		public bool HasInfo => InfoCount > 0;

		public bool HasSomethingToReport
		{
			get
			{
				if (ErrorCount <= 0 && WarningCount <= 0)
				{
					return InfoCount > 0;
				}
				return true;
			}
		}

		public bool IsListening { get; private set; }

		public BuildLoggerReporter()
		{
			formMode = FormMode.ChildWindow;
			form = new BuildLoggerReportForm(formMode);
			buildLogger = new BuildLogger(form.BuildLoggerList);
			ErrorCount = 0;
			WarningCount = 0;
			InfoCount = 0;
		}

		public BuildLoggerReporter(FormMode formMode)
		{
			this.formMode = formMode;
			form = new BuildLoggerReportForm(formMode);
			buildLogger = new BuildLogger(form.BuildLoggerList);
			ErrorCount = 0;
			WarningCount = 0;
			InfoCount = 0;
		}

		public void StartListening(ProjectBuilder builder)
		{
			this.builder = builder;
			builder.BuildReportingHandler.OnErrorHandler += BuildReportingHandler_OnErrorHandler;
			builder.BuildReportingHandler.OnFatalErrorHandler += BuildReportingHandler_OnFatalErrorHandler;
			builder.BuildReportingHandler.OnWarningHandler += BuildReportingHandler_OnWarningHandler;
			builder.BuildReportingHandler.OnInfoHandler += BuildReportingHandler_OnInfoHandler;
			IsListening = true;
		}

		public void AddFinishedMessage(string task = "importing")
		{
			if (task != null && task.Length != 0)
			{
				buildLogger.AddLogFinisher(task);
			}
		}

		public void StopListening()
		{
			builder.BuildReportingHandler.OnErrorHandler -= BuildReportingHandler_OnErrorHandler;
			builder.BuildReportingHandler.OnFatalErrorHandler -= BuildReportingHandler_OnFatalErrorHandler;
			builder.BuildReportingHandler.OnWarningHandler -= BuildReportingHandler_OnWarningHandler;
			builder.BuildReportingHandler.OnInfoHandler -= BuildReportingHandler_OnInfoHandler;
			IsListening = false;
		}

		public void Reset()
		{
			if (IsListening)
			{
				StopListening();
			}
			form = new BuildLoggerReportForm(formMode);
			buildLogger = new BuildLogger(form.BuildLoggerList);
			ErrorCount = 0;
			WarningCount = 0;
			InfoCount = 0;
		}

		public void ShowDialog()
		{
			form.Mode = (HasErrors ? BuildLoggerReportForm.ReportMode.Error : (HasWarnings ? BuildLoggerReportForm.ReportMode.Warning : BuildLoggerReportForm.ReportMode.Info));
			form.ShowDialog();
		}

		private void BuildReportingHandler_OnInfoHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			buildLogger.AddItem(BuildErrorType.Info, processId, buildIssue);
			InfoCount++;
		}

		private void BuildReportingHandler_OnWarningHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			buildLogger.AddItem(BuildErrorType.Warning, processId, buildIssue);
			WarningCount++;
		}

		private ErrorAction BuildReportingHandler_OnErrorHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			buildLogger.AddItem(BuildErrorType.Error, processId, buildIssue);
			ErrorCount++;
			return ErrorAction.ForceContinue;
		}

		private void BuildReportingHandler_OnFatalErrorHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			buildLogger.AddItem(BuildErrorType.FatalError, processId, buildIssue);
			ErrorCount++;
		}
	}
	public class CleanForm : Office2007Form
	{
		private IContainer components;

		private Button NoButton;

		private Button YesButton;

		private CheckBoxX GTSCheckbox;

		private CheckBoxX GAssetsCheckBox;

		private CheckBoxX IntermediateCheckBox;

		private LabelX labelQuestion;

		public CleanOperationParameters CleanParameters { get; private set; }

		public CleanForm()
		{
			InitializeComponent();
		}

		private void YesButton_Click(object sender, EventArgs e)
		{
			CleanOperationParameters cleanParameters = default(CleanOperationParameters);
			cleanParameters.intermediates = IntermediateCheckBox.Checked;
			cleanParameters.tileSet = GTSCheckbox.Checked;
			cleanParameters.soups = GAssetsCheckBox.Checked;
			CleanParameters = cleanParameters;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.NoButton = new System.Windows.Forms.Button();
			this.YesButton = new System.Windows.Forms.Button();
			this.GTSCheckbox = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.GAssetsCheckBox = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.IntermediateCheckBox = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.labelQuestion = new DevComponents.DotNetBar.LabelX();
			base.SuspendLayout();
			this.NoButton.AccessibleRole = System.Windows.Forms.AccessibleRole.PushButton;
			this.NoButton.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.NoButton.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.NoButton.Location = new System.Drawing.Point(226, 161);
			this.NoButton.Name = "NoButton";
			this.NoButton.Size = new System.Drawing.Size(75, 23);
			this.NoButton.TabIndex = 11;
			this.NoButton.Text = "Cancel";
			this.YesButton.AccessibleRole = System.Windows.Forms.AccessibleRole.PushButton;
			this.YesButton.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.YesButton.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.YesButton.Location = new System.Drawing.Point(142, 161);
			this.YesButton.Name = "YesButton";
			this.YesButton.Size = new System.Drawing.Size(78, 23);
			this.YesButton.TabIndex = 10;
			this.YesButton.Text = "Clean";
			this.YesButton.Click += new System.EventHandler(YesButton_Click);
			this.GTSCheckbox.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.GTSCheckbox.Location = new System.Drawing.Point(28, 117);
			this.GTSCheckbox.Name = "GTSCheckbox";
			this.GTSCheckbox.Size = new System.Drawing.Size(152, 23);
			this.GTSCheckbox.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.GTSCheckbox.TabIndex = 9;
			this.GTSCheckbox.Text = "Delete GTS Tile Set file";
			this.GAssetsCheckBox.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.GAssetsCheckBox.Location = new System.Drawing.Point(28, 88);
			this.GAssetsCheckBox.Name = "GAssetsCheckBox";
			this.GAssetsCheckBox.Size = new System.Drawing.Size(152, 23);
			this.GAssetsCheckBox.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.GAssetsCheckBox.TabIndex = 8;
			this.GAssetsCheckBox.Text = "Delete GTEX Files";
			this.IntermediateCheckBox.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.IntermediateCheckBox.Checked = true;
			this.IntermediateCheckBox.CheckState = System.Windows.Forms.CheckState.Checked;
			this.IntermediateCheckBox.CheckValue = "Y";
			this.IntermediateCheckBox.Location = new System.Drawing.Point(28, 59);
			this.IntermediateCheckBox.Name = "IntermediateCheckBox";
			this.IntermediateCheckBox.Size = new System.Drawing.Size(152, 23);
			this.IntermediateCheckBox.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.IntermediateCheckBox.TabIndex = 7;
			this.IntermediateCheckBox.Text = "Delete Intermediate Files";
			this.labelQuestion.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelQuestion.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelQuestion.Location = new System.Drawing.Point(12, 12);
			this.labelQuestion.Name = "labelQuestion";
			this.labelQuestion.Size = new System.Drawing.Size(289, 47);
			this.labelQuestion.TabIndex = 6;
			this.labelQuestion.Text = "Which files do you want to clean?";
			this.labelQuestion.WordWrap = true;
			base.AcceptButton = this.YesButton;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.CancelButton = this.NoButton;
			base.ClientSize = new System.Drawing.Size(313, 196);
			base.Controls.Add(this.NoButton);
			base.Controls.Add(this.YesButton);
			base.Controls.Add(this.GTSCheckbox);
			base.Controls.Add(this.GAssetsCheckBox);
			base.Controls.Add(this.IntermediateCheckBox);
			base.Controls.Add(this.labelQuestion);
			this.DoubleBuffered = true;
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "CleanForm";
			base.ShowIcon = false;
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "Clean";
			base.ResumeLayout(false);
		}
	}
	public class CrashReportForm : Form
	{
		[Serializable]
		public class CrashReport
		{
			public string Application { get; set; }

			public DateTime TimeStamp { get; set; }

			public string Message { get; set; }

			public string DetailedMessage { get; set; }

			public string StackTrace { get; set; }

			public string AssemblyVersion { get; set; }

			public string AssemblyDescription { get; set; }

			public CrashReport()
			{
			}

			public CrashReport(string message, Exception e)
			{
				Application = AssemblyHelper.AssemblyProduct;
				TimeStamp = DateTime.Now;
				Message = message;
				DetailedMessage = e.ToString();
				StackTrace = e.StackTrace;
				AssemblyDescription = AssemblyHelper.AssemblyDescription;
				AssemblyVersion = AssemblyHelper.AssemblyInformationalVersion;
			}

			public override string ToString()
			{
				return string.Format("Fatal Exception in {1} at {2}{0}Message: {3}{0}Detailed: {4}{0}StackTrace: {5}{0}Version: {6}{0}AssemblyInfo: {7}", Environment.NewLine, Application, TimeStamp, Message, DetailedMessage, StackTrace, AssemblyVersion, AssemblyDescription);
			}
		}

		public enum DisplayMode
		{
			FatalError,
			Error
		}

		private IContainer components;

		private Label labelTitle;

		private PictureBox pictureBox1;

		private TextBox textBoxMessage;

		private Label label2;

		private Button buttonQuit;

		private Button buttonSaveReport;

		private Label label3;

		private TextBox textBoxStackTrace;

		private Button buttonCopyClipboard;

		public string Message { get; set; }

		public Exception Exception { get; set; }

		public DisplayMode Mode { get; set; }

		public CrashReportForm()
		{
			InitializeComponent();
		}

		private void buttonSaveReport_Click(object sender, EventArgs e)
		{
			SaveFileDialog saveFileDialog = new SaveFileDialog();
			saveFileDialog.Filter = "GrBuild Bug Report (*.gbr)|*.gbr;";
			if (saveFileDialog.ShowDialog() == DialogResult.OK && SaveReport(saveFileDialog.FileName))
			{
				MessageBox.Show(string.Format("Successfully saved the crash report. Please send it to Graphine support via the support platform ({0}) or by email({1}).", new object[2]
				{
					Constants.OnlineSupportUrl,
					Constants.OnlineSupportEmail
				}), "Crash report saved", MessageBoxButtons.OK, MessageBoxIcon.Asterisk);
			}
		}

		private void buttonQuit_Click(object sender, EventArgs e)
		{
			Close();
		}

		private void CrashReportForm_Load(object sender, EventArgs e)
		{
			CrashReport crashReport = new CrashReport(Message, Exception);
			textBoxMessage.Text = crashReport.Message;
			textBoxStackTrace.Text = crashReport.ToString();
			if (Mode == DisplayMode.Error)
			{
				buttonQuit.Text = "Try Resume";
			}
			else
			{
				buttonQuit.Text = "Quit";
			}
		}

		private bool SaveReport(string filename)
		{
			try
			{
				XmlSerializer xmlSerializer = new XmlSerializer(typeof(CrashReport));
				CrashReport o = new CrashReport(Message, Exception);
				using StringWriter stringWriter = new StringWriter();
				using XmlWriter xmlWriter = XmlWriter.Create(stringWriter);
				xmlSerializer.Serialize(xmlWriter, o);
				using StreamWriter streamWriter = new StreamWriter(filename);
				streamWriter.Write(stringWriter.ToString());
			}
			catch
			{
				MessageBox.Show("Error writing crash report to output file. Make sure you have write access. Choose another folder and try again.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
				return false;
			}
			return true;
		}

		private void buttonCopyClipboard_Click(object sender, EventArgs e)
		{
			ClipboardHelper.CopyText(new CrashReport(Message, Exception).ToString());
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(GrBuildStudio.CrashReportForm));
			this.labelTitle = new System.Windows.Forms.Label();
			this.pictureBox1 = new System.Windows.Forms.PictureBox();
			this.textBoxMessage = new System.Windows.Forms.TextBox();
			this.label2 = new System.Windows.Forms.Label();
			this.buttonQuit = new System.Windows.Forms.Button();
			this.buttonSaveReport = new System.Windows.Forms.Button();
			this.label3 = new System.Windows.Forms.Label();
			this.textBoxStackTrace = new System.Windows.Forms.TextBox();
			this.buttonCopyClipboard = new System.Windows.Forms.Button();
			((System.ComponentModel.ISupportInitialize)this.pictureBox1).BeginInit();
			base.SuspendLayout();
			this.labelTitle.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelTitle.Location = new System.Drawing.Point(58, 33);
			this.labelTitle.Name = "labelTitle";
			this.labelTitle.Size = new System.Drawing.Size(400, 75);
			this.labelTitle.TabIndex = 0;
			this.labelTitle.Text = resources.GetString("labelTitle.Text");
			this.pictureBox1.Image = GrBuildStudio.Properties.Resources.big_warning;
			this.pictureBox1.Location = new System.Drawing.Point(16, 33);
			this.pictureBox1.Name = "pictureBox1";
			this.pictureBox1.Size = new System.Drawing.Size(36, 36);
			this.pictureBox1.TabIndex = 1;
			this.pictureBox1.TabStop = false;
			this.textBoxMessage.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.textBoxMessage.Location = new System.Drawing.Point(72, 120);
			this.textBoxMessage.Multiline = true;
			this.textBoxMessage.Name = "textBoxMessage";
			this.textBoxMessage.ReadOnly = true;
			this.textBoxMessage.Size = new System.Drawing.Size(386, 57);
			this.textBoxMessage.TabIndex = 2;
			this.label2.AutoSize = true;
			this.label2.Location = new System.Drawing.Point(13, 123);
			this.label2.Name = "label2";
			this.label2.Size = new System.Drawing.Size(53, 13);
			this.label2.TabIndex = 3;
			this.label2.Text = "Message:";
			this.buttonQuit.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonQuit.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.buttonQuit.Location = new System.Drawing.Point(383, 275);
			this.buttonQuit.Name = "buttonQuit";
			this.buttonQuit.Size = new System.Drawing.Size(75, 23);
			this.buttonQuit.TabIndex = 4;
			this.buttonQuit.Text = "Quit";
			this.buttonQuit.UseVisualStyleBackColor = true;
			this.buttonQuit.Click += new System.EventHandler(buttonQuit_Click);
			this.buttonSaveReport.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonSaveReport.Location = new System.Drawing.Point(256, 275);
			this.buttonSaveReport.Name = "buttonSaveReport";
			this.buttonSaveReport.Size = new System.Drawing.Size(121, 23);
			this.buttonSaveReport.TabIndex = 5;
			this.buttonSaveReport.Text = "Save Bug Report";
			this.buttonSaveReport.UseVisualStyleBackColor = true;
			this.buttonSaveReport.Click += new System.EventHandler(buttonSaveReport_Click);
			this.label3.AutoSize = true;
			this.label3.Location = new System.Drawing.Point(13, 194);
			this.label3.Name = "label3";
			this.label3.Size = new System.Drawing.Size(42, 13);
			this.label3.TabIndex = 7;
			this.label3.Text = "Details:";
			this.textBoxStackTrace.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.textBoxStackTrace.Location = new System.Drawing.Point(72, 191);
			this.textBoxStackTrace.Multiline = true;
			this.textBoxStackTrace.Name = "textBoxStackTrace";
			this.textBoxStackTrace.ReadOnly = true;
			this.textBoxStackTrace.Size = new System.Drawing.Size(386, 57);
			this.textBoxStackTrace.TabIndex = 6;
			this.buttonCopyClipboard.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCopyClipboard.Location = new System.Drawing.Point(72, 275);
			this.buttonCopyClipboard.Name = "buttonCopyClipboard";
			this.buttonCopyClipboard.Size = new System.Drawing.Size(121, 23);
			this.buttonCopyClipboard.TabIndex = 8;
			this.buttonCopyClipboard.Text = "Copy to Clipboard";
			this.buttonCopyClipboard.UseVisualStyleBackColor = true;
			this.buttonCopyClipboard.Click += new System.EventHandler(buttonCopyClipboard_Click);
			base.AcceptButton = this.buttonQuit;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.ClientSize = new System.Drawing.Size(482, 310);
			base.Controls.Add(this.buttonCopyClipboard);
			base.Controls.Add(this.label3);
			base.Controls.Add(this.textBoxStackTrace);
			base.Controls.Add(this.buttonSaveReport);
			base.Controls.Add(this.buttonQuit);
			base.Controls.Add(this.label2);
			base.Controls.Add(this.textBoxMessage);
			base.Controls.Add(this.pictureBox1);
			base.Controls.Add(this.labelTitle);
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "CrashReportForm";
			base.ShowIcon = false;
			this.Text = "Unexcepted Error";
			base.Load += new System.EventHandler(CrashReportForm_Load);
			((System.ComponentModel.ISupportInitialize)this.pictureBox1).EndInit();
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	public class DeleteProjectForm : OfficeForm
	{
		private SolutionModel model;

		private IContainer components;

		private LabelX labelQuestion;

		private CheckBoxX IntermediateCheckBox;

		private CheckBoxX OutputCheckBox;

		private CheckBoxX ProjectCheckbox;

		private Button YesButton;

		private Button NoButton;

		public DeleteProjectForm()
		{
			InitializeComponent();
		}

		public void InitForProject(SolutionModel _model)
		{
			model = _model;
			Text = "Delete " + model.ActiveSolutionProject.Name + "?";
			labelQuestion.Text = "Do you want to delete project '" + model.ActiveSolutionProject.Name + "' from this solution? \r\n\r\nNote that this operation will delete all files on disk (unless requested below)";
		}

		private void YesButton_Click(object sender, EventArgs e)
		{
			if (model.ActiveSolutionProject != null)
			{
				GrBuildLib.Error error = model.RemoveProject(model.ActiveSolutionProject.Id, !IntermediateCheckBox.Checked, !OutputCheckBox.Checked, !ProjectCheckbox.Checked);
				if (error == GrBuildLib.Error.Ok)
				{
					Close();
				}
				else
				{
					MessageBox.Show(this, "During the excluding of the project, the following error occurred: " + error, "Error excluding", MessageBoxButtons.OK, MessageBoxIcon.Hand);
				}
			}
		}

		private void NoButton_Click(object sender, EventArgs e)
		{
			Close();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.labelQuestion = new DevComponents.DotNetBar.LabelX();
			this.IntermediateCheckBox = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.OutputCheckBox = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.ProjectCheckbox = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.YesButton = new System.Windows.Forms.Button();
			this.NoButton = new System.Windows.Forms.Button();
			base.SuspendLayout();
			this.labelQuestion.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelQuestion.Location = new System.Drawing.Point(12, 12);
			this.labelQuestion.Name = "labelQuestion";
			this.labelQuestion.Size = new System.Drawing.Size(381, 47);
			this.labelQuestion.TabIndex = 0;
			this.labelQuestion.Text = "Do you want to delete project 'Tileset1'? \r\n\r\nNote that this operation will delete all files on disk (unless requested below)";
			this.labelQuestion.WordWrap = true;
			this.IntermediateCheckBox.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.IntermediateCheckBox.Location = new System.Drawing.Point(12, 67);
			this.IntermediateCheckBox.Name = "IntermediateCheckBox";
			this.IntermediateCheckBox.Size = new System.Drawing.Size(152, 23);
			this.IntermediateCheckBox.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.IntermediateCheckBox.TabIndex = 1;
			this.IntermediateCheckBox.Text = "Keep Intermediate Files";
			this.OutputCheckBox.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.OutputCheckBox.Location = new System.Drawing.Point(12, 96);
			this.OutputCheckBox.Name = "OutputCheckBox";
			this.OutputCheckBox.Size = new System.Drawing.Size(152, 23);
			this.OutputCheckBox.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.OutputCheckBox.TabIndex = 2;
			this.OutputCheckBox.Text = "Keep Output Files";
			this.ProjectCheckbox.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.ProjectCheckbox.Location = new System.Drawing.Point(12, 125);
			this.ProjectCheckbox.Name = "ProjectCheckbox";
			this.ProjectCheckbox.Size = new System.Drawing.Size(152, 23);
			this.ProjectCheckbox.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.ProjectCheckbox.TabIndex = 3;
			this.ProjectCheckbox.Text = "Keep Project Files";
			this.YesButton.AccessibleRole = System.Windows.Forms.AccessibleRole.PushButton;
			this.YesButton.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.YesButton.Location = new System.Drawing.Point(223, 150);
			this.YesButton.Name = "YesButton";
			this.YesButton.Size = new System.Drawing.Size(78, 23);
			this.YesButton.TabIndex = 4;
			this.YesButton.Text = "Yes";
			this.YesButton.Click += new System.EventHandler(YesButton_Click);
			this.NoButton.AccessibleRole = System.Windows.Forms.AccessibleRole.PushButton;
			this.NoButton.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.NoButton.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.NoButton.Location = new System.Drawing.Point(307, 150);
			this.NoButton.Name = "NoButton";
			this.NoButton.Size = new System.Drawing.Size(75, 23);
			this.NoButton.TabIndex = 5;
			this.NoButton.Text = "No";
			this.NoButton.Click += new System.EventHandler(NoButton_Click);
			base.AcceptButton = this.YesButton;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.CancelButton = this.NoButton;
			base.ClientSize = new System.Drawing.Size(394, 185);
			base.Controls.Add(this.NoButton);
			base.Controls.Add(this.YesButton);
			base.Controls.Add(this.ProjectCheckbox);
			base.Controls.Add(this.OutputCheckBox);
			base.Controls.Add(this.IntermediateCheckBox);
			base.Controls.Add(this.labelQuestion);
			this.DoubleBuffered = true;
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "DeleteProjectDialog";
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "ExcludeProjectDialog";
			base.ResumeLayout(false);
		}
	}
	public class MessageBar : UserControl
	{
		private IContainer components;

		private LabelX label;

		private ButtonX buttonHide;

		public string MessageText
		{
			get
			{
				return label.Text;
			}
			set
			{
				label.Text = value;
			}
		}

		public Image MessageImage
		{
			get
			{
				return label.Image;
			}
			set
			{
				label.Image = value;
			}
		}

		public MessageBar()
		{
			InitializeComponent();
		}

		private void buttonHide_Click(object sender, EventArgs e)
		{
			base.Visible = false;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.label = new DevComponents.DotNetBar.LabelX();
			this.buttonHide = new DevComponents.DotNetBar.ButtonX();
			base.SuspendLayout();
			this.label.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.label.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.label.Image = GrBuildStudio.Properties.Resources.info;
			this.label.Location = new System.Drawing.Point(0, 4);
			this.label.Name = "label";
			this.label.Size = new System.Drawing.Size(595, 28);
			this.label.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.label.TabIndex = 10;
			this.label.Text = "Info: One or more projects are opened in read-only mode. You can build projects but not make changes.";
			this.label.WordWrap = true;
			this.buttonHide.AccessibleRole = System.Windows.Forms.AccessibleRole.PushButton;
			this.buttonHide.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.buttonHide.ColorTable = DevComponents.DotNetBar.eButtonColor.OrangeWithBackground;
			this.buttonHide.Location = new System.Drawing.Point(596, 6);
			this.buttonHide.Name = "buttonHide";
			this.buttonHide.Size = new System.Drawing.Size(62, 23);
			this.buttonHide.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.buttonHide.TabIndex = 11;
			this.buttonHide.Text = "Hide";
			this.buttonHide.Click += new System.EventHandler(buttonHide_Click);
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.buttonHide);
			base.Controls.Add(this.label);
			base.Name = "MessageBar";
			base.Size = new System.Drawing.Size(663, 35);
			base.ResumeLayout(false);
		}
	}
	public class MigrateAssetsForm : OfficeForm
	{
		private enum Action
		{
			Copy,
			Move
		}

		private Dictionary<Guid, List<Asset>> assetsToMigrate;

		private SolutionModel model;

		private SolutionBuilder solutionBuilder;

		private IContainer components;

		private ProjectList projectList1;

		private Label label2;

		private PickerControl pickerControl1;

		private Label label3;

		private ComboBox comboBoxAction;

		private Label label4;

		private Button buttonCancel;

		private Button buttonMigrate;

		public MigrateAssetsForm()
		{
			InitializeComponent();
		}

		public void Initialize(SolutionModel model, Dictionary<Guid, List<Asset>> assetsToMigrate)
		{
			this.model = model;
			this.assetsToMigrate = assetsToMigrate;
			ComboBoxHelper.FillEnumComboBox<Action>(comboBoxAction);
			comboBoxAction.SelectedIndex = 0;
			pickerControl1.DisplayTextBox.Text = "No Solution Loaded";
			EnableButtons();
		}

		private void EnableButtons()
		{
			buttonMigrate.Enabled = projectList1.SelectedProject != null;
		}

		private bool LoadSolution(string filename)
		{
			UnloadSolution();
			solutionBuilder = new SolutionBuilder();
			GrBuildLib.Error error = GrBuildLib.Error.Ok;
			try
			{
				error = solutionBuilder.LoadSolution(filename, createIfNotExist: false);
			}
			catch (UnspecifiedException ex)
			{
				string message = string.Format("Could not load solution. Detailed error message: '{0}'. Error code: '{1}'.", new object[2] { ex.Message, ex.ErrorCode });
				StudioLogger.Global.LogError(message);
				return false;
			}
			catch (Exception ex2)
			{
				UnspecifiedException e = new UnspecifiedException($"Could not load solution. Detailed error message: '{ex2.Message}'.", ex2);
				StudioLogger.Global.LogException(e);
				return false;
			}
			switch (error)
			{
			case GrBuildLib.Error.SolutionLocked:
				StudioLogger.Global.LogError("Solution is already open in another instance. Please close the other instance or open a different solution.");
				return false;
			default:
				StudioLogger.Global.LogError("Could not open solution. General error: " + error);
				return false;
			case GrBuildLib.Error.Ok:
				return true;
			}
		}

		private void UnloadSolution()
		{
			if (solutionBuilder != null && solutionBuilder.IsSolutionLoaded())
			{
				solutionBuilder.CloseSolution();
			}
		}

		private void pickerControl1_Picked(object sender, EventArgs e)
		{
			OpenFileDialog openFileDialog = new OpenFileDialog();
			openFileDialog.Filter = DialogUtil.SolutionOpenDialogFilter;
			openFileDialog.InitialDirectory = DialogUtil.SolutionLocation;
			if (openFileDialog.ShowDialog() == DialogResult.OK)
			{
				string fullPath = Path.GetFullPath(openFileDialog.FileName);
				string fullPath2 = Path.GetFullPath(model.SolutionBuilder.ActiveSolutionFullPath);
				if (fullPath.Equals(fullPath2))
				{
					string message = "Please select a solution other than the currently loaded solution. To move Stacked Textures between projects in a loaded solution, just drag and drop Stacked Textures between the Tile Set main views.";
					StudioLogger.Global.LogError(message);
				}
				else if (LoadSolution(fullPath))
				{
					EnableButtons();
					projectList1.Solution = solutionBuilder.ActiveSolution;
					pickerControl1.DisplayTextBox.Text = fullPath;
					DialogUtil.SolutionLocation = Paths.GetDirectoryName(openFileDialog.FileName);
				}
			}
		}

		private void buttonMigrate_Click(object sender, EventArgs e)
		{
			Migrate();
		}

		public static void ConversionProblemsCallback(object sender, SolutionModel.MoveAssetConvProblemsArgs e)
		{
			if (MessageBox.Show("In order to migrate at least one of the Stacked Textures, some layers will get lost. Continue?", "Continue?", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.Yes)
			{
				e.Continue = true;
				e.Options = AssetTools.AssetToImportAssetConversionOptions.AllowExtendAndShrink;
			}
			else
			{
				e.Continue = false;
			}
		}

		private void Migrate()
		{
			bool keepCopy = ComboBoxHelper.GetSelectedEnumValue<Action>(comboBoxAction) == Action.Copy;
			if (projectList1.SelectedProject == null)
			{
				return;
			}
			Guid id = projectList1.SelectedProject.Id;
			try
			{
				new BuildLoggerReporter();
				model.MoveAssets(assetsToMigrate, solutionBuilder, id, keepCopy, out var report, ConversionProblemsCallback);
				if (!report.HasErrors)
				{
					string text = $"Successfully migrated all {report.TotalAssetCount} stacked textures.";
					MessageBox.Show(this, text, "Migration Completed", MessageBoxButtons.OK, MessageBoxIcon.Asterisk);
					return;
				}
				if (report.HasImportErrors)
				{
					string message = $"Migration completed with errors. Importing the migrating stacked textures showed errors. Please press OK to inspect these.";
					StudioLogger.Global.LogError(message);
					report.BuildLoggerReporterImport.ShowDialog();
				}
				if (!report.HasDeletionErrors)
				{
					return;
				}
				string message2 = $"Migration completed with errors. Deleting migrated stacked textures from their original tile sets showed errors. Please press OK to inspect these.";
				StudioLogger.Global.LogError(message2);
				foreach (BuildLoggerReporter item in report.BuildLoggerReporterDeletion)
				{
					if (item.HasErrors)
					{
						item.ShowDialog();
					}
				}
			}
			catch (Exception ex)
			{
				string message3 = $"Migration failed because of an unexpected error. Exception error: {ex.ToString()}";
				StudioLogger.Global.LogError(message3);
			}
		}

		private void MigrateAssetsForm_FormClosing(object sender, FormClosingEventArgs e)
		{
			UnloadSolution();
		}

		private void projectList1_SelectionChanged(object sender)
		{
			EnableButtons();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.label2 = new System.Windows.Forms.Label();
			this.label3 = new System.Windows.Forms.Label();
			this.comboBoxAction = new System.Windows.Forms.ComboBox();
			this.label4 = new System.Windows.Forms.Label();
			this.buttonCancel = new System.Windows.Forms.Button();
			this.buttonMigrate = new System.Windows.Forms.Button();
			this.pickerControl1 = new GrBuildStudio.Controls.PickerControl();
			this.projectList1 = new GrBuildStudio.ProjectList();
			base.SuspendLayout();
			this.label2.AutoSize = true;
			this.label2.Location = new System.Drawing.Point(10, 21);
			this.label2.Name = "label2";
			this.label2.Size = new System.Drawing.Size(79, 13);
			this.label2.TabIndex = 3;
			this.label2.Text = "Target Solution";
			this.label3.AutoSize = true;
			this.label3.Location = new System.Drawing.Point(12, 79);
			this.label3.Name = "label3";
			this.label3.Size = new System.Drawing.Size(77, 13);
			this.label3.TabIndex = 5;
			this.label3.Text = "Target Project:";
			this.comboBoxAction.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxAction.FormattingEnabled = true;
			this.comboBoxAction.Location = new System.Drawing.Point(15, 258);
			this.comboBoxAction.Name = "comboBoxAction";
			this.comboBoxAction.Size = new System.Drawing.Size(207, 21);
			this.comboBoxAction.TabIndex = 6;
			this.label4.AutoSize = true;
			this.label4.Location = new System.Drawing.Point(12, 239);
			this.label4.Name = "label4";
			this.label4.Size = new System.Drawing.Size(40, 13);
			this.label4.TabIndex = 7;
			this.label4.Text = "Action:";
			this.buttonCancel.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.buttonCancel.Location = new System.Drawing.Point(316, 300);
			this.buttonCancel.Name = "buttonCancel";
			this.buttonCancel.Size = new System.Drawing.Size(75, 23);
			this.buttonCancel.TabIndex = 512;
			this.buttonCancel.Text = "Close";
			this.buttonCancel.UseVisualStyleBackColor = true;
			this.buttonMigrate.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonMigrate.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.buttonMigrate.Location = new System.Drawing.Point(235, 300);
			this.buttonMigrate.Name = "buttonMigrate";
			this.buttonMigrate.Size = new System.Drawing.Size(75, 23);
			this.buttonMigrate.TabIndex = 511;
			this.buttonMigrate.Text = "Go";
			this.buttonMigrate.UseVisualStyleBackColor = true;
			this.buttonMigrate.Click += new System.EventHandler(buttonMigrate_Click);
			this.pickerControl1.AllowFileDrop = false;
			this.pickerControl1.AllowFolderDrop = false;
			this.pickerControl1.Location = new System.Drawing.Point(15, 41);
			this.pickerControl1.Name = "pickerControl1";
			this.pickerControl1.Size = new System.Drawing.Size(372, 20);
			this.pickerControl1.TabIndex = 4;
			this.pickerControl1.Template = null;
			this.pickerControl1.Picked += new System.EventHandler(pickerControl1_Picked);
			this.projectList1.Location = new System.Drawing.Point(15, 98);
			this.projectList1.Name = "projectList1";
			this.projectList1.Size = new System.Drawing.Size(376, 124);
			this.projectList1.Solution = null;
			this.projectList1.TabIndex = 2;
			this.projectList1.SelectionChanged += new GrBuildStudio.ProjectList.SelectionChangedEventHandler(projectList1_SelectionChanged);
			base.AcceptButton = this.buttonMigrate;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.CancelButton = this.buttonCancel;
			base.ClientSize = new System.Drawing.Size(403, 335);
			base.Controls.Add(this.buttonCancel);
			base.Controls.Add(this.buttonMigrate);
			base.Controls.Add(this.label4);
			base.Controls.Add(this.comboBoxAction);
			base.Controls.Add(this.label3);
			base.Controls.Add(this.pickerControl1);
			base.Controls.Add(this.label2);
			base.Controls.Add(this.projectList1);
			this.DoubleBuffered = true;
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "MigrateAssetsForm";
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "Migrate Stacked Textures";
			base.FormClosing += new System.Windows.Forms.FormClosingEventHandler(MigrateAssetsForm_FormClosing);
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	internal interface MRUSerializer
	{
		bool Save(string[] mruList);

		bool Load(out string[] mruList);
	}
	internal class MRUSerializerInRegistry : MRUSerializer
	{
		private string folderPath;

		public MRUSerializerInRegistry(string folderPath)
		{
			this.folderPath = folderPath;
		}

		public bool Save(string[] mruList)
		{
			try
			{
				RegistryKey registryKey = Registry.CurrentUser.CreateSubKey(folderPath);
				if (registryKey == null)
				{
					return false;
				}
				StringBuilder stringBuilder = new StringBuilder();
				for (int i = 0; i < mruList.Length; i++)
				{
					stringBuilder.Append(mruList[i]);
					if (i != mruList.Length - 1)
					{
						stringBuilder.Append(";");
					}
				}
				registryKey.SetValue("MRUList", stringBuilder.ToString());
				registryKey.Close();
			}
			catch
			{
			}
			return true;
		}

		public bool Load(out string[] mruList)
		{
			mruList = new string[0];
			try
			{
				RegistryKey registryKey = Registry.CurrentUser.CreateSubKey(folderPath);
				if (registryKey == null)
				{
					return false;
				}
				string text = (string)registryKey.GetValue("MRUList", string.Empty);
				if (text == null)
				{
					return false;
				}
				string[] array = text.Split(';');
				List<string> list = new List<string>();
				string[] array2 = array;
				foreach (string text2 in array2)
				{
					if (text2.Length != 0)
					{
						list.Add(text2);
					}
				}
				mruList = list.ToArray();
				registryKey.Close();
			}
			catch
			{
			}
			return true;
		}
	}
	internal class MRUSerializerInMemory : MRUSerializer
	{
		private string[] list;

		public MRUSerializerInMemory()
		{
			list = new string[0];
		}

		public bool Save(string[] mruList)
		{
			list = mruList;
			return true;
		}

		public bool Load(out string[] mruList)
		{
			mruList = list;
			return true;
		}
	}
	internal class MRUManager
	{
		private List<string> list;

		private MRUSerializer serializer;

		public string[] FileList => ReverseList(list);

		public int MaximumLength { get; private set; }

		public MRUManager(MRUSerializer serializer, int maximumLength)
		{
			this.serializer = serializer;
			list = new List<string>();
			MaximumLength = maximumLength;
			Load();
		}

		private void Load()
		{
			serializer.Load(out var mruList);
			list.Clear();
			for (int i = 0; i < mruList.Length; i++)
			{
				list.Add(mruList[i]);
			}
		}

		private void Save()
		{
			serializer.Save(list.ToArray());
		}

		private string[] ReverseList(List<string> list)
		{
			List<string> obj = new List<string>(list);
			obj.Reverse();
			return obj.ToArray();
		}

		private void DequeueIfRequired()
		{
			if (list.Count > 0 && list.Count > MaximumLength)
			{
				list.RemoveAt(0);
			}
		}

		public void AddFile(string filename)
		{
			if (list.Contains(filename))
			{
				list.Remove(filename);
				list.Add(filename);
			}
			else
			{
				list.Add(filename);
			}
			DequeueIfRequired();
			Save();
		}

		public void RemoveFile(string filename)
		{
			if (list.Contains(filename))
			{
				list.Remove(filename);
			}
			Save();
		}
	}
	internal class MRUMenuManager
	{
		public delegate void MRUItemClickedEventHandler(object sender, string filename);

		private MRUManager mruManager;

		private ButtonItem parentButton;

		private int maximumButtonCaptionLength;

		public event MRUItemClickedEventHandler MRUItemClicked;

		protected virtual void OnMRUItemClicked(string filename)
		{
			this.MRUItemClicked?.Invoke(this, filename);
		}

		public MRUMenuManager(MRUManager manager, ButtonItem parentButton, int maximumButtonCaptionLength)
		{
			mruManager = manager;
			this.parentButton = parentButton;
			this.maximumButtonCaptionLength = maximumButtonCaptionLength;
			SetupMenu();
		}

		private void SetupMenu()
		{
			string[] fileList = mruManager.FileList;
			parentButton.SubItems.Clear();
			if (fileList.Length == 0)
			{
				ButtonItem buttonItem = new ButtonItem();
				buttonItem.Text = "";
				buttonItem.Enabled = false;
				buttonItem.Tag = null;
				parentButton.SubItems.Add(buttonItem);
				return;
			}
			for (int i = 0; i < fileList.Length; i++)
			{
				string arg = ShellTools.ShortenPathname(fileList[i], maximumButtonCaptionLength);
				ButtonItem buttonItem2 = new ButtonItem();
				buttonItem2.Text = $"{(i + 1).ToString()} - {arg}";
				buttonItem2.Tag = fileList[i];
				buttonItem2.Name = "Test";
				buttonItem2.Click += ButtonItemMRUItem_Click;
				parentButton.SubItems.Add(buttonItem2);
			}
		}

		private void ButtonItemMRUItem_Click(object sender, EventArgs e)
		{
			string filename = (string)((ButtonItem)sender).Tag;
			OnMRUItemClicked(filename);
		}

		public void AddMRUFile(string filename)
		{
			mruManager.AddFile(filename);
			SetupMenu();
		}

		public void RemoveMRUFile(string filename)
		{
			mruManager.RemoveFile(filename);
			SetupMenu();
		}

		public void Refresh()
		{
			SetupMenu();
		}
	}
	public class ProjectList : UserControl
	{
		public delegate void SelectionChangedEventHandler(object sender);

		private Solution solution;

		private IContainer components;

		private ListBoxAdv listBoxAdv1;

		private ListBoxItem listBoxItem1;

		public Solution Solution
		{
			get
			{
				return solution;
			}
			set
			{
				solution = value;
				PopulateList();
			}
		}

		public SolutionProjectDecriptor SelectedProject { get; private set; }

		public event SelectionChangedEventHandler SelectionChanged;

		public ProjectList()
		{
			InitializeComponent();
		}

		protected virtual void OnSelectionChanged()
		{
			this.SelectionChanged?.Invoke(this);
		}

		private void PopulateList()
		{
			listBoxAdv1.Items.Clear();
			if (solution == null)
			{
				return;
			}
			foreach (SolutionProjectDecriptor value in solution.Projects.Values)
			{
				ListBoxItem listBoxItem = new ListBoxItem();
				listBoxItem.Text = value.Name;
				listBoxItem.Tag = value;
				listBoxAdv1.Items.Add(listBoxItem);
			}
		}

		private void listBoxAdv1_SelectedIndexChanged(object sender, EventArgs e)
		{
			ListBoxItem listBoxItem = (ListBoxItem)listBoxAdv1.SelectedItem;
			SelectedProject = (SolutionProjectDecriptor)listBoxItem.Tag;
			OnSelectionChanged();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.listBoxAdv1 = new DevComponents.DotNetBar.ListBoxAdv();
			this.listBoxItem1 = new DevComponents.DotNetBar.ListBoxItem();
			base.SuspendLayout();
			this.listBoxAdv1.AutoScroll = true;
			this.listBoxAdv1.BackgroundStyle.Class = "ListBoxAdv";
			this.listBoxAdv1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.listBoxAdv1.ContainerControlProcessDialogKey = true;
			this.listBoxAdv1.Dock = System.Windows.Forms.DockStyle.Fill;
			this.listBoxAdv1.DragDropSupport = true;
			this.listBoxAdv1.Items.Add(this.listBoxItem1);
			this.listBoxAdv1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.listBoxAdv1.Location = new System.Drawing.Point(0, 0);
			this.listBoxAdv1.Name = "listBoxAdv1";
			this.listBoxAdv1.Size = new System.Drawing.Size(219, 112);
			this.listBoxAdv1.TabIndex = 1;
			this.listBoxAdv1.Text = "listBoxAdv1";
			this.listBoxAdv1.SelectedIndexChanged += new System.EventHandler(listBoxAdv1_SelectedIndexChanged);
			this.listBoxItem1.Name = "listBoxItem1";
			this.listBoxItem1.Text = "Item 1";
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.listBoxAdv1);
			base.Name = "ProjectList";
			base.Size = new System.Drawing.Size(219, 112);
			base.ResumeLayout(false);
		}
	}
	public class FilterBar : UserControl
	{
		public delegate void FilterRequestEventHandler(object sender);

		public delegate void CancelClickEventHandler(object sender);

		private IContainer components;

		private TextBox textBoxWhat;

		private Label label1;

		private Button buttonClose;

		private Label label2;

		public string Filter
		{
			get
			{
				return textBoxWhat.Text;
			}
			set
			{
				textBoxWhat.Text = value;
			}
		}

		public event FilterRequestEventHandler FilterRequest;

		public event CancelClickEventHandler CancelClick;

		public FilterBar()
		{
			InitializeComponent();
		}

		public void Activate()
		{
			textBoxWhat.SelectAll();
			textBoxWhat.Focus();
		}

		public void Reset()
		{
			Filter = string.Empty;
		}

		protected virtual void OnFilterRequest()
		{
			this.FilterRequest?.Invoke(this);
		}

		protected virtual void OnCancelClick()
		{
			this.CancelClick?.Invoke(this);
		}

		private void buttonClose_Click(object sender, EventArgs e)
		{
			OnCancelClick();
		}

		private void textBoxWhat_TextChanged(object sender, EventArgs e)
		{
			OnFilterRequest();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.textBoxWhat = new System.Windows.Forms.TextBox();
			this.label1 = new System.Windows.Forms.Label();
			this.buttonClose = new System.Windows.Forms.Button();
			this.label2 = new System.Windows.Forms.Label();
			base.SuspendLayout();
			this.textBoxWhat.Location = new System.Drawing.Point(167, 10);
			this.textBoxWhat.Name = "textBoxWhat";
			this.textBoxWhat.Size = new System.Drawing.Size(186, 20);
			this.textBoxWhat.TabIndex = 1;
			this.textBoxWhat.TextChanged += new System.EventHandler(textBoxWhat_TextChanged);
			this.label1.AutoSize = true;
			this.label1.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
			this.label1.Location = new System.Drawing.Point(42, 13);
			this.label1.Name = "label1";
			this.label1.Size = new System.Drawing.Size(119, 13);
			this.label1.TabIndex = 1;
			this.label1.Text = "Filter Stacked Textures:";
			this.buttonClose.Location = new System.Drawing.Point(384, 8);
			this.buttonClose.Name = "buttonClose";
			this.buttonClose.Size = new System.Drawing.Size(75, 23);
			this.buttonClose.TabIndex = 4;
			this.buttonClose.Text = "Close";
			this.buttonClose.UseVisualStyleBackColor = true;
			this.buttonClose.Click += new System.EventHandler(buttonClose_Click);
			this.label2.Image = GrBuildStudio.Properties.Resources.magnifier;
			this.label2.Location = new System.Drawing.Point(21, 10);
			this.label2.Name = "label2";
			this.label2.Size = new System.Drawing.Size(20, 23);
			this.label2.TabIndex = 5;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.label2);
			base.Controls.Add(this.buttonClose);
			base.Controls.Add(this.label1);
			base.Controls.Add(this.textBoxWhat);
			base.Name = "FilterBar";
			base.Size = new System.Drawing.Size(471, 36);
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	internal class State
	{
		private static Bitmap iconInfo = Resources.asset_info;

		private static Bitmap iconWarning = Resources.asset_warning;

		private static Bitmap iconError = Resources.asset_error;

		private static Bitmap iconImported = Resources.asset_imported;

		private static Bitmap iconBuilt = Resources.asset_built;

		private static Bitmap iconBuiltWithInfo = Resources.asset_built_info;

		private static Bitmap iconPartiallyBuilt = Resources.asset_partially_built;

		private static Bitmap iconPartiallyBuiltWithInfo = Resources.asset_partially_built_info;

		private static Bitmap iconUnknown = Resources.asset_unknown;

		public static string GetAssetStateInfo(AssetState state)
		{
			string result = "Unknown";
			if (state != null)
			{
				string info = GetInfo(state.PipelineState, state.FailureState, state.SoupFailureState);
				if (state.FailureState != FailureState.None || state.Changes != 0)
				{
					result = ((state.FailureState != FailureState.None) ? info : ((state.PipelineState != PipelineState.Built) ? info : "One of the layers of the Stacked Texture was changed, Build the Project."));
				}
				else
				{
					result = info;
					result = ((state.PipelineState != 0) ? info : "UDim Changed, Build to add/remove the changed UDim patches.");
				}
			}
			return result;
		}

		public static bool IsValidState(PipelineState state, FailureState failure, SoupFailureState soupFailure)
		{
			bool result = failure == FailureState.None;
			if ((failure == FailureState.TextureNotFound || failure == FailureState.TextureInaccessible) && (state == PipelineState.Composited || state == PipelineState.Coded || state == PipelineState.Built))
			{
				result = true;
			}
			if (soupFailure == SoupFailureState.Inaccessible)
			{
				result = false;
			}
			return result;
		}

		public static string GetInfo(PipelineState state, FailureState failure, SoupFailureState soupFailure)
		{
			if (IsValidState(state, failure, soupFailure))
			{
				switch (state)
				{
				case PipelineState.Built:
					return "The Stacked Texture was succesfully built.";
				case PipelineState.Atlassed:
				case PipelineState.Composited:
				case PipelineState.Coded:
					return "The Stacked texture is partially build, Build the project.";
				case PipelineState.None:
				case PipelineState.Imported:
					return "The Stacked Texture is Imported, Build the project.";
				case PipelineState.Unknown:
					return "Unknown state, try to rebuild to fix.";
				default:
					return "Unknown state, try to rebuild to fix.";
				}
			}
			if (soupFailure == SoupFailureState.Inaccessible)
			{
				return "The gtex file is inaccessible.";
			}
			return failure switch
			{
				FailureState.TextureNotFound => "One or more of the textures were not found, please check this and Rescan or delete the Stacked Texture.", 
				FailureState.TextureInaccessible => "One or more of the textures are Inaccessible.", 
				FailureState.LayerResolutionsNotMatching => "The layer resolutions don't macth.", 
				FailureState.InvalidUDimPattern => "The UDim has an invalid pattren, please check this and Rebuild.", 
				FailureState.InvalidPatternDimensions => "The Dimensions of the pattren are invalid, please check this and Rebuild.", 
				FailureState.InvalidAssetBorder => "The Stacked Texture's border is Invalid, please change the border and Rebuild.", 
				FailureState.InvalidTextureFormat => "The texture format is invalid, please change the texture format and Rebuild.", 
				FailureState.Unknown => "Unknown error, try to Rebuild.", 
				_ => "No error", 
			};
		}

		public static Bitmap GetAssetIcon(AssetState state)
		{
			return GetAssetIcon(state.PipelineState, state.FailureState, state.SoupFailureState);
		}

		public static Bitmap GetAssetIcon(PipelineState state, FailureState failure, SoupFailureState soupFailure)
		{
			if (IsValidState(state, failure, soupFailure))
			{
				bool flag = failure == FailureState.TextureInaccessible || failure == FailureState.TextureNotFound || failure == FailureState.InvalidTextureFormat;
				bool flag2 = soupFailure != SoupFailureState.None;
				if (flag && flag2)
				{
					return iconError;
				}
				switch (state)
				{
				case PipelineState.Built:
					if (!flag)
					{
						return iconBuilt;
					}
					return iconBuiltWithInfo;
				case PipelineState.Atlassed:
				case PipelineState.Composited:
				case PipelineState.Coded:
					if (!flag)
					{
						return iconPartiallyBuilt;
					}
					return iconPartiallyBuiltWithInfo;
				case PipelineState.None:
				case PipelineState.Imported:
					return iconImported;
				case PipelineState.Unknown:
					return iconUnknown;
				default:
					return iconUnknown;
				}
			}
			return iconError;
		}

		public static Bitmap GetLayerIcon(AssetState assetState, LayerAssetState layerState)
		{
			if (IsValidState(assetState.PipelineState, assetState.FailureState, assetState.SoupFailureState))
			{
				bool flag = GetAssetIcon(assetState) == iconError;
				bool flag2 = layerState.FailureState == FailureState.TextureInaccessible || layerState.FailureState == FailureState.TextureNotFound || layerState.FailureState == FailureState.InvalidTextureFormat;
				if (flag2 && flag)
				{
					return iconError;
				}
				if (flag2)
				{
					return iconInfo;
				}
				return null;
			}
			return iconError;
		}

		public static Bitmap GetTextureIcon(AssetState state, TextureChanges changes)
		{
			bool flag = GetAssetIcon(state) == iconError;
			switch (changes)
			{
			case TextureChanges.None:
				return null;
			case TextureChanges.DataUpdated:
				return iconImported;
			case TextureChanges.Missing:
			case TextureChanges.Inaccessible:
				if (!flag)
				{
					return iconInfo;
				}
				return iconError;
			default:
				return iconUnknown;
			}
		}

		public static string GetAssetState(AssetState state, out Bitmap icon)
		{
			string result = "Unknown";
			icon = iconUnknown;
			if (state != null)
			{
				string text = state.PipelineState.ToString();
				if (state.PipelineState == PipelineState.Built && state.builtForGTexStreaming)
				{
					text = "Built for GTex Streaming";
				}
				string text2 = state.FailureState.ToString();
				string text3 = "Changed";
				if (IsValidState(state.PipelineState, state.FailureState, state.SoupFailureState) && state.Changes == CausingChanges.None)
				{
					result = text;
					icon = GetAssetIcon(state.PipelineState, state.FailureState, state.SoupFailureState);
					result = ((state.PipelineState != 0) ? text : "UDim Changed");
				}
				else if (state.SoupFailureState == SoupFailureState.Inaccessible)
				{
					result = "GTEXInaccessible";
					icon = GetAssetIcon(state.PipelineState, state.FailureState, state.SoupFailureState);
				}
				else if (state.FailureState != FailureState.None)
				{
					result = text2;
					icon = GetAssetIcon(state.PipelineState, state.FailureState, state.SoupFailureState);
				}
				else if (state.PipelineState == PipelineState.Built)
				{
					result = text3;
					icon = iconPartiallyBuilt;
				}
				else
				{
					result = text;
					icon = GetAssetIcon(state.PipelineState, state.FailureState, state.SoupFailureState);
				}
			}
			return result;
		}

		public static string GetLayerState(AssetState assetState, LayerAssetState layerState, out Bitmap icon)
		{
			string result = "Unknown";
			icon = null;
			if (layerState != null)
			{
				string text = layerState.FailureState.ToString();
				string text2 = "Changed";
				if (layerState.Changes == CausingChanges.None && layerState.FailureState == FailureState.None)
				{
					result = "Ok";
				}
				else if (layerState.FailureState != FailureState.None)
				{
					result = text;
					icon = GetLayerIcon(assetState, layerState);
				}
				else
				{
					result = text2;
				}
			}
			return result;
		}

		public static string GetTextureState(AssetState assetState, TextureAssetState textureState, out Bitmap icon)
		{
			string result = "Unknown";
			icon = null;
			if (textureState != null)
			{
				if (textureState.Changes == TextureChanges.None)
				{
					result = "Ok";
				}
				else
				{
					result = textureState.Changes.ToString();
					icon = GetTextureIcon(assetState, textureState.Changes);
				}
			}
			return result;
		}
	}
	internal enum KnownDestinationCategory
	{
		Frequent = 1,
		Recent
	}
	internal enum TaskbarProgressBarStatus
	{
		NoProgress = 0,
		Indeterminate = 1,
		Normal = 2,
		Error = 4,
		Paused = 8
	}
	internal enum SetTabPropertiesOption
	{
		None = 0,
		UseAppThumbnailAlways = 1,
		UseAppThumbnailWhenActive = 2,
		UseAppPeekAlways = 4,
		UseAppPeekWhenActive = 8
	}
	internal enum ThumbButtonMask
	{
		Bitmap = 1,
		Icon = 2,
		Tooltip = 4,
		THB_FLAGS = 8
	}
	[Flags]
	internal enum ThumbButtonOptions
	{
		Enabled = 0,
		Disabled = 1,
		DismissOnClick = 2,
		NoBackground = 4,
		Hidden = 8,
		NonInteractive = 0x10
	}
	[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
	internal struct ThumbButton
	{
		internal const int Clicked = 6144;

		[MarshalAs(UnmanagedType.U4)]
		internal ThumbButtonMask Mask;

		internal uint Id;

		internal uint Bitmap;

		internal IntPtr Icon;

		[MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]
		internal string Tip;

		[MarshalAs(UnmanagedType.U4)]
		internal ThumbButtonOptions Flags;
	}
	public enum HResult
	{
		Ok = 0,
		False = 1,
		InvalidArguments = -2147024809,
		OutOfMemory = -2147024882,
		NoInterface = -2147467262,
		Fail = -2147467259,
		ElementNotFound = -2147023728,
		TypeElementNotFound = -2147319765,
		NoObject = -2147221019,
		Win32ErrorCanceled = 1223,
		Canceled = -2147023673,
		ResourceInUse = -2147024726,
		AccessDenied = -2147287035
	}
	[ComImport]
	[Guid("6332DEBF-87B5-4670-90C0-5E57B408A49E")]
	[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
	internal interface ICustomDestinationList
	{
		void SetAppID([MarshalAs(UnmanagedType.LPWStr)] string pszAppID);

		[PreserveSig]
		HResult BeginList(out uint cMaxSlots, ref Guid riid, [MarshalAs(UnmanagedType.Interface)] out object ppvObject);

		[PreserveSig]
		HResult AppendCategory([MarshalAs(UnmanagedType.LPWStr)] string pszCategory, [MarshalAs(UnmanagedType.Interface)] IObjectArray poa);

		void AppendKnownCategory([MarshalAs(UnmanagedType.I4)] KnownDestinationCategory category);

		[PreserveSig]
		HResult AddUserTasks([MarshalAs(UnmanagedType.Interface)] IObjectArray poa);

		void CommitList();

		void GetRemovedDestinations(ref Guid riid, [MarshalAs(UnmanagedType.Interface)] out object ppvObject);

		void DeleteList([MarshalAs(UnmanagedType.LPWStr)] string pszAppID);

		void AbortList();
	}
	[ComImport]
	[Guid("77F10CF0-3DB5-4966-B520-B7C54FD35ED6")]
	[ClassInterface(ClassInterfaceType.None)]
	internal class CDestinationList
	{
		[MethodImpl(MethodImplOptions.InternalCall)]
		public extern CDestinationList();
	}
	[ComImport]
	[Guid("92CA9DCD-5622-4BBA-A805-5E9F541BD8C9")]
	[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
	internal interface IObjectArray
	{
		void GetCount(out uint cObjects);

		void GetAt(uint iIndex, ref Guid riid, [MarshalAs(UnmanagedType.Interface)] out object ppvObject);
	}
	[ComImport]
	[Guid("5632B1A4-E38A-400A-928A-D4CD63230295")]
	[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
	internal interface IObjectCollection
	{
		[PreserveSig]
		void GetCount(out uint cObjects);

		[PreserveSig]
		void GetAt(uint iIndex, ref Guid riid, [MarshalAs(UnmanagedType.Interface)] out object ppvObject);

		void AddObject([MarshalAs(UnmanagedType.Interface)] object pvObject);

		void AddFromArray([MarshalAs(UnmanagedType.Interface)] IObjectArray poaSource);

		void RemoveObject(uint uiIndex);

		void Clear();
	}
	[ComImport]
	[Guid("2D3468C1-36A7-43B6-AC24-D3F02FD9607A")]
	[ClassInterface(ClassInterfaceType.None)]
	internal class CEnumerableObjectCollection
	{
		[MethodImpl(MethodImplOptions.InternalCall)]
		public extern CEnumerableObjectCollection();
	}
	[ComImport]
	[Guid("c43dc798-95d1-4bea-9030-bb99e2983a1a")]
	[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
	internal interface ITaskbarList4
	{
		[PreserveSig]
		void HrInit();

		[PreserveSig]
		void AddTab(IntPtr hwnd);

		[PreserveSig]
		void DeleteTab(IntPtr hwnd);

		[PreserveSig]
		void ActivateTab(IntPtr hwnd);

		[PreserveSig]
		void SetActiveAlt(IntPtr hwnd);

		[PreserveSig]
		void MarkFullscreenWindow(IntPtr hwnd, [MarshalAs(UnmanagedType.Bool)] bool fFullscreen);

		[PreserveSig]
		void SetProgressValue(IntPtr hwnd, ulong ullCompleted, ulong ullTotal);

		[PreserveSig]
		void SetProgressState(IntPtr hwnd, TaskbarProgressBarStatus tbpFlags);

		[PreserveSig]
		void RegisterTab(IntPtr hwndTab, IntPtr hwndMDI);

		[PreserveSig]
		void UnregisterTab(IntPtr hwndTab);

		[PreserveSig]
		void SetTabOrder(IntPtr hwndTab, IntPtr hwndInsertBefore);

		[PreserveSig]
		void SetTabActive(IntPtr hwndTab, IntPtr hwndInsertBefore, uint dwReserved);

		[PreserveSig]
		HResult ThumbBarAddButtons(IntPtr hwnd, uint cButtons, [MarshalAs(UnmanagedType.LPArray)] ThumbButton[] pButtons);

		[PreserveSig]
		HResult ThumbBarUpdateButtons(IntPtr hwnd, uint cButtons, [MarshalAs(UnmanagedType.LPArray)] ThumbButton[] pButtons);

		[PreserveSig]
		void ThumbBarSetImageList(IntPtr hwnd, IntPtr himl);

		[PreserveSig]
		void SetOverlayIcon(IntPtr hwnd, IntPtr hIcon, [MarshalAs(UnmanagedType.LPWStr)] string pszDescription);

		[PreserveSig]
		void SetThumbnailTooltip(IntPtr hwnd, [MarshalAs(UnmanagedType.LPWStr)] string pszTip);

		[PreserveSig]
		void SetThumbnailClip(IntPtr hwnd, IntPtr prcClip);

		void SetTabProperties(IntPtr hwndTab, SetTabPropertiesOption stpFlags);
	}
	[ComImport]
	[Guid("56FDF344-FD6D-11d0-958A-006097C9A090")]
	[ClassInterface(ClassInterfaceType.None)]
	internal class CTaskbarList
	{
		[MethodImpl(MethodImplOptions.InternalCall)]
		public extern CTaskbarList();
	}
	internal static class TaskbarList
	{
		private static object _syncLock = new object();

		private static ITaskbarList4 _taskbarList;

		internal static ITaskbarList4 Instance
		{
			get
			{
				if (_taskbarList == null)
				{
					lock (_syncLock)
					{
						if (_taskbarList == null)
						{
							_taskbarList = (ITaskbarList4)new CTaskbarList();
							_taskbarList.HrInit();
						}
					}
				}
				return _taskbarList;
			}
		}

		public static bool RunningOnWin7
		{
			get
			{
				if (Environment.OSVersion.Platform == PlatformID.Win32NT)
				{
					return Environment.OSVersion.Version.CompareTo(new System.Version(6, 1)) >= 0;
				}
				return false;
			}
		}
	}
	public class TaskBarProgressBar
	{
		private Form parent;

		public TaskBarProgressBar(Form parent)
		{
			this.parent = parent;
		}

		public void Start()
		{
			if (TaskbarList.RunningOnWin7 && parent != null)
			{
				_ = parent.Handle;
				TaskbarList.Instance.SetProgressState(parent.Handle, TaskbarProgressBarStatus.Normal);
			}
		}

		public void Stop()
		{
			if (TaskbarList.RunningOnWin7 && parent != null)
			{
				_ = parent.Handle;
				TaskbarList.Instance.SetProgressState(parent.Handle, TaskbarProgressBarStatus.NoProgress);
			}
		}

		public void SetError()
		{
			if (TaskbarList.RunningOnWin7 && parent != null)
			{
				_ = parent.Handle;
				TaskbarList.Instance.SetProgressState(parent.Handle, TaskbarProgressBarStatus.Error);
			}
		}

		public void Reset()
		{
			if (TaskbarList.RunningOnWin7 && parent != null)
			{
				_ = parent.Handle;
				TaskbarList.Instance.SetProgressState(parent.Handle, TaskbarProgressBarStatus.NoProgress);
			}
		}

		public void SetValue(ulong value, ulong max)
		{
			if (TaskbarList.RunningOnWin7 && parent != null)
			{
				_ = parent.Handle;
				TaskbarList.Instance.SetProgressValue(parent.Handle, value, max);
			}
		}
	}
	public class ToolTip : SuperTooltip
	{
		private ResourceManager resources;

		public ToolTip()
		{
			InitializeComponent();
			resources = new ResourceManager(typeof(Resources));
			base.BeforeTooltipDisplay += Component1_BeforeTooltipDisplay;
		}

		private void Component1_BeforeTooltipDisplay(object sender, SuperTooltipEventArgs e)
		{
			if (e.TooltipInfo.BodyText == string.Empty && e.TooltipInfo.HeaderText == string.Empty && e.TooltipInfo.FooterText == string.Empty)
			{
				e.Cancel = true;
				return;
			}
			string bodyText = e.TooltipInfo.BodyText;
			string @string = resources.GetString(bodyText);
			if (@string == null)
			{
				return;
			}
			if (@string == string.Empty)
			{
				e.Cancel = true;
				return;
			}
			string[] array = @string.Split(';');
			e.Cancel = true;
			e.TooltipInfo.HeaderVisible = false;
			e.TooltipInfo.FooterVisible = false;
			e.TooltipInfo.HeaderText = array[0];
			if (array[0] != string.Empty)
			{
				e.TooltipInfo.HeaderVisible = true;
				e.Cancel = false;
			}
			if (array.Length > 1)
			{
				e.TooltipInfo.BodyText = array[1];
				if (array[1] != string.Empty)
				{
					e.Cancel = false;
				}
			}
			else
			{
				e.TooltipInfo.BodyText = string.Empty;
			}
			if (array.Length > 2)
			{
				if (array[2] != string.Empty)
				{
					e.TooltipInfo.FooterText = array[2];
					e.TooltipInfo.FooterVisible = true;
					e.Cancel = false;
				}
			}
			else
			{
				e.TooltipInfo.FooterText = string.Empty;
			}
		}

		private void InitializeComponent()
		{
		}
	}
	public class BuildLoggerReportForm : OfficeForm
	{
		public enum ReportMode
		{
			Info,
			Warning,
			Error
		}

		private IContainer components;

		private BuildLoggerList buildLoggerList;

		private Button buttonClose;

		private LabelX labelBuildRequired;

		public string TaskDescription { get; set; }

		public ReportMode Mode { get; set; }

		public BuildLoggerList BuildLoggerList => buildLoggerList;

		private BuildLoggerReportForm()
		{
			InitializeComponent();
		}

		public BuildLoggerReportForm(FormMode formMode)
		{
			InitializeComponent();
			base.ShowInTaskbar = formMode == FormMode.Standalone;
		}

		private void BuildLoggerReportForm_Load(object sender, EventArgs e)
		{
			if (Mode == ReportMode.Error)
			{
				labelBuildRequired.Text = "Errors or warnings occurred during import. Please inspect them.";
				labelBuildRequired.Image = Resources.error;
			}
			else if (Mode == ReportMode.Warning)
			{
				labelBuildRequired.Text = "Warnings occurred during import. Please inspect them.";
				labelBuildRequired.Image = Resources.warning;
			}
			else if (Mode == ReportMode.Info)
			{
				labelBuildRequired.Text = "Additional information messages were generated during import. Please inspect them.";
				labelBuildRequired.Image = Resources.info;
			}
			else
			{
				labelBuildRequired.Visible = false;
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.buildLoggerList = new GrBuildStudio.BuildLoggerList();
			this.buttonClose = new System.Windows.Forms.Button();
			this.labelBuildRequired = new DevComponents.DotNetBar.LabelX();
			base.SuspendLayout();
			this.buildLoggerList.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.buildLoggerList.Location = new System.Drawing.Point(12, 57);
			this.buildLoggerList.Name = "buildLoggerList";
			this.buildLoggerList.Size = new System.Drawing.Size(715, 299);
			this.buildLoggerList.TabIndex = 14;
			this.buttonClose.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonClose.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.buttonClose.Location = new System.Drawing.Point(652, 362);
			this.buttonClose.Name = "buttonClose";
			this.buttonClose.Size = new System.Drawing.Size(75, 23);
			this.buttonClose.TabIndex = 15;
			this.buttonClose.Text = "Close";
			this.buttonClose.UseVisualStyleBackColor = true;
			this.labelBuildRequired.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelBuildRequired.Image = GrBuildStudio.Properties.Resources.warning;
			this.labelBuildRequired.Location = new System.Drawing.Point(12, 19);
			this.labelBuildRequired.Name = "labelBuildRequired";
			this.labelBuildRequired.Size = new System.Drawing.Size(715, 23);
			this.labelBuildRequired.TabIndex = 25;
			this.labelBuildRequired.Text = "Errors or warnings occurred. Please inspect them.";
			base.AcceptButton = this.buttonClose;
			base.ClientSize = new System.Drawing.Size(739, 397);
			base.Controls.Add(this.labelBuildRequired);
			base.Controls.Add(this.buttonClose);
			base.Controls.Add(this.buildLoggerList);
			this.DoubleBuffered = true;
			base.MinimizeBox = false;
			base.Name = "BuildLoggerReportForm";
			base.ShowIcon = false;
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "Operation Summary";
			base.Load += new System.EventHandler(BuildLoggerReportForm_Load);
			base.ResumeLayout(false);
		}
	}
	public class SlowTaskProgressForm : OfficeForm
	{
		private IContainer components;

		private Label label1;

		private ProgressBar progressBar1;

		private System.Windows.Forms.Timer timer1;

		private SlowTaskProgressForm()
		{
			InitializeComponent();
		}

		public SlowTaskProgressForm(SlowTaskMonitor.ProgressBarType type)
		{
			InitializeComponent();
			if (type == SlowTaskMonitor.ProgressBarType.Marquee)
			{
				progressBar1.Style = ProgressBarStyle.Marquee;
			}
			else
			{
				progressBar1.Style = ProgressBarStyle.Blocks;
			}
		}

		public void UpdateText(string text)
		{
			if (label1.InvokeRequired)
			{
				label1.Invoke((Action)delegate
				{
					UpdateText(text);
				});
			}
			else
			{
				label1.Text = text;
			}
		}

		public void UpdateProgress(long min, long max, long value)
		{
			if (progressBar1.InvokeRequired)
			{
				progressBar1.Invoke((Action)delegate
				{
					UpdateProgress(min, max, value);
				});
			}
			else
			{
				progressBar1.Minimum = (int)min;
				progressBar1.Maximum = (int)max;
				progressBar1.Value = (int)value;
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.components = new System.ComponentModel.Container();
			this.label1 = new System.Windows.Forms.Label();
			this.progressBar1 = new System.Windows.Forms.ProgressBar();
			this.timer1 = new System.Windows.Forms.Timer(this.components);
			base.SuspendLayout();
			this.label1.Location = new System.Drawing.Point(68, 29);
			this.label1.Name = "label1";
			this.label1.Size = new System.Drawing.Size(341, 45);
			this.label1.TabIndex = 0;
			this.label1.Text = "label1";
			this.label1.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
			this.progressBar1.Location = new System.Drawing.Point(68, 116);
			this.progressBar1.Name = "progressBar1";
			this.progressBar1.Size = new System.Drawing.Size(341, 36);
			this.progressBar1.TabIndex = 2;
			base.AutoScaleDimensions = new System.Drawing.SizeF(12f, 25f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.ClientSize = new System.Drawing.Size(488, 210);
			base.ControlBox = false;
			base.Controls.Add(this.progressBar1);
			base.Controls.Add(this.label1);
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "ProgressForm";
			base.ShowIcon = false;
			base.ShowInTaskbar = false;
			base.SizeGripStyle = System.Windows.Forms.SizeGripStyle.Hide;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "SlowTaskForm";
			base.ResumeLayout(false);
		}
	}
	public class SlowTaskWorker
	{
		public delegate void DoWorkEventHandler(object sender, SlowTaskMonitor monitor, object argument);

		private BackgroundWorker worker;

		private SlowTaskMonitor monitor;

		private string title;

		public event DoWorkEventHandler DoWork;

		protected virtual void OnDoWork(SlowTaskMonitor monitor, object argument)
		{
			this.DoWork?.Invoke(this, monitor, argument);
		}

		public SlowTaskWorker(string title)
		{
			this.title = title;
			monitor = new SlowTaskMonitor(title);
			worker = new BackgroundWorker();
			worker.DoWork += worker_DoWork;
		}

		private void worker_DoWork(object sender, DoWorkEventArgs e)
		{
			monitor.Start();
			OnDoWork(monitor, e.Argument);
			monitor.End();
		}

		public void RunAsync()
		{
			worker.RunWorkerAsync();
		}

		public void RunAsync(object argument)
		{
			worker.RunWorkerAsync(argument);
		}
	}
	public class SlowTaskMonitor
	{
		public enum ProgressBarType
		{
			ProgressBar,
			Marquee
		}

		private static int defaultDelay = 1000;

		private static Form defaultParent = null;

		private SlowTaskProgressForm form;

		private BackgroundWorker monitor;

		private int delay;

		private ManualResetEvent finishedWorking;

		private ManualResetEvent dialogCreated;

		private Form parent;

		private string title;

		private long lastmin;

		private long lastmax;

		private long lastvalue;

		private string lasttext;

		public static int DefaultDelay
		{
			get
			{
				return defaultDelay;
			}
			set
			{
				defaultDelay = value;
			}
		}

		public static Form DefaultParent
		{
			get
			{
				return defaultParent;
			}
			set
			{
				defaultParent = value;
			}
		}

		public ProgressBarType Type { get; set; }

		public SlowTaskMonitor(string title)
			: this(title, defaultDelay, defaultParent)
		{
		}

		public SlowTaskMonitor(string title, Form parentForm)
			: this(title, defaultDelay, parentForm)
		{
		}

		public SlowTaskMonitor(string title, int delay)
			: this(title, defaultDelay, defaultParent)
		{
		}

		public SlowTaskMonitor(string title, int delay, Form parentForm)
		{
			finishedWorking = new ManualResetEvent(initialState: false);
			dialogCreated = new ManualResetEvent(initialState: false);
			this.delay = delay;
			parent = parentForm;
			this.title = title;
			lastmax = 100L;
			lastmin = 0L;
			lastvalue = 0L;
			lasttext = "";
			monitor = new BackgroundWorker();
			monitor.DoWork += monitor_DoWork;
			Type = ProgressBarType.ProgressBar;
		}

		public void Start()
		{
			monitor.RunWorkerAsync();
		}

		private void monitor_DoWork(object sender, DoWorkEventArgs e)
		{
			if (WaitHandle.WaitAny(new WaitHandle[1] { finishedWorking }, delay) == 258)
			{
				form = new SlowTaskProgressForm(Type);
				form.Text = title;
				form.Load += form_Load;
				if (parent != null)
				{
					form.StartPosition = FormStartPosition.Manual;
					form.Location = new Point(Math.Max(0, parent.Left + parent.Width / 2 - form.Width / 2), Math.Max(0, parent.Top + parent.Height / 2 - form.Height / 2));
				}
				form.ShowDialog();
			}
			dialogCreated.Set();
		}

		private void form_Load(object sender, EventArgs e)
		{
			UpdateProgress(lastmin, lastmax, lastvalue);
			UpdateText(lasttext);
			dialogCreated.Set();
		}

		public void UpdateProgress(long min, long max, long value)
		{
			lastmin = min;
			lastmax = max;
			lastvalue = value;
			if (form != null)
			{
				form.UpdateProgress(min, max, value);
			}
		}

		public void UpdateText(string text)
		{
			lasttext = text;
			if (form != null)
			{
				form.UpdateText(text);
			}
		}

		public void End()
		{
			finishedWorking.Set();
			WaitHandle.WaitAny(new WaitHandle[1] { dialogCreated });
			try
			{
				if (form != null)
				{
					form.Invoke((Action)delegate
					{
						form.Close();
					});
				}
			}
			catch
			{
			}
		}
	}
	public class BuildForm : Office2007Form
	{
		private class TaskBarProgressMonitor
		{
			private TaskBarProgressBar taskbarProgress;

			private int currentTask;

			private int currentProject;

			private Form parent;

			public int TaskCount { get; set; }

			public int ProjectCount { get; set; }

			public TaskBarProgressMonitor(Form parent)
			{
				this.parent = parent;
				Reset();
				taskbarProgress = new TaskBarProgressBar(parent);
			}

			public void Reset()
			{
				currentTask = 0;
				currentProject = 0;
			}

			public void Start()
			{
				if (parent.InvokeRequired)
				{
					parent.Invoke((Action)delegate
					{
						Start();
					});
				}
				else
				{
					Reset();
					taskbarProgress.Start();
				}
			}

			public void Stop()
			{
				if (parent.InvokeRequired)
				{
					parent.Invoke((Action)delegate
					{
						Stop();
					});
				}
				else
				{
					taskbarProgress.Stop();
				}
			}

			public void StepTask()
			{
				if (parent.InvokeRequired)
				{
					parent.Invoke((Action)delegate
					{
						StepTask();
					});
					return;
				}
				currentTask++;
				if (currentTask >= TaskCount)
				{
					TaskCount++;
				}
				Update();
			}

			public void StepProject()
			{
				if (parent.InvokeRequired)
				{
					parent.Invoke((Action)delegate
					{
						StepProject();
					});
				}
				else
				{
					currentProject++;
					currentTask = 0;
					Update();
				}
			}

			public void Update()
			{
				if (parent.InvokeRequired)
				{
					parent.Invoke((Action)delegate
					{
						Update();
					});
				}
				else
				{
					int num = ProjectCount * TaskCount;
					int num2 = currentProject * TaskCount + currentTask;
					taskbarProgress.SetValue((ulong)num2, (ulong)num);
				}
			}
		}

		private struct ProcessTrackContext
		{
			public SlowTask processStart;

			public SlowTask processEnd;

			public StepItem stepItem;

			public ProcessTrackContext(SlowTask start, SlowTask end, StepItem stepItem)
			{
				processStart = start;
				processEnd = end;
				this.stepItem = stepItem;
			}
		}

		private TaskBarProgressMonitor taskBarProgressMonitor;

		private SolutionModel model;

		private Task task;

		private BuildLogger buildLogger;

		private Guid[] projectIds;

		private CleanOperationParameters cleanParams;

		private ProjectBuildOptions projectBuildOptions;

		private int errors;

		private int warnings;

		private int infos;

		private bool Canceled;

		private Form parent;

		private int projectIdx;

		private int projectCount;

		private bool building;

		private int assetIndex;

		private int assetCount;

		private Asset currentAsset;

		private int currentContextIdx;

		private ProcessTrackContext[] contexts;

		private StepItem currentStepItem;

		private ProgressTracker<SlowTask>.TaskDescription currentTaskDesc;

		private IContainer components;

		private ProgressSteps progressSteps1;

		private StepItem stepItemImport;

		private StepItem stepItemComposeAndCode;

		private StepItem stepItemBuild;

		private LabelX labelText;

		private LabelX labelProject;

		private BuildLoggerList buildLoggerList;

		private StepItem stepItemPreprocess;

		private StepItem stepItemClean;

		private Button buttonClose;

		private Button buttonCancel;

		public bool CloseOnFinished { get; set; }

		public bool ForceCloseOnFinished { get; set; }

		public BuildForm(Form parent)
		{
			warnings = 0;
			errors = 0;
			infos = 0;
			InitializeComponent();
			buildLogger = new BuildLogger(buildLoggerList);
			building = true;
			buttonClose.Enabled = false;
			Canceled = false;
			cleanParams = Defaults.CleanOperationParameters;
			this.parent = parent;
			taskBarProgressMonitor = new TaskBarProgressMonitor(parent);
			Clear();
		}

		public BuildForm(Form parent, FormMode formMode)
		{
			warnings = 0;
			errors = 0;
			infos = 0;
			InitializeComponent();
			buildLogger = new BuildLogger(buildLoggerList);
			building = true;
			buttonClose.Enabled = false;
			Canceled = false;
			this.parent = parent;
			Form form = ((formMode == FormMode.Standalone) ? this : parent);
			taskBarProgressMonitor = new TaskBarProgressMonitor(form);
			base.ShowInTaskbar = formMode == FormMode.Standalone;
			Clear();
		}

		private void Clear()
		{
			labelProject.Text = string.Empty;
			labelText.Text = string.Empty;
		}

		public void Create(SolutionModel model)
		{
			this.model = model;
			BuildContexts();
		}

		public void ShowAndBuild(Task task, Guid[] projectIds, ProjectBuildOptions projectBuildOptions)
		{
			ShowAndBuild(task, projectIds, Defaults.CleanOperationParameters, projectBuildOptions);
		}

		public void ShowAndBuild(Task task, Guid[] projectIds, CleanOperationParameters cleanParams, ProjectBuildOptions projectBuildOptions)
		{
			this.task = task;
			this.projectIds = projectIds;
			this.cleanParams = cleanParams;
			this.projectBuildOptions = projectBuildOptions;
			ShowDialog(parent);
		}

		public void ShowAndBuild(Task task, ProjectBuildOptions projectBuildOptions)
		{
			ShowAndBuild(task, null, Defaults.CleanOperationParameters, projectBuildOptions);
		}

		public void ShowAndBuild(Task task, CleanOperationParameters cleanParams, ProjectBuildOptions projectBuildOptions)
		{
			ShowAndBuild(task, null, cleanParams, projectBuildOptions);
		}

		public bool ErrorOccurred()
		{
			return buildLogger.ContainsErrors();
		}

		public bool AtlassingErrorOccurred()
		{
			return buildLogger.ContainsAtlassingErrors();
		}

		private void BuildProjects()
		{
			if (Canceled)
			{
				return;
			}
			CancelSolution(cancel: false);
			projectIdx = 0;
			projectCount = projectIds.Length;
			taskBarProgressMonitor.TaskCount = 9;
			taskBarProgressMonitor.ProjectCount = projectCount;
			taskBarProgressMonitor.Start();
			model.SolutionBuilder.ProjectBuildStarting += SolutionBuilder_ProjectBuildStarting;
			model.SolutionBuilder.ProjectBuildFinished += SolutionBuilder_ProjectBuildFinished;
			try
			{
				Guid[] array = projectIds;
				foreach (Guid projectId in array)
				{
					model.SolutionBuilder.BuildProject(projectId, projectBuildOptions);
					if (!Canceled)
					{
						taskBarProgressMonitor.StepProject();
						continue;
					}
					break;
				}
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
			model.SolutionBuilder.ProjectBuildStarting -= SolutionBuilder_ProjectBuildStarting;
			model.SolutionBuilder.ProjectBuildFinished -= SolutionBuilder_ProjectBuildFinished;
			taskBarProgressMonitor.Stop();
		}

		private void RebuildProjects()
		{
			CleanProjects();
			BuildProjects();
		}

		private void CleanProjects()
		{
			if (Canceled)
			{
				return;
			}
			CancelSolution(cancel: false);
			projectIdx = 0;
			projectCount = projectIds.Length;
			stepItemClean.Maximum = projectCount;
			taskBarProgressMonitor.TaskCount = 1;
			taskBarProgressMonitor.ProjectCount = projectCount;
			taskBarProgressMonitor.Start();
			model.SolutionBuilder.ProjectCleanStarting += SolutionBuilder_ProjectCleanStarting;
			model.SolutionBuilder.ProjectCleanFinished += SolutionBuilder_ProjectCleanFinished;
			try
			{
				Guid[] array = projectIds;
				foreach (Guid projectId in array)
				{
					model.SolutionBuilder.CleanProject(projectId, cleanParams);
					taskBarProgressMonitor.StepProject();
				}
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
			model.SolutionBuilder.ProjectCleanStarting -= SolutionBuilder_ProjectCleanStarting;
			model.SolutionBuilder.ProjectCleanFinished -= SolutionBuilder_ProjectCleanFinished;
			taskBarProgressMonitor.Stop();
		}

		private void RepageProjects()
		{
			if (Canceled)
			{
				return;
			}
			CancelSolution(cancel: false);
			projectIdx = 0;
			projectCount = projectIds.Length;
			stepItemClean.Maximum = projectCount;
			taskBarProgressMonitor.TaskCount = 1;
			taskBarProgressMonitor.ProjectCount = projectCount;
			taskBarProgressMonitor.Start();
			model.SolutionBuilder.ProjectRepageStarting += SolutionBuilder_ProjectRepageStarting;
			model.SolutionBuilder.ProjectRepageFinished += SolutionBuilder_ProjectRepageFinished;
			try
			{
				Guid[] array = projectIds;
				foreach (Guid projectId in array)
				{
					model.SolutionBuilder.RepageProject(projectId);
					taskBarProgressMonitor.StepProject();
				}
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
			model.SolutionBuilder.ProjectRepageStarting -= SolutionBuilder_ProjectRepageStarting;
			model.SolutionBuilder.ProjectRepageFinished -= SolutionBuilder_ProjectRepageFinished;
			taskBarProgressMonitor.Stop();
		}

		private void CancelSolution(bool cancel = true)
		{
			try
			{
				model.SolutionBuilder.CancelBuild(cancel);
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
		}

		private void SolutionBuilder_ProjectCleanStarting(object sender, ProjectBuilder builder)
		{
			ResetProgress();
			projectIdx++;
			builder.ProgressTracker.ProgressTick += ProgressTracker_ProgressTick;
			builder.ProgressTracker.TaskStarted += ProgressTracker_TaskStarted;
			builder.ProgressTracker.TaskFinished += ProgressTracker_TaskFinished;
			builder.ProgressTracker.AssetStarted += ProgressTracker_AssetStarted;
			buildLogger.AddInfoText($"Cleaning project '{builder.ActiveProject.Name}'...");
			SetText(labelProject, string.Format("Project {0} out of {1}", new object[2] { projectIdx, projectCount }));
		}

		private void SolutionBuilder_ProjectCleanFinished(object sender, ProjectBuilder builder)
		{
			builder.ProgressTracker.ProgressTick -= ProgressTracker_ProgressTick;
			builder.ProgressTracker.TaskStarted -= ProgressTracker_TaskStarted;
			builder.ProgressTracker.TaskFinished -= ProgressTracker_TaskFinished;
			builder.ProgressTracker.AssetStarted -= ProgressTracker_AssetStarted;
			buildLogger.AddInfoText(string.Format("Finished cleaning project.", builder.ActiveProject.Name));
			stepItemClean.Value = stepItemClean.Maximum;
			taskBarProgressMonitor.StepTask();
		}

		private void SolutionBuilder_ProjectRepageStarting(object sender, ProjectBuilder builder)
		{
			ResetProgress();
			projectIdx++;
			builder.ProgressTracker.ProgressTick += ProgressTracker_ProgressTick;
			builder.ProgressTracker.TaskStarted += ProgressTracker_TaskStarted;
			builder.ProgressTracker.TaskFinished += ProgressTracker_TaskFinished;
			builder.ProgressTracker.AssetStarted += ProgressTracker_AssetStarted;
			buildLogger.AddInfoText($"Repageing project '{builder.ActiveProject.Name}'...");
			SetText(labelProject, string.Format("Project {0} out of {1}", new object[2] { projectIdx, projectCount }));
		}

		private void SolutionBuilder_ProjectRepageFinished(object sender, ProjectBuilder builder)
		{
			builder.ProgressTracker.ProgressTick -= ProgressTracker_ProgressTick;
			builder.ProgressTracker.TaskStarted -= ProgressTracker_TaskStarted;
			builder.ProgressTracker.TaskFinished -= ProgressTracker_TaskFinished;
			builder.ProgressTracker.AssetStarted -= ProgressTracker_AssetStarted;
			buildLogger.AddInfoText(string.Format("Finished Repageing project.", builder.ActiveProject.Name));
			stepItemClean.Value = stepItemClean.Maximum;
			taskBarProgressMonitor.StepTask();
		}

		private void SolutionBuilder_ProjectBuildStarting(object sender, ProjectBuilder builder)
		{
			ResetProgress();
			projectIdx++;
			builder.ProgressTracker.ProgressTick += ProgressTracker_ProgressTick;
			builder.ProgressTracker.TaskStarted += ProgressTracker_TaskStarted;
			builder.ProgressTracker.TaskFinished += ProgressTracker_TaskFinished;
			builder.ProgressTracker.AssetStarted += ProgressTracker_AssetStarted;
			builder.BuildReportingHandler.OnErrorHandler += BuildReportingHandler_OnErrorHandler;
			builder.BuildReportingHandler.OnFatalErrorHandler += BuildReportingHandler_OnFatalErrorHandler;
			builder.BuildReportingHandler.OnWarningHandler += BuildReportingHandler_OnWarningHandler;
			builder.BuildReportingHandler.OnInfoHandler += BuildReportingHandler_OnInfoHandler;
			buildLogger.AddInfoText($"Building project '{builder.ActiveProject.Name}'...");
			SetText(labelProject, string.Format("Project {0} out of {1}", new object[2] { projectIdx, projectCount }));
		}

		private void SetText(Control control, string text)
		{
			if (control.InvokeRequired)
			{
				control.Invoke((Action)delegate
				{
					SetText(control, text);
				});
			}
			else
			{
				control.Text = text;
			}
		}

		private void SolutionBuilder_ProjectBuildFinished(object sender, ProjectBuilder builder)
		{
			builder.ProgressTracker.ProgressTick -= ProgressTracker_ProgressTick;
			builder.ProgressTracker.TaskStarted -= ProgressTracker_TaskStarted;
			builder.ProgressTracker.TaskFinished -= ProgressTracker_TaskFinished;
			builder.ProgressTracker.AssetStarted -= ProgressTracker_AssetStarted;
			builder.BuildReportingHandler.OnErrorHandler -= BuildReportingHandler_OnErrorHandler;
			builder.BuildReportingHandler.OnFatalErrorHandler -= BuildReportingHandler_OnFatalErrorHandler;
			builder.BuildReportingHandler.OnWarningHandler -= BuildReportingHandler_OnWarningHandler;
			builder.BuildReportingHandler.OnInfoHandler -= BuildReportingHandler_OnInfoHandler;
			if (builder.ProcessResult == PipelineProcessResult.Canceled)
			{
				SetText(labelText, "Canceled!");
			}
			else
			{
				buildLogger.AddInfoText($"Finished building {builder.ActiveProject.Name} - {builder.ProcessResult.ToString()}!");
				SetText(labelText, "Finished!");
			}
			SetFullProgress();
		}

		private void BuildContexts()
		{
			contexts = new ProcessTrackContext[5]
			{
				new ProcessTrackContext(SlowTask.Cleaning, SlowTask.Cleaning, stepItemClean),
				new ProcessTrackContext(SlowTask.Preprocess, SlowTask.Preprocess, stepItemPreprocess),
				new ProcessTrackContext(SlowTask.ImportProcess, SlowTask.AtlasProcess, stepItemImport),
				new ProcessTrackContext(SlowTask.ComposeAndCodeProcess, SlowTask.ComposeAndCodeProcess, stepItemComposeAndCode),
				new ProcessTrackContext(SlowTask.TileFileBuildProcess, SlowTask.TileFileBuildProcess, stepItemBuild)
			};
		}

		private void ProgressTracker_TaskStarted(object sender, ProgressTracker<SlowTask>.TaskDescription desc)
		{
			currentTaskDesc = desc;
			for (int i = 0; i < contexts.Length; i++)
			{
				if (contexts[i].processStart == desc.Task)
				{
					currentContextIdx = i;
					currentStepItem = contexts[i].stepItem;
					currentStepItem.Value = 0;
					for (int j = 0; j < i; j++)
					{
						int num3 = (contexts[j].stepItem.Value = (contexts[j].stepItem.Maximum = 100));
					}
					break;
				}
			}
			switch (desc.Task)
			{
			case SlowTask.Preprocess:
				SetText(labelText, "Preprocessing...");
				currentStepItem = stepItemPreprocess;
				currentStepItem.Value = 10;
				break;
			case SlowTask.ImportProcess:
				SetText(labelText, "Importing...");
				currentStepItem.Value += 10;
				break;
			case SlowTask.AtlasProcess:
				SetText(labelText, "Atlassing...");
				currentStepItem.Value += 10;
				break;
			case SlowTask.PostProcess:
				SetText(labelText, "Postprocessing...");
				currentStepItem.Value += 10;
				break;
			case SlowTask.OrderProcess:
				SetText(labelText, "Ordering...");
				break;
			case SlowTask.Cleaning:
				SetText(labelText, "Cleaning solution...");
				currentStepItem.Value += 10;
				break;
			case SlowTask.Composing:
				SetText(labelText, "Compositing asset ...");
				break;
			case SlowTask.Coding:
				SetText(labelText, "Coding asset ...");
				break;
			case SlowTask.ComposeAndCodeProcess:
				SetText(labelText, "Compositing and coding...");
				break;
			case SlowTask.TileFileBuildProcess:
				SetText(labelText, "Building GTS...");
				break;
			case SlowTask.TileFilePreTaskProcess:
				SetText(labelText, "Preparing...");
				currentStepItem.Value += 10;
				break;
			default:
				SetText(labelText, string.Empty);
				currentStepItem.Value += 10;
				break;
			}
			if (Canceled)
			{
				SetText(labelText, "Canceling...");
			}
		}

		private void ProgressTracker_TaskFinished(object sender, ProgressTracker<SlowTask>.TaskDescription desc)
		{
			if (desc.Task == SlowTask.TileFileBuildProcess)
			{
				stepItemBuild.Value = stepItemBuild.Maximum;
			}
			taskBarProgressMonitor.StepTask();
		}

		private void ProgressTracker_AssetStarted(object sender, Asset a, int assetIndex, int assetCount)
		{
			currentAsset = a;
			this.assetIndex = assetIndex;
			this.assetCount = assetCount;
		}

		private void ProgressTracker_ProgressTick(object sender, long min, long max, long value)
		{
			int num = 1000;
			string text = string.Empty;
			if (Canceled)
			{
				text = "Canceling after remaining process...\n";
			}
			switch (currentTaskDesc.Task)
			{
			case SlowTask.Coding:
			{
				SetText(labelText, string.Format(text + "Processing stacked texture {0} out of {1}: coding tile {2} out of {3} ", assetIndex + 1, assetCount, (min + value < max - min) ? (min + value) : (max - min), max - min));
				float num2 = (float)value / (float)(max - min);
				long num3 = (num - 1) / 2 + (long)(num2 * (float)(num - 1) / 2f);
				min = 1L;
				max = num * assetCount;
				value = num * assetIndex + num3;
				break;
			}
			case SlowTask.Composing:
				SetText(labelText, string.Format(text + "Processing stacked texture {0} out of {1}: compositing", new object[2]
				{
					(min + value < max - min) ? (min + value) : (max - min),
					max - min
				}));
				min = 1L;
				max = num * assetCount;
				value = num * assetIndex + num / 10;
				break;
			}
			long value2 = ((value - 1 < min) ? min : (value - 1));
			SetCurrentProgress(min, max, value2);
		}

		private void builder_DoWork(object sender, DoWorkEventArgs e)
		{
			if (projectIds == null)
			{
				projectIds = model.SolutionBuilder.ActiveSolution.Projects.Keys.ToArray();
			}
			switch (task)
			{
			case Task.Build:
				BuildProjects();
				break;
			case Task.Clean:
				CleanProjects();
				break;
			case Task.Rebuild:
				RebuildProjects();
				break;
			case Task.Repage:
				RepageProjects();
				break;
			}
			building = false;
			EnableCloseButton(enable: true);
			if (!Canceled)
			{
				buildLogger.AddLogFinisher();
			}
			else
			{
				buildLogger.AddLogFinishCanceling();
			}
			if (CloseOnFinished && (!buildLogger.ContainsErrors() || (ForceCloseOnFinished && buildLogger.ContainsAtlassingErrors())))
			{
				BeginInvoke((MethodInvoker)delegate
				{
					Close();
				});
			}
		}

		public void EnableCloseButton(bool enable)
		{
			if (buttonClose.InvokeRequired)
			{
				buttonClose.Invoke((Action)delegate
				{
					EnableCloseButton(enable);
				});
			}
			else
			{
				buttonClose.Enabled = enable;
				buttonCancel.Enabled = !enable;
			}
		}

		private void BuildReportingHandler_OnInfoHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			infos++;
			buildLogger.AddItem(BuildErrorType.Info, processId, buildIssue);
		}

		private void BuildReportingHandler_OnWarningHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			warnings++;
			buildLogger.AddItem(BuildErrorType.Warning, processId, buildIssue);
		}

		private ErrorAction BuildReportingHandler_OnErrorHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			errors++;
			buildLogger.AddItem(BuildErrorType.Error, processId, buildIssue);
			return ErrorAction.Stop;
		}

		private void BuildReportingHandler_OnFatalErrorHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			errors++;
			buildLogger.AddItem(BuildErrorType.FatalError, processId, buildIssue);
		}

		private void SetCurrentProgress(long min, long max, long value)
		{
			if (currentStepItem.InvokeRequired)
			{
				currentStepItem.Invoke((Action)delegate
				{
					SetCurrentProgress(min, max, value);
				});
			}
			else
			{
				currentStepItem.Minimum = (int)min;
				currentStepItem.Maximum = (int)max;
				currentStepItem.Value = (int)value;
			}
		}

		private void SetProgressForAll(long min, long max, long value)
		{
			if (progressSteps1.InvokeRequired)
			{
				progressSteps1.Invoke((Action)delegate
				{
					SetProgressForAll(min, max, value);
				});
				return;
			}
			foreach (StepItem item in progressSteps1.Items)
			{
				item.Maximum = (int)max;
				item.Value = (int)value;
				item.Minimum = (int)min;
			}
		}

		private void ResetProgress()
		{
			SetProgressForAll(0L, 100L, 0L);
		}

		private void SetFullProgress()
		{
			SetProgressForAll(0L, 100L, 100L);
		}

		private void SetFormTitle()
		{
			switch (task)
			{
			case Task.Rebuild:
				Text = "Rebuilding";
				break;
			case Task.Build:
				Text = "Building";
				break;
			case Task.Clean:
				Text = "Cleaning";
				break;
			}
		}

		private void BuildForm_Load(object sender, EventArgs e)
		{
			SetFormTitle();
			if (task == Task.Clean)
			{
				stepItemPreprocess.Visible = false;
				stepItemImport.Visible = false;
				stepItemComposeAndCode.Visible = false;
				stepItemBuild.Visible = false;
				stepItemClean.MinimumSize = new Size(progressSteps1.Size.Width, stepItemClean.Size.Height);
			}
			if (task == Task.Build)
			{
				stepItemClean.Visible = false;
			}
			BackgroundWorker backgroundWorker = new BackgroundWorker();
			backgroundWorker.DoWork += builder_DoWork;
			backgroundWorker.RunWorkerAsync();
		}

		private void BuildForm_FormClosing(object sender, FormClosingEventArgs e)
		{
			if (building)
			{
				MessageBox.Show("You cannot exit during a build. Please wait until the build is completed or cancel the build.", "Building", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
				e.Cancel = true;
			}
		}

		private void buttonClose_Click(object sender, EventArgs e)
		{
			Close();
		}

		private void buttonCancel_Click(object sender, EventArgs e)
		{
			Canceled = true;
			CancelSolution();
			SetText(labelText, "Canceling after remaining process...\n" + labelText.Text);
			buildLogger.AddInfoText("Build Canceled.");
			buttonCancel.Enabled = false;
		}

		private void BuildForm_FormClosed(object sender, FormClosedEventArgs e)
		{
			taskBarProgressMonitor.Stop();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.progressSteps1 = new DevComponents.DotNetBar.ProgressSteps();
			this.stepItemClean = new DevComponents.DotNetBar.StepItem();
			this.stepItemPreprocess = new DevComponents.DotNetBar.StepItem();
			this.stepItemImport = new DevComponents.DotNetBar.StepItem();
			this.stepItemComposeAndCode = new DevComponents.DotNetBar.StepItem();
			this.stepItemBuild = new DevComponents.DotNetBar.StepItem();
			this.labelText = new DevComponents.DotNetBar.LabelX();
			this.labelProject = new DevComponents.DotNetBar.LabelX();
			this.buttonClose = new System.Windows.Forms.Button();
			this.buildLoggerList = new GrBuildStudio.BuildLoggerList();
			this.buttonCancel = new System.Windows.Forms.Button();
			base.SuspendLayout();
			this.progressSteps1.BackgroundStyle.Class = "ProgressSteps";
			this.progressSteps1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.progressSteps1.ContainerControlProcessDialogKey = true;
			this.progressSteps1.Items.AddRange(new DevComponents.DotNetBar.BaseItem[5] { this.stepItemClean, this.stepItemPreprocess, this.stepItemImport, this.stepItemComposeAndCode, this.stepItemBuild });
			this.progressSteps1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.progressSteps1.Location = new System.Drawing.Point(12, 75);
			this.progressSteps1.Name = "progressSteps1";
			this.progressSteps1.Size = new System.Drawing.Size(800, 44);
			this.progressSteps1.TabIndex = 9;
			this.stepItemClean.HotTracking = false;
			this.stepItemClean.MinimumSize = new System.Drawing.Size(100, 30);
			this.stepItemClean.Name = "stepItemClean";
			this.stepItemClean.SymbolSize = 13f;
			this.stepItemClean.Text = "Cleaning";
			this.stepItemClean.TextAlignment = DevComponents.DotNetBar.eButtonTextAlignment.Center;
			this.stepItemPreprocess.HotTracking = false;
			this.stepItemPreprocess.MinimumSize = new System.Drawing.Size(120, 30);
			this.stepItemPreprocess.Name = "stepItemPreprocess";
			this.stepItemPreprocess.SymbolSize = 13f;
			this.stepItemPreprocess.Text = "Preprocessing";
			this.stepItemPreprocess.TextAlignment = DevComponents.DotNetBar.eButtonTextAlignment.Center;
			this.stepItemImport.HotTracking = false;
			this.stepItemImport.MinimumSize = new System.Drawing.Size(140, 30);
			this.stepItemImport.Name = "stepItemImport";
			this.stepItemImport.SymbolSize = 13f;
			this.stepItemImport.Text = "Importing";
			this.stepItemImport.TextAlignment = DevComponents.DotNetBar.eButtonTextAlignment.Center;
			this.stepItemComposeAndCode.HotTracking = false;
			this.stepItemComposeAndCode.MinimumSize = new System.Drawing.Size(300, 30);
			this.stepItemComposeAndCode.Name = "stepItemComposeAndCode";
			this.stepItemComposeAndCode.Stretch = true;
			this.stepItemComposeAndCode.SymbolSize = 13f;
			this.stepItemComposeAndCode.Text = "Compositing and Coding GTex Files";
			this.stepItemComposeAndCode.TextAlignment = DevComponents.DotNetBar.eButtonTextAlignment.Center;
			this.stepItemBuild.HotTracking = false;
			this.stepItemBuild.MinimumSize = new System.Drawing.Size(140, 30);
			this.stepItemBuild.Name = "stepItemBuild";
			this.stepItemBuild.SymbolSize = 13f;
			this.stepItemBuild.Text = "Building GTS";
			this.stepItemBuild.TextAlignment = DevComponents.DotNetBar.eButtonTextAlignment.Center;
			this.labelText.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelText.Location = new System.Drawing.Point(12, 109);
			this.labelText.Name = "labelText";
			this.labelText.Size = new System.Drawing.Size(800, 55);
			this.labelText.TabIndex = 10;
			this.labelText.Text = "Compositing 1 stacked texture out of 20";
			this.labelProject.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelProject.Location = new System.Drawing.Point(12, 30);
			this.labelProject.Name = "labelProject";
			this.labelProject.Size = new System.Drawing.Size(800, 28);
			this.labelProject.TabIndex = 12;
			this.labelProject.Text = "Project 1 out of 3";
			this.buttonClose.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonClose.Location = new System.Drawing.Point(737, 337);
			this.buttonClose.Name = "buttonClose";
			this.buttonClose.Size = new System.Drawing.Size(75, 23);
			this.buttonClose.TabIndex = 14;
			this.buttonClose.Text = "Close";
			this.buttonClose.UseVisualStyleBackColor = true;
			this.buttonClose.Click += new System.EventHandler(buttonClose_Click);
			this.buildLoggerList.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.buildLoggerList.Location = new System.Drawing.Point(12, 175);
			this.buildLoggerList.Name = "buildLoggerList";
			this.buildLoggerList.Size = new System.Drawing.Size(800, 156);
			this.buildLoggerList.TabIndex = 13;
			this.buttonCancel.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCancel.Location = new System.Drawing.Point(656, 337);
			this.buttonCancel.Name = "buttonCancel";
			this.buttonCancel.Size = new System.Drawing.Size(75, 23);
			this.buttonCancel.TabIndex = 15;
			this.buttonCancel.Text = "Cancel";
			this.buttonCancel.UseVisualStyleBackColor = true;
			this.buttonCancel.Click += new System.EventHandler(buttonCancel_Click);
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.ClientSize = new System.Drawing.Size(824, 372);
			base.Controls.Add(this.buttonCancel);
			base.Controls.Add(this.buttonClose);
			base.Controls.Add(this.buildLoggerList);
			base.Controls.Add(this.labelProject);
			base.Controls.Add(this.labelText);
			base.Controls.Add(this.progressSteps1);
			this.DoubleBuffered = true;
			this.Font = new System.Drawing.Font("Segoe UI", 8.25f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "BuildForm";
			base.ShowIcon = false;
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "Building";
			base.FormClosing += new System.Windows.Forms.FormClosingEventHandler(BuildForm_FormClosing);
			base.FormClosed += new System.Windows.Forms.FormClosedEventHandler(BuildForm_FormClosed);
			base.Load += new System.EventHandler(BuildForm_Load);
			base.ResumeLayout(false);
		}
	}
	public class BuildLoggerList : UserControl
	{
		private IContainer components;

		private ListViewEx listView;

		private System.Windows.Forms.ColumnHeader columnHeaderSpacer;

		private System.Windows.Forms.ColumnHeader columnHeaderIndex;

		private System.Windows.Forms.ColumnHeader columnHeaderDescription;

		private ContextMenuStrip contextMenuStripCopyToClipBoard;

		private ToolStripMenuItem copyToClipboardToolStripMenuItem;

		private ImageList imageList1;

		public BuildLoggerList()
		{
			InitializeComponent();
		}

		public void AddItem(int messageIndex, BuildErrorType messageType, BuildProcess processId, BuildIssue buildIssue)
		{
			if (listView.InvokeRequired)
			{
				listView.Invoke((Action)delegate
				{
					AddItem(messageIndex, messageType, processId, buildIssue);
				});
				return;
			}
			ListViewItem listViewItem = new ListViewItem();
			listViewItem.Text = "";
			listViewItem.ImageIndex = (int)messageType;
			int num = messageIndex;
			listViewItem.SubItems.Add(num.ToString());
			listViewItem.SubItems.Add(buildIssue.InnerMessage);
			listViewItem.ToolTipText = buildIssue.InnerMessage;
			listView.Items.Add(listViewItem);
			columnHeaderDescription.AutoResize(ColumnHeaderAutoResizeStyle.ColumnContent);
			listView.EnsureVisible(listViewItem.Index);
		}

		public void AddError(int messageIndex, string message)
		{
			if (listView.InvokeRequired)
			{
				listView.Invoke((Action)delegate
				{
					AddError(messageIndex, message);
				});
				return;
			}
			ListViewItem listViewItem = new ListViewItem();
			listViewItem.Text = "";
			listViewItem.ImageIndex = 1;
			int num = messageIndex;
			listViewItem.SubItems.Add(num.ToString());
			listViewItem.SubItems.Add(message);
			listView.Items.Add(listViewItem);
			columnHeaderDescription.AutoResize(ColumnHeaderAutoResizeStyle.ColumnContent);
			listView.EnsureVisible(listViewItem.Index);
		}

		public void AddInfoText(int messageIndex, string message)
		{
			if (listView.InvokeRequired)
			{
				listView.Invoke((Action)delegate
				{
					AddInfoText(messageIndex, message);
				});
				return;
			}
			ListViewItem listViewItem = new ListViewItem();
			listViewItem.Text = "";
			listViewItem.ImageIndex = 3;
			int num = messageIndex;
			listViewItem.SubItems.Add(num.ToString());
			listViewItem.SubItems.Add(message);
			listView.Items.Add(listViewItem);
			columnHeaderDescription.AutoResize(ColumnHeaderAutoResizeStyle.ColumnContent);
			listView.EnsureVisible(listViewItem.Index);
		}

		public void Clear()
		{
			if (listView.InvokeRequired)
			{
				listView.Invoke((Action)delegate
				{
					Clear();
				});
			}
			else
			{
				columnHeaderDescription.AutoResize(ColumnHeaderAutoResizeStyle.HeaderSize);
				listView.Items.Clear();
			}
		}

		public string GetText()
		{
			string text = string.Empty;
			for (int i = 0; listView.Items.Count > i; i++)
			{
				text += listView.Items[i].SubItems[1].Text;
				text += "\r\t";
				text += listView.Items[i].SubItems[2].Text;
				text += "\r\n";
			}
			return text.Substring(0, text.Length - 2);
		}

		private void copyToClipboardToolStripMenuItem_Click(object sender, EventArgs e)
		{
			ClipboardHelper.CopyText(GetText());
		}

		private void listView_MouseUp(object sender, MouseEventArgs e)
		{
			if (e.Button == MouseButtons.Right)
			{
				contextMenuStripCopyToClipBoard.Show(PointToScreen(e.Location));
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.components = new System.ComponentModel.Container();
			System.Windows.Forms.ListViewItem listViewItem = new System.Windows.Forms.ListViewItem(new string[3] { "", "1", "Image 'world.topo.bathy.200412.3x21600x21600.B0.png' could not be imported..." }, 0);
			System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(GrBuildStudio.BuildLoggerList));
			this.listView = new DevComponents.DotNetBar.Controls.ListViewEx();
			this.columnHeaderSpacer = new System.Windows.Forms.ColumnHeader();
			this.columnHeaderIndex = new System.Windows.Forms.ColumnHeader();
			this.columnHeaderDescription = new System.Windows.Forms.ColumnHeader();
			this.imageList1 = new System.Windows.Forms.ImageList(this.components);
			this.contextMenuStripCopyToClipBoard = new System.Windows.Forms.ContextMenuStrip(this.components);
			this.copyToClipboardToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.contextMenuStripCopyToClipBoard.SuspendLayout();
			base.SuspendLayout();
			this.listView.BackColor = System.Drawing.Color.White;
			this.listView.Border.Class = "ListViewBorder";
			this.listView.Border.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.listView.Columns.AddRange(new System.Windows.Forms.ColumnHeader[3] { this.columnHeaderSpacer, this.columnHeaderIndex, this.columnHeaderDescription });
			this.listView.DisabledBackColor = System.Drawing.Color.Empty;
			this.listView.Dock = System.Windows.Forms.DockStyle.Fill;
			this.listView.ForeColor = System.Drawing.Color.Black;
			this.listView.FullRowSelect = true;
			this.listView.Items.AddRange(new System.Windows.Forms.ListViewItem[1] { listViewItem });
			this.listView.Location = new System.Drawing.Point(0, 0);
			this.listView.Name = "listView";
			this.listView.ShowItemToolTips = true;
			this.listView.Size = new System.Drawing.Size(665, 168);
			this.listView.SmallImageList = this.imageList1;
			this.listView.TabIndex = 1;
			this.listView.UseCompatibleStateImageBehavior = false;
			this.listView.View = System.Windows.Forms.View.Details;
			this.listView.MouseUp += new System.Windows.Forms.MouseEventHandler(listView_MouseUp);
			this.columnHeaderSpacer.Text = "";
			this.columnHeaderSpacer.Width = 25;
			this.columnHeaderIndex.Text = "";
			this.columnHeaderIndex.Width = 28;
			this.columnHeaderDescription.Text = "Description";
			this.columnHeaderDescription.Width = 533;
			this.imageList1.ImageStream = (System.Windows.Forms.ImageListStreamer)resources.GetObject("imageList1.ImageStream");
			this.imageList1.TransparentColor = System.Drawing.Color.Transparent;
			this.imageList1.Images.SetKeyName(0, "fatalerror.png");
			this.imageList1.Images.SetKeyName(1, "error.png");
			this.imageList1.Images.SetKeyName(2, "warning.png");
			this.imageList1.Images.SetKeyName(3, "info.png");
			this.contextMenuStripCopyToClipBoard.Items.AddRange(new System.Windows.Forms.ToolStripItem[1] { this.copyToClipboardToolStripMenuItem });
			this.contextMenuStripCopyToClipBoard.Name = "contextMenuStripCopyToClipBoard";
			this.contextMenuStripCopyToClipBoard.Size = new System.Drawing.Size(172, 26);
			this.copyToClipboardToolStripMenuItem.Name = "copyToClipboardToolStripMenuItem";
			this.copyToClipboardToolStripMenuItem.Size = new System.Drawing.Size(171, 22);
			this.copyToClipboardToolStripMenuItem.Text = "Copy to Clipboard";
			this.copyToClipboardToolStripMenuItem.Click += new System.EventHandler(copyToClipboardToolStripMenuItem_Click);
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.listView);
			base.Name = "BuildLoggerList";
			base.Size = new System.Drawing.Size(665, 168);
			this.contextMenuStripCopyToClipBoard.ResumeLayout(false);
			base.ResumeLayout(false);
		}
	}
	public class BuildSummaryDetails : UserControl
	{
		private ProjectBuilder builder;

		private IContainer components;

		private TextBox textBoxFiles;

		private TextBox textBoxPath;

		private Label label20;

		private Label label17;

		private Button buttonOpen;

		private Button buttonOpenGTS;

		private Label label16;

		private LabelX labelBuildRequired;

		private Label labelSize;

		private ToolTip ToolTip;

		public BuildSummaryDetails()
		{
			InitializeComponent();
		}

		public void SetProject(ProjectBuilder builder)
		{
			this.builder = builder;
			Reload();
		}

		public void Reload()
		{
			LoadForm();
		}

		private void LoadForm()
		{
			if (labelBuildRequired.InvokeRequired)
			{
				labelBuildRequired.Invoke((Action)delegate
				{
					LoadForm();
				});
				return;
			}
			buttonOpen.Enabled = builder != null;
			buttonOpenGTS.Enabled = builder != null;
			if (builder == null || builder.ActiveProject == null)
			{
				labelBuildRequired.Visible = false;
				textBoxPath.Text = string.Empty;
				textBoxFiles.Text = string.Empty;
				labelSize.Text = string.Empty;
				return;
			}
			if (builder.BuildStateSummary == null)
			{
				builder.QueryAssetBuildStates();
			}
			labelBuildRequired.Visible = builder.BuildStateSummary.BuildRequired;
			Directory.SetCurrentDirectory(builder.GetProjectPath());
			string fullPath = Path.GetFullPath(builder.ActiveProject.BuildConfiguration.OutputDirectory);
			string outputFilename = builder.ActiveProject.BuildConfiguration.OutputFilename;
			string text = Path.Combine(fullPath, outputFilename);
			if (!File.Exists(text))
			{
				buttonOpenGTS.Enabled = false;
			}
			else
			{
				buttonOpenGTS.Enabled = true;
				buttonOpen.Enabled = true;
			}
			GtsInfo info = default(GtsInfo);
			if (GTSBuilderTools.GetGtsInfo(text, out info) != 0)
			{
				textBoxFiles.Text = string.Empty;
				textBoxPath.Text = fullPath;
				labelSize.Text = string.Empty;
			}
			else
			{
				if (!GTSBuilderTools.GetGTPFiles(text, out var gtpFilenames))
				{
					return;
				}
				long num = new FileInfo(text).Length;
				string text2 = builder.ActiveProject.BuildConfiguration.OutputFilename;
				foreach (string item in gtpFilenames)
				{
					try
					{
						num += new FileInfo(Path.Combine(fullPath, item)).Length;
						text2 = text2 + Environment.NewLine + item;
					}
					catch
					{
					}
				}
				textBoxFiles.Text = text2;
				textBoxPath.Text = fullPath;
				labelSize.Text = Various.FormatBytes(num);
			}
		}

		private void buttonOpen_Click(object sender, EventArgs e)
		{
			ShellTools.OpenGtsInExplorer(builder);
		}

		private void buttonOpenGTS_Click(object sender, EventArgs e)
		{
			try
			{
				ShellTools.OpenGTSInViewer(builder);
			}
			catch (Exception ex)
			{
				string message = $"Could not open TileSetViewer application. Underlying error message: '{ex.Message}' Please make sure the Tools SDK was installed correctly.";
				StudioLogger.Global.LogError(message);
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.textBoxFiles = new System.Windows.Forms.TextBox();
			this.textBoxPath = new System.Windows.Forms.TextBox();
			this.label20 = new System.Windows.Forms.Label();
			this.label17 = new System.Windows.Forms.Label();
			this.buttonOpen = new System.Windows.Forms.Button();
			this.buttonOpenGTS = new System.Windows.Forms.Button();
			this.label16 = new System.Windows.Forms.Label();
			this.labelBuildRequired = new DevComponents.DotNetBar.LabelX();
			this.labelSize = new System.Windows.Forms.Label();
			this.ToolTip = new GrBuildStudio.ToolTip();
			base.SuspendLayout();
			this.textBoxFiles.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.textBoxFiles.Location = new System.Drawing.Point(91, 39);
			this.textBoxFiles.Multiline = true;
			this.textBoxFiles.Name = "textBoxFiles";
			this.textBoxFiles.ReadOnly = true;
			this.textBoxFiles.ScrollBars = System.Windows.Forms.ScrollBars.Both;
			this.textBoxFiles.Size = new System.Drawing.Size(168, 92);
			this.ToolTip.SetSuperTooltip(this.textBoxFiles, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_BUILDSUMMARY_OUTPUTFILES", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.textBoxFiles.TabIndex = 21;
			this.textBoxFiles.Text = "Marble.gts\r\nMarble_0.gtp\r\nMarble_1.gtp\r\nMarble_2.gtp\r\nMarble_3.gtp\r\nMarble_4.gtp";
			this.textBoxFiles.WordWrap = false;
			this.textBoxPath.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.textBoxPath.Location = new System.Drawing.Point(91, 13);
			this.textBoxPath.Name = "textBoxPath";
			this.textBoxPath.ReadOnly = true;
			this.textBoxPath.Size = new System.Drawing.Size(168, 20);
			this.ToolTip.SetSuperTooltip(this.textBoxPath, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_BUILDSUMMARY_OUTPUTPATH", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.textBoxPath.TabIndex = 20;
			this.textBoxPath.Text = "E:\\Output\\";
			this.label20.AutoSize = true;
			this.label20.Location = new System.Drawing.Point(15, 37);
			this.label20.Name = "label20";
			this.label20.Size = new System.Drawing.Size(66, 13);
			this.label20.TabIndex = 19;
			this.label20.Text = "Output Files:";
			this.label17.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.label17.AutoSize = true;
			this.label17.Location = new System.Drawing.Point(17, 140);
			this.label17.Name = "label17";
			this.label17.Size = new System.Drawing.Size(30, 13);
			this.label17.TabIndex = 18;
			this.label17.Text = "Size:";
			this.buttonOpen.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.buttonOpen.Location = new System.Drawing.Point(265, 13);
			this.buttonOpen.Name = "buttonOpen";
			this.buttonOpen.Size = new System.Drawing.Size(75, 23);
			this.buttonOpen.TabIndex = 16;
			this.buttonOpen.Text = "Open...";
			this.buttonOpen.UseVisualStyleBackColor = true;
			this.buttonOpen.Click += new System.EventHandler(buttonOpen_Click);
			this.buttonOpenGTS.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonOpenGTS.Location = new System.Drawing.Point(265, 108);
			this.buttonOpenGTS.Name = "buttonOpenGTS";
			this.buttonOpenGTS.Size = new System.Drawing.Size(75, 23);
			this.buttonOpenGTS.TabIndex = 17;
			this.buttonOpenGTS.Text = "Open GTS...";
			this.buttonOpenGTS.UseVisualStyleBackColor = true;
			this.buttonOpenGTS.Click += new System.EventHandler(buttonOpenGTS_Click);
			this.label16.AutoSize = true;
			this.label16.Location = new System.Drawing.Point(15, 16);
			this.label16.Name = "label16";
			this.label16.Size = new System.Drawing.Size(67, 13);
			this.label16.TabIndex = 14;
			this.label16.Text = "Output Path:";
			this.labelBuildRequired.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.labelBuildRequired.AutoSize = true;
			this.labelBuildRequired.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelBuildRequired.Image = GrBuildStudio.Properties.Resources.warning;
			this.labelBuildRequired.Location = new System.Drawing.Point(18, 163);
			this.labelBuildRequired.Name = "labelBuildRequired";
			this.labelBuildRequired.Size = new System.Drawing.Size(252, 20);
			this.labelBuildRequired.TabIndex = 24;
			this.labelBuildRequired.Text = "Project is newer than output file. Please Build...";
			this.labelSize.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.labelSize.Location = new System.Drawing.Point(88, 140);
			this.labelSize.Name = "labelSize";
			this.labelSize.Size = new System.Drawing.Size(150, 13);
			this.ToolTip.SetSuperTooltip(this.labelSize, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_BUILDSUMMARY_SIZE", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.labelSize.TabIndex = 25;
			this.labelSize.Text = "1024MB";
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			this.AutoSize = true;
			this.BackColor = System.Drawing.Color.Transparent;
			base.Controls.Add(this.labelSize);
			base.Controls.Add(this.labelBuildRequired);
			base.Controls.Add(this.textBoxFiles);
			base.Controls.Add(this.textBoxPath);
			base.Controls.Add(this.label20);
			base.Controls.Add(this.label17);
			base.Controls.Add(this.buttonOpen);
			base.Controls.Add(this.buttonOpenGTS);
			base.Controls.Add(this.label16);
			this.MinimumSize = new System.Drawing.Size(300, 150);
			base.Name = "BuildSummaryDetails";
			base.Size = new System.Drawing.Size(359, 195);
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	public class Constants
	{
		private static string[] defaultLayerNames = new string[4] { "diffuse", "normal", "specular", "roughness" };

		public static DataType[] SupportedDataTypes => new DataType[13]
		{
			DataType.R8G8B8_SRGB,
			DataType.R8G8B8A8_SRGB,
			DataType.R8G8B8_LINEAR,
			DataType.R8G8B8A8_LINEAR,
			DataType.X8Y8Z0_TANGENT,
			DataType.X8,
			DataType.X8Y8,
			DataType.X8Y8Z8,
			DataType.X8Y8Z8W8,
			DataType.R16G16B16_FLOAT,
			DataType.R16G16B16A16_FLOAT,
			DataType.R32G32B32_FLOAT,
			DataType.R32G32B32A32_FLOAT
		};

		public static string[] SupportedQualityProfiles => new string[5] { "Low", "Medium", "High", "Lossless", "Uncompressed" };

		public static string SolutionExtension => "grsln";

		public static string ProjectExtension => "grproj";

		public static QualityLevel DefaultQualityLevel => QualityLevel.Default;

		public static string OnlineDocumentationUrl => "https://documentation.graphinesoftware.com/";

		public static string OnlineSupportUrl => "https://support.graphinesoftware.com/";

		public static string OnlineSupportEmail => "support@graphinesoftware.com";

		public static string DefaultTileSetName => "TileSet";

		public static string DefaultSolutionName => "Solution";

		public static string ProjectSettingFile => "user.settings";

		public static ColorItem[][] CustomStandardColorPickerColors
		{
			get
			{
				ColorItem[][] array = new ColorItem[1][] { new ColorItem[9]
				{
					new ColorItem("Black", "Black", System.Drawing.Color.FromArgb(255, 0, 0, 0)),
					new ColorItem("White", "White", System.Drawing.Color.FromArgb(255, 255, 255, 255)),
					new ColorItem("", "Flat Normal", System.Drawing.Color.FromArgb(255, 127, 127, 255)),
					new ColorItem("", "Middle Grey 127", System.Drawing.Color.FromArgb(255, 127, 127, 127)),
					new ColorItem("", "Middle Grey 128", System.Drawing.Color.FromArgb(255, 128, 128, 128)),
					new ColorItem("", "Hot Pink", System.Drawing.Color.FromArgb(255, 255, 0, 255)),
					new ColorItem("", "Graphine Blue", System.Drawing.Color.FromArgb(255, 15, 150, 241)),
					new ColorItem("", "Graphine Orange", System.Drawing.Color.FromArgb(255, 240, 134, 44)),
					new ColorItem("", "Nixel", System.Drawing.Color.FromArgb(255, 198, 113, 113))
				} };
				for (int i = 0; i < array.Length; i++)
				{
					for (int j = 0; j < array[i].Length; j++)
					{
						array[i][j].Tooltip = array[i][j].Text;
					}
				}
				return array;
			}
		}

		public static string[] DefaultLayerNames
		{
			get
			{
				return defaultLayerNames;
			}
			set
			{
				defaultLayerNames = value;
			}
		}

		public static char ChannelPackedLayerSplitLiteral => '+';

		public static SwizzlePreset[] SwizzlePresets => new SwizzlePreset[6]
		{
			SwizzlePreset.RGBA,
			SwizzlePreset.BGRA,
			SwizzlePreset.RtoA,
			SwizzlePreset.BtoA,
			SwizzlePreset.GtoA,
			SwizzlePreset.AtoRGB
		};
	}
	public class CustomLayerLayoutForm : OfficeForm
	{
		private IContainer components;

		private ToolTip ToolTip;

		private CustomLayerLayoutControl customLayerLayoutControl1;

		private Button buttonCancel;

		private Button buttonCreate;

		public ProjectTemplate ProjectTemplate => customLayerLayoutControl1.ProjectTemplate;

		public CustomLayerLayoutForm()
		{
			InitializeComponent();
		}

		public void InitializeForCreation()
		{
			SuspendLayout();
			customLayerLayoutControl1.InitializeForCreation(Defaults.DefaultBuildProfile);
			customLayerLayoutControl1.OnLayerEnabledEvent += customLayerLayoutControl1_OnLayerEnabledEvent;
			ResumeLayout();
			EnableControls();
		}

		private void customLayerLayoutControl1_OnLayerEnabledEvent(int activeLayerCount)
		{
			EnableControls();
		}

		public void InitializeForLayerConfig(LayerConfig config)
		{
			SuspendLayout();
			customLayerLayoutControl1.InitializeForLayerConfig(config, Defaults.DefaultBuildProfile);
			ResumeLayout();
			EnableControls();
		}

		private void EnableControls()
		{
			buttonCreate.Enabled = customLayerLayoutControl1.HasLayerSelected() > 0;
		}

		private void CustomLayerLayoutForm_FormClosing(object sender, FormClosingEventArgs e)
		{
			e.Cancel = customLayerLayoutControl1.cancelClose;
			customLayerLayoutControl1.cancelClose = false;
		}

		private void buttonCreate_Click(object sender, EventArgs e)
		{
			customLayerLayoutControl1.ApplyLayerConfiguration();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.ToolTip = new GrBuildStudio.ToolTip();
			this.customLayerLayoutControl1 = new GrBuildStudio.CustomLayerLayoutControl();
			this.buttonCancel = new System.Windows.Forms.Button();
			this.buttonCreate = new System.Windows.Forms.Button();
			base.SuspendLayout();
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.customLayerLayoutControl1.BackColor = System.Drawing.Color.Transparent;
			this.customLayerLayoutControl1.Location = new System.Drawing.Point(12, 12);
			this.customLayerLayoutControl1.Name = "customLayerLayoutControl1";
			this.customLayerLayoutControl1.Size = new System.Drawing.Size(760, 274);
			this.customLayerLayoutControl1.TabIndex = 0;
			this.buttonCancel.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.buttonCancel.Location = new System.Drawing.Point(697, 292);
			this.buttonCancel.Name = "buttonCancel";
			this.buttonCancel.Size = new System.Drawing.Size(75, 23);
			this.buttonCancel.TabIndex = 1;
			this.buttonCancel.Text = "Cancel";
			this.buttonCancel.UseVisualStyleBackColor = true;
			this.buttonCreate.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCreate.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.buttonCreate.Location = new System.Drawing.Point(616, 292);
			this.buttonCreate.Name = "buttonCreate";
			this.buttonCreate.Size = new System.Drawing.Size(75, 23);
			this.buttonCreate.TabIndex = 2;
			this.buttonCreate.Text = "Create";
			this.buttonCreate.UseVisualStyleBackColor = true;
			this.buttonCreate.Click += new System.EventHandler(buttonCreate_Click);
			base.AcceptButton = this.buttonCreate;
			base.CancelButton = this.buttonCancel;
			base.ClientSize = new System.Drawing.Size(784, 321);
			base.Controls.Add(this.buttonCreate);
			base.Controls.Add(this.buttonCancel);
			base.Controls.Add(this.customLayerLayoutControl1);
			this.DoubleBuffered = true;
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "CustomLayerLayoutForm";
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "Custom Layer Layout";
			base.FormClosing += new System.Windows.Forms.FormClosingEventHandler(CustomLayerLayoutForm_FormClosing);
			base.ResumeLayout(false);
		}
	}
	public class CustomLayerLayoutControl : UserControl
	{
		private class ControlRow
		{
			public CheckBox checkBox;

			public TextBox nameBox;

			public ComboBox dataType;

			public ComboBox codingProfile;

			public ComboBox qualityProfile;

			public ColorPickerButton colorButton;
		}

		private class ColorButtonInfo
		{
			public bool UserSet { get; set; }
		}

		private struct RowValues
		{
			internal string LayerName { get; set; }

			internal DataType DataType { get; set; }

			internal string CodingProfile { get; set; }

			internal string Qualityprofile { get; set; }

			internal string DefaultColor { get; set; }
		}

		public delegate void OnLayerEnabledDelegate(int activeLayerCount);

		public bool cancelClose;

		private List<ControlRow> controlRows;

		private bool withAddButton = true;

		private int[] columnWidths = new int[6] { 30, 180, 150, 120, 110, 120 };

		private string[] columnNames = new string[6] { "Add", "Name", "Datatype", "Compression Format", "Default Quality", "Default Color" };

		private int controlHeight = 20;

		private int controlMargin = 20;

		private List<DataType> dataTypes;

		private IContainer components;

		private ScrollableEditList scrollableEditList;

		private ToolTip ToolTip;

		public BuildProfile ActiveBuildProfile { get; set; }

		public ProjectTemplate ProjectTemplate { get; private set; }

		public event OnLayerEnabledDelegate OnLayerEnabledEvent;

		public CustomLayerLayoutControl()
		{
			InitializeComponent();
			dataTypes = new List<DataType>(Constants.SupportedDataTypes);
		}

		private void SetupLayout()
		{
			scrollableEditList.Columns.Clear();
			int num = 0;
			if (!withAddButton)
			{
				num = 1;
			}
			for (int i = num; i < columnNames.Length; i++)
			{
				scrollableEditList.Columns.Add(new ScrollableEditList.ColumnItem(columnNames[i], columnWidths[i]));
			}
			controlRows = new List<ControlRow>();
		}

		public void InitializeForCreation(BuildProfile buildProfile)
		{
			ActiveBuildProfile = buildProfile;
			SuspendLayout();
			scrollableEditList.SuspendLayout();
			scrollableEditList.Clear();
			SetupLayout();
			DataType dataType = Constants.SupportedDataTypes[0];
			for (int i = 0; i < GrBuildLib.Constants.MaxLayers; i++)
			{
				ScrollableEditList.Row row = null;
				string layerName = $"layer{i + 1}";
				if (i < Constants.DefaultLayerNames.Length)
				{
					layerName = Constants.DefaultLayerNames[i];
				}
				RowValues values = default(RowValues);
				values.LayerName = layerName;
				values.DataType = dataType;
				values.CodingProfile = "default";
				values.Qualityprofile = "default";
				values.DefaultColor = "";
				MakeRow(i, values, out row, out var controls);
				scrollableEditList.Rows.Add(row);
				controlRows.Add(controls);
			}
			scrollableEditList.ResumeLayout();
			ResumeLayout();
		}

		public void InitializeForLayerConfig(LayerConfig config, BuildProfile buildProfile)
		{
			ActiveBuildProfile = buildProfile;
			SuspendLayout();
			scrollableEditList.SuspendLayout();
			scrollableEditList.Clear();
			withAddButton = false;
			SetupLayout();
			for (int i = 0; i < config.Layers.Count; i++)
			{
				LayerDescription layerDescription = config.Layers[i];
				ScrollableEditList.Row row = null;
				RowValues values = default(RowValues);
				values.LayerName = layerDescription.LayerName;
				values.DataType = layerDescription.DataType;
				values.CodingProfile = ((layerDescription.CodingProfile != null) ? layerDescription.CodingProfile.ToString() : string.Empty);
				values.Qualityprofile = ((layerDescription.QualityProfile != null) ? layerDescription.QualityProfile.ToString() : string.Empty);
				values.DefaultColor = layerDescription.DefaultColor;
				MakeRow(i, values, out row, out var controls);
				scrollableEditList.Rows.Add(row);
				controlRows.Add(controls);
			}
			scrollableEditList.ResumeLayout();
			ResumeLayout();
		}

		private void MakeRow(int layerIndex, RowValues values, out ScrollableEditList.Row row, out ControlRow controls)
		{
			controls = new ControlRow();
			if (withAddButton)
			{
				controls.checkBox = new CheckBox();
				controls.checkBox.Tag = controls;
				controls.checkBox.BackColor = System.Drawing.Color.Transparent;
				controls.checkBox.TabIndex = 10 * (layerIndex + 1);
				controls.checkBox.CheckedChanged += checkBox_CheckedChanged;
				controls.checkBox.Padding = new System.Windows.Forms.Padding(5, 0, 0, 0);
				ToolTip.SetSuperTooltip(controls.checkBox, new SuperTooltipInfo("", "", "TT_CUSTOMLAYOUT_CHECKLAYER", null, null, ToolTip.DefaultTooltipSettings.Color));
			}
			controls.nameBox = new TextBox();
			controls.nameBox.Size = new Size(columnWidths[1] - 2 * controlMargin, controlHeight);
			controls.nameBox.Text = values.LayerName;
			controls.nameBox.Tag = controls;
			controls.nameBox.TabIndex = 10 * (layerIndex + 1) + 2;
			ToolTip.SetSuperTooltip(controls.nameBox, new SuperTooltipInfo("", "", "TT_CUSTOMLAYOUT_LAYERNAME", null, null, ToolTip.DefaultTooltipSettings.Color));
			controls.dataType = new ComboBox();
			controls.dataType.DropDownStyle = ComboBoxStyle.DropDownList;
			controls.dataType.Size = new Size(columnWidths[2] - 2 * controlMargin, controlHeight);
			controls.dataType.Tag = controls;
			controls.dataType.TabIndex = 10 * (layerIndex + 1) + 4;
			controls.dataType.SelectedValueChanged += dataType_SelectedValueChanged;
			ToolTip.SetSuperTooltip(controls.dataType, new SuperTooltipInfo("", "", "TT_CUSTOMLAYOUT_DATATYPE", null, null, ToolTip.DefaultTooltipSettings.Color));
			ComboBoxHelper.FillComboBox(controls.dataType, dataTypes);
			controls.qualityProfile = new ComboBox();
			controls.qualityProfile.DropDownStyle = ComboBoxStyle.DropDownList;
			controls.qualityProfile.Size = new Size(columnWidths[3] - 2 * controlMargin, controlHeight);
			controls.qualityProfile.Tag = controls;
			controls.qualityProfile.TabIndex = 10 * (layerIndex + 1) + 6;
			ToolTip.SetSuperTooltip(controls.qualityProfile, new SuperTooltipInfo("", "", "TT_CUSTOMLAYOUT_QUALITYPROFILE", null, null, ToolTip.DefaultTooltipSettings.Color));
			controls.codingProfile = new ComboBox();
			controls.codingProfile.DropDownStyle = ComboBoxStyle.DropDownList;
			controls.codingProfile.Size = new Size(columnWidths[3] - 2 * controlMargin, controlHeight);
			controls.codingProfile.Tag = controls;
			controls.codingProfile.TabIndex = 10 * (layerIndex + 1) + 6;
			controls.codingProfile.SelectedValueChanged += codingProfile_SelectedValueChanged;
			ToolTip.SetSuperTooltip(controls.codingProfile, new SuperTooltipInfo("", "", "TT_CUSTOMLAYOUT_CODINGPROFILE", null, null, ToolTip.DefaultTooltipSettings.Color));
			controls.colorButton = new ColorPickerButton();
			controls.colorButton.AccessibleRole = AccessibleRole.PushButton;
			controls.colorButton.ColorTable = eButtonColor.OrangeWithBackground;
			controls.colorButton.SelectedColorChanged += colorButton_SelectedColorChanged;
			System.Drawing.Color selectedColor = HexToColor(values.DefaultColor, values.DataType);
			controls.colorButton.SelectedColor = selectedColor;
			controls.colorButton.DisplayThemeColors = false;
			controls.colorButton.CustomStandardColors = Constants.CustomStandardColorPickerColors;
			ColorButtonInfo colorButtonInfo = new ColorButtonInfo();
			colorButtonInfo.UserSet = values.DefaultColor != null && !values.DefaultColor.Equals(string.Empty);
			controls.colorButton.Tag = colorButtonInfo;
			ToolTip.SetSuperTooltip(controls.colorButton, new SuperTooltipInfo("", "", "TT_CUSTOMLAYOUT_DEFAULTCOLOR", null, null, ToolTip.DefaultTooltipSettings.Color));
			row = new ScrollableEditList.Row();
			if (withAddButton)
			{
				row.RowItems.Add(new ScrollableEditList.RowItem(controls.checkBox));
			}
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.nameBox));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.dataType));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.codingProfile));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.qualityProfile));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.colorButton));
			controls.dataType.Text = values.DataType.ToString();
			Func<CodingProfile, bool> selector = (CodingProfile cp) => cp.Name.ToLowerInvariant().Equals(values.CodingProfile.ToLowerInvariant());
			ComboBoxHelper.SelectComboBoxItem(controls.codingProfile, selector);
			controls.qualityProfile.Text = values.Qualityprofile.ToLowerInvariant();
		}

		private string ColorToHex(System.Drawing.Color c)
		{
			return "#" + c.R.ToString("X2") + c.G.ToString("X2") + c.B.ToString("X2") + c.A.ToString("X2");
		}

		private System.Drawing.Color HexToColor(string hex, DataType layertype)
		{
			if (hex == null || hex == string.Empty)
			{
				return AssetTools.NixelColorToColor(AssetTools.ParseNixelColor(hex, layertype));
			}
			if (hex.StartsWith("#"))
			{
				hex = hex.Substring(1);
			}
			if (hex.Length != 8)
			{
				if (hex.Length != 6)
				{
					throw new Exception("Color not valid");
				}
				hex += "00";
			}
			return System.Drawing.Color.FromArgb(int.Parse(hex.Substring(6, 2), NumberStyles.HexNumber), int.Parse(hex.Substring(0, 2), NumberStyles.HexNumber), int.Parse(hex.Substring(2, 2), NumberStyles.HexNumber), int.Parse(hex.Substring(4, 2), NumberStyles.HexNumber));
		}

		private Bitmap CreateColorIcon(System.Drawing.Color c)
		{
			Bitmap bitmap = new Bitmap(16, 16);
			using Graphics graphics = Graphics.FromImage(bitmap);
			graphics.FillRectangle(new SolidBrush(c), 0, 0, 16, 16);
			return bitmap;
		}

		private void colorButton_SelectedColorChanged(object sender, EventArgs e)
		{
			ColorPickerButton colorPickerButton = sender as ColorPickerButton;
			colorPickerButton.Image = CreateColorIcon(colorPickerButton.SelectedColor);
			colorPickerButton.Text = ColorToHex(colorPickerButton.SelectedColor);
			ColorButtonInfo colorButtonInfo = (ColorButtonInfo)colorPickerButton.Tag;
			if (colorButtonInfo != null)
			{
				colorButtonInfo.UserSet = true;
			}
			colorPickerButton.Tag = colorButtonInfo;
		}

		protected virtual void OnLayerEnabled()
		{
			this.OnLayerEnabledEvent?.Invoke(HasLayerSelected());
		}

		private void checkBox_CheckedChanged(object sender, EventArgs e)
		{
			OnLayerEnabled();
		}

		private void dataType_SelectedValueChanged(object sender, EventArgs e)
		{
			ComboBox comboBox = (ComboBox)sender;
			if (comboBox == null)
			{
				return;
			}
			ControlRow controlRow = (ControlRow)comboBox.Tag;
			if (controlRow != null)
			{
				controlRow.codingProfile.Items.Clear();
				DataType selectedEnumValue = ComboBoxHelper.GetSelectedEnumValue<DataType>(controlRow.dataType);
				List<CodingProfile> availableCodingProfiles = CodingProfileHelper.GetAvailableCodingProfiles(ActiveBuildProfile, selectedEnumValue);
				string defaultCodingProfile = "";
				if (ActiveBuildProfile.DefaultCodingProfiles.ContainsKey(selectedEnumValue))
				{
					defaultCodingProfile = ActiveBuildProfile.DefaultCodingProfiles[selectedEnumValue];
				}
				Func<CodingProfile, bool> equalsDefault = (CodingProfile cp) => cp.Name.ToLowerInvariant().Equals(defaultCodingProfile.ToLowerInvariant());
				Func<CodingProfile, string> toString = (CodingProfile cp) => (!equalsDefault(cp)) ? cp.DisplayName : (cp.DisplayName + " (default)");
				ComboBoxHelper.FillComboboxValues(controlRow.codingProfile, availableCodingProfiles, toString);
				if (ActiveBuildProfile.DefaultCodingProfiles.ContainsKey(selectedEnumValue) && controlRow.codingProfile.Items.Count > 0)
				{
					ComboBoxHelper.SelectComboBoxItem(controlRow.codingProfile, equalsDefault);
				}
			}
		}

		private void codingProfile_SelectedValueChanged(object sender, EventArgs e)
		{
			ComboBox comboBox = (ComboBox)sender;
			if (comboBox == null)
			{
				return;
			}
			ControlRow controlRow = (ControlRow)comboBox.Tag;
			if (controlRow != null)
			{
				DataType selectedEnumValue = ComboBoxHelper.GetSelectedEnumValue<DataType>(controlRow.dataType);
				List<string> availableQualityProfiles = CodingProfileHelper.GetAvailableQualityProfiles(ComboBoxHelper.GetSelectedValue<CodingProfile>(controlRow.codingProfile), selectedEnumValue, includeHidden: false, includeDefault: true);
				ComboBoxHelper.FillComboBox(controlRow.qualityProfile, availableQualityProfiles);
				if (controlRow.qualityProfile.Items.Count > 0)
				{
					controlRow.qualityProfile.SelectedIndex = 0;
				}
			}
		}

		private List<string> EnumToStringList<T>()
		{
			List<string> list = new List<string>();
			Array values = System.Enum.GetValues(typeof(T));
			for (int i = 0; i < values.Length; i++)
			{
				list.Add(values.GetValue(i).ToString());
			}
			return list;
		}

		private List<string> EnumToStringList(DataType[] dataTypes)
		{
			List<string> list = new List<string>();
			for (int i = 0; i < dataTypes.Length; i++)
			{
				list.Add(dataTypes.GetValue(i).ToString());
			}
			return list;
		}

		public int HasLayerSelected()
		{
			if (!withAddButton)
			{
				return -1;
			}
			int num = 0;
			for (int i = 0; i < controlRows.Count; i++)
			{
				if (controlRows[i].checkBox.Checked)
				{
					num++;
				}
			}
			return num;
		}

		public void ApplyLayerConfiguration()
		{
			if (HasLayerSelected() == 0)
			{
				MessageBox.Show("Please select at least one layer.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
				cancelClose = true;
				return;
			}
			ProjectTemplate = new ProjectTemplate();
			for (int i = 0; i < controlRows.Count; i++)
			{
				bool flag = true;
				if (withAddButton && !controlRows[i].checkBox.Checked)
				{
					flag = false;
				}
				if (flag)
				{
					DataType dataType = (DataType)System.Enum.Parse(typeof(DataType), controlRows[i].dataType.Text);
					string defaultColor = string.Empty;
					ColorButtonInfo colorButtonInfo = (ColorButtonInfo)controlRows[i].colorButton.Tag;
					if (colorButtonInfo != null && colorButtonInfo.UserSet)
					{
						defaultColor = ColorToHex(controlRows[i].colorButton.SelectedColor);
					}
					CodingProfile selectedValue = ComboBoxHelper.GetSelectedValue<CodingProfile>(controlRows[i].codingProfile);
					ProjectTemplate.LayerConfig.Layers.Add(new LayerDescription(dataType, selectedValue.Name, controlRows[i].qualityProfile.Text, controlRows[i].nameBox.Text, defaultColor));
				}
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.scrollableEditList = new GrBuildStudio.Controls.ScrollableEditList();
			this.ToolTip = new GrBuildStudio.ToolTip();
			base.SuspendLayout();
			this.scrollableEditList.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.scrollableEditList.Location = new System.Drawing.Point(0, 0);
			this.scrollableEditList.Name = "scrollableEditList";
			this.scrollableEditList.Size = new System.Drawing.Size(759, 258);
			this.scrollableEditList.TabIndex = 64;
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.BackColor = System.Drawing.Color.Transparent;
			base.Controls.Add(this.scrollableEditList);
			this.DoubleBuffered = true;
			base.Name = "CustomLayerLayoutControl";
			base.Size = new System.Drawing.Size(759, 258);
			base.ResumeLayout(false);
		}
	}
	public enum InfoType
	{
		None,
		File
	}
	internal struct NodeContext
	{
		public InfoType type;

		public string path;

		public NodeContext(InfoType type, string path)
		{
			this.type = type;
			this.path = path;
		}
	}
	public struct MaskInfo
	{
		public int MaskCount { get; set; }

		public ImportTemplateInfo[] Infos { get; set; }

		public string[] Names { get; set; }
	}
	public class LayerAssetDetailsControl : UserControl
	{
		private IContainer components;

		private AdvTree detailTree;

		private Node node7;

		private Node node8;

		private Node node;

		private Node node12;

		private NodeConnector nodeConnector2;

		private ElementStyle elementStyle2;

		private Button bDetails;

		private ToolTip ToolTip;

		private string Template { get; set; }

		public LayerAssetDetailsControl()
		{
			InitializeComponent();
			detailTree.Nodes.Clear();
		}

		public void UpdateTree(ImportTemplateInfo info)
		{
			MaskInfo maskInfo = default(MaskInfo);
			maskInfo.MaskCount = 1;
			maskInfo.Infos = new ImportTemplateInfo[1] { info };
			maskInfo.Names = new string[1] { "" };
			UpdateTree(maskInfo);
		}

		public void UpdateTree(MaskInfo maskInfo)
		{
			detailTree.Nodes.Clear();
			int maskCount = maskInfo.MaskCount;
			for (int i = 0; i < maskCount; i++)
			{
				Node a = new Node();
				UpdateTreeNode(maskInfo, i, a);
				detailTree.Nodes.Add(a);
			}
		}

		private void UpdateTreeNode(MaskInfo maskInfo, int index, Node a)
		{
			if (maskInfo.Infos[index] == null)
			{
				if (!string.IsNullOrEmpty(maskInfo.Names[index]))
				{
					a.Text = maskInfo.Names[index] + ": Empty";
				}
				else
				{
					a.Text = "Empty";
				}
			}
			else
			{
				string text = string.Empty;
				if (maskInfo.MaskCount > 1)
				{
					text = maskInfo.Names[index] + ": ";
				}
				ImportTemplateInfo importTemplateInfo = maskInfo.Infos[index];
				switch (importTemplateInfo.Type)
				{
				case TextureType.Single:
					a.Text = text + "Single File";
					break;
				case TextureType.UDim:
					a.Text = text + "UDIM with " + importTemplateInfo.FoundTextureFiles.NumberOfTextures + " patches found.";
					break;
				case TextureType.Tiled:
					a.Text = text + "Tiled texture with " + importTemplateInfo.FoundTextureFiles.Range.GetTiledHeight() + " row(s) and " + importTemplateInfo.FoundTextureFiles.Range.GetTiledWidth() + " column(s) found.";
					break;
				case TextureType.Unknown:
					a.Text = text + "Multiple files (" + importTemplateInfo.FoundTextureFiles.NumberOfTextures + ")";
					break;
				default:
					a.Text = text + "No files found. ";
					break;
				}
				foreach (PatternScanner.TextureFile textureFile in importTemplateInfo.FoundTextureFiles.TextureFiles)
				{
					Node node = new Node(Path.GetFileName(textureFile.Filename));
					node.Tag = new NodeContext(InfoType.File, textureFile.Filename);
					node.NodeDoubleClick += node_NodeDoubleClick;
					a.Nodes.Add(node);
				}
			}
			a.Tag = new NodeContext(InfoType.None, "");
		}

		private void button1_Click(object sender, EventArgs e)
		{
			if (detailTree.Nodes.Count >= 1 && detailTree.Nodes[0].Nodes.Count >= 1)
			{
				NodeContext nodeContext = ((detailTree.SelectedNode != null) ? ((NodeContext)detailTree.SelectedNode.Tag) : ((NodeContext)detailTree.Nodes[0].Nodes[0].Tag));
				if (nodeContext.type == InfoType.File)
				{
					OpenFileInExplorer(nodeContext.path);
				}
			}
		}

		private void OpenFileInExplorer(string filename)
		{
			if (File.Exists(filename))
			{
				ShellTools.OpenExplorerAndSelect(filename);
			}
		}

		private void node_NodeDoubleClick(object sender, EventArgs e)
		{
			if (detailTree.SelectedNode != null)
			{
				NodeContext nodeContext = (NodeContext)detailTree.SelectedNode.Tag;
				if (nodeContext.type == InfoType.File)
				{
					OpenFileInExplorer(nodeContext.path);
				}
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.detailTree = new DevComponents.AdvTree.AdvTree();
			this.node7 = new DevComponents.AdvTree.Node();
			this.node8 = new DevComponents.AdvTree.Node();
			this.node = new DevComponents.AdvTree.Node();
			this.node12 = new DevComponents.AdvTree.Node();
			this.nodeConnector2 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle2 = new DevComponents.DotNetBar.ElementStyle();
			this.bDetails = new System.Windows.Forms.Button();
			this.ToolTip = new GrBuildStudio.ToolTip();
			((System.ComponentModel.ISupportInitialize)this.detailTree).BeginInit();
			base.SuspendLayout();
			this.detailTree.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.detailTree.AllowDrop = true;
			this.detailTree.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.detailTree.BackColor = System.Drawing.SystemColors.Window;
			this.detailTree.BackgroundStyle.Class = "TreeBorderKey";
			this.detailTree.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.detailTree.DragDropEnabled = false;
			this.detailTree.DragDropNodeCopyEnabled = false;
			this.detailTree.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.detailTree.Location = new System.Drawing.Point(3, 3);
			this.detailTree.Name = "detailTree";
			this.detailTree.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node7 });
			this.detailTree.NodesConnector = this.nodeConnector2;
			this.detailTree.NodeStyle = this.elementStyle2;
			this.detailTree.PathSeparator = ";";
			this.detailTree.Size = new System.Drawing.Size(380, 227);
			this.detailTree.Styles.Add(this.elementStyle2);
			this.ToolTip.SetSuperTooltip(this.detailTree, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_LAYERASSETDETAILS_CONTROL", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.detailTree.TabIndex = 12;
			this.detailTree.Text = "advTree2";
			this.node7.Expanded = true;
			this.node7.Name = "node7";
			this.node7.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node8 });
			this.node7.Text = "Found 40 UDIM patches, from 1001 to 1040";
			this.node8.Expanded = true;
			this.node8.Name = "node8";
			this.node8.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node, this.node12 });
			this.node8.Text = "click to expand...";
			this.node.Expanded = true;
			this.node.Name = "node";
			this.node.Text = "HIGH_QUAL_TEXTURES_color.1001.exr";
			this.node.NodeDoubleClick += new System.EventHandler(node_NodeDoubleClick);
			this.node12.Expanded = true;
			this.node12.Name = "node12";
			this.node12.Text = "HIGH_QUAL_TEXTURES_color.1002.exr";
			this.nodeConnector2.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle2.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle2.Name = "elementStyle2";
			this.elementStyle2.TextColor = System.Drawing.SystemColors.ControlText;
			this.bDetails.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.bDetails.Location = new System.Drawing.Point(308, 236);
			this.bDetails.Name = "bDetails";
			this.bDetails.Size = new System.Drawing.Size(75, 23);
			this.bDetails.TabIndex = 13;
			this.bDetails.Text = "Details...";
			this.bDetails.UseVisualStyleBackColor = true;
			this.bDetails.Click += new System.EventHandler(button1_Click);
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			this.BackColor = System.Drawing.Color.Transparent;
			base.Controls.Add(this.bDetails);
			base.Controls.Add(this.detailTree);
			base.Name = "LayerAssetDetailsControl";
			base.Size = new System.Drawing.Size(386, 264);
			((System.ComponentModel.ISupportInitialize)this.detailTree).EndInit();
			base.ResumeLayout(false);
		}
	}
	public class ImportAssetForm : OfficeForm
	{
		private class ControlRow
		{
			public ChannelPickerControl picker;

			public ImportTemplateInfo[] templateInfos = new ImportTemplateInfo[4];

			public ButtonX optionsButton;

			public ButtonX infoButton;

			public Label descriptionLabel;

			public LayerAssetDetailsControl details;

			public int layerIndex;

			public SwizzleControl[] swizzles = new SwizzleControl[4];

			public ButtonItem[] swizzleMenuButtons = new ButtonItem[4];

			public ButtonItem[] forceTypeMenuButtons = new ButtonItem[4];
		}

		public enum OverrideTextureType
		{
			Auto,
			Single,
			UDim,
			Tiled
		}

		private struct PresetControlPair
		{
			internal SwizzleControl Control { get; set; }

			internal SwizzlePreset Preset { get; set; }

			internal PresetControlPair(SwizzleControl control, SwizzlePreset preset)
			{
				this = default(PresetControlPair);
				Control = control;
				Preset = preset;
			}
		}

		private struct OptionsButtonContext
		{
			public delegate void OptionSelectedEventHandler(object sender, OptionsButtonContext context);

			public ControlRow row;

			public int layerIndex;

			public int subTexIndex;

			public event OptionSelectedEventHandler OptionSelected;

			public OptionsButtonContext(ControlRow row, int layerIndex, int subTexIndex)
			{
				this = default(OptionsButtonContext);
				this.row = row;
				this.layerIndex = layerIndex;
				this.subTexIndex = subTexIndex;
			}

			public void RaiseOptionSelected()
			{
				this.OptionSelected?.Invoke(this, this);
			}
		}

		public Asset AssetToEdit;

		private SolutionModel model;

		private UserSettings userSettings;

		private ProjectSettings projectSettings;

		private List<ControlRow> controlRows;

		private List<string> SuggestedNames = new List<string>();

		private string firstLayername = string.Empty;

		private bool cancelClose;

		private string[] columnNames = new string[6] { "", "Texture", "File", "Info", "", "" };

		private int[] columnWidths = new int[6] { 30, 120, 300, 140, 60, 60 };

		private int controlHeight = 20;

		private int controlMargin = 20;

		private int rowMargin = 16;

		private IContainer components;

		private Button buttonCancel;

		private Button buttonImport;

		private ScrollableEditList scrollableEditList;

		private Label labelName;

		private ComboBox comboBoxName;

		private Label label10;

		private ToolTip ToolTip;

		private CheckBox checkBoxCubemap;

		private Label label1;

		private ControlContainerItem controlContainerItem1;

		public LayerConfig LayerConfig { private get; set; }

		public AssetImportDescription AssetImportDescription { get; private set; }

		private ImportAssetForm()
		{
			InitializeComponent();
		}

		public ImportAssetForm(SolutionModel model, UserSettings settings)
		{
			InitializeComponent();
			this.model = model;
			userSettings = settings;
		}

		private void ImportAssetForm_Load(object sender, EventArgs e)
		{
			base.Width = 118 + columnWidths.Sum();
			projectSettings = userSettings.Solution[model.ActiveProjectBuilder.ActiveProject.Id];
			for (int i = 0; i < columnNames.Length; i++)
			{
				scrollableEditList.Columns.Add(new ScrollableEditList.ColumnItem(columnNames[i], columnWidths[i]));
			}
			if (LayerConfig != null)
			{
				controlRows = new List<ControlRow>();
				for (int j = 0; j < LayerConfig.Layers.Count; j++)
				{
					ScrollableEditList.Row row = null;
					MakeRow(j, out row, out var controls);
					scrollableEditList.Rows.Add(row);
					controlRows.Add(controls);
				}
			}
			UpdateSuggestedNames();
			UpdateExampleName();
			if (AssetToEdit != null)
			{
				LoadAsset();
			}
		}

		private void SetOptionButtonToValue<T>(ControlRow row, int buttonOptionIdx, T selectedEnum) where T : struct, IConvertible
		{
			if (!typeof(T).IsEnum)
			{
				throw new ArgumentException("T must be an enumerated type");
			}
			foreach (ButtonItem subItem in row.optionsButton.SubItems[buttonOptionIdx].SubItems)
			{
				subItem.Checked = subItem.Text == selectedEnum.ToString();
			}
		}

		private void LoadAsset()
		{
			ImportAsset import = null;
			string projectPath = model.ActiveProjectBuilder.GetProjectPath();
			if (!AssetTools.AssetToImportAsset(AssetToEdit, projectPath, out import))
			{
				return;
			}
			checkBoxCubemap.Checked = import.Type == AssetType.CubeMap;
			labelName.Text = import.Name;
			comboBoxName.Items.Clear();
			comboBoxName.Items.Add(import.Name);
			comboBoxName.SelectedIndex = 0;
			firstLayername = "";
			UpdateExampleName();
			buttonImport.Text = "Update";
			for (int i = 0; i < LayerConfig.Layers.Count; i++)
			{
				ImportAssetLayer importAssetLayer = import.Layers[i];
				ControlRow controlRow = controlRows[i];
				if (string.IsNullOrEmpty(importAssetLayer.QualityProfile))
				{
					importAssetLayer.QualityProfile = "Default";
				}
				QualityLevel selectedEnum = (QualityLevel)System.Enum.Parse(typeof(QualityLevel), importAssetLayer.QualityProfile, ignoreCase: true);
				SetOptionButtonToValue(controlRow, 1, selectedEnum);
				SetOptionButtonToValue(controlRow, 2, importAssetLayer.Flip);
				SetOptionButtonToValue(controlRow, 3, importAssetLayer.MipSourceType);
				switch (importAssetLayer.PackingMode)
				{
				case AssetPackingMode.Combined:
					controlRow.picker.ActiveSourceMode = SourceMode.MultiSource;
					break;
				case AssetPackingMode.Combined3:
					controlRow.picker.ActiveSourceMode = SourceMode.MultiSource3;
					break;
				case AssetPackingMode.Combined4:
					controlRow.picker.ActiveSourceMode = SourceMode.MultiSource4;
					break;
				default:
					controlRow.picker.ActiveSourceMode = SourceMode.SingleSource;
					break;
				}
				checkBoxCubemap.Enabled = importAssetLayer.PackingMode == AssetPackingMode.None;
				int srcIdx;
				for (srcIdx = 0; srcIdx < 4; srcIdx++)
				{
					List<CombinedTextureSource.Item> list = importAssetLayer.Source.Sources.Where((CombinedTextureSource.Item _src) => _src.SubIndex == srcIdx).ToList();
					if (list.Count > 0)
					{
						if (list.Count > 1)
						{
							MessageBox.Show(this, "More subtextures found than anticipated ! found " + list.Count + ". only using first", "internal error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
						}
						string fullPath = Path.GetFullPath(list.First().Source);
						ImportTemplateInfo importTemplateInfo = updatePickers(controlRow, srcIdx, fullPath);
						controlRow.picker.SetDisplayText(srcIdx, importTemplateInfo.DisplayString);
						controlRow.swizzles[srcIdx].maxChannels = DataTypeInfo.GetNumChannels(LayerConfig.Layers[i].DataType);
						controlRow.swizzles[srcIdx].LoadSwizzle(importAssetLayer.Swizzle[srcIdx]);
					}
				}
			}
		}

		private void MakeRow(int layerIndex, out ScrollableEditList.Row row, out ControlRow controls)
		{
			controls = new ControlRow();
			controls.layerIndex = layerIndex;
			controls.picker = new ChannelPickerControl(LayerConfig.Layers[layerIndex].DataType);
			controls.picker.Name = "assetPicker";
			controls.picker.BackColor = System.Drawing.Color.Transparent;
			controls.picker.PickerPicked += picker_Picked;
			controls.picker.PickerReset += picker_Reset;
			controls.picker.SourceModeChanged += picker_SourceModeChanged;
			controls.picker.SourceModeChanging += picker_SourceModeChanging;
			controls.picker.PickerFileDropped += picker_PickerFileDropped;
			controls.picker.Tag = controls;
			controls.picker.Init(ToolTip, "TT_SINGLEASSET_TEMPLATE_TBOX", layerIndex, ChannelPickerControl.FileFolderMode.File);
			controls.picker.Size = new Size(columnWidths[2] - 2 * controlMargin, controls.picker.Size.Height);
			controls.descriptionLabel = new Label();
			controls.descriptionLabel.Name = "descriptionLabel";
			controls.descriptionLabel.Size = new Size(columnWidths[3] - 2 * controlMargin, controlHeight + rowMargin);
			controls.descriptionLabel.BackColor = System.Drawing.Color.Transparent;
			controls.descriptionLabel.TextAlign = ContentAlignment.MiddleLeft;
			controls.descriptionLabel.TabIndex = 10 * (layerIndex + 1) + 4;
			ToolTip.SetSuperTooltip(controls.descriptionLabel, new SuperTooltipInfo("", "", "TT_SINGLEASSET_DESC_LABEL", null, null, ToolTip.DefaultTooltipSettings.Color));
			controls.optionsButton = SetupOptionsButton(controls, layerIndex);
			controls.optionsButton.Tag = controls;
			controls.optionsButton.TabIndex = 10 * (layerIndex + 1) + 6;
			controls.details = new LayerAssetDetailsControl();
			controls.details.Tag = controls;
			controls.infoButton = SetupInfoButton(controls.details);
			controls.infoButton.Tag = controls;
			controls.infoButton.TabIndex = 10 * (layerIndex + 1) + 8;
			controls.details.UpdateTree(new ImportTemplateInfo());
			row = new ScrollableEditList.Row();
			row.RowItems.Add(new ScrollableEditList.RowItem(""));
			row.RowItems.Add(new ScrollableEditList.RowItem(LayerConfig.Layers[layerIndex].LayerName));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.picker));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.descriptionLabel));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.optionsButton));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.infoButton));
			controls.picker.ActiveSourceMode = PreferredSourceMode(LayerConfig.Layers[layerIndex].LayerName);
		}

		private SourceMode PreferredSourceMode(string layerName)
		{
			return layerName.Count((char f) => f == Constants.ChannelPackedLayerSplitLiteral) switch
			{
				0 => SourceMode.SingleSource, 
				1 => SourceMode.MultiSource, 
				2 => SourceMode.MultiSource3, 
				3 => SourceMode.MultiSource4, 
				_ => SourceMode.SingleSource, 
			};
		}

		private void picker_PickerFileDropped(object sender, int subIndex, string filePath)
		{
			ChannelPickerControl obj = (ChannelPickerControl)sender;
			ControlRow row = (ControlRow)obj.Tag;
			if (projectSettings != null)
			{
				projectSettings.SingleAssetImportLocation = Paths.GetDirectoryName(filePath);
			}
			ImportTemplateInfo importTemplateInfo = updatePickers(row, subIndex, filePath);
			obj.SetDisplayText(subIndex, importTemplateInfo.DisplayString);
		}

		private void picker_Picked(object sender, EventArgs e, int subtextureIndex)
		{
			ChannelPickerControl channelPickerControl = (ChannelPickerControl)sender;
			ControlRow row = (ControlRow)channelPickerControl.Tag;
			OpenFileDialog openFileDialog = new OpenFileDialog();
			openFileDialog.Filter = string.Format("Image Files ({0})|{0}|All Files (*.*)|*.*", GrimTools.GetExtensionsFilterString());
			if (projectSettings != null)
			{
				openFileDialog.InitialDirectory = projectSettings.SingleAssetImportLocation;
			}
			if (openFileDialog.ShowDialog() == DialogResult.OK)
			{
				if (projectSettings != null)
				{
					projectSettings.SingleAssetImportLocation = Paths.GetDirectoryName(openFileDialog.FileName);
				}
				ImportTemplateInfo importTemplateInfo = updatePickers(row, subtextureIndex, openFileDialog.FileName);
				channelPickerControl.SetDisplayText(subtextureIndex, importTemplateInfo.DisplayString);
			}
		}

		private TextureType OverridenTextureType(OverrideTextureType t)
		{
			return t switch
			{
				OverrideTextureType.Single => TextureType.Single, 
				OverrideTextureType.Tiled => TextureType.Tiled, 
				OverrideTextureType.UDim => TextureType.UDim, 
				_ => TextureType.Unknown, 
			};
		}

		private ImportTemplateInfo updatePickers(ControlRow row, int subtextureIndex, string fileName)
		{
			ButtonItem buttonItem = row.forceTypeMenuButtons[subtextureIndex];
			OverrideTextureType overrideTextureType = RetrieveSelectedEnumButtonItem(buttonItem, OverrideTextureType.Auto);
			ImportTemplateInfo importTemplateInfo = null;
			importTemplateInfo = ((overrideTextureType != 0) ? ImportTemplateConstructor.TemplateFromFilename(fileName, OverridenTextureType(overrideTextureType)) : ImportTemplateConstructor.TemplateFromFilename(fileName));
			row.templateInfos[subtextureIndex] = importTemplateInfo;
			UpdateDescriptionAndDetails(row);
			if (!SuggestedNames.Contains(importTemplateInfo.SuggestedAssetName))
			{
				SuggestedNames.Add(importTemplateInfo.SuggestedAssetName);
			}
			UpdateSuggestedNames();
			return importTemplateInfo;
		}

		private void UpdateDescriptionAndDetails(ControlRow row)
		{
			string text = "";
			int num = 1;
			float num2 = 1f;
			ChannelMerging.ChannelMask channelMask = null;
			Dictionary<AssetPackingMode, ChannelMerging.ChannelMask> allMasks = new Dictionary<AssetPackingMode, ChannelMerging.ChannelMask>();
			ChannelMerging.GetAllChannelMasks(LayerConfig.Layers[row.layerIndex].DataType, ref allMasks);
			switch (row.picker.ActiveSourceMode)
			{
			case SourceMode.MultiSource4:
				num = 4;
				channelMask = allMasks[AssetPackingMode.Combined4];
				num2 = 2f;
				break;
			case SourceMode.MultiSource3:
				num = 3;
				channelMask = allMasks[AssetPackingMode.Combined3];
				num2 = 1.5f;
				break;
			case SourceMode.MultiSource:
				num = 2;
				channelMask = allMasks[AssetPackingMode.Combined];
				break;
			}
			for (int i = 0; i < num; i++)
			{
				if (i > 0)
				{
					text += "\n";
				}
				if (num > 1)
				{
					text = text + channelMask.humanReadable[i] + ": ";
				}
				text += ((row.templateInfos[i] != null) ? GetDescriptiveTextForInfo(row.templateInfos[i]) : "Empty");
			}
			row.descriptionLabel.Text = text;
			MaskInfo maskInfo = default(MaskInfo);
			maskInfo.MaskCount = num;
			maskInfo.Infos = new ImportTemplateInfo[4];
			maskInfo.Names = new string[4];
			for (int j = 0; j < num; j++)
			{
				maskInfo.Infos[j] = row.templateInfos[j];
				maskInfo.Names[j] = ((channelMask != null) ? channelMask.humanReadable[j] : string.Empty);
			}
			row.details.UpdateTree(maskInfo);
			bool visible = row.picker.ActiveSourceMode == SourceMode.MultiSource || row.picker.ActiveSourceMode == SourceMode.MultiSource3 || row.picker.ActiveSourceMode == SourceMode.MultiSource4;
			bool visible2 = row.picker.ActiveSourceMode == SourceMode.MultiSource3 || row.picker.ActiveSourceMode == SourceMode.MultiSource4;
			bool visible3 = row.picker.ActiveSourceMode == SourceMode.MultiSource4;
			row.swizzleMenuButtons[0].Text = ((row.picker.ActiveSourceMode == SourceMode.SingleSource) ? "Swizzle" : "Swizzle 0");
			row.swizzleMenuButtons[1].Visible = visible;
			row.swizzleMenuButtons[2].Visible = visible2;
			row.swizzleMenuButtons[3].Visible = visible3;
			row.forceTypeMenuButtons[0].Text = ((row.picker.ActiveSourceMode == SourceMode.SingleSource) ? "Force Type" : "Force Type 0");
			row.forceTypeMenuButtons[1].Visible = visible;
			row.forceTypeMenuButtons[2].Visible = visible2;
			row.forceTypeMenuButtons[3].Visible = visible3;
			Size size = row.descriptionLabel.Size;
			size.Height = controlHeight + (int)((float)rowMargin * num2);
			row.descriptionLabel.Size = size;
		}

		private void picker_Reset(object sender, int idx)
		{
			ControlRow controlRow = (ControlRow)((ChannelPickerControl)sender).Tag;
			controlRow.templateInfos[idx] = null;
			UpdateDescriptionAndDetails(controlRow);
		}

		private void picker_SourceModeChanged(object sender, SourceMode mode)
		{
			ControlRow row = (ControlRow)((ChannelPickerControl)sender).Tag;
			UpdateDescriptionAndDetails(row);
		}

		private bool picker_SourceModeChanging(object sender, SourceMode from, SourceMode to)
		{
			if (to == SourceMode.MultiSource || to == SourceMode.MultiSource3 || to == SourceMode.MultiSource4)
			{
				if (checkBoxCubemap.Checked)
				{
					MessageBox.Show("Cubemaps cannot have multiple sources (channel packing).", "Cubemaps do not support channel packing", MessageBoxButtons.OK, MessageBoxIcon.Hand);
					return false;
				}
				checkBoxCubemap.Enabled = false;
				checkBoxCubemap.Checked = false;
			}
			else
			{
				bool enabled = true;
				if (LayerConfig != null)
				{
					for (int i = 0; i < LayerConfig.Layers.Count; i++)
					{
						if (controlRows[i].picker != sender && (controlRows[i].picker.ActiveSourceMode == SourceMode.MultiSource || controlRows[i].picker.ActiveSourceMode == SourceMode.MultiSource3 || controlRows[i].picker.ActiveSourceMode == SourceMode.MultiSource4))
						{
							enabled = false;
							break;
						}
					}
				}
				checkBoxCubemap.Enabled = enabled;
			}
			return true;
		}

		private string GetDescriptiveTextForInfo(ImportTemplateInfo info)
		{
			return info.Type switch
			{
				TextureType.Single => "Single File", 
				TextureType.UDim => $"UDIM - {info.FoundTextureFiles.NumberOfTextures} patches", 
				TextureType.Tiled => string.Format("Tiled - {0} x {1}", new object[2]
				{
					info.FoundTextureFiles.Range.GetTiledWidth(),
					info.FoundTextureFiles.Range.GetTiledHeight()
				}), 
				_ => "No File", 
			};
		}

		private bool DoesAssetExists(string name)
		{
			if (AssetToEdit != null && name == AssetToEdit.Name)
			{
				return false;
			}
			return model.ActiveProjectBuilder.GetAsset(AssetImportDescription.Name) != null;
		}

		private void buttonImport_Click(object sender, EventArgs e)
		{
			AssetImportDescription = new AssetImportDescription();
			AssetImportDescription.Name = comboBoxName.Text.Replace("*", firstLayername);
			AssetImportDescription.Type = (checkBoxCubemap.Checked ? AssetType.CubeMap : AssetType.Normal);
			if (LayerConfig == null)
			{
				return;
			}
			bool flag = false;
			for (int i = 0; i < LayerConfig.Layers.Count; i++)
			{
				LayerAssetImportDescription layerAssetImportDescription = new LayerAssetImportDescription();
				layerAssetImportDescription.Name = null;
				int num = 1;
				AssetPackingMode packingMode = AssetPackingMode.None;
				switch (controlRows[i].picker.ActiveSourceMode)
				{
				case SourceMode.MultiSource:
					packingMode = AssetPackingMode.Combined;
					num = 2;
					break;
				case SourceMode.MultiSource3:
					packingMode = AssetPackingMode.Combined3;
					num = 3;
					break;
				case SourceMode.MultiSource4:
					packingMode = AssetPackingMode.Combined4;
					num = 4;
					break;
				}
				for (int j = 0; j < 4; j++)
				{
					bool flag2 = controlRows[i].templateInfos[j] != null;
					if (j >= num)
					{
						flag2 = false;
					}
					flag = flag || flag2;
					ImportTemplateInfo importTemplateInfo = (flag2 ? controlRows[i].templateInfos[j] : ImportTemplateInfo.Empty);
					if (flag2)
					{
						layerAssetImportDescription.FileSources.AddSource(importTemplateInfo.TemplateString, j);
					}
					if (layerAssetImportDescription.Name == null && flag2)
					{
						layerAssetImportDescription.Name = importTemplateInfo.SuggestedAssetName;
					}
					layerAssetImportDescription.Swizzle[j] = controlRows[i].swizzles[j].Swizzle;
					if (layerAssetImportDescription.Swizzle[j].Equals(SwizzlePreset.Default.Pattern))
					{
						layerAssetImportDescription.Swizzle[j] = "";
					}
				}
				layerAssetImportDescription.PackingMode = packingMode;
				if (layerAssetImportDescription.Name == null)
				{
					layerAssetImportDescription.Name = LayerConfig.Layers[i].LayerName;
				}
				foreach (ButtonItem subItem in controlRows[i].optionsButton.SubItems[1].SubItems)
				{
					if (subItem.Checked)
					{
						layerAssetImportDescription.Quality = (QualityLevel)System.Enum.Parse(typeof(QualityLevel), subItem.Text);
						break;
					}
				}
				foreach (ButtonItem subItem2 in controlRows[i].optionsButton.SubItems[2].SubItems)
				{
					if (subItem2.Checked)
					{
						layerAssetImportDescription.Flip = (FlipOption)System.Enum.Parse(typeof(FlipOption), subItem2.Text);
						break;
					}
				}
				foreach (ButtonItem subItem3 in controlRows[i].optionsButton.SubItems[3].SubItems)
				{
					if (subItem3.Checked)
					{
						layerAssetImportDescription.MipSourceType = (TextureMipSourceType)System.Enum.Parse(typeof(TextureMipSourceType), subItem3.Text);
						break;
					}
				}
				AssetImportDescription.LayerAssets.Add(layerAssetImportDescription);
			}
			if (!flag)
			{
				MessageBox.Show("No layer textures set. Set at least one texture in a layer!", "Import Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
			}
			else if (DoesAssetExists(AssetImportDescription.Name) && MessageBox.Show($"The Stacked Textures with name '{AssetImportDescription.Name}' already exist and will be updated with the new information. Proceed?", "Warning", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.No)
			{
				base.DialogResult = DialogResult.Cancel;
				cancelClose = true;
			}
			else
			{
				userSettings.Solution[model.ActiveProjectBuilder.ActiveProject.Id] = projectSettings;
				base.DialogResult = DialogResult.OK;
			}
		}

		private List<string> EnumToStringList<T>()
		{
			List<string> list = new List<string>();
			Array values = System.Enum.GetValues(typeof(T));
			for (int i = 0; i < values.Length; i++)
			{
				list.Add(values.GetValue(i).ToString());
			}
			return list;
		}

		private ButtonItem SetupEnumButtonItems<T>(T defaultValue, string title)
		{
			ButtonItem buttonItem = new ButtonItem();
			buttonItem.GlobalItem = false;
			buttonItem.Text = title;
			string text = defaultValue.ToString();
			foreach (string item in EnumToStringList<T>())
			{
				bool @checked = text.Equals(item);
				ButtonItem buttonItem2 = new ButtonItem();
				buttonItem2.Checked = @checked;
				buttonItem2.Text = item;
				buttonItem2.Tag = item;
				buttonItem2.Click += sub_Click;
				buttonItem.SubItems.Add(buttonItem2);
			}
			return buttonItem;
		}

		private ButtonItem SetupEnumButtonItems<T>(T defaultValue, string title, List<string> filterList)
		{
			ButtonItem buttonItem = new ButtonItem();
			buttonItem.GlobalItem = false;
			buttonItem.Text = title;
			string text = defaultValue.ToString();
			foreach (string item in EnumToStringList<T>())
			{
				if (filterList.Contains(item, StringComparer.OrdinalIgnoreCase))
				{
					bool @checked = text.Equals(item);
					ButtonItem buttonItem2 = new ButtonItem();
					buttonItem2.Checked = @checked;
					buttonItem2.Text = item;
					buttonItem2.Tag = item;
					buttonItem2.Click += sub_Click;
					buttonItem.SubItems.Add(buttonItem2);
				}
			}
			return buttonItem;
		}

		private T RetrieveSelectedEnumButtonItem<T>(ButtonItem parent, T defaultValue)
		{
			foreach (ButtonItem subItem in parent.SubItems)
			{
				if (subItem.Checked)
				{
					return (T)System.Enum.Parse(typeof(T), subItem.Text, ignoreCase: true);
				}
			}
			return defaultValue;
		}

		private void sub_Click(object sender, EventArgs e)
		{
			ButtonItem buttonItem = (ButtonItem)sender;
			if (buttonItem == null)
			{
				return;
			}
			ButtonItem buttonItem2 = (ButtonItem)buttonItem.Parent;
			if (buttonItem2 == null)
			{
				return;
			}
			foreach (ButtonItem subItem in buttonItem2.SubItems)
			{
				subItem.Checked = subItem == (ButtonItem)sender;
			}
			if (buttonItem2.Tag is OptionsButtonContext)
			{
				((OptionsButtonContext)buttonItem2.Tag).RaiseOptionSelected();
			}
		}

		private List<string> GetAvailableQualityProfiles(LayerConfig layerConfig, int layerIdx)
		{
			DataType dataType = layerConfig.Layers[layerIdx].DataType;
			return CodingProfileHelper.GetAvailableQualityProfiles(layerConfig.Layers[layerIdx].CodingProfile, dataType, includeHidden: false, includeDefault: true);
		}

		private ButtonX SetupOptionsButton(ControlRow row, int layerIndex)
		{
			ButtonX buttonX = new ButtonX();
			buttonX.Name = "button";
			buttonX.Text = "Options";
			buttonX.Size = new Size(columnWidths[4] - 2 * controlMargin, controlHeight);
			buttonX.AccessibleRole = AccessibleRole.PushButton;
			buttonX.AutoExpandOnClick = true;
			buttonX.Style = eDotNetBarStyle.StyleManagerControlled;
			ButtonItem buttonItem = new ButtonItem();
			buttonItem.Name = "clearButton";
			buttonItem.Text = "Clear this layer";
			buttonItem.Tag = row;
			buttonItem.Click += clearButton_Click;
			buttonX.SubItems.Add(buttonItem);
			List<string> availableQualityProfiles = GetAvailableQualityProfiles(LayerConfig, layerIndex);
			ButtonItem buttonItem2 = SetupEnumButtonItems(Constants.DefaultQualityLevel, "QualityLevel", availableQualityProfiles);
			buttonItem2.Name = "qualityLevelButton";
			buttonItem2.BeginGroup = true;
			buttonX.SubItems.Add(buttonItem2);
			ToolTip.SetSuperTooltip(buttonX.SubItems[0], new SuperTooltipInfo("", "", "TT_OPTION_QUALITYLEVEL", null, null, ToolTip.DefaultTooltipSettings.Color));
			buttonX.SubItems.Add(SetupEnumButtonItems(FlipOption.None, "Flip"));
			ToolTip.SetSuperTooltip(buttonX.SubItems[1], new SuperTooltipInfo("", "", "TT_OPTION_FLIP", null, null, ToolTip.DefaultTooltipSettings.Color));
			buttonX.SubItems.Add(SetupEnumButtonItems(TextureMipSourceType.Default, "Mip map Source"));
			ButtonItem buttonItem3 = new ButtonItem();
			buttonItem3.Name = "swizzleButton";
			buttonItem3.Text = "Swizzle";
			buttonX.SubItems.Add(buttonItem3);
			for (int i = 0; i < 4; i++)
			{
				row.swizzleMenuButtons[i] = SetupSwizzlingButtonItem(i, row, layerIndex);
				buttonItem3.SubItems.Add(row.swizzleMenuButtons[i]);
			}
			ButtonItem buttonItem4 = new ButtonItem();
			buttonItem4.Name = "forceButton";
			buttonItem4.Text = "Force Type";
			buttonItem4.BeginGroup = true;
			buttonX.SubItems.Add(buttonItem4);
			for (int j = 0; j < 4; j++)
			{
				ButtonItem item = SetupForceTypeButtonItems(j, row, layerIndex);
				buttonItem4.SubItems.Add(item);
			}
			return buttonX;
		}

		private void clearButton_Click(object sender, EventArgs e)
		{
			((ControlRow)((ButtonItem)sender).Tag).picker.Reset();
		}

		private ButtonX SetupInfoButton(LayerAssetDetailsControl detailControl)
		{
			ButtonX obj = new ButtonX
			{
				Name = "button",
				Text = "Info",
				Size = new Size(columnWidths[5] - 2 * controlMargin, controlHeight),
				AccessibleRole = AccessibleRole.PushButton,
				AutoExpandOnClick = true,
				Style = eDotNetBarStyle.StyleManagerControlled
			};
			ControlContainerItem item = new ControlContainerItem
			{
				AllowItemResize = true,
				MenuVisibility = eMenuVisibility.VisibleAlways,
				Control = detailControl
			};
			obj.SubItems.Add(item);
			return obj;
		}

		private ButtonItem SetupSwizzlingButtonItem(int subIdx, ControlRow row, int layerIndex)
		{
			ButtonItem buttonItem = new ButtonItem();
			buttonItem.Name = "swizzleButton" + subIdx;
			buttonItem.Text = "Swizzle " + subIdx;
			ButtonItem buttonItem2 = new ButtonItem();
			buttonItem2.Text = "Load Preset";
			buttonItem.SubItems.Add(buttonItem2);
			SwizzleControl swizzleControl = new SwizzleControl();
			row.swizzles[subIdx] = swizzleControl;
			swizzleControl.Padding = new System.Windows.Forms.Padding(4, 4, 4, 4);
			SwizzlePreset[] swizzlePresets = Constants.SwizzlePresets;
			foreach (SwizzlePreset swizzlePreset in swizzlePresets)
			{
				ButtonItem buttonItem3 = new ButtonItem();
				buttonItem3.Text = swizzlePreset.Name;
				buttonItem3.Tag = new PresetControlPair(swizzleControl, swizzlePreset);
				buttonItem3.Click += presetButton_Click;
				buttonItem2.SubItems.Add(buttonItem3);
			}
			ControlContainerItem controlContainerItem = new ControlContainerItem();
			controlContainerItem.AllowItemResize = false;
			controlContainerItem.BeginGroup = false;
			controlContainerItem.GlobalItem = false;
			controlContainerItem.MenuVisibility = eMenuVisibility.VisibleAlways;
			controlContainerItem.Name = "controlContainerItem1";
			controlContainerItem.Text = "Swizzle";
			LabelItem labelItem = new LabelItem();
			labelItem.Text = "Custom: ";
			labelItem.PaddingLeft = 32;
			ItemContainer itemContainer = new ItemContainer();
			itemContainer.BeginGroup = true;
			itemContainer.SubItems.Add(labelItem);
			itemContainer.SubItems.Add(controlContainerItem);
			int numChannels = DataTypeInfo.GetNumChannels(LayerConfig.Layers[layerIndex].DataType);
			swizzleControl.Initialize(numChannels, SwizzlePreset.RGBA.Pattern);
			controlContainerItem.Control = swizzleControl;
			buttonItem.SubItems.Add(itemContainer);
			return buttonItem;
		}

		private ButtonItem SetupForceTypeButtonItems(int subIdx, ControlRow row, int layerIndex)
		{
			ButtonItem buttonItem = SetupEnumButtonItems(OverrideTextureType.Auto, "Force Type " + subIdx);
			OptionsButtonContext optionsButtonContext = new OptionsButtonContext(row, layerIndex, subIdx);
			optionsButtonContext.OptionSelected += context_OptionSelected;
			buttonItem.Tag = optionsButtonContext;
			row.forceTypeMenuButtons[subIdx] = buttonItem;
			return buttonItem;
		}

		private void context_OptionSelected(object sender, OptionsButtonContext context)
		{
			if (context.row.templateInfos[context.subTexIndex] != null)
			{
				string templateConstructorInput = context.row.templateInfos[context.subTexIndex].TemplateConstructorInput;
				ImportTemplateInfo importTemplateInfo = updatePickers(context.row, context.subTexIndex, templateConstructorInput);
				context.row.picker.SetDisplayText(context.subTexIndex, importTemplateInfo.DisplayString);
			}
		}

		private void presetButton_Click(object sender, EventArgs e)
		{
			PresetControlPair presetControlPair = (PresetControlPair)((ButtonItem)sender).Tag;
			presetControlPair.Control.LoadSwizzle(presetControlPair.Preset.Pattern);
		}

		private void comboBoxName_Leave(object sender, EventArgs e)
		{
			UpdateExampleName();
		}

		private void UpdateSuggestedNames()
		{
			string value = null;
			for (int i = 0; i < controlRows.Count; i++)
			{
				for (int j = 0; j < 4; j++)
				{
					if (controlRows[i].templateInfos[j] != null)
					{
						value = controlRows[i].templateInfos[j].SuggestedAssetName;
						break;
					}
				}
				if (!string.IsNullOrEmpty(value))
				{
					break;
				}
			}
			firstLayername = value;
			_ = string.Empty;
			_ = comboBoxName.Text;
			_ = string.Empty;
			comboBoxName.Items.Clear();
			if (AssetToEdit == null)
			{
				comboBoxName.Items.Add("MyName");
				comboBoxName.Items.Add("*");
			}
			foreach (string suggestedName in SuggestedNames)
			{
				comboBoxName.Items.Add(suggestedName);
			}
			UpdateExampleName();
		}

		private void UpdateExampleName()
		{
			string text = comboBoxName.Text;
			text = ((!(firstLayername != string.Empty)) ? text.Replace("*", "MyName") : text.Replace("*", firstLayername));
			labelName.Text = "Example: \t\"" + text + "\"";
		}

		private void comboBoxName_Enter(object sender, EventArgs e)
		{
			UpdateExampleName();
		}

		private void ImportAssetForm_FormClosing(object sender, FormClosingEventArgs e)
		{
			e.Cancel = cancelClose;
			cancelClose = false;
		}

		private void checkBoxCubemap_Clicked(object sender, EventArgs e)
		{
			if (LayerConfig != null)
			{
				for (int i = 0; i < LayerConfig.Layers.Count; i++)
				{
					if (controlRows[i].picker.ActiveSourceMode == SourceMode.MultiSource)
					{
						checkBoxCubemap.CheckState = CheckState.Unchecked;
						MessageBox.Show("Cubemaps cannot have multiple sources (channel packing). Please validate '" + LayerConfig.Layers[i].LayerName + "'", "Cubemaps do not support channel packing", MessageBoxButtons.OK, MessageBoxIcon.Hand);
						return;
					}
				}
			}
			checkBoxCubemap.Checked = !checkBoxCubemap.Checked;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.buttonCancel = new System.Windows.Forms.Button();
			this.buttonImport = new System.Windows.Forms.Button();
			this.labelName = new System.Windows.Forms.Label();
			this.comboBoxName = new System.Windows.Forms.ComboBox();
			this.label10 = new System.Windows.Forms.Label();
			this.checkBoxCubemap = new System.Windows.Forms.CheckBox();
			this.label1 = new System.Windows.Forms.Label();
			this.controlContainerItem1 = new DevComponents.DotNetBar.ControlContainerItem();
			this.scrollableEditList = new GrBuildStudio.Controls.ScrollableEditList();
			this.ToolTip = new GrBuildStudio.ToolTip();
			base.SuspendLayout();
			this.buttonCancel.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.buttonCancel.Location = new System.Drawing.Point(705, 310);
			this.buttonCancel.Name = "buttonCancel";
			this.buttonCancel.Size = new System.Drawing.Size(75, 23);
			this.buttonCancel.TabIndex = 510;
			this.buttonCancel.Text = "Cancel";
			this.buttonCancel.UseVisualStyleBackColor = true;
			this.buttonImport.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonImport.Location = new System.Drawing.Point(624, 310);
			this.buttonImport.Name = "buttonImport";
			this.buttonImport.Size = new System.Drawing.Size(75, 23);
			this.buttonImport.TabIndex = 500;
			this.buttonImport.Text = "Add";
			this.buttonImport.UseVisualStyleBackColor = true;
			this.buttonImport.Click += new System.EventHandler(buttonImport_Click);
			this.labelName.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.labelName.Location = new System.Drawing.Point(360, 267);
			this.labelName.Name = "labelName";
			this.labelName.Size = new System.Drawing.Size(420, 18);
			this.ToolTip.SetSuperTooltip(this.labelName, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "Stacked texture's name", null, null, DevComponents.DotNetBar.eTooltipColor.Gray, false, false, new System.Drawing.Size(0, 0)));
			this.labelName.TabIndex = 45;
			this.labelName.Text = "world.topo.bathy.200412.3x21600x21600";
			this.comboBoxName.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.comboBoxName.FormattingEnabled = true;
			this.comboBoxName.Items.AddRange(new object[1] { "MyName" });
			this.comboBoxName.Location = new System.Drawing.Point(65, 264);
			this.comboBoxName.Name = "comboBoxName";
			this.comboBoxName.Size = new System.Drawing.Size(289, 21);
			this.ToolTip.SetSuperTooltip(this.comboBoxName, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_SINGLEASSET_NAME_COMBOBOX", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.comboBoxName.TabIndex = 490;
			this.comboBoxName.Text = "*";
			this.comboBoxName.Enter += new System.EventHandler(comboBoxName_Enter);
			this.comboBoxName.Leave += new System.EventHandler(comboBoxName_Leave);
			this.label10.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.label10.AutoSize = true;
			this.label10.Location = new System.Drawing.Point(12, 267);
			this.label10.Name = "label10";
			this.label10.Size = new System.Drawing.Size(35, 13);
			this.label10.TabIndex = 43;
			this.label10.Text = "Name";
			this.checkBoxCubemap.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.checkBoxCubemap.AutoCheck = false;
			this.checkBoxCubemap.AutoSize = true;
			this.checkBoxCubemap.Location = new System.Drawing.Point(65, 296);
			this.checkBoxCubemap.Name = "checkBoxCubemap";
			this.checkBoxCubemap.Size = new System.Drawing.Size(15, 14);
			this.checkBoxCubemap.TabIndex = 511;
			this.checkBoxCubemap.UseVisualStyleBackColor = true;
			this.checkBoxCubemap.Click += new System.EventHandler(checkBoxCubemap_Clicked);
			this.label1.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.label1.AutoSize = true;
			this.label1.Location = new System.Drawing.Point(12, 297);
			this.label1.Name = "label1";
			this.label1.Size = new System.Drawing.Size(52, 13);
			this.label1.TabIndex = 512;
			this.label1.Text = "Cubemap";
			this.controlContainerItem1.AllowItemResize = false;
			this.controlContainerItem1.GlobalItem = false;
			this.controlContainerItem1.MenuVisibility = DevComponents.DotNetBar.eMenuVisibility.VisibleAlways;
			this.controlContainerItem1.Name = "controlContainerItem1";
			this.scrollableEditList.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.scrollableEditList.Location = new System.Drawing.Point(12, 12);
			this.scrollableEditList.Name = "scrollableEditList";
			this.scrollableEditList.Size = new System.Drawing.Size(767, 241);
			this.scrollableEditList.TabIndex = 42;
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			base.AcceptButton = this.buttonImport;
			base.CancelButton = this.buttonCancel;
			base.ClientSize = new System.Drawing.Size(792, 345);
			base.Controls.Add(this.label1);
			base.Controls.Add(this.checkBoxCubemap);
			base.Controls.Add(this.labelName);
			base.Controls.Add(this.comboBoxName);
			base.Controls.Add(this.label10);
			base.Controls.Add(this.scrollableEditList);
			base.Controls.Add(this.buttonCancel);
			base.Controls.Add(this.buttonImport);
			this.DoubleBuffered = true;
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "ImportAssetForm";
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "Import Single Stacked texture in Tile Set 'Loft'";
			base.FormClosing += new System.Windows.Forms.FormClosingEventHandler(ImportAssetForm_FormClosing);
			base.Load += new System.EventHandler(ImportAssetForm_Load);
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	public class MessageBoxLogListener : LogListener
	{
		public Logger.Verbosity VerbosityLevel { get; set; }

		public bool Supressed { get; set; }

		public Form Owner { get; set; }

		public MessageBoxLogListener()
		{
			VerbosityLevel = Defaults.Verbosity;
		}

		public MessageBoxLogListener(Form owner)
		{
			VerbosityLevel = Defaults.Verbosity;
			Owner = owner;
		}

		public void LogTitle(string title, Logger.Verbosity verbosity)
		{
		}

		public void LogConsole(string message, Logger.Verbosity verbosity)
		{
		}

		public void LogLine(Logger.Verbosity verbosity)
		{
		}

		public void LogMessage(string message, Logger.Verbosity verbosity)
		{
			if (!Supressed)
			{
				IWin32Window owner = null;
				if (!Owner.IsDisposed)
				{
					owner = Owner;
				}
				MessageBox.Show(owner, message, "Info", MessageBoxButtons.OK, MessageBoxIcon.Asterisk);
			}
		}

		public void LogCurrentLine(string message, Logger.Verbosity verbosity)
		{
			LogMessage(message, verbosity);
		}

		public void LogCurrentLine(string message, bool endWithNewLine, Logger.Verbosity verbosity)
		{
			LogMessage(message, verbosity);
		}

		public void LogError(string message)
		{
			if (Supressed)
			{
				return;
			}
			IWin32Window handle = null;
			if (Owner != null && !Owner.IsDisposed)
			{
				handle = Owner;
			}
			if (Owner != null && Owner.InvokeRequired)
			{
				Owner.Invoke((Action)delegate
				{
					MessageBox.Show(handle, message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
				});
			}
			else
			{
				MessageBox.Show(handle, message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
			}
		}

		public void LogWarning(string message)
		{
			if (!Supressed)
			{
				IWin32Window owner = null;
				if (Owner != null && !Owner.IsDisposed)
				{
					owner = Owner;
				}
				MessageBox.Show(owner, message, "Warning", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
			}
		}

		public void LogInfo(string message)
		{
			if (!Supressed)
			{
				IWin32Window owner = null;
				if (!Owner.IsDisposed)
				{
					owner = Owner;
				}
				MessageBox.Show(owner, message, "Info", MessageBoxButtons.OK, MessageBoxIcon.Asterisk);
			}
		}

		public void PrintProgress(string message, bool isLast, Logger.Verbosity verbosity)
		{
		}
	}
	public class StudioLogger : Logger
	{
		private MessageBoxLogListener messageBoxLogger;

		public static StudioLogger Global = new StudioLogger();

		public StudioLogger()
			: base(Defaults.Verbosity)
		{
			base.VerbosityLevel = Defaults.Verbosity;
			messageBoxLogger = new MessageBoxLogListener();
			RegisterLogListener(messageBoxLogger);
		}

		public void SetOwnerWindow(Form owner)
		{
			messageBoxLogger.Owner = owner;
		}

		public void LogException(Exception e)
		{
			CrashReportForm crashReportForm = new CrashReportForm();
			crashReportForm.Exception = e;
			crashReportForm.Message = e.Message;
			crashReportForm.Mode = CrashReportForm.DisplayMode.Error;
			crashReportForm.ShowDialog();
		}
	}
	public class MainForm : Office2007Form
	{
		public class StartupContext
		{
			public string solutionToLoadPath;

			public bool buildSolution;

			public bool rebuildSolution;

			public bool quitAfterSuccessBuild;

			public bool optimizedBuild;

			public bool silentAtlasErrors;

			public bool hideMainWindow;

			public bool buildForGtex;

			public bool allowForeignGtex;

			public bool forceGtex;

			public bool buildnotileset;
		}

		private SolutionModel model;

		private UserSettings userSettings;

		private OpenFileDialog openSolutionDialog;

		private OpenFileDialog openScriptDialog;

		private SaveFileDialog saveScriptDialog;

		private StartupContext startupContext;

		private BuildLoggerReporter buildLoggerReporter;

		private List<Guid> selectedNodes;

		private SlowTaskMonitor slowTaskMonitor;

		private MRUMenuManager mruMenuManager;

		private bool surpressBuildLoggerDialog;

		private IContainer components;

		private DotNetBarManager dotNetBarManager1;

		private DockSite dockSite4;

		private DockSite dockSite1;

		private DockSite dockSite2;

		private DockSite dockSite3;

		private DockSite dockSite5;

		private DockSite dockSite6;

		private DockSite dockSite7;

		private DockSite dockSite8;

		private StyleManager styleManager1;

		private Bar bar3;

		private ButtonItem buttonItemFile;

		private Bar bar4;

		private ButtonItem buttonItemOpenSolution;

		private ButtonItem buttonItemFileExit;

		private DockSite dockSite9;

		private Bar bar2;

		private PanelDockContainer panelDockContainer1;

		private DockContainerItem dockContainerItem1;

		private Node node3;

		private Node node4;

		private Node node7;

		private Node node8;

		private ImageList imageListBuildLog;

		private ButtonItem buttonItemFileExcludeTileSet;

		private ButtonItem buttonItemImport;

		private ButtonItem buttonItemBuildSolution;

		private ButtonItem buttonItemToolbarNewSolution;

		private ComboItem comboItem1;

		private ComboItem comboItem2;

		private ComboItem comboItem3;

		private ComboItem comboItem4;

		private Bar bar6;

		private PanelDockContainer panelDockContainer5;

		private DockContainerItem dockContainerItem5;

		private Cell cell3;

		private Bar bar8;

		private ComboItem comboItem5;

		private ComboItem comboItem6;

		private Cell cell1;

		private Cell cell2;

		private Cell cell5;

		private PanelDockContainer panelDockContainer8;

		private DockContainerItem dockContainerItem8;

		private ButtonItem buttonItemTileSetImport;

		private ButtonItem buttonItemTileSetImportSingleAsset;

		private ButtonItem buttonItemTileSetImportBatch;

		private ButtonItem buttonItemTileSetImportFromScript;

		private ButtonItem buttonItemImportSingleAsset;

		private ButtonItem buttonItemBatchImport;

		private ButtonItem buttonItemImportFromScript;

		private ButtonItem buttonItemFileNewSolution;

		private ButtonItem buttonItemFileOpenSolution;

		private AdvTree advTree3;

		private DevComponents.AdvTree.ColumnHeader columnHeader5;

		private DevComponents.AdvTree.ColumnHeader columnHeader6;

		private Node node18;

		private Node node20;

		private Node node23;

		private Node node24;

		private Node node25;

		private Node node26;

		private Node node27;

		private Cell cell10;

		private Node node28;

		private Node node29;

		private Node node30;

		private Node node31;

		private Node node32;

		private Node node33;

		private NodeConnector nodeConnector3;

		private ElementStyle elementStyle3;

		private Node node34;

		private AdvTree advTree1;

		private DevComponents.AdvTree.ColumnHeader columnHeader3;

		private DevComponents.AdvTree.ColumnHeader columnHeader4;

		private Node node1;

		private Node node2;

		private Node node5;

		private Node node6;

		private Node node9;

		private Node node10;

		private Node node35;

		private Cell cell4;

		private Node node36;

		private Node node37;

		private Node node38;

		private Node node39;

		private Node node41;

		private Node node42;

		private NodeConnector nodeConnector4;

		private ElementStyle elementStyle2;

		private AdvTree advTree2;

		private DevComponents.AdvTree.ColumnHeader columnHeader7;

		private DevComponents.AdvTree.ColumnHeader columnHeader8;

		private Node node11;

		private Node node17;

		private Node node19;

		private Node node12;

		private Node node13;

		private Node node14;

		private Node node15;

		private Cell cell6;

		private Node node16;

		private Node node21;

		private Node node22;

		private Node node40;

		private Node node43;

		private Node node44;

		private NodeConnector nodeConnector1;

		private ElementStyle elementStyle1;

		private Node node45;

		private Node node46;

		private Node node47;

		private Node node48;

		private NodeConnector nodeConnector2;

		private ElementStyle elementStyle8;

		private ElementStyle elementStyle4;

		private ButtonItem buttonItemBuild;

		private ButtonItem buttonItemBuildBuildSolution;

		private ButtonItem buttonItemBuildRebuildSolution;

		private ButtonItem buttonItemBuildCleanSolution;

		private ButtonItem buttonItemTileSet;

		private ButtonItem buttonItemTileSetOpenViewer;

		private ButtonItem buttonItemTileSetOpenExplorer;

		private ButtonItem buttonItemHelp;

		private ButtonItem buttonItemHelpAbout;

		private ButtonItem buttonItemTileSetProperties;

		private Cell cell7;

		private Cell cell9;

		private Cell cell8;

		private Cell cell11;

		private ButtonItem buttonItemHelpOnlineDocs;

		private ButtonItem buttonItemRescan;

		private SolutionTree solutionTree;

		private AssetDetails assetDetails;

		private BuildSummaryDetails buildSummaryDetails;

		private ContextMenuStrip contextMenuStripAssetSelected;

		private ToolStripMenuItem toolStripMenuItemRemoveAsset;

		private ButtonItem buttonItemViewGTS;

		private ToolStripMenuItem importSingleAssetToolStripMenuItem;

		private ToolStripMenuItem singleAssetToolStripMenuItem;

		private ToolStripMenuItem batchImportToolStripMenuItem;

		private ToolStripMenuItem fromImportScriptToolStripMenuItem;

		private ToolStripMenuItem toolStripMenuItem1;

		private ToolStripMenuItem openTileSetToolStripMenuItem;

		private ContextMenuStrip contextMenuStripRightClickProject;

		private ButtonItem buttonRebuild;

		private ButtonItem buttonClean;

		private ToolStripSeparator seperatorToolStripMenuItem;

		private ToolStripSeparator seperator2ToolStripMenuItem;

		private ToolTip ToolTip;

		private ButtonItem buttonItemOpenlog;

		private ButtonItem buttonItemTileSetExportToScript;

		private ButtonItem buttonItemFileCloseSolution;

		private ButtonItem buttonRescan;

		private ToolStripMenuItem showTileSetInWindowsExplorerToolStripMenuItem;

		private ToolStripMenuItem copyOutputFileNameToolStripMenuItem;

		private ButtonItem buttonItemFileMRU;

		private ButtonItem buttonItemList;

		private ToolStripMenuItem buildToolStripMenuItem;

		private ToolStripMenuItem rebuildToolStripMenuItem;

		private ToolStripMenuItem cleanToolStripMenuItem;

		private ToolStripSeparator toolStripSeparator1;

		private ButtonItem buttonItemBuildBuildProject;

		private ButtonItem buttonItemBuildRebuildProject;

		private ButtonItem buttonItemBuildCleanProject;

		private ToolStripMenuItem toolStripMenuItemRenameAsset;

		private ToolStripSeparator toolStripSeparator2;

		private ToolStripMenuItem excludeFromSolutionToolStripMenuItem;

		private ButtonItem buttonItemFileAddNewTileSet;

		private ToolStripMenuItem toolStripMenuItemEditAsset;

		private ButtonItem buttonItemBuildRepageSolution;

		private ButtonItem buttonItem1;

		private ButtonItem buttonItemBuildRepageProject;

		private ButtonItem buttonItemFilter;

		private ButtonItem buttonItemFileMigrateTextures;

		private ToolStripSeparator toolStripSeparator3;

		private ToolStripMenuItem toolStripMenuItemMigrateAsset;

		private MessageBar readOnlyMessageBar;

		private ButtonItem buttonItemBuildBuildProjectForGTex;

		private ButtonItem buttonItemBuildBuildSolutionForGTexStreaming;

		private ButtonItem buttonItemBuildRebuildProjectForGTex;

		private ButtonItem buttonItemBuildRebuildSolutionForGTex;

		public AutoBuildReport AutoBuildReport { get; private set; }

		public MainForm()
		{
			InitializeComponent();
			StudioLogger.Global.SetOwnerWindow(this);
			AutoBuildReport = new AutoBuildReport();
			selectedNodes = new List<Guid>();
			try
			{
				string fullName = new FileInfo(Assembly.GetEntryAssembly().Location).Directory.FullName;
				string currentDirectory = Directory.GetCurrentDirectory();
				Directory.SetCurrentDirectory(fullName);
				GraphineLicenseManager.License.CheckLicenseAndActivate("Granite SDK", new string[1] { "Granite 2" }, out var _, out var _);
				Directory.SetCurrentDirectory(currentDirectory);
			}
			catch (Exception ex)
			{
				MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
				Environment.Exit(1);
			}
			model = new SolutionModel();
			userSettings = new UserSettings(model);
			model.SolutionBuilder.SolutionClosing += userSettings.OnSolutionClosing;
			model.SolutionBuilder.SolutionLoaded += userSettings.OnSolutionLoaded;
			model.SolutionBuilder.ProjectAdded += userSettings.OnProjectAddedToSolution;
			model.SolutionBuilder.ProjectRemoved += userSettings.OnProjectRemovedFromSolution;
			solutionTree.Create(model);
			assetDetails.Create(model);
			model.ActiveProjectChanged += model_ActiveProjectChanged;
			model.ProjectStateChanged += model_ProjectStateChanged;
			model.ProjectOutputChanged += model_ProjectOutputChanged;
			model.AssetImportStarted += model_AssetImportStarted;
			model.AssetImportFinished += model_AssetImportFinished;
			model.AssetRemoving += model_AssetRemoving;
			model.SolutionBuilder.SolutionLoaded += SolutionBuilder_SolutionLoaded;
			model.SolutionBuilder.ProjectUpgrading += SolutionBuilder_ProjectUpgrading;
			openSolutionDialog = new OpenFileDialog();
			openSolutionDialog.Filter = DialogUtil.SolutionOpenDialogFilter;
			openScriptDialog = new OpenFileDialog();
			openScriptDialog.Filter = DialogUtil.ImportScriptOpenDialogFilter;
			saveScriptDialog = new SaveFileDialog();
			saveScriptDialog.Filter = DialogUtil.ImportScriptOpenDialogFilter;
			solutionTree.AssetNodeClicked += solutionTree_AssetNodeClicked;
			solutionTree.AssetNodeDoubleClicked += solutionTree_AssetNodeDoubleClicked;
			solutionTree.AssetNodeRightClicked += solutionTree_AssetNodeRightClicked;
			solutionTree.RightClicked += solutionTree_RightClicked;
			solutionTree.DeletePressed += solutionTree_DeletePressed;
			solutionTree.AssetRenamed += solutionTree_AssetRenamed;
			solutionTree.AssetMoveRequest += solutionTree_AssetMoveRequest;
			solutionTree.SelectionChanged += solutionTree_SelectionChanged;
			EnableContextualMenus();
			buildSummaryDetails.SetProject(null);
			assetDetails.Clear();
			assetDetails.AssetChanged += assetDetails_AssetChanged;
			readOnlyMessageBar.Visible = false;
			MRUManager mRUManager = new MRUManager(new MRUSerializerInRegistry("SOFTWARE\\Graphine\\TileSetStudio"), 5);
			mruMenuManager = new MRUMenuManager(mRUManager, buttonItemFileMRU, 50);
			mruMenuManager.MRUItemClicked += mruMenuManager_MRUItemClicked;
			string[] fileList = mRUManager.FileList;
			if (fileList != null && fileList.Length >= 1)
			{
				DialogUtil.SolutionLocation = Paths.GetDirectoryName(fileList[0]);
			}
		}

		private void SolutionBuilder_ProjectUpgrading(object sender, ProjectBuilder builder, ProjectBuilder.UpgradeInfo info)
		{
			if (base.InvokeRequired)
			{
				Invoke((Action)delegate
				{
					SolutionBuilder_ProjectUpgrading(sender, builder, info);
				});
			}
			else if (info.WillUpgradeCodingProfiles2dot7)
			{
				string text = $"The project '{builder.ActiveProject.Name}' will upgrade to the latest version. Layer compression formats and Stacked Texture's quality profiles could be altered. Please inspect them after loading.";
				MessageBox.Show(this, text, "Upgrading...", MessageBoxButtons.OK, MessageBoxIcon.Asterisk);
			}
		}

		private void solutionTree_SelectionChanged(object sender)
		{
			Guid activeProject = solutionTree.ActiveProject;
			if (!solutionTree.SelectedAssets.ContainsKey(activeProject) || (solutionTree.SelectedAssets.ContainsKey(activeProject) && solutionTree.SelectedAssets[activeProject].Count != 1))
			{
				assetDetails.Clear();
				return;
			}
			SolutionTree.NodeContext selectedAsset = solutionTree.SelectedAsset;
			AssetDetails.SelectionContext selection = default(AssetDetails.SelectionContext);
			switch (selectedAsset.Type)
			{
			case ProjectTree.AssetNodeType.AssetGroup:
				selection = new AssetDetails.SelectionContext(selectedAsset.ProjectId, selectedAsset.Asset.AssetGroupId);
				break;
			case ProjectTree.AssetNodeType.Asset:
				selection = new AssetDetails.SelectionContext(selectedAsset.ProjectId, selectedAsset.Asset.Id);
				break;
			case ProjectTree.AssetNodeType.Layer:
				selection = new AssetDetails.SelectionContext(selectedAsset.ProjectId, selectedAsset.Asset.Id, selectedAsset.Layer);
				break;
			case ProjectTree.AssetNodeType.Texture:
				selection = new AssetDetails.SelectionContext(selectedAsset.ProjectId, selectedAsset.Asset.Id, selectedAsset.Layer, selectedAsset.Texture);
				break;
			}
			assetDetails.SetSelection(selection);
			EnableContextualMenus();
		}

		private void mruMenuManager_MRUItemClicked(object sender, string filename)
		{
			OpenSolution(filename);
		}

		private void buttonItemFileCloseSolution_Click(object sender, EventArgs e)
		{
			CloseSolution();
		}

		private void AskAndDeleteSelectedAssets()
		{
			if (selectedNodes.Count < 1)
			{
				return;
			}
			Guid id = model.ActiveSolutionProject.Id;
			bool flag = false;
			foreach (Guid selectedNode in selectedNodes)
			{
				Asset asset = model.FindAsset(id, selectedNode);
				if (asset != null && !string.IsNullOrEmpty(asset.AssetGroupId))
				{
					flag = true;
					break;
				}
			}
			string empty = string.Empty;
			if (flag)
			{
				empty = "Some of the selected Stacked Textures belong to Stacked Texture Groups. For these Stacked Textures, the entire group will be deleted. ";
				empty += "Are you sure that you want to delete the selected Stacked Textures?";
			}
			else
			{
				empty = "Are you sure that you want to delete " + selectedNodes.Count + " selected Stacked Textures?";
			}
			if (MessageBox.Show(this, empty, "Confirm", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.Yes)
			{
				DeleteSelectedAssets();
			}
		}

		private bool RenameSelectedAsset(ProjectTree.RenameAsset renameAsset)
		{
			if (renameAsset == null || renameAsset.assetId == Guid.Empty || string.IsNullOrEmpty(renameAsset.newName))
			{
				return false;
			}
			if (model.IsAssetNameAvailable(model.ActiveSolutionProject.Id, renameAsset.newName))
			{
				model.RenameAsset(model.ActiveSolutionProject.Id, renameAsset.assetId, renameAsset.newName);
				ProjectNodeModel projectNode = solutionTree.GetProjectNode(model.ActiveSolutionProject.Id);
				AssetDetails.SelectionContext selection = new AssetDetails.SelectionContext(model.ActiveSolutionProject.Id, projectNode.Tree.SelectedAsset.Asset.Id);
				assetDetails.SetSelection(selection);
				return true;
			}
			string text = $"The name {renameAsset.newName} is already used inside the project. Each asset needs to have an unique name";
			MessageBox.Show(this, text, "invalid name", MessageBoxButtons.OK, MessageBoxIcon.Hand);
			return false;
		}

		private void MoveAssets(Guid srcProjectId, List<Asset> assets, Guid destProjectId, bool keepCopy)
		{
			model.MoveAssets(srcProjectId, assets, destProjectId, keepCopy, MigrateAssetsForm.ConversionProblemsCallback);
		}

		private void solutionTree_DeletePressed(List<SolutionTree.NodeContext> contexts)
		{
			selectedNodes.Clear();
			foreach (SolutionTree.NodeContext context in contexts)
			{
				if (context.Type == ProjectTree.AssetNodeType.Asset || context.Type == ProjectTree.AssetNodeType.AssetGroup)
				{
					selectedNodes.Add(context.Asset.Id);
				}
			}
			AskAndDeleteSelectedAssets();
		}

		private bool solutionTree_AssetRenamed(ProjectTree.RenameAsset renameAsset)
		{
			return RenameSelectedAsset(renameAsset);
		}

		private void solutionTree_AssetMoveRequest(object sender, Guid srcProjectId, List<Asset> assets, Guid destProjectId, bool keepCopy)
		{
			MoveAssets(srcProjectId, assets, destProjectId, keepCopy);
		}

		private void removeToolStripMenuItem_Click(object sender, EventArgs e)
		{
			AskAndDeleteSelectedAssets();
		}

		private void renameStackedTextureToolStripMenuItem_Click(object sender, EventArgs e)
		{
			solutionTree.StartRename();
		}

		private void buttonItemTileSetImportSingleAsset_Click(object sender, EventArgs e)
		{
			ImportSingleAsset();
		}

		private void buttonItemFileExit_Click(object sender, EventArgs e)
		{
			Close();
		}

		private void buttonItemBuildSolution_Click(object sender, EventArgs e)
		{
			BuildSolution();
		}

		private void buttonItemBuildBuildSolution_Click(object sender, EventArgs e)
		{
			BuildSolution();
		}

		private void buttonItemBuildRepageSolution_Click(object sender, EventArgs e)
		{
			RepageSolution();
		}

		private void buttonItemBuildRebuildSolution_Click(object sender, EventArgs e)
		{
			RebuildSolution();
		}

		private void buttonItemBuildCleanSolution_Click(object sender, EventArgs e)
		{
			CleanSolution();
		}

		private void buttonItemBuildBuildProject_Click(object sender, EventArgs e)
		{
			BuildProject(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void buttonItemBuildRebuildProject_Click(object sender, EventArgs e)
		{
			RebuildProject(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void buttonItemBuildCleanProject_Click(object sender, EventArgs e)
		{
			CleanProject(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void buttonItemBuildRepageProject_Click(object sender, EventArgs e)
		{
			RepageProject(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void buttonItemRescan_Click(object sender, EventArgs e)
		{
			Rescan();
		}

		private void buttonItemHelpAbout_Click(object sender, EventArgs e)
		{
			new AboutBox().ShowDialog();
		}

		private void buttonItemTileSetProperties_Click(object sender, EventArgs e)
		{
			OpenProperties();
		}

		private void buttonItemTileSetImportBatch_Click(object sender, EventArgs e)
		{
			BatchImport();
		}

		private void buttonItemImportSingleAsset_Click(object sender, EventArgs e)
		{
			ImportSingleAsset();
		}

		private void buttonItemBatchImport_Click(object sender, EventArgs e)
		{
			BatchImport();
		}

		private void buttonItemTileSetOpenViewer_Click(object sender, EventArgs e)
		{
			OpenTileSetViewer();
		}

		private void buttonItemViewGTS_Click(object sender, EventArgs e)
		{
			OpenTileSetViewer();
		}

		private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
		{
			try
			{
				model.Close();
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e2)
			{
				StudioLogger.Global.LogException(e2);
			}
		}

		private void buttonItemFileOpenSolution_Click(object sender, EventArgs e)
		{
			OpenSolution();
		}

		private void buttonItemOpenSolution_Click(object sender, EventArgs e)
		{
			OpenSolution();
		}

		private void buttonItemTileSetImportFromScript_Click(object sender, EventArgs e)
		{
			ImportFromScript();
		}

		private void buttonItemImportFromScript_Click(object sender, EventArgs e)
		{
			ImportFromScript();
		}

		private void buttonItemTileSetExportToScript_Click(object sender, EventArgs e)
		{
			ExportToScript();
		}

		private void buildToolStripMenuItem_Click(object sender, EventArgs e)
		{
			BuildProject(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void rebuildToolStripMenuItem_Click(object sender, EventArgs e)
		{
			RebuildProject(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void cleanToolStripMenuItem_Click(object sender, EventArgs e)
		{
			CleanProject(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void buttonItemBuildBuildProjectForGTex_Click(object sender, EventArgs e)
		{
			BuildProjectForGTex(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void buttonItemBuildRebuildProjectForGTex_Click(object sender, EventArgs e)
		{
			RebuildProjectForGTex(model.ActiveProjectBuilder.ActiveProject.Id);
		}

		private void buttonItemBuildBuildSolutionForGTexStreaming_Click(object sender, EventArgs e)
		{
			BuildSolutionForGTex();
		}

		private void buttonItemBuildRebuildSolutionForGTex_Click(object sender, EventArgs e)
		{
			RebuildSolutionForGTex();
		}

		private void solutionTree_RightClicked(object sender, Point location)
		{
			contextMenuStripRightClickProject.Show(location);
		}

		private void SolutionBuilder_SolutionLoaded(object sender, Solution solution)
		{
			EnableContextualMenus();
		}

		private void model_AssetRemoving(object sender, Guid assetId, Guid projectId)
		{
			if (assetDetails.Asset != null && assetDetails.Asset.Id.Equals(assetId))
			{
				assetDetails.Clear();
			}
		}

		private void model_AssetImportFinished(object sender, ProjectBuilder builder)
		{
			if (surpressBuildLoggerDialog)
			{
				return;
			}
			if (slowTaskMonitor != null)
			{
				slowTaskMonitor.End();
			}
			if (buildLoggerReporter != null)
			{
				if (buildLoggerReporter.HasSomethingToReport)
				{
					buildLoggerReporter.AddFinishedMessage();
					buildLoggerReporter.ShowDialog();
				}
				buildLoggerReporter.StopListening();
			}
		}

		private void model_AssetImportStarted(object sender, ProjectBuilder builder)
		{
			if (!surpressBuildLoggerDialog)
			{
				buildLoggerReporter = new BuildLoggerReporter();
				buildLoggerReporter.StartListening(builder);
				slowTaskMonitor = new SlowTaskMonitor("Importing Stacked Textures", this);
				slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
				slowTaskMonitor.Start();
			}
		}

		private void assetDetails_AssetChanged(object sender, Asset asset, ProjectBuilder builder)
		{
			try
			{
				model.UpdateAsset(builder.ActiveProject.Id, asset);
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
		}

		private void solutionTree_AssetNodeRightClicked(object sender, List<SolutionTree.NodeContext> contexts, Point location)
		{
			selectedNodes.Clear();
			foreach (SolutionTree.NodeContext context in contexts)
			{
				if (context.Type == ProjectTree.AssetNodeType.Asset || context.Type == ProjectTree.AssetNodeType.AssetGroup)
				{
					selectedNodes.Add(context.Asset.Id);
				}
			}
			IsSolutionOrProjectReadOnly(out var projReadOnly, out var _);
			int count = selectedNodes.Count;
			toolStripMenuItemEditAsset.Enabled = count == 1 && !projReadOnly;
			toolStripMenuItemRenameAsset.Enabled = count == 1 && !projReadOnly;
			toolStripMenuItemRemoveAsset.Enabled = count > 0 && !projReadOnly;
			toolStripMenuItemMigrateAsset.Enabled = count > 0 && !projReadOnly;
			contextMenuStripAssetSelected.Show(location);
		}

		private void model_ActiveProjectChanged(object sender)
		{
			EnableContextualMenus();
			buildSummaryDetails.SetProject(model.ActiveProjectBuilder);
			if (model.ActiveSolutionProject != null)
			{
				ProjectNodeModel projectNode = solutionTree.GetProjectNode(model.ActiveSolutionProject.Id);
				if (projectNode != null && projectNode.Tree.SelectedAsset != null && solutionTree.SelectedAssets[model.ActiveSolutionProject.Id].Count == 1)
				{
					AssetDetails.SelectionContext selection = new AssetDetails.SelectionContext(model.ActiveSolutionProject.Id, projectNode.Tree.SelectedAsset.Asset.Id);
					assetDetails.SetSelection(selection);
				}
				else
				{
					AssetDetails.SelectionContext selection2 = new AssetDetails.SelectionContext(model.ActiveProjectBuilder.ActiveProject.Id, default(Guid));
					assetDetails.SetSelection(selection2);
				}
			}
			else
			{
				assetDetails.Clear();
			}
		}

		private void model_ProjectStateChanged(object sender, Guid projectId)
		{
			if (base.IsHandleCreated)
			{
				BeginInvoke((MethodInvoker)delegate
				{
					assetDetails.Clear();
				});
			}
			buildSummaryDetails.Reload();
		}

		private void model_ProjectOutputChanged(object sender, Guid projectId)
		{
			buildSummaryDetails.Reload();
		}

		private void EnableDisableMenuSubItems(ButtonItem bi, bool enable)
		{
			bi.Visible = enable;
			bi.Parent.Refresh();
		}

		private void EnableContextualMenus()
		{
			bool flag = model.ActiveSolutionProject != null;
			bool flag2 = model.SolutionBuilder.ActiveSolution != null;
			bool hasSelectedAssets = solutionTree.HasSelectedAssets;
			EnableDisableMenuSubItems(buttonItemTileSet, flag && flag2);
			EnableDisableMenuSubItems(buttonItemBuild, flag2);
			buttonRescan.Enabled = flag2;
			buttonClean.Enabled = flag2;
			buttonRebuild.Enabled = flag2;
			buttonItemFilter.Enabled = flag2;
			buttonItemViewGTS.Enabled = flag;
			buttonItemFileCloseSolution.Enabled = flag2;
			buttonItemBuildSolution.Enabled = flag2;
			EnableDisableMenuSubItems(buttonItemBuildBuildProject, flag);
			EnableDisableMenuSubItems(buttonItemBuildRebuildProject, flag);
			EnableDisableMenuSubItems(buttonItemBuildCleanProject, flag);
			string text = "selected project";
			if (flag && model != null && model.ActiveProjectBuilder != null)
			{
				text = model.ActiveProjectBuilder.ActiveProject.Name;
			}
			buttonItemBuildBuildProject.Text = "Build " + text;
			buttonItemBuildRebuildProject.Text = "Rebuild " + text;
			buttonItemBuildCleanProject.Text = "Clean " + text;
			IsSolutionOrProjectReadOnly(out var projReadOnly, out var solReadOnly);
			buttonItemFileAddNewTileSet.Enabled = flag2 && !solReadOnly;
			buttonItemFileExcludeTileSet.Enabled = flag2 && !solReadOnly;
			buttonItemFileMigrateTextures.Enabled = hasSelectedAssets && !model.ReadOnlyMode;
			buttonItemTileSetImport.Enabled = flag2 && !projReadOnly;
			buttonItemImport.Enabled = flag && !projReadOnly;
		}

		private void solutionTree_AssetNodeDoubleClicked(object sender, SolutionTree.NodeContext context)
		{
			if (context.Type == ProjectTree.AssetNodeType.Texture)
			{
				ShellTools.OpenExplorerAndSelect(context.Texture.Source);
			}
		}

		private void solutionTree_AssetNodeClicked(object sender, SolutionTree.NodeContext context)
		{
		}

		private void SelectDefaultConfiguration()
		{
			solutionTree.SelectFirstProject();
		}

		public void SetStartupContext(StartupContext context)
		{
			startupContext = context;
		}

		private void ImportSingleAsset()
		{
			if (model.ActiveSolutionProject == null && model.ActiveProjectBuilder == null)
			{
				return;
			}
			ImportAssetForm importAssetForm = new ImportAssetForm(model, userSettings);
			importAssetForm.LayerConfig = model.ActiveProjectBuilder.ActiveProject.LayerConfiguration;
			importAssetForm.Text = "Add Single Stacked Texture in Tile Set '" + model.ActiveProjectBuilder.ActiveProject.Name + "'";
			if (importAssetForm.ShowDialog(this) == DialogResult.OK)
			{
				try
				{
					model.ImportAsset(importAssetForm.AssetImportDescription);
				}
				catch (UnspecifiedException ex)
				{
					StudioLogger.Global.LogError(ex.Message);
				}
				catch (Exception e)
				{
					StudioLogger.Global.LogException(e);
				}
			}
		}

		private void buttonItemFileNewSolution_Click(object sender, EventArgs e)
		{
			NewProjectForm newProjectForm = new NewProjectForm();
			newProjectForm.CreateNewSolutionDefault = true;
			newProjectForm.AllowUserNewSolutionCreation = true;
			newProjectForm.SolutionPath = DialogUtil.SolutionLocation;
			if (newProjectForm.ShowDialog() == DialogResult.OK)
			{
				if (model.ActiveSolution != null)
				{
					CloseSolution();
				}
				string text = "";
				if (!newProjectForm.SolutionName.EndsWith(Constants.SolutionExtension))
				{
					text = "." + Constants.SolutionExtension;
				}
				string fileName = Path.Combine(newProjectForm.SolutionPath, newProjectForm.SolutionName + text);
				CreateSolution(fileName, newProjectForm.ProjectName, newProjectForm.ProjectTemplate);
				DialogUtil.SolutionLocation = newProjectForm.SolutionPath;
			}
		}

		private bool CreateSolution(string fileName, string projectName, ProjectTemplate projectTemplate)
		{
			GrBuildLib.Error error = GrBuildLib.Error.Ok;
			try
			{
				error = model.SolutionBuilder.NewSolution(fileName);
				if (error != 0)
				{
					StudioLogger.Global.LogError("Could not create new solution. General error: " + error);
					return false;
				}
				if (model.ProjectExists(projectName))
				{
					string message = $"A project with the name '{projectName}' is already exists in the selected folder. Please choose a different project name or folder.";
					StudioLogger.Global.LogError(message);
					return false;
				}
				if (model.CreateProject(projectName, projectTemplate) != 0)
				{
					return false;
				}
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
				return false;
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
				return false;
			}
			mruMenuManager.AddMRUFile(fileName);
			return true;
		}

		private void OpenSolution()
		{
			openSolutionDialog.InitialDirectory = DialogUtil.SolutionLocation;
			if (openSolutionDialog.ShowDialog() == DialogResult.OK)
			{
				OpenSolution(openSolutionDialog.FileName);
			}
		}

		private bool OpenSolution(string filename)
		{
			slowTaskMonitor = new SlowTaskMonitor("Opening Project", this);
			slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
			slowTaskMonitor.Start();
			if (model.ActiveSolution != null)
			{
				CloseSolution();
			}
			GrBuildLib.Error error = GrBuildLib.Error.Ok;
			try
			{
				error = model.SolutionBuilder.LoadSolution(filename, createIfNotExist: false);
			}
			catch (UnspecifiedException ex)
			{
				if (slowTaskMonitor != null)
				{
					slowTaskMonitor.End();
					slowTaskMonitor = null;
				}
				string message = string.Format("Could not load solution. Detailed error message: '{0}'. Error code: '{1}'.", new object[2] { ex.Message, ex.ErrorCode });
				StudioLogger.Global.LogError(message);
			}
			catch (GrInvalidProjectCompatibilityVersionException ex2)
			{
				if (slowTaskMonitor != null)
				{
					slowTaskMonitor.End();
					slowTaskMonitor = null;
				}
				StudioLogger.Global.LogError(ex2.Message);
			}
			catch (Exception ex3)
			{
				if (slowTaskMonitor != null)
				{
					slowTaskMonitor.End();
					slowTaskMonitor = null;
				}
				UnspecifiedException e = new UnspecifiedException($"Could not load solution. Detailed error message: '{ex3.Message}'.", ex3);
				StudioLogger.Global.LogException(e);
			}
			switch (error)
			{
			case GrBuildLib.Error.SolutionLocked:
				if (slowTaskMonitor != null)
				{
					slowTaskMonitor.End();
					slowTaskMonitor = null;
				}
				StudioLogger.Global.LogError("Solution is already open in another instance. Please close the other instance or open a different solution.");
				SelectDefaultConfiguration();
				return true;
			default:
				mruMenuManager.RemoveMRUFile(filename);
				StudioLogger.Global.LogError("Could not open solution. General error: " + error);
				SelectDefaultConfiguration();
				if (slowTaskMonitor != null)
				{
					slowTaskMonitor.End();
					slowTaskMonitor = null;
				}
				return false;
			case GrBuildLib.Error.Ok:
				SelectDefaultConfiguration();
				if (slowTaskMonitor != null)
				{
					slowTaskMonitor.End();
					slowTaskMonitor = null;
				}
				mruMenuManager.AddMRUFile(filename);
				DialogUtil.SolutionLocation = Paths.GetDirectoryName(filename);
				UpdateReadOnlyMode();
				UpdateDialogTitle();
				return true;
			}
		}

		private void UpdateDialogTitle()
		{
			if (model != null && model.ActiveSolution != null)
			{
				Text = model.ActiveSolution.Name + " - Tile Set Studio";
			}
			else
			{
				Text = "Tile Set Studio";
			}
		}

		private void buttonItemToolbarNewSolution_Click(object sender, EventArgs e)
		{
			buttonItemFileNewSolution_Click(sender, e);
		}

		private void BuildSolution()
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			ProjectBuildOptions projectBuildOptions = new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset);
			buildForm.ShowAndBuild(Task.Build, projectBuildOptions);
		}

		private void BuildSolutionForGTex()
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			ProjectBuildOptions projectBuildOptions = new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTex, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset);
			buildForm.ShowAndBuild(Task.Build, projectBuildOptions);
		}

		private void RebuildSolutionForGTex()
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			ProjectBuildOptions projectBuildOptions = new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTex, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset);
			buildForm.ShowAndBuild(Task.Rebuild, projectBuildOptions);
		}

		private void RebuildSolution()
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			ProjectBuildOptions projectBuildOptions = new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset);
			buildForm.ShowAndBuild(Task.Rebuild, projectBuildOptions);
		}

		private void CleanSolution()
		{
			CleanForm cleanForm = new CleanForm();
			if (cleanForm.ShowDialog() == DialogResult.OK)
			{
				BuildForm buildForm = new BuildForm(this);
				buildForm.Create(model);
				buildForm.ShowAndBuild(projectBuildOptions: new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset), task: Task.Clean, cleanParams: cleanForm.CleanParameters);
			}
		}

		private void RepageSolution()
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			ProjectBuildOptions projectBuildOptions = new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset);
			buildForm.ShowAndBuild(Task.Repage, projectBuildOptions);
		}

		private void BuildProject(Guid projectID)
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			buildForm.ShowAndBuild(projectBuildOptions: new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset), task: Task.Build, projectIds: new Guid[1] { projectID });
		}

		private void BuildProjectForGTex(Guid projectID)
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			buildForm.ShowAndBuild(projectBuildOptions: new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTex, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset), task: Task.Build, projectIds: new Guid[1] { projectID });
		}

		private void RebuildProjectForGTex(Guid projectID)
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			buildForm.ShowAndBuild(projectBuildOptions: new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTex, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset), task: Task.Rebuild, projectIds: new Guid[1] { projectID });
		}

		private void RebuildProject(Guid projectID)
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			buildForm.ShowAndBuild(projectBuildOptions: new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset), task: Task.Rebuild, projectIds: new Guid[1] { projectID });
		}

		private void CleanProject(Guid projectID)
		{
			CleanForm cleanForm = new CleanForm();
			if (cleanForm.ShowDialog() == DialogResult.OK)
			{
				BuildForm buildForm = new BuildForm(this);
				buildForm.Create(model);
				buildForm.ShowAndBuild(projectBuildOptions: new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset), task: Task.Clean, projectIds: new Guid[1] { projectID }, cleanParams: cleanForm.CleanParameters);
			}
		}

		private void RepageProject(Guid projectID)
		{
			BuildForm buildForm = new BuildForm(this);
			buildForm.Create(model);
			buildForm.ShowAndBuild(projectBuildOptions: new ProjectBuildOptions(GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset), task: Task.Repage, projectIds: new Guid[1] { projectID });
		}

		private void MainForm_Load(object sender, EventArgs e)
		{
			if (!startupContext.hideMainWindow)
			{
				BeginInvoke((MethodInvoker)delegate
				{
					LoadAndBuild();
				});
			}
		}

		public void LoadAndBuild()
		{
			AutoBuildReport = new AutoBuildReport();
			if (startupContext.solutionToLoadPath != null)
			{
				OpenSolution(startupContext.solutionToLoadPath);
			}
			if (!startupContext.buildSolution)
			{
				return;
			}
			TargetConfiguration targetConfiguration = TargetConfiguration.Optimized;
			try
			{
				model.SetTargetConfiguration(targetConfiguration);
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
			BuildForm buildForm = new BuildForm(this, FormMode.Standalone);
			buildForm.Create(model);
			buildForm.CloseOnFinished = startupContext.quitAfterSuccessBuild;
			buildForm.ForceCloseOnFinished = startupContext.silentAtlasErrors;
			Task task = (startupContext.rebuildSolution ? Task.Rebuild : Task.Build);
			ProjectBuildOptions projectBuildOptions = new ProjectBuildOptions(startupContext.buildForGtex ? GrBuildLib.BuildMode.BuildForGTex : GrBuildLib.BuildMode.BuildForGTP, startupContext.allowForeignGtex, startupContext.forceGtex, startupContext.buildnotileset);
			buildForm.ShowAndBuild(task, projectBuildOptions);
			if (!buildForm.ErrorOccurred() && startupContext.quitAfterSuccessBuild)
			{
				Close();
			}
			if (buildForm.ErrorOccurred())
			{
				AutoBuildReport.ErrorsOccurred = true;
				if (buildForm.AtlassingErrorOccurred() && startupContext.silentAtlasErrors)
				{
					AutoBuildReport.AtlassingErrorsOccurred = true;
					Close();
				}
			}
		}

		private void buttonItemFileAddNewTileSet_Click(object sender, EventArgs e)
		{
			NewProjectForm newProjectForm = new NewProjectForm();
			newProjectForm.CreateNewSolutionDefault = false;
			newProjectForm.AllowUserNewSolutionCreation = false;
			newProjectForm.SolutionPath = model.SolutionBuilder.ActiveSolutionFullPath;
			newProjectForm.ProjectName = UserExperience.SuggestProjectName(model);
			if (newProjectForm.ShowDialog() != DialogResult.OK)
			{
				return;
			}
			try
			{
				if (model.HasProject(newProjectForm.ProjectName))
				{
					string message = $"A project with the name '{newProjectForm.ProjectName}' is already in the solution. Please choose a different name.";
					StudioLogger.Global.LogError(message);
				}
				else if (model.ProjectExists(newProjectForm.ProjectName))
				{
					string message2 = $"A project with the name '{newProjectForm.ProjectName}' is already exists in the selected folder. Please choose a different project name or folder.";
					StudioLogger.Global.LogError(message2);
				}
				else
				{
					model.CreateProject(newProjectForm.ProjectName, newProjectForm.ProjectTemplate);
				}
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e2)
			{
				StudioLogger.Global.LogException(e2);
			}
		}

		private void buttonItemHelpOnlineDocs_Click(object sender, EventArgs e)
		{
			System.Diagnostics.Process.Start(Constants.OnlineDocumentationUrl);
		}

		private void ImportFromScript()
		{
			ProjectSettings projectSettings = userSettings.Solution[model.ActiveProjectBuilder.ActiveProject.Id];
			if (projectSettings != null)
			{
				openScriptDialog.InitialDirectory = projectSettings.ImportScriptLocation;
			}
			if (openScriptDialog.ShowDialog() == DialogResult.OK)
			{
				try
				{
					model.ImportFromScript(openScriptDialog.FileName);
				}
				catch (GrXmlException ex)
				{
					StudioLogger.Global.LogError("A parsing error occurred when parsing the XML file. Details of the error: " + ((Exception)(object)ex).Message + " Please consult the documentation for more information on XML script syntax.");
					return;
				}
				catch (InvalidLayerConfigurationException ex2)
				{
					StudioLogger.Global.LogError("A parsing error occurred when parsing the XML file: an invalid layer configuration was found. Details of the error: " + ex2.Message + " Please consult the documentation for more information on XML script syntax.");
					return;
				}
				catch (MissingLayerConfigurationException ex3)
				{
					StudioLogger.Global.LogError("A parsing error occurred when parsing the XML file: no layer configuration was found. Details of the error: " + ex3.Message + " Please consult the documentation for more information on XML script syntax.");
					return;
				}
				catch (IOException ex4)
				{
					StudioLogger.Global.LogError("The file '" + openScriptDialog.FileName + "' could not be found or not read. Details of the error: " + ex4.Message + " Please make sure the file is accessible.");
					return;
				}
				catch (Exception ex5)
				{
					StudioLogger.Global.LogError("Unspecified error when importing file '" + openScriptDialog.FileName + "'. Details of the error: " + ex5.Message + " Contact Graphine if the error persists.");
					return;
				}
				if (projectSettings != null)
				{
					projectSettings.ImportScriptLocation = Paths.GetDirectoryName(openScriptDialog.FileName);
					userSettings.Solution[model.ActiveProjectBuilder.ActiveProject.Id] = projectSettings;
				}
			}
		}

		private void OpenTileSetViewer()
		{
			try
			{
				Directory.SetCurrentDirectory(model.ActiveProjectBuilder.GetProjectPath());
				ShellTools.OpenGTSInViewer(Path.Combine(model.ActiveProjectBuilder.ActiveProject.BuildConfiguration.OutputDirectory, model.ActiveProjectBuilder.ActiveProject.BuildConfiguration.OutputFilename));
			}
			catch
			{
				StudioLogger.Global.LogError("Unable to open file in viewer.");
			}
		}

		private void DeleteSelectedAssets()
		{
			if (selectedNodes.Count != 0)
			{
				slowTaskMonitor = new SlowTaskMonitor("Removing Stacked Texture(s)", this);
				slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
				slowTaskMonitor.Start();
				buildLoggerReporter = new BuildLoggerReporter();
				buildLoggerReporter.StartListening(model.ActiveProjectBuilder);
				try
				{
					model.RemoveAssets(selectedNodes, autoRemoveGroups: true);
				}
				catch (UnspecifiedException ex)
				{
					StudioLogger.Global.LogError(ex.Message);
				}
				catch (Exception e)
				{
					StudioLogger.Global.LogException(e);
				}
				selectedNodes.Clear();
				assetDetails.SetSelection(new AssetDetails.SelectionContext(model.ActiveSolutionProject.Id, default(Guid)));
				if (buildLoggerReporter.HasSomethingToReport)
				{
					buildLoggerReporter.AddFinishedMessage("deleting");
					buildLoggerReporter.ShowDialog();
				}
				buildLoggerReporter.StopListening();
				SelectDefaultConfiguration();
				if (slowTaskMonitor != null)
				{
					slowTaskMonitor.End();
				}
			}
		}

		private void ClearAssetQualityProfiles(ProjectBuilder builder, bool[] layerChanged)
		{
			for (int i = 0; i < layerChanged.Length; i++)
			{
				if (!layerChanged[i])
				{
					continue;
				}
				foreach (Asset value in builder.ActiveProject.Assets.Values)
				{
					value.AssetLayers[i].QualityProfile = "default";
				}
			}
		}

		private void UpdateAssetPackingModes(ProjectBuilder builder, bool[] layerChanged)
		{
			for (int i = 0; i < layerChanged.Length; i++)
			{
				if (!layerChanged[i])
				{
					continue;
				}
				DataType dataType = builder.ActiveProject.LayerConfiguration.Layers[i].DataType;
				foreach (Asset value in builder.ActiveProject.Assets.Values)
				{
					AssetPackingMode packingMode = value.AssetLayers[i].PackingMode;
					if (!ChannelMerging.isValidPackingModeForDataType(dataType, packingMode))
					{
						int count = value.AssetLayers[i].Textures.Count;
						value.AssetLayers[i].PackingMode = ChannelMerging.UpdatePackingMode(dataType, packingMode, count);
						int maxSubIdx = ChannelMerging.GetMaxValidSubTextureIdx(value.AssetLayers[i].PackingMode);
						value.AssetLayers[i].Textures.RemoveAll((Texture _tex) => _tex.SubIndex > maxSubIdx);
					}
				}
			}
		}

		private void OpenProperties()
		{
			if (model.ActiveProjectBuilder == null)
			{
				return;
			}
			slowTaskMonitor = new SlowTaskMonitor("Preparing Properties", this);
			slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
			slowTaskMonitor.Start();
			bool readOnly = model.ActiveProjectBuilder.ReadOnly;
			ProjectPropertiesForm projectPropertiesForm = new ProjectPropertiesForm(readOnly);
			projectPropertiesForm.Properties = GetProjectProperties();
			projectPropertiesForm.ProjectPath = model.ActiveProjectBuilder.GetProjectPath();
			projectPropertiesForm.ProjectBuilder = model.ActiveProjectBuilder;
			projectPropertiesForm.Text = "Project '" + model.ActiveProjectBuilder.ActiveProject.Name + "' Properties";
			slowTaskMonitor.End();
			if (projectPropertiesForm.ShowDialog(this) == DialogResult.OK && !readOnly)
			{
				SetProjectProperties(projectPropertiesForm.Properties);
				if (projectPropertiesForm.Properties.CodingProfileChanged)
				{
					ClearAssetQualityProfiles(model.ActiveProjectBuilder, projectPropertiesForm.Properties.CodingProfileLayerChanged);
				}
				if (projectPropertiesForm.Properties.DataTypesChanged)
				{
					UpdateAssetPackingModes(model.ActiveProjectBuilder, projectPropertiesForm.Properties.DataTypeLayerChanged);
				}
				Rescan();
			}
		}

		private void SetProjectProperties(ProjectProperties properties)
		{
			slowTaskMonitor = new SlowTaskMonitor("Setting Properties", this);
			slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
			slowTaskMonitor.Start();
			try
			{
				model.UpdateProfiles(properties.BuildProfile);
				model.UpdateGTSOutputFilename(properties.OutputFilename);
				model.UpdateSoupOutputFilename(properties.SoupOutputFolder);
				model.UpdatePageFiles(properties.PagesFolder);
				model.UpdatePatching(properties.Patching);
				model.UpdateHighQualityCoding(properties.HighQualityCoding);
				model.UpdateNoUniform(properties.NoUniformCoding);
				model.UpdateNoRedirection(properties.NoRedirection);
				model.UpdateNoSharedMips(properties.NoSharedMipGeneration);
				model.UpdateMipStripping(properties.MipStripping);
				model.UpdateMaxAnisotropy(properties.MaxAnisotropy);
				model.UpdateTargetDisk(properties.TargetDisk);
				model.UpdatePageSize(properties.PageSize);
				model.UpdateTileSize(properties.TileWidth, properties.TileHeight);
				model.UpdateTilingmode(properties.TilingMode);
				model.UpdatePagingStrategy(properties.PagingStrategy);
				model.UpdateLayerConfiguration(properties.LayerConfiguration);
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
			slowTaskMonitor.End();
		}

		private ProjectProperties GetProjectProperties()
		{
			ProjectProperties projectProperties = new ProjectProperties();
			ProjectBuilder activeProjectBuilder = model.ActiveProjectBuilder;
			Project activeProject = activeProjectBuilder.ActiveProject;
			projectProperties.ProjectName = activeProject.Name;
			projectProperties.BuildProfile = activeProject.BuildProfile;
			projectProperties.OutputFilename = Path.Combine(activeProject.BuildConfiguration.OutputDirectory, activeProject.BuildConfiguration.OutputFilename);
			projectProperties.SoupOutputFolder = activeProject.BuildConfiguration.SoupOutputDirectory;
			projectProperties.NoUniformCoding = !activeProjectBuilder.EnableUniformCoding;
			projectProperties.Patching = !activeProjectBuilder.NoPatching;
			projectProperties.NoSharedMipGeneration = !activeProjectBuilder.EnableSharedMipGeneration;
			projectProperties.MipStripping = activeProjectBuilder.EnableMipStripping;
			projectProperties.NoRedirection = !activeProjectBuilder.EnableRedirection;
			projectProperties.HighQualityCoding = activeProjectBuilder.EnableHighQualityCoding;
			projectProperties.PagesFolder = activeProject.BuildConfiguration.PagesDirectory;
			projectProperties.MaxAnisotropy = activeProject.BuildConfiguration.MaximumAnisotropy;
			projectProperties.TileHeight = activeProject.BuildConfiguration.TileHeight;
			projectProperties.TileWidth = activeProject.BuildConfiguration.TileWidth;
			projectProperties.PageSize = activeProject.BuildConfiguration.PageSize;
			projectProperties.TargetDisk = activeProject.BuildConfiguration.TargetDisk;
			projectProperties.TilingMode = activeProject.BuildConfiguration.TilingMode;
			projectProperties.PagingStrategy = activeProject.BuildConfiguration.PagingStrategy;
			projectProperties.LayerConfiguration = activeProject.LayerConfiguration;
			return projectProperties;
		}

		private void BatchImport()
		{
			if (model.ActiveSolutionProject == null)
			{
				return;
			}
			BatchImportAssetsForm batchImportAssetsForm = new BatchImportAssetsForm(model.ActiveProjectBuilder.ActiveProject.LayerConfiguration, model, userSettings);
			batchImportAssetsForm.Text = "Add Multiple Stacked Textures in Tile Set '" + model.ActiveProjectBuilder.ActiveProject.Name + "'";
			if (batchImportAssetsForm.ShowDialog(this) == DialogResult.OK)
			{
				try
				{
					model.ImportAssetTemplate(batchImportAssetsForm.LayerTemplateImportDescription);
				}
				catch (UnspecifiedException ex)
				{
					StudioLogger.Global.LogError(ex.Message);
				}
				catch (Exception e)
				{
					StudioLogger.Global.LogException(e);
				}
			}
		}

		private void buttonItemOpenlog_Click(object sender, EventArgs e)
		{
			try
			{
				string fullPath = Path.GetFullPath(model.ActiveProjectBuilder.GetProjectPath());
				string logFile = model.ActiveProjectBuilder.ActiveProject.BuildConfiguration.LogFile;
				System.Diagnostics.Process.Start(Path.Combine(fullPath, logFile));
			}
			catch
			{
				StudioLogger.Global.LogError("Unable to open log file.");
			}
		}

		private void ExportToScript()
		{
			ProjectSettings projectSettings = userSettings.Solution[model.ActiveProjectBuilder.ActiveProject.Id];
			if (projectSettings != null)
			{
				saveScriptDialog.InitialDirectory = projectSettings.ExportScriptLocation;
			}
			saveScriptDialog.FileName = model.ActiveProjectBuilder.ActiveProject.Name + ".xml";
			if (saveScriptDialog.ShowDialog() == DialogResult.OK)
			{
				slowTaskMonitor = new SlowTaskMonitor("Exporting", this);
				slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
				slowTaskMonitor.Start();
				bool flag = false;
				try
				{
					flag = model.ExportToImportScript(saveScriptDialog.FileName);
				}
				catch (UnspecifiedException ex)
				{
					StudioLogger.Global.LogError(ex.Message);
				}
				catch (Exception e)
				{
					StudioLogger.Global.LogException(e);
				}
				slowTaskMonitor.End();
				if (flag)
				{
					StudioLogger.Global.LogInfo("Successfully exported to file.");
				}
				else
				{
					StudioLogger.Global.LogError("Failed to export to XML import script.");
				}
				if (projectSettings != null)
				{
					projectSettings.ExportScriptLocation = Paths.GetDirectoryName(saveScriptDialog.FileName);
					userSettings.Solution[model.ActiveProjectBuilder.ActiveProject.Id] = projectSettings;
				}
			}
		}

		private void Rescan()
		{
			slowTaskMonitor = new SlowTaskMonitor("Rescanning Stacked Textures", this);
			slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
			slowTaskMonitor.Start();
			try
			{
				model.ScanAssets();
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
			slowTaskMonitor.End();
		}

		private void CloseSolution()
		{
			try
			{
				model.Close();
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
			ShowFilterBar(show: false);
			EnableContextualMenus();
			solutionTree.Delete();
			buildSummaryDetails.Reload();
			assetDetails.Clear();
			UpdateDialogTitle();
			UpdateReadOnlyMode();
		}

		protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
		{
			if (model != null && model.ActiveSolution != null)
			{
				switch (keyData)
				{
				case Keys.R | Keys.Control:
					Rescan();
					return true;
				case Keys.B | Keys.Shift | Keys.Control:
					BuildSolution();
					return true;
				case Keys.R | Keys.Shift | Keys.Control:
					RebuildSolution();
					return true;
				case Keys.C | Keys.Shift | Keys.Control:
					CleanSolution();
					return true;
				case Keys.I | Keys.Control:
					ImportSingleAsset();
					return true;
				case Keys.I | Keys.Shift | Keys.Control:
					BatchImport();
					return true;
				case Keys.P | Keys.Control:
					ImportFromScript();
					return true;
				case Keys.F | Keys.Control:
					ShowFilterBar(show: true);
					return true;
				default:
					return base.ProcessCmdKey(ref msg, keyData);
				}
			}
			return base.ProcessCmdKey(ref msg, keyData);
		}

		private void showTileSetInWindowsExplorerToolStripMenuItem_Click(object sender, EventArgs e)
		{
			ShellTools.OpenGtsInExplorer(model.ActiveProjectBuilder);
		}

		private void copyOutputFileNameToolStripMenuItem_Click(object sender, EventArgs e)
		{
			string gtsPath = ShellTools.GetGtsPath(model.ActiveProjectBuilder);
			if (gtsPath != null)
			{
				ClipboardHelper.CopyText(gtsPath);
			}
		}

		private void excludeFromSolutionToolStripMenuItem_Click(object sender, EventArgs e)
		{
			ExcludeSelectedProjectFromSolution();
		}

		private void excludeFromSolutionMenu_Click(object sender, EventArgs e)
		{
			ExcludeSelectedProjectFromSolution();
		}

		private void ExcludeSelectedProjectFromSolution()
		{
			if (model.ActiveProjectBuilder != null)
			{
				DeleteProjectForm deleteProjectForm = new DeleteProjectForm();
				deleteProjectForm.InitForProject(model);
				deleteProjectForm.ShowDialog(this);
			}
		}

		private void editToolStripMenuItem_Click(object sender, EventArgs e)
		{
			EditSelectedAsset();
		}

		private void EditSelectedAsset()
		{
			if (selectedNodes.Count < 1 || (model.ActiveSolutionProject == null && model.ActiveProjectBuilder == null))
			{
				return;
			}
			Guid id = model.ActiveSolutionProject.Id;
			Asset asset = model.FindAsset(id, selectedNodes[0]);
			if (asset == null)
			{
				return;
			}
			if (!string.IsNullOrEmpty(asset.AssetGroupId) && asset.Face != 0)
			{
				asset = model.FindFirstAssetInGroup(id, asset.AssetGroupId);
				if (asset == null)
				{
					return;
				}
			}
			ImportAssetForm importAssetForm = new ImportAssetForm(model, userSettings);
			importAssetForm.LayerConfig = model.ActiveProjectBuilder.ActiveProject.LayerConfiguration;
			importAssetForm.Text = "Editing " + asset.Name;
			importAssetForm.AssetToEdit = asset;
			if (importAssetForm.ShowDialog(this) != DialogResult.OK)
			{
				return;
			}
			try
			{
				if (importAssetForm.AssetImportDescription.Type != asset.Type)
				{
					List<Guid> list = new List<Guid>();
					list.Add(asset.Id);
					model.RemoveAssets(list, asset.Type == AssetType.CubeMap);
					model.ImportAsset(importAssetForm.AssetImportDescription);
				}
				else
				{
					if (importAssetForm.AssetImportDescription.Name != asset.Name)
					{
						model.RenameAsset(id, asset.Id, importAssetForm.AssetImportDescription.Name);
					}
					model.ReImportAsset(importAssetForm.AssetImportDescription);
				}
			}
			catch (UnspecifiedException ex)
			{
				StudioLogger.Global.LogError(ex.Message);
			}
			catch (Exception e)
			{
				StudioLogger.Global.LogException(e);
			}
		}

		private void buttonItemFilter_Click(object sender, EventArgs e)
		{
			ShowFilterBar(!buttonItemFilter.Checked);
		}

		private void ShowFilterBar(bool show)
		{
			solutionTree.EnableFilter(show);
			buttonItemFilter.Checked = show;
		}

		private void solutionTree_FilterBarClosed(object sender)
		{
			buttonItemFilter.Checked = false;
		}

		private void buttonItemTilesetMigrateTextures_Click(object sender, EventArgs e)
		{
			MigrateTextures();
		}

		private void toolStripMenuItemMigrateAsset_Click(object sender, EventArgs e)
		{
			MigrateTextures();
		}

		private void MigrateTextures()
		{
			surpressBuildLoggerDialog = true;
			MigrateAssetsForm migrateAssetsForm = new MigrateAssetsForm();
			migrateAssetsForm.Initialize(model, solutionTree.SelectedAssets);
			migrateAssetsForm.ShowDialog();
			surpressBuildLoggerDialog = false;
		}

		private void UpdateReadOnlyMode()
		{
			string empty = string.Empty;
			empty = ((model.SolutionBuilder.ReadOnly && !model.SolutionBuilder.ProjectsReadOnly) ? "The solution is opened in read-only mode. You can build and edit, but not add or delete projects." : ((model.SolutionBuilder.ReadOnly || !model.SolutionBuilder.ProjectsReadOnly) ? "The solution or one or more projects are opened in read-only mode. You can build but not add, delete, or edit projects." : "One or more projects are opened in read-only mode. You can build these projects but not edit them."));
			readOnlyMessageBar.MessageText = empty;
			bool visible = model != null && model.ReadOnlyMode;
			readOnlyMessageBar.Visible = visible;
		}

		private void IsSolutionOrProjectReadOnly(out bool projReadOnly, out bool solReadOnly)
		{
			projReadOnly = false;
			solReadOnly = false;
			if (model.ActiveSolutionProject == null || model.SolutionBuilder == null)
			{
				solReadOnly = true;
			}
			else
			{
				solReadOnly = model.SolutionBuilder.ReadOnly;
			}
			if (model.ActiveProjectBuilder == null)
			{
				projReadOnly = true;
			}
			else
			{
				projReadOnly = model.ActiveProjectBuilder.ReadOnly;
			}
		}

		private void contextMenuStripRightClickProject_Opening(object sender, CancelEventArgs e)
		{
			IsSolutionOrProjectReadOnly(out var projReadOnly, out var _);
			importSingleAssetToolStripMenuItem.Enabled = !projReadOnly;
			excludeFromSolutionToolStripMenuItem.Enabled = !projReadOnly;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.components = new System.ComponentModel.Container();
			System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(GrBuildStudio.MainForm));
			this.dotNetBarManager1 = new DevComponents.DotNetBar.DotNetBarManager(this.components);
			this.dockSite4 = new DevComponents.DotNetBar.DockSite();
			this.dockSite9 = new DevComponents.DotNetBar.DockSite();
			this.bar2 = new DevComponents.DotNetBar.Bar();
			this.panelDockContainer1 = new DevComponents.DotNetBar.PanelDockContainer();
			this.solutionTree = new GrBuildStudio.SolutionTree();
			this.dockContainerItem1 = new DevComponents.DotNetBar.DockContainerItem();
			this.dockSite1 = new DevComponents.DotNetBar.DockSite();
			this.dockSite2 = new DevComponents.DotNetBar.DockSite();
			this.bar8 = new DevComponents.DotNetBar.Bar();
			this.panelDockContainer8 = new DevComponents.DotNetBar.PanelDockContainer();
			this.buildSummaryDetails = new GrBuildStudio.BuildSummaryDetails();
			this.dockContainerItem8 = new DevComponents.DotNetBar.DockContainerItem();
			this.bar6 = new DevComponents.DotNetBar.Bar();
			this.panelDockContainer5 = new DevComponents.DotNetBar.PanelDockContainer();
			this.assetDetails = new GrBuildStudio.AssetDetails();
			this.dockContainerItem5 = new DevComponents.DotNetBar.DockContainerItem();
			this.dockSite8 = new DevComponents.DotNetBar.DockSite();
			this.dockSite5 = new DevComponents.DotNetBar.DockSite();
			this.dockSite6 = new DevComponents.DotNetBar.DockSite();
			this.dockSite7 = new DevComponents.DotNetBar.DockSite();
			this.bar3 = new DevComponents.DotNetBar.Bar();
			this.buttonItemFile = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFileNewSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFileOpenSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFileCloseSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFileAddNewTileSet = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFileExcludeTileSet = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFileMigrateTextures = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFileMRU = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemList = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFileExit = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSet = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSetImport = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSetImportSingleAsset = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSetImportBatch = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSetImportFromScript = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSetOpenViewer = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSetOpenExplorer = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemOpenlog = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSetExportToScript = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemTileSetProperties = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuild = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemRescan = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildBuildSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildRebuildSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildCleanSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildBuildProject = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildRebuildProject = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildCleanProject = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItem1 = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildBuildProjectForGTex = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildRebuildProjectForGTex = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildBuildSolutionForGTexStreaming = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildRebuildSolutionForGTex = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildRepageSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildRepageProject = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemHelp = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemHelpOnlineDocs = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemHelpAbout = new DevComponents.DotNetBar.ButtonItem();
			this.bar4 = new DevComponents.DotNetBar.Bar();
			this.buttonItemToolbarNewSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemOpenSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemImport = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemImportSingleAsset = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBatchImport = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemImportFromScript = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemFilter = new DevComponents.DotNetBar.ButtonItem();
			this.buttonRescan = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemBuildSolution = new DevComponents.DotNetBar.ButtonItem();
			this.buttonClean = new DevComponents.DotNetBar.ButtonItem();
			this.buttonRebuild = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItemViewGTS = new DevComponents.DotNetBar.ButtonItem();
			this.dockSite3 = new DevComponents.DotNetBar.DockSite();
			this.comboItem3 = new DevComponents.Editors.ComboItem();
			this.comboItem4 = new DevComponents.Editors.ComboItem();
			this.imageListBuildLog = new System.Windows.Forms.ImageList(this.components);
			this.advTree1 = new DevComponents.AdvTree.AdvTree();
			this.columnHeader3 = new DevComponents.AdvTree.ColumnHeader();
			this.columnHeader4 = new DevComponents.AdvTree.ColumnHeader();
			this.node1 = new DevComponents.AdvTree.Node();
			this.cell7 = new DevComponents.AdvTree.Cell();
			this.node2 = new DevComponents.AdvTree.Node();
			this.node5 = new DevComponents.AdvTree.Node();
			this.node6 = new DevComponents.AdvTree.Node();
			this.node9 = new DevComponents.AdvTree.Node();
			this.node10 = new DevComponents.AdvTree.Node();
			this.node35 = new DevComponents.AdvTree.Node();
			this.cell4 = new DevComponents.AdvTree.Cell();
			this.node36 = new DevComponents.AdvTree.Node();
			this.node37 = new DevComponents.AdvTree.Node();
			this.node38 = new DevComponents.AdvTree.Node();
			this.node39 = new DevComponents.AdvTree.Node();
			this.cell9 = new DevComponents.AdvTree.Cell();
			this.node41 = new DevComponents.AdvTree.Node();
			this.node42 = new DevComponents.AdvTree.Node();
			this.nodeConnector4 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle2 = new DevComponents.DotNetBar.ElementStyle();
			this.advTree2 = new DevComponents.AdvTree.AdvTree();
			this.columnHeader7 = new DevComponents.AdvTree.ColumnHeader();
			this.columnHeader8 = new DevComponents.AdvTree.ColumnHeader();
			this.node11 = new DevComponents.AdvTree.Node();
			this.cell8 = new DevComponents.AdvTree.Cell();
			this.node17 = new DevComponents.AdvTree.Node();
			this.node19 = new DevComponents.AdvTree.Node();
			this.node12 = new DevComponents.AdvTree.Node();
			this.node13 = new DevComponents.AdvTree.Node();
			this.node14 = new DevComponents.AdvTree.Node();
			this.node15 = new DevComponents.AdvTree.Node();
			this.cell6 = new DevComponents.AdvTree.Cell();
			this.node16 = new DevComponents.AdvTree.Node();
			this.node21 = new DevComponents.AdvTree.Node();
			this.node22 = new DevComponents.AdvTree.Node();
			this.node40 = new DevComponents.AdvTree.Node();
			this.cell11 = new DevComponents.AdvTree.Cell();
			this.node43 = new DevComponents.AdvTree.Node();
			this.node44 = new DevComponents.AdvTree.Node();
			this.nodeConnector1 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle1 = new DevComponents.DotNetBar.ElementStyle();
			this.node45 = new DevComponents.AdvTree.Node();
			this.node46 = new DevComponents.AdvTree.Node();
			this.elementStyle4 = new DevComponents.DotNetBar.ElementStyle();
			this.node47 = new DevComponents.AdvTree.Node();
			this.node48 = new DevComponents.AdvTree.Node();
			this.nodeConnector2 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle8 = new DevComponents.DotNetBar.ElementStyle();
			this.node3 = new DevComponents.AdvTree.Node();
			this.cell1 = new DevComponents.AdvTree.Cell();
			this.node4 = new DevComponents.AdvTree.Node();
			this.cell2 = new DevComponents.AdvTree.Cell();
			this.node7 = new DevComponents.AdvTree.Node();
			this.cell5 = new DevComponents.AdvTree.Cell();
			this.node8 = new DevComponents.AdvTree.Node();
			this.cell3 = new DevComponents.AdvTree.Cell();
			this.styleManager1 = new DevComponents.DotNetBar.StyleManager(this.components);
			this.comboItem1 = new DevComponents.Editors.ComboItem();
			this.comboItem2 = new DevComponents.Editors.ComboItem();
			this.comboItem5 = new DevComponents.Editors.ComboItem();
			this.comboItem6 = new DevComponents.Editors.ComboItem();
			this.advTree3 = new DevComponents.AdvTree.AdvTree();
			this.columnHeader5 = new DevComponents.AdvTree.ColumnHeader();
			this.columnHeader6 = new DevComponents.AdvTree.ColumnHeader();
			this.node18 = new DevComponents.AdvTree.Node();
			this.node20 = new DevComponents.AdvTree.Node();
			this.node23 = new DevComponents.AdvTree.Node();
			this.node24 = new DevComponents.AdvTree.Node();
			this.node25 = new DevComponents.AdvTree.Node();
			this.node26 = new DevComponents.AdvTree.Node();
			this.node27 = new DevComponents.AdvTree.Node();
			this.cell10 = new DevComponents.AdvTree.Cell();
			this.node28 = new DevComponents.AdvTree.Node();
			this.node29 = new DevComponents.AdvTree.Node();
			this.node30 = new DevComponents.AdvTree.Node();
			this.node31 = new DevComponents.AdvTree.Node();
			this.node32 = new DevComponents.AdvTree.Node();
			this.node33 = new DevComponents.AdvTree.Node();
			this.nodeConnector3 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle3 = new DevComponents.DotNetBar.ElementStyle();
			this.node34 = new DevComponents.AdvTree.Node();
			this.contextMenuStripAssetSelected = new System.Windows.Forms.ContextMenuStrip(this.components);
			this.toolStripMenuItemEditAsset = new System.Windows.Forms.ToolStripMenuItem();
			this.toolStripMenuItemRemoveAsset = new System.Windows.Forms.ToolStripMenuItem();
			this.toolStripMenuItemRenameAsset = new System.Windows.Forms.ToolStripMenuItem();
			this.toolStripSeparator3 = new System.Windows.Forms.ToolStripSeparator();
			this.toolStripMenuItemMigrateAsset = new System.Windows.Forms.ToolStripMenuItem();
			this.importSingleAssetToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.singleAssetToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.batchImportToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.fromImportScriptToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.toolStripMenuItem1 = new System.Windows.Forms.ToolStripMenuItem();
			this.openTileSetToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.contextMenuStripRightClickProject = new System.Windows.Forms.ContextMenuStrip(this.components);
			this.seperatorToolStripMenuItem = new System.Windows.Forms.ToolStripSeparator();
			this.buildToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.rebuildToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.cleanToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.toolStripSeparator1 = new System.Windows.Forms.ToolStripSeparator();
			this.showTileSetInWindowsExplorerToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.copyOutputFileNameToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.seperator2ToolStripMenuItem = new System.Windows.Forms.ToolStripSeparator();
			this.excludeFromSolutionToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
			this.toolStripSeparator2 = new System.Windows.Forms.ToolStripSeparator();
			this.readOnlyMessageBar = new GrBuildStudio.MessageBar();
			this.ToolTip = new GrBuildStudio.ToolTip();
			this.dockSite9.SuspendLayout();
			((System.ComponentModel.ISupportInitialize)this.bar2).BeginInit();
			this.bar2.SuspendLayout();
			this.panelDockContainer1.SuspendLayout();
			this.dockSite2.SuspendLayout();
			((System.ComponentModel.ISupportInitialize)this.bar8).BeginInit();
			this.bar8.SuspendLayout();
			this.panelDockContainer8.SuspendLayout();
			((System.ComponentModel.ISupportInitialize)this.bar6).BeginInit();
			this.bar6.SuspendLayout();
			this.panelDockContainer5.SuspendLayout();
			this.dockSite7.SuspendLayout();
			((System.ComponentModel.ISupportInitialize)this.bar3).BeginInit();
			((System.ComponentModel.ISupportInitialize)this.bar4).BeginInit();
			((System.ComponentModel.ISupportInitialize)this.advTree1).BeginInit();
			((System.ComponentModel.ISupportInitialize)this.advTree2).BeginInit();
			((System.ComponentModel.ISupportInitialize)this.advTree3).BeginInit();
			this.contextMenuStripAssetSelected.SuspendLayout();
			this.contextMenuStripRightClickProject.SuspendLayout();
			base.SuspendLayout();
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.F1);
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlC);
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlA);
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlV);
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlX);
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlZ);
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlY);
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.Del);
			this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.Ins);
			this.dotNetBarManager1.BottomDockSite = this.dockSite4;
			this.dotNetBarManager1.EnableFullSizeDock = false;
			this.dotNetBarManager1.FillDockSite = this.dockSite9;
			this.dotNetBarManager1.LeftDockSite = this.dockSite1;
			this.dotNetBarManager1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.dotNetBarManager1.ParentForm = this;
			this.dotNetBarManager1.RightDockSite = this.dockSite2;
			this.dotNetBarManager1.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.dotNetBarManager1.ToolbarBottomDockSite = this.dockSite8;
			this.dotNetBarManager1.ToolbarLeftDockSite = this.dockSite5;
			this.dotNetBarManager1.ToolbarRightDockSite = this.dockSite6;
			this.dotNetBarManager1.ToolbarTopDockSite = this.dockSite7;
			this.dotNetBarManager1.TopDockSite = this.dockSite3;
			this.dockSite4.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite4.Dock = System.Windows.Forms.DockStyle.Bottom;
			this.dockSite4.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
			this.dockSite4.Location = new System.Drawing.Point(0, 729);
			this.dockSite4.Name = "dockSite4";
			this.dockSite4.Size = new System.Drawing.Size(1008, 0);
			this.dockSite4.TabIndex = 3;
			this.dockSite4.TabStop = false;
			this.dockSite9.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite9.Controls.Add(this.bar2);
			this.dockSite9.Dock = System.Windows.Forms.DockStyle.Fill;
			this.dockSite9.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer(new DevComponents.DotNetBar.DocumentBaseContainer[1]
			{
				new DevComponents.DotNetBar.DocumentBarContainer(this.bar2, 651, 643)
			}, DevComponents.DotNetBar.eOrientation.Horizontal);
			this.dockSite9.Location = new System.Drawing.Point(0, 86);
			this.dockSite9.Name = "dockSite9";
			this.dockSite9.Size = new System.Drawing.Size(651, 643);
			this.dockSite9.TabIndex = 8;
			this.dockSite9.TabStop = false;
			this.bar2.AccessibleDescription = "DotNetBar Bar (bar2)";
			this.bar2.AccessibleName = "DotNetBar Bar";
			this.bar2.AccessibleRole = System.Windows.Forms.AccessibleRole.Grouping;
			this.bar2.CanDockBottom = false;
			this.bar2.CanDockDocument = true;
			this.bar2.CanDockLeft = false;
			this.bar2.CanDockRight = false;
			this.bar2.CanDockTop = false;
			this.bar2.CanUndock = false;
			this.bar2.Controls.Add(this.panelDockContainer1);
			this.bar2.DockTabAlignment = DevComponents.DotNetBar.eTabStripAlignment.Top;
			this.bar2.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			this.bar2.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.Caption;
			this.bar2.IsMaximized = false;
			this.bar2.Items.AddRange(new DevComponents.DotNetBar.BaseItem[1] { this.dockContainerItem1 });
			this.bar2.LayoutType = DevComponents.DotNetBar.eLayoutType.DockContainer;
			this.bar2.Location = new System.Drawing.Point(0, 0);
			this.bar2.Name = "bar2";
			this.bar2.Size = new System.Drawing.Size(651, 643);
			this.bar2.Stretch = true;
			this.bar2.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.bar2.TabIndex = 0;
			this.bar2.TabStop = false;
			this.bar2.Text = "Tile Set Projects";
			this.panelDockContainer1.ColorSchemeStyle = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.panelDockContainer1.Controls.Add(this.solutionTree);
			this.panelDockContainer1.DisabledBackColor = System.Drawing.Color.Empty;
			this.panelDockContainer1.Location = new System.Drawing.Point(3, 23);
			this.panelDockContainer1.Name = "panelDockContainer1";
			this.panelDockContainer1.Size = new System.Drawing.Size(645, 617);
			this.panelDockContainer1.Style.Alignment = System.Drawing.StringAlignment.Center;
			this.panelDockContainer1.Style.BackColor1.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.PanelBackground;
			this.panelDockContainer1.Style.ForeColor.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.ItemText;
			this.panelDockContainer1.Style.GradientAngle = 90;
			this.panelDockContainer1.TabIndex = 0;
			this.solutionTree.ActiveProject = new System.Guid("00000000-0000-0000-0000-000000000000");
			this.solutionTree.Dock = System.Windows.Forms.DockStyle.Fill;
			this.solutionTree.Location = new System.Drawing.Point(0, 0);
			this.solutionTree.Name = "solutionTree";
			this.solutionTree.Size = new System.Drawing.Size(645, 617);
			this.solutionTree.TabIndex = 0;
			this.solutionTree.FilterBarClosed += new GrBuildStudio.SolutionTree.FilterBarClosedEventHandler(solutionTree_FilterBarClosed);
			this.dockContainerItem1.Control = this.panelDockContainer1;
			this.dockContainerItem1.Name = "dockContainerItem1";
			this.dockContainerItem1.Text = "dockContainerItem1";
			this.dockSite1.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite1.Dock = System.Windows.Forms.DockStyle.Left;
			this.dockSite1.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
			this.dockSite1.Location = new System.Drawing.Point(0, 86);
			this.dockSite1.Name = "dockSite1";
			this.dockSite1.Size = new System.Drawing.Size(0, 643);
			this.dockSite1.TabIndex = 0;
			this.dockSite1.TabStop = false;
			this.dockSite2.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite2.Controls.Add(this.bar8);
			this.dockSite2.Controls.Add(this.bar6);
			this.dockSite2.Dock = System.Windows.Forms.DockStyle.Right;
			this.dockSite2.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer(new DevComponents.DotNetBar.DocumentBaseContainer[2]
			{
				new DevComponents.DotNetBar.DocumentBarContainer(this.bar6, 354, 381),
				new DevComponents.DotNetBar.DocumentBarContainer(this.bar8, 354, 259)
			}, DevComponents.DotNetBar.eOrientation.Vertical);
			this.dockSite2.Location = new System.Drawing.Point(651, 86);
			this.dockSite2.Name = "dockSite2";
			this.dockSite2.Size = new System.Drawing.Size(357, 643);
			this.dockSite2.TabIndex = 1;
			this.dockSite2.TabStop = false;
			this.bar8.AccessibleDescription = "DotNetBar Bar (bar8)";
			this.bar8.AccessibleName = "DotNetBar Bar";
			this.bar8.AccessibleRole = System.Windows.Forms.AccessibleRole.Grouping;
			this.bar8.CloseSingleTab = true;
			this.bar8.Controls.Add(this.panelDockContainer8);
			this.bar8.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			this.bar8.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.Caption;
			this.bar8.IsMaximized = false;
			this.bar8.Items.AddRange(new DevComponents.DotNetBar.BaseItem[1] { this.dockContainerItem8 });
			this.bar8.LayoutType = DevComponents.DotNetBar.eLayoutType.DockContainer;
			this.bar8.Location = new System.Drawing.Point(3, 384);
			this.bar8.Name = "bar8";
			this.bar8.Size = new System.Drawing.Size(354, 259);
			this.bar8.Stretch = true;
			this.bar8.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.bar8.TabIndex = 0;
			this.bar8.TabStop = false;
			this.bar8.Text = "Build Summary";
			this.panelDockContainer8.ColorSchemeStyle = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.panelDockContainer8.Controls.Add(this.buildSummaryDetails);
			this.panelDockContainer8.DisabledBackColor = System.Drawing.Color.Empty;
			this.panelDockContainer8.Location = new System.Drawing.Point(3, 23);
			this.panelDockContainer8.Name = "panelDockContainer8";
			this.panelDockContainer8.Size = new System.Drawing.Size(348, 233);
			this.panelDockContainer8.Style.Alignment = System.Drawing.StringAlignment.Center;
			this.panelDockContainer8.Style.BackColor1.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.PanelBackground;
			this.panelDockContainer8.Style.ForeColor.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.ItemText;
			this.panelDockContainer8.Style.GradientAngle = 90;
			this.panelDockContainer8.TabIndex = 0;
			this.buildSummaryDetails.AutoSize = true;
			this.buildSummaryDetails.BackColor = System.Drawing.Color.Transparent;
			this.buildSummaryDetails.Dock = System.Windows.Forms.DockStyle.Fill;
			this.buildSummaryDetails.Location = new System.Drawing.Point(0, 0);
			this.buildSummaryDetails.MinimumSize = new System.Drawing.Size(300, 150);
			this.buildSummaryDetails.Name = "buildSummaryDetails";
			this.buildSummaryDetails.Size = new System.Drawing.Size(348, 233);
			this.buildSummaryDetails.TabIndex = 0;
			this.dockContainerItem8.Control = this.panelDockContainer8;
			this.dockContainerItem8.Name = "dockContainerItem8";
			this.dockContainerItem8.Text = "Build Summary";
			this.bar6.AccessibleDescription = "DotNetBar Bar (bar6)";
			this.bar6.AccessibleName = "DotNetBar Bar";
			this.bar6.AccessibleRole = System.Windows.Forms.AccessibleRole.Grouping;
			this.bar6.CloseSingleTab = true;
			this.bar6.Controls.Add(this.panelDockContainer5);
			this.bar6.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			this.bar6.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.Caption;
			this.bar6.IsMaximized = false;
			this.bar6.Items.AddRange(new DevComponents.DotNetBar.BaseItem[1] { this.dockContainerItem5 });
			this.bar6.LayoutType = DevComponents.DotNetBar.eLayoutType.DockContainer;
			this.bar6.Location = new System.Drawing.Point(3, 0);
			this.bar6.Name = "bar6";
			this.bar6.Size = new System.Drawing.Size(354, 381);
			this.bar6.Stretch = true;
			this.bar6.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.bar6.TabIndex = 0;
			this.bar6.TabStop = false;
			this.bar6.Text = "Stacked Texture's Details";
			this.panelDockContainer5.ColorSchemeStyle = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.panelDockContainer5.Controls.Add(this.assetDetails);
			this.panelDockContainer5.DisabledBackColor = System.Drawing.Color.Empty;
			this.panelDockContainer5.Location = new System.Drawing.Point(3, 23);
			this.panelDockContainer5.Name = "panelDockContainer5";
			this.panelDockContainer5.Size = new System.Drawing.Size(348, 355);
			this.panelDockContainer5.Style.Alignment = System.Drawing.StringAlignment.Center;
			this.panelDockContainer5.Style.BackColor1.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.PanelBackground;
			this.panelDockContainer5.Style.ForeColor.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.ItemText;
			this.panelDockContainer5.Style.GradientAngle = 90;
			this.panelDockContainer5.TabIndex = 0;
			this.assetDetails.Asset = null;
			this.assetDetails.BackColor = System.Drawing.Color.Transparent;
			this.assetDetails.Dock = System.Windows.Forms.DockStyle.Fill;
			this.assetDetails.Location = new System.Drawing.Point(0, 0);
			this.assetDetails.Name = "assetDetails";
			this.assetDetails.Size = new System.Drawing.Size(348, 355);
			this.assetDetails.TabIndex = 2;
			this.dockContainerItem5.Control = this.panelDockContainer5;
			this.dockContainerItem5.Name = "dockContainerItem5";
			this.dockContainerItem5.Text = "Stacked texture's Details";
			this.dockSite8.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite8.Dock = System.Windows.Forms.DockStyle.Bottom;
			this.dockSite8.Location = new System.Drawing.Point(0, 729);
			this.dockSite8.Name = "dockSite8";
			this.dockSite8.Size = new System.Drawing.Size(1008, 0);
			this.dockSite8.TabIndex = 7;
			this.dockSite8.TabStop = false;
			this.dockSite5.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite5.Dock = System.Windows.Forms.DockStyle.Left;
			this.dockSite5.Location = new System.Drawing.Point(0, 86);
			this.dockSite5.Name = "dockSite5";
			this.dockSite5.Size = new System.Drawing.Size(0, 643);
			this.dockSite5.TabIndex = 4;
			this.dockSite5.TabStop = false;
			this.dockSite6.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite6.Dock = System.Windows.Forms.DockStyle.Right;
			this.dockSite6.Location = new System.Drawing.Point(1008, 86);
			this.dockSite6.Name = "dockSite6";
			this.dockSite6.Size = new System.Drawing.Size(0, 643);
			this.dockSite6.TabIndex = 5;
			this.dockSite6.TabStop = false;
			this.dockSite7.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite7.Controls.Add(this.bar3);
			this.dockSite7.Controls.Add(this.bar4);
			this.dockSite7.Dock = System.Windows.Forms.DockStyle.Top;
			this.dockSite7.Location = new System.Drawing.Point(0, 0);
			this.dockSite7.Name = "dockSite7";
			this.dockSite7.Size = new System.Drawing.Size(1008, 50);
			this.dockSite7.TabIndex = 6;
			this.dockSite7.TabStop = false;
			this.bar3.AccessibleDescription = "DotNetBar Bar (bar3)";
			this.bar3.AccessibleName = "DotNetBar Bar";
			this.bar3.AccessibleRole = System.Windows.Forms.AccessibleRole.MenuBar;
			this.bar3.DockSide = DevComponents.DotNetBar.eDockSide.Top;
			this.bar3.Font = new System.Drawing.Font("Segoe UI", 9f);
			this.bar3.IsMaximized = false;
			this.bar3.Items.AddRange(new DevComponents.DotNetBar.BaseItem[4] { this.buttonItemFile, this.buttonItemTileSet, this.buttonItemBuild, this.buttonItemHelp });
			this.bar3.ItemSpacing = 4;
			this.bar3.Location = new System.Drawing.Point(0, 0);
			this.bar3.MenuBar = true;
			this.bar3.Name = "bar3";
			this.bar3.Size = new System.Drawing.Size(1008, 24);
			this.bar3.Stretch = true;
			this.bar3.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.bar3.TabIndex = 0;
			this.bar3.TabStop = false;
			this.bar3.Text = "Main";
			this.buttonItemFile.Name = "buttonItemFile";
			this.buttonItemFile.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[8] { this.buttonItemFileNewSolution, this.buttonItemFileOpenSolution, this.buttonItemFileCloseSolution, this.buttonItemFileAddNewTileSet, this.buttonItemFileExcludeTileSet, this.buttonItemFileMigrateTextures, this.buttonItemFileMRU, this.buttonItemFileExit });
			this.buttonItemFile.Text = "File";
			this.buttonItemFileNewSolution.Image = GrBuildStudio.Properties.Resources.page_white_star;
			this.buttonItemFileNewSolution.Name = "buttonItemFileNewSolution";
			this.buttonItemFileNewSolution.Text = "New Solution...";
			this.buttonItemFileNewSolution.Click += new System.EventHandler(buttonItemFileNewSolution_Click);
			this.buttonItemFileOpenSolution.Image = GrBuildStudio.Properties.Resources.folder_picture;
			this.buttonItemFileOpenSolution.Name = "buttonItemFileOpenSolution";
			this.buttonItemFileOpenSolution.Text = "Open Solution...";
			this.buttonItemFileOpenSolution.Click += new System.EventHandler(buttonItemFileOpenSolution_Click);
			this.buttonItemFileCloseSolution.Name = "buttonItemFileCloseSolution";
			this.buttonItemFileCloseSolution.Text = "Close Solution...";
			this.buttonItemFileCloseSolution.Click += new System.EventHandler(buttonItemFileCloseSolution_Click);
			this.buttonItemFileAddNewTileSet.BeginGroup = true;
			this.buttonItemFileAddNewTileSet.Name = "buttonItemFileAddNewTileSet";
			this.buttonItemFileAddNewTileSet.Text = "Add Tile Set Project...";
			this.buttonItemFileAddNewTileSet.Click += new System.EventHandler(buttonItemFileAddNewTileSet_Click);
			this.buttonItemFileExcludeTileSet.Name = "buttonItemFileExcludeTileSet";
			this.buttonItemFileExcludeTileSet.Text = "Delete Selected Project...";
			this.buttonItemFileExcludeTileSet.Click += new System.EventHandler(excludeFromSolutionMenu_Click);
			this.buttonItemFileMigrateTextures.BeginGroup = true;
			this.buttonItemFileMigrateTextures.Name = "buttonItemFileMigrateTextures";
			this.buttonItemFileMigrateTextures.Text = "Migrate Stacked Textures...";
			this.buttonItemFileMigrateTextures.Click += new System.EventHandler(buttonItemTilesetMigrateTextures_Click);
			this.buttonItemFileMRU.BeginGroup = true;
			this.buttonItemFileMRU.Name = "buttonItemFileMRU";
			this.buttonItemFileMRU.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[1] { this.buttonItemList });
			this.buttonItemFileMRU.Text = "Recent Solutions";
			this.buttonItemList.Name = "buttonItemList";
			this.buttonItemList.Text = "buttonItem1";
			this.buttonItemFileExit.BeginGroup = true;
			this.buttonItemFileExit.Name = "buttonItemFileExit";
			this.buttonItemFileExit.Text = "Exit";
			this.buttonItemFileExit.Click += new System.EventHandler(buttonItemFileExit_Click);
			this.buttonItemTileSet.Name = "buttonItemTileSet";
			this.buttonItemTileSet.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[6] { this.buttonItemTileSetImport, this.buttonItemTileSetOpenViewer, this.buttonItemTileSetOpenExplorer, this.buttonItemOpenlog, this.buttonItemTileSetExportToScript, this.buttonItemTileSetProperties });
			this.buttonItemTileSet.Text = "Tile Set";
			this.buttonItemTileSetImport.Image = GrBuildStudio.Properties.Resources.image_add;
			this.buttonItemTileSetImport.Name = "buttonItemTileSetImport";
			this.buttonItemTileSetImport.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[3] { this.buttonItemTileSetImportSingleAsset, this.buttonItemTileSetImportBatch, this.buttonItemTileSetImportFromScript });
			this.buttonItemTileSetImport.Text = "Add Stacked Texture(s)";
			this.buttonItemTileSetImportSingleAsset.AlternateShortCutText = "Ctrl+I";
			this.buttonItemTileSetImportSingleAsset.Name = "buttonItemTileSetImportSingleAsset";
			this.buttonItemTileSetImportSingleAsset.Text = "Single Stacked Texture...";
			this.buttonItemTileSetImportSingleAsset.Click += new System.EventHandler(buttonItemTileSetImportSingleAsset_Click);
			this.buttonItemTileSetImportBatch.AlternateShortCutText = "Ctrl+Shift+I";
			this.buttonItemTileSetImportBatch.Name = "buttonItemTileSetImportBatch";
			this.buttonItemTileSetImportBatch.Text = "Batch Import...";
			this.buttonItemTileSetImportBatch.Click += new System.EventHandler(buttonItemTileSetImportBatch_Click);
			this.buttonItemTileSetImportFromScript.AlternateShortCutText = "Ctrl+P";
			this.buttonItemTileSetImportFromScript.Name = "buttonItemTileSetImportFromScript";
			this.buttonItemTileSetImportFromScript.Text = "From Import Script...";
			this.buttonItemTileSetImportFromScript.Click += new System.EventHandler(buttonItemTileSetImportFromScript_Click);
			this.buttonItemTileSetOpenViewer.BeginGroup = true;
			this.buttonItemTileSetOpenViewer.Image = GrBuildStudio.Properties.Resources.bar_tilesetviewer;
			this.buttonItemTileSetOpenViewer.Name = "buttonItemTileSetOpenViewer";
			this.buttonItemTileSetOpenViewer.Text = "Open Tile Set Output...";
			this.buttonItemTileSetOpenViewer.Click += new System.EventHandler(buttonItemTileSetOpenViewer_Click);
			this.buttonItemTileSetOpenExplorer.Image = GrBuildStudio.Properties.Resources.bar_tilesetviewer;
			this.buttonItemTileSetOpenExplorer.Name = "buttonItemTileSetOpenExplorer";
			this.buttonItemTileSetOpenExplorer.Text = "View Tile Set in Windows Explorer...";
			this.buttonItemTileSetOpenExplorer.Click += new System.EventHandler(showTileSetInWindowsExplorerToolStripMenuItem_Click);
			this.buttonItemOpenlog.Name = "buttonItemOpenlog";
			this.buttonItemOpenlog.Text = "Open Log File...";
			this.buttonItemOpenlog.Click += new System.EventHandler(buttonItemOpenlog_Click);
			this.buttonItemTileSetExportToScript.BeginGroup = true;
			this.buttonItemTileSetExportToScript.Name = "buttonItemTileSetExportToScript";
			this.buttonItemTileSetExportToScript.Text = "Export to Import Script...";
			this.buttonItemTileSetExportToScript.Click += new System.EventHandler(buttonItemTileSetExportToScript_Click);
			this.buttonItemTileSetProperties.BeginGroup = true;
			this.buttonItemTileSetProperties.Name = "buttonItemTileSetProperties";
			this.buttonItemTileSetProperties.Text = "Properties...";
			this.buttonItemTileSetProperties.Click += new System.EventHandler(buttonItemTileSetProperties_Click);
			this.buttonItemBuild.Name = "buttonItemBuild";
			this.buttonItemBuild.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[8] { this.buttonItemRescan, this.buttonItemBuildBuildSolution, this.buttonItemBuildRebuildSolution, this.buttonItemBuildCleanSolution, this.buttonItemBuildBuildProject, this.buttonItemBuildRebuildProject, this.buttonItemBuildCleanProject, this.buttonItem1 });
			this.buttonItemBuild.Text = "Build";
			this.buttonItemRescan.AlternateShortCutText = "Ctrl+R";
			this.buttonItemRescan.Image = GrBuildStudio.Properties.Resources.database_refresh;
			this.buttonItemRescan.Name = "buttonItemRescan";
			this.buttonItemRescan.Text = "Rescan imported Stacked Texture(s)";
			this.buttonItemRescan.Click += new System.EventHandler(buttonItemRescan_Click);
			this.buttonItemBuildBuildSolution.AlternateShortCutText = "Ctrl+Shift+B";
			this.buttonItemBuildBuildSolution.BeginGroup = true;
			this.buttonItemBuildBuildSolution.Image = GrBuildStudio.Properties.Resources.build;
			this.buttonItemBuildBuildSolution.Name = "buttonItemBuildBuildSolution";
			this.buttonItemBuildBuildSolution.Text = "Build Solution";
			this.buttonItemBuildBuildSolution.Click += new System.EventHandler(buttonItemBuildBuildSolution_Click);
			this.buttonItemBuildRebuildSolution.AlternateShortCutText = "Ctrl+Shift+R";
			this.buttonItemBuildRebuildSolution.Image = GrBuildStudio.Properties.Resources.rebuild;
			this.buttonItemBuildRebuildSolution.Name = "buttonItemBuildRebuildSolution";
			this.buttonItemBuildRebuildSolution.Text = "Rebuild Solution";
			this.buttonItemBuildRebuildSolution.Click += new System.EventHandler(buttonItemBuildRebuildSolution_Click);
			this.buttonItemBuildCleanSolution.AlternateShortCutText = "Ctrl+Shift+C";
			this.buttonItemBuildCleanSolution.Image = GrBuildStudio.Properties.Resources.clean;
			this.buttonItemBuildCleanSolution.Name = "buttonItemBuildCleanSolution";
			this.buttonItemBuildCleanSolution.Text = "Clean Solution";
			this.buttonItemBuildCleanSolution.Click += new System.EventHandler(buttonItemBuildCleanSolution_Click);
			this.buttonItemBuildBuildProject.BeginGroup = true;
			this.buttonItemBuildBuildProject.Name = "buttonItemBuildBuildProject";
			this.buttonItemBuildBuildProject.Text = "Build Project";
			this.buttonItemBuildBuildProject.Click += new System.EventHandler(buttonItemBuildBuildProject_Click);
			this.buttonItemBuildRebuildProject.Name = "buttonItemBuildRebuildProject";
			this.buttonItemBuildRebuildProject.Text = "Rebuild Project";
			this.buttonItemBuildRebuildProject.Click += new System.EventHandler(buttonItemBuildRebuildProject_Click);
			this.buttonItemBuildCleanProject.Name = "buttonItemBuildCleanProject";
			this.buttonItemBuildCleanProject.Text = "Clean Project";
			this.buttonItemBuildCleanProject.Click += new System.EventHandler(buttonItemBuildCleanProject_Click);
			this.buttonItem1.BeginGroup = true;
			this.buttonItem1.Name = "buttonItem1";
			this.buttonItem1.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[6] { this.buttonItemBuildBuildProjectForGTex, this.buttonItemBuildRebuildProjectForGTex, this.buttonItemBuildBuildSolutionForGTexStreaming, this.buttonItemBuildRebuildSolutionForGTex, this.buttonItemBuildRepageSolution, this.buttonItemBuildRepageProject });
			this.buttonItem1.Text = "Advanced";
			this.buttonItemBuildBuildProjectForGTex.BeginGroup = true;
			this.buttonItemBuildBuildProjectForGTex.Name = "buttonItemBuildBuildProjectForGTex";
			this.buttonItemBuildBuildProjectForGTex.Text = "Build Project for GTex Streaming";
			this.buttonItemBuildBuildProjectForGTex.Click += new System.EventHandler(buttonItemBuildBuildProjectForGTex_Click);
			this.buttonItemBuildRebuildProjectForGTex.Name = "buttonItemBuildRebuildProjectForGTex";
			this.buttonItemBuildRebuildProjectForGTex.Text = "Rebuild Project for GTex Streaming";
			this.buttonItemBuildRebuildProjectForGTex.Click += new System.EventHandler(buttonItemBuildRebuildProjectForGTex_Click);
			this.buttonItemBuildBuildSolutionForGTexStreaming.BeginGroup = true;
			this.buttonItemBuildBuildSolutionForGTexStreaming.Image = GrBuildStudio.Properties.Resources.build;
			this.buttonItemBuildBuildSolutionForGTexStreaming.Name = "buttonItemBuildBuildSolutionForGTexStreaming";
			this.buttonItemBuildBuildSolutionForGTexStreaming.Text = "Build Solution for GTex Streaming";
			this.buttonItemBuildBuildSolutionForGTexStreaming.Click += new System.EventHandler(buttonItemBuildBuildSolutionForGTexStreaming_Click);
			this.buttonItemBuildRebuildSolutionForGTex.Image = GrBuildStudio.Properties.Resources.rebuild;
			this.buttonItemBuildRebuildSolutionForGTex.Name = "buttonItemBuildRebuildSolutionForGTex";
			this.buttonItemBuildRebuildSolutionForGTex.Text = "Rebuild Solution for GTex Streaming";
			this.buttonItemBuildRebuildSolutionForGTex.Click += new System.EventHandler(buttonItemBuildRebuildSolutionForGTex_Click);
			this.buttonItemBuildRepageSolution.BeginGroup = true;
			this.buttonItemBuildRepageSolution.Name = "buttonItemBuildRepageSolution";
			this.buttonItemBuildRepageSolution.Text = "Force Repage Solution";
			this.buttonItemBuildRepageSolution.Click += new System.EventHandler(buttonItemBuildRepageSolution_Click);
			this.buttonItemBuildRepageProject.Name = "buttonItemBuildRepageProject";
			this.buttonItemBuildRepageProject.Text = "Force Repage Current Project";
			this.buttonItemBuildRepageProject.Click += new System.EventHandler(buttonItemBuildRepageProject_Click);
			this.buttonItemHelp.Name = "buttonItemHelp";
			this.buttonItemHelp.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[2] { this.buttonItemHelpOnlineDocs, this.buttonItemHelpAbout });
			this.buttonItemHelp.Text = "Help";
			this.buttonItemHelpOnlineDocs.Name = "buttonItemHelpOnlineDocs";
			this.buttonItemHelpOnlineDocs.Text = "Online Documentation...";
			this.buttonItemHelpOnlineDocs.Click += new System.EventHandler(buttonItemHelpOnlineDocs_Click);
			this.buttonItemHelpAbout.BeginGroup = true;
			this.buttonItemHelpAbout.Name = "buttonItemHelpAbout";
			this.buttonItemHelpAbout.Text = "About...";
			this.buttonItemHelpAbout.Click += new System.EventHandler(buttonItemHelpAbout_Click);
			this.bar4.AccessibleDescription = "DotNetBar Bar (bar4)";
			this.bar4.AccessibleName = "DotNetBar Bar";
			this.bar4.AccessibleRole = System.Windows.Forms.AccessibleRole.ToolBar;
			this.bar4.DockLine = 1;
			this.bar4.DockSide = DevComponents.DotNetBar.eDockSide.Top;
			this.bar4.Font = new System.Drawing.Font("Segoe UI", 9f);
			this.bar4.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.Office2003;
			this.bar4.IsMaximized = false;
			this.bar4.Items.AddRange(new DevComponents.DotNetBar.BaseItem[9] { this.buttonItemToolbarNewSolution, this.buttonItemOpenSolution, this.buttonItemImport, this.buttonItemFilter, this.buttonRescan, this.buttonItemBuildSolution, this.buttonClean, this.buttonRebuild, this.buttonItemViewGTS });
			this.bar4.Location = new System.Drawing.Point(0, 25);
			this.bar4.Name = "bar4";
			this.bar4.Size = new System.Drawing.Size(250, 25);
			this.bar4.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.bar4.TabIndex = 1;
			this.bar4.TabStop = false;
			this.bar4.Text = "ToolBar";
			this.buttonItemToolbarNewSolution.BeginGroup = true;
			this.buttonItemToolbarNewSolution.Image = GrBuildStudio.Properties.Resources.page_white_star;
			this.buttonItemToolbarNewSolution.Name = "buttonItemToolbarNewSolution";
			this.ToolTip.SetSuperTooltip(this.buttonItemToolbarNewSolution, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_NEW_ICON", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonItemToolbarNewSolution.Text = "New";
			this.buttonItemToolbarNewSolution.Click += new System.EventHandler(buttonItemToolbarNewSolution_Click);
			this.buttonItemOpenSolution.Image = GrBuildStudio.Properties.Resources.folder_picture;
			this.buttonItemOpenSolution.Name = "buttonItemOpenSolution";
			this.ToolTip.SetSuperTooltip(this.buttonItemOpenSolution, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_OPEN_ICON", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonItemOpenSolution.Text = "Open";
			this.buttonItemOpenSolution.Click += new System.EventHandler(buttonItemOpenSolution_Click);
			this.buttonItemImport.AutoExpandOnClick = true;
			this.buttonItemImport.BeginGroup = true;
			this.buttonItemImport.Image = GrBuildStudio.Properties.Resources.image_add;
			this.buttonItemImport.Name = "buttonItemImport";
			this.buttonItemImport.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[3] { this.buttonItemImportSingleAsset, this.buttonItemBatchImport, this.buttonItemImportFromScript });
			this.ToolTip.SetSuperTooltip(this.buttonItemImport, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_IMPORT_ICON", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonItemImport.Text = "Import";
			this.buttonItemImportSingleAsset.AlternateShortCutText = "Ctrl+I";
			this.buttonItemImportSingleAsset.Name = "buttonItemImportSingleAsset";
			this.buttonItemImportSingleAsset.Text = "Single Stacked texture...";
			this.buttonItemImportSingleAsset.Click += new System.EventHandler(buttonItemImportSingleAsset_Click);
			this.buttonItemBatchImport.AlternateShortCutText = "Ctrl+Shift+I";
			this.buttonItemBatchImport.Name = "buttonItemBatchImport";
			this.buttonItemBatchImport.Text = "Batch Import...";
			this.buttonItemBatchImport.Click += new System.EventHandler(buttonItemBatchImport_Click);
			this.buttonItemImportFromScript.AlternateShortCutText = "Ctrl+P";
			this.buttonItemImportFromScript.Name = "buttonItemImportFromScript";
			this.buttonItemImportFromScript.Text = "From Import Script...";
			this.buttonItemImportFromScript.Click += new System.EventHandler(buttonItemImportFromScript_Click);
			this.buttonItemFilter.Image = GrBuildStudio.Properties.Resources.magnifier;
			this.buttonItemFilter.Name = "buttonItemFilter";
			this.ToolTip.SetSuperTooltip(this.buttonItemFilter, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_FILTER", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonItemFilter.Text = "Filter Stacked Textures";
			this.buttonItemFilter.Click += new System.EventHandler(buttonItemFilter_Click);
			this.buttonRescan.BeginGroup = true;
			this.buttonRescan.Image = GrBuildStudio.Properties.Resources.database_refresh;
			this.buttonRescan.Name = "buttonRescan";
			this.ToolTip.SetSuperTooltip(this.buttonRescan, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_RESCAN_ICON", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonRescan.Text = "Rescan";
			this.buttonRescan.Click += new System.EventHandler(buttonItemRescan_Click);
			this.buttonItemBuildSolution.BeginGroup = true;
			this.buttonItemBuildSolution.Image = GrBuildStudio.Properties.Resources.build;
			this.buttonItemBuildSolution.Name = "buttonItemBuildSolution";
			this.ToolTip.SetSuperTooltip(this.buttonItemBuildSolution, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_BUILD_ICON", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonItemBuildSolution.Text = "Build";
			this.buttonItemBuildSolution.Click += new System.EventHandler(buttonItemBuildSolution_Click);
			this.buttonClean.Image = GrBuildStudio.Properties.Resources.rebuild;
			this.buttonClean.Name = "buttonClean";
			this.ToolTip.SetSuperTooltip(this.buttonClean, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_REBUILD_ICON", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonClean.Text = "Rebuild";
			this.buttonClean.Click += new System.EventHandler(buttonItemBuildRebuildSolution_Click);
			this.buttonRebuild.Image = GrBuildStudio.Properties.Resources.clean;
			this.buttonRebuild.Name = "buttonRebuild";
			this.ToolTip.SetSuperTooltip(this.buttonRebuild, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_CLEAN_ICON", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonRebuild.Text = "Clean";
			this.buttonRebuild.Click += new System.EventHandler(buttonItemBuildCleanSolution_Click);
			this.buttonItemViewGTS.BeginGroup = true;
			this.buttonItemViewGTS.Image = GrBuildStudio.Properties.Resources.bar_tilesetviewer;
			this.buttonItemViewGTS.Name = "buttonItemViewGTS";
			this.ToolTip.SetSuperTooltip(this.buttonItemViewGTS, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_OPENGTS_ICON", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.buttonItemViewGTS.Text = "OpenGts";
			this.buttonItemViewGTS.Click += new System.EventHandler(buttonItemViewGTS_Click);
			this.dockSite3.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
			this.dockSite3.Dock = System.Windows.Forms.DockStyle.Top;
			this.dockSite3.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
			this.dockSite3.Location = new System.Drawing.Point(0, 86);
			this.dockSite3.Name = "dockSite3";
			this.dockSite3.Size = new System.Drawing.Size(1008, 0);
			this.dockSite3.TabIndex = 2;
			this.dockSite3.TabStop = false;
			this.comboItem3.Text = "Fast";
			this.comboItem4.Text = "Optimized";
			this.imageListBuildLog.ImageStream = (System.Windows.Forms.ImageListStreamer)resources.GetObject("imageListBuildLog.ImageStream");
			this.imageListBuildLog.TransparentColor = System.Drawing.Color.Transparent;
			this.imageListBuildLog.Images.SetKeyName(0, "exclamation.png");
			this.imageListBuildLog.Images.SetKeyName(1, "exclamation.png");
			this.imageListBuildLog.Images.SetKeyName(2, "error.png");
			this.imageListBuildLog.Images.SetKeyName(3, "information.png");
			this.advTree1.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.advTree1.AllowDrop = true;
			this.advTree1.BackColor = System.Drawing.SystemColors.Window;
			this.advTree1.BackgroundStyle.Class = "TreeBorderKey";
			this.advTree1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.advTree1.Columns.Add(this.columnHeader3);
			this.advTree1.Columns.Add(this.columnHeader4);
			this.advTree1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.advTree1.Location = new System.Drawing.Point(19, 45);
			this.advTree1.Name = "advTree1";
			this.advTree1.Nodes.AddRange(new DevComponents.AdvTree.Node[4] { this.node1, this.node6, this.node37, this.node39 });
			this.advTree1.NodesConnector = this.nodeConnector4;
			this.advTree1.NodeStyle = this.elementStyle2;
			this.advTree1.PathSeparator = ";";
			this.advTree1.Size = new System.Drawing.Size(600, 198);
			this.advTree1.Styles.Add(this.elementStyle2);
			this.advTree1.TabIndex = 10;
			this.advTree1.Text = "advTree1";
			this.columnHeader3.Name = "columnHeader3";
			this.columnHeader3.StretchToFill = true;
			this.columnHeader3.Text = "Stacked Texture";
			this.columnHeader3.Width.Absolute = 150;
			this.columnHeader4.Name = "columnHeader4";
			this.columnHeader4.Text = "State";
			this.columnHeader4.Width.Absolute = 150;
			this.node1.Cells.Add(this.cell7);
			this.node1.Image = GrBuildStudio.Properties.Resources.exclamation;
			this.node1.Name = "node1";
			this.node1.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node2, this.node5 });
			this.node1.Text = "BlueMarble";
			this.cell7.Name = "cell7";
			this.cell7.StyleMouseOver = null;
			this.cell7.Text = "Missing";
			this.node2.Expanded = true;
			this.node2.Name = "node2";
			this.node2.Text = "Diffuse: bluemarble_d.png";
			this.node5.Expanded = true;
			this.node5.Name = "node5";
			this.node5.Text = "Normals: bluemarble_n.png";
			this.node6.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node6.Name = "node6";
			this.node6.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node9, this.node36 });
			this.node6.Text = "Glider";
			this.node9.Name = "node9";
			this.node9.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node10 });
			this.node9.Text = "Diffuse: UDIM";
			this.node10.Name = "node10";
			this.node10.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node35 });
			this.node10.Text = "102 items found... expand to view";
			this.node35.Cells.Add(this.cell4);
			this.node35.Expanded = true;
			this.node35.Name = "node35";
			this.node35.Text = "world.topo.bathy.200412.3x21600x21600.A0_n.png";
			this.cell4.Name = "cell4";
			this.cell4.StyleMouseOver = null;
			this.cell4.Text = "Built";
			this.node36.Expanded = true;
			this.node36.Name = "node36";
			this.node36.Text = "Normals: UDIM";
			this.node37.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node37.Name = "node37";
			this.node37.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node38 });
			this.node37.Text = "Loft";
			this.node38.Expanded = true;
			this.node38.Name = "node38";
			this.node38.Text = "node16";
			this.node39.Cells.Add(this.cell9);
			this.node39.Image = GrBuildStudio.Properties.Resources.error_add;
			this.node39.Name = "node39";
			this.node39.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node41, this.node42 });
			this.node39.Text = "Asset 3";
			this.cell9.Name = "cell9";
			this.cell9.StyleMouseOver = null;
			this.cell9.Text = "Not built";
			this.node41.Expanded = true;
			this.node41.Name = "node41";
			this.node41.Text = "node10";
			this.node42.Expanded = true;
			this.node42.Name = "node42";
			this.node42.Text = "node11";
			this.nodeConnector4.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle2.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle2.Name = "elementStyle2";
			this.elementStyle2.TextColor = System.Drawing.SystemColors.ControlText;
			this.advTree2.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.advTree2.AllowDrop = true;
			this.advTree2.BackColor = System.Drawing.SystemColors.Window;
			this.advTree2.BackgroundStyle.Class = "TreeBorderKey";
			this.advTree2.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.advTree2.Columns.Add(this.columnHeader7);
			this.advTree2.Columns.Add(this.columnHeader8);
			this.advTree2.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.advTree2.Location = new System.Drawing.Point(19, 288);
			this.advTree2.Name = "advTree2";
			this.advTree2.Nodes.AddRange(new DevComponents.AdvTree.Node[4] { this.node11, this.node12, this.node21, this.node40 });
			this.advTree2.NodesConnector = this.nodeConnector1;
			this.advTree2.NodeStyle = this.elementStyle1;
			this.advTree2.PathSeparator = ";";
			this.advTree2.Size = new System.Drawing.Size(600, 198);
			this.advTree2.Styles.Add(this.elementStyle1);
			this.advTree2.TabIndex = 9;
			this.advTree2.Text = "advTree1";
			this.columnHeader7.Name = "columnHeader7";
			this.columnHeader7.StretchToFill = true;
			this.columnHeader7.Text = "Stacked Texture";
			this.columnHeader7.Width.Absolute = 150;
			this.columnHeader8.Name = "columnHeader8";
			this.columnHeader8.Text = "State";
			this.columnHeader8.Width.Absolute = 150;
			this.node11.Cells.Add(this.cell8);
			this.node11.Image = GrBuildStudio.Properties.Resources.exclamation;
			this.node11.Name = "node11";
			this.node11.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node17, this.node19 });
			this.node11.Text = "BlueMarble";
			this.cell8.Name = "cell8";
			this.cell8.StyleMouseOver = null;
			this.cell8.Text = "Missing";
			this.node17.Expanded = true;
			this.node17.Name = "node17";
			this.node17.Text = "Diffuse: bluemarble_d.png";
			this.node19.Expanded = true;
			this.node19.Name = "node19";
			this.node19.Text = "Normals: bluemarble_n.png";
			this.node12.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node12.Name = "node12";
			this.node12.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node13, this.node16 });
			this.node12.Text = "Glider";
			this.node13.Name = "node13";
			this.node13.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node14 });
			this.node13.Text = "Diffuse: UDIM";
			this.node14.Name = "node14";
			this.node14.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node15 });
			this.node14.Text = "102 items found... expand to view";
			this.node15.Cells.Add(this.cell6);
			this.node15.Expanded = true;
			this.node15.Name = "node15";
			this.node15.Text = "world.topo.bathy.200412.3x21600x21600.A0_n.png";
			this.cell6.Name = "cell6";
			this.cell6.StyleMouseOver = null;
			this.cell6.Text = "Built";
			this.node16.Expanded = true;
			this.node16.Name = "node16";
			this.node16.Text = "Normals: UDIM";
			this.node21.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node21.Name = "node21";
			this.node21.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node22 });
			this.node21.Text = "Loft";
			this.node22.Expanded = true;
			this.node22.Name = "node22";
			this.node22.Text = "node16";
			this.node40.Cells.Add(this.cell11);
			this.node40.Image = GrBuildStudio.Properties.Resources.error_add;
			this.node40.Name = "node40";
			this.node40.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node43, this.node44 });
			this.node40.Text = "Asset 3";
			this.cell11.Name = "cell11";
			this.cell11.StyleMouseOver = null;
			this.cell11.Text = "Not built";
			this.node43.Expanded = true;
			this.node43.Name = "node43";
			this.node43.Text = "node10";
			this.node44.Expanded = true;
			this.node44.Name = "node44";
			this.node44.Text = "node11";
			this.nodeConnector1.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle1.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle1.Name = "elementStyle1";
			this.elementStyle1.TextColor = System.Drawing.SystemColors.ControlText;
			this.node45.Expanded = true;
			this.node45.Name = "node45";
			this.node45.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node46 });
			this.node45.Style = this.elementStyle4;
			this.node45.Text = "<b>Tile Set 'BlueMarble'</b> - 3 layers (RGBA, Norm, RGBA)";
			this.node46.Expanded = true;
			this.node46.HostedControl = this.advTree1;
			this.node46.Name = "node46";
			this.node46.Text = "advTree3";
			this.elementStyle4.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle4.Font = new System.Drawing.Font("Microsoft Sans Serif", 9.75f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			this.elementStyle4.MarginBottom = 6;
			this.elementStyle4.MarginTop = 6;
			this.elementStyle4.Name = "elementStyle4";
			this.node47.Expanded = true;
			this.node47.Name = "node47";
			this.node47.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node48 });
			this.node47.Style = this.elementStyle4;
			this.node47.Text = "<b>Tile Set 'Loft'</b> - 2 layers (RGB, RGBA)";
			this.node48.Expanded = true;
			this.node48.HostedControl = this.advTree2;
			this.node48.Name = "node48";
			this.node48.Text = "advTree1";
			this.nodeConnector2.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle8.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle8.Name = "elementStyle8";
			this.elementStyle8.TextColor = System.Drawing.SystemColors.ControlText;
			this.node3.Cells.Add(this.cell1);
			this.node3.Expanded = true;
			this.node3.Name = "node3";
			this.node3.Text = "world.topo.bathy.200412.3x21600x21600.A0.png";
			this.cell1.Name = "cell1";
			this.cell1.StyleMouseOver = null;
			this.cell1.Text = "Imported";
			this.node4.Cells.Add(this.cell2);
			this.node4.Name = "node4";
			this.node4.Text = "world.topo.bathy.200412.3x21600x21600.A1.png";
			this.cell2.Name = "cell2";
			this.cell2.StyleMouseOver = null;
			this.cell2.Text = "Built";
			this.node7.Cells.Add(this.cell5);
			this.node7.ImageIndex = 1;
			this.node7.Name = "node7";
			this.node7.Text = "world.topo.bathy.200412.3x21600x21600.B0.png";
			this.cell5.Name = "cell5";
			this.cell5.StyleMouseOver = null;
			this.cell5.Text = "Missing";
			this.node8.Cells.Add(this.cell3);
			this.node8.Expanded = true;
			this.node8.ImageIndex = 1;
			this.node8.Name = "node8";
			this.node8.Text = "world.topo.bathy.200412.3x21600x21600.B1.png";
			this.cell3.Name = "cell3";
			this.cell3.StyleMouseOver = null;
			this.cell3.Text = "Missing";
			this.styleManager1.ManagerStyle = DevComponents.DotNetBar.eStyle.VisualStudio2012Light;
			this.styleManager1.MetroColorParameters = new DevComponents.DotNetBar.Metro.ColorTables.MetroColorGeneratorParameters(System.Drawing.Color.FromArgb(239, 239, 242), System.Drawing.Color.FromArgb(0, 122, 204));
			this.comboItem1.Text = "Fast";
			this.comboItem2.Text = "Optimized";
			this.comboItem5.Text = "Fast";
			this.comboItem6.Text = "Optimized";
			this.advTree3.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.advTree3.AllowDrop = true;
			this.advTree3.BackColor = System.Drawing.SystemColors.Window;
			this.advTree3.BackgroundStyle.Class = "TreeBorderKey";
			this.advTree3.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.advTree3.Columns.Add(this.columnHeader5);
			this.advTree3.Columns.Add(this.columnHeader6);
			this.advTree3.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.advTree3.Location = new System.Drawing.Point(0, 0);
			this.advTree3.Name = "advTree3";
			this.advTree3.Nodes.AddRange(new DevComponents.AdvTree.Node[4] { this.node18, this.node24, this.node29, this.node31 });
			this.advTree3.NodesConnector = this.nodeConnector3;
			this.advTree3.NodeStyle = this.elementStyle3;
			this.advTree3.PathSeparator = ";";
			this.advTree3.Size = new System.Drawing.Size(535, 524);
			this.advTree3.Styles.Add(this.elementStyle3);
			this.advTree3.TabIndex = 1;
			this.advTree3.Text = "advTree1";
			this.columnHeader5.Name = "columnHeader5";
			this.columnHeader5.StretchToFill = true;
			this.columnHeader5.Text = "Stacked Texture";
			this.columnHeader5.Width.Absolute = 150;
			this.columnHeader6.Name = "columnHeader6";
			this.columnHeader6.Text = "State";
			this.columnHeader6.Width.Absolute = 150;
			this.node18.Image = GrBuildStudio.Properties.Resources.exclamation;
			this.node18.Name = "node18";
			this.node18.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node20, this.node23 });
			this.node18.Text = "BlueMarble";
			this.node20.Expanded = true;
			this.node20.Name = "node20";
			this.node20.Text = "Diffuse: bluemarble_d.png";
			this.node23.Expanded = true;
			this.node23.Name = "node23";
			this.node23.Text = "Normals: bluemarble_n.png";
			this.node24.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node24.Name = "node24";
			this.node24.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node25, this.node28 });
			this.node24.Text = "Glider";
			this.node25.Name = "node25";
			this.node25.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node26 });
			this.node25.Text = "Diffuse: UDIM";
			this.node26.Name = "node26";
			this.node26.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node27 });
			this.node26.Text = "102 items found... expand to view";
			this.node27.Cells.Add(this.cell10);
			this.node27.Expanded = true;
			this.node27.Name = "node27";
			this.node27.Text = "world.topo.bathy.200412.3x21600x21600.A0_n.png";
			this.cell10.Name = "cell10";
			this.cell10.StyleMouseOver = null;
			this.cell10.Text = "Built";
			this.node28.Expanded = true;
			this.node28.Name = "node28";
			this.node28.Text = "Normals: UDIM";
			this.node29.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node29.Name = "node29";
			this.node29.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node30 });
			this.node29.Text = "Loft";
			this.node30.Expanded = true;
			this.node30.Name = "node30";
			this.node30.Text = "node16";
			this.node31.Image = GrBuildStudio.Properties.Resources.error_add;
			this.node31.Name = "node31";
			this.node31.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node32, this.node33 });
			this.node31.Text = "Asset 3";
			this.node32.Expanded = true;
			this.node32.Name = "node32";
			this.node32.Text = "node10";
			this.node33.Expanded = true;
			this.node33.Name = "node33";
			this.node33.Text = "node11";
			this.nodeConnector3.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle3.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle3.Name = "elementStyle3";
			this.elementStyle3.TextColor = System.Drawing.SystemColors.ControlText;
			this.node34.Expanded = true;
			this.node34.HostedControl = this.advTree3;
			this.node34.Name = "node34";
			this.node34.Text = "advTree3";
			this.contextMenuStripAssetSelected.Items.AddRange(new System.Windows.Forms.ToolStripItem[5] { this.toolStripMenuItemEditAsset, this.toolStripMenuItemRemoveAsset, this.toolStripMenuItemRenameAsset, this.toolStripSeparator3, this.toolStripMenuItemMigrateAsset });
			this.contextMenuStripAssetSelected.Name = "contextMenuStripAssetSelected";
			this.contextMenuStripAssetSelected.Size = new System.Drawing.Size(118, 98);
			this.toolStripMenuItemEditAsset.Name = "toolStripMenuItemEditAsset";
			this.toolStripMenuItemEditAsset.Size = new System.Drawing.Size(117, 22);
			this.toolStripMenuItemEditAsset.Text = "Edit...";
			this.toolStripMenuItemEditAsset.Click += new System.EventHandler(editToolStripMenuItem_Click);
			this.toolStripMenuItemRemoveAsset.Image = GrBuildStudio.Properties.Resources.cross;
			this.toolStripMenuItemRemoveAsset.Name = "toolStripMenuItemRemoveAsset";
			this.toolStripMenuItemRemoveAsset.Size = new System.Drawing.Size(117, 22);
			this.toolStripMenuItemRemoveAsset.Text = "Remove";
			this.toolStripMenuItemRemoveAsset.Click += new System.EventHandler(removeToolStripMenuItem_Click);
			this.toolStripMenuItemRenameAsset.Name = "toolStripMenuItemRenameAsset";
			this.toolStripMenuItemRenameAsset.Size = new System.Drawing.Size(117, 22);
			this.toolStripMenuItemRenameAsset.Text = "Rename";
			this.toolStripMenuItemRenameAsset.Click += new System.EventHandler(renameStackedTextureToolStripMenuItem_Click);
			this.toolStripSeparator3.Name = "toolStripSeparator3";
			this.toolStripSeparator3.Size = new System.Drawing.Size(114, 6);
			this.toolStripMenuItemMigrateAsset.Name = "toolStripMenuItemMigrateAsset";
			this.toolStripMenuItemMigrateAsset.Size = new System.Drawing.Size(117, 22);
			this.toolStripMenuItemMigrateAsset.Text = "Migrate";
			this.toolStripMenuItemMigrateAsset.Click += new System.EventHandler(toolStripMenuItemMigrateAsset_Click);
			this.importSingleAssetToolStripMenuItem.DropDownItems.AddRange(new System.Windows.Forms.ToolStripItem[3] { this.singleAssetToolStripMenuItem, this.batchImportToolStripMenuItem, this.fromImportScriptToolStripMenuItem });
			this.importSingleAssetToolStripMenuItem.Image = GrBuildStudio.Properties.Resources.image_add;
			this.importSingleAssetToolStripMenuItem.Name = "importSingleAssetToolStripMenuItem";
			this.importSingleAssetToolStripMenuItem.Size = new System.Drawing.Size(263, 22);
			this.importSingleAssetToolStripMenuItem.Text = "Add Stacked Texture(s)";
			this.singleAssetToolStripMenuItem.Name = "singleAssetToolStripMenuItem";
			this.singleAssetToolStripMenuItem.Size = new System.Drawing.Size(213, 22);
			this.singleAssetToolStripMenuItem.Text = "Single Stacked Texture(s)...";
			this.singleAssetToolStripMenuItem.Click += new System.EventHandler(buttonItemTileSetImportSingleAsset_Click);
			this.batchImportToolStripMenuItem.Name = "batchImportToolStripMenuItem";
			this.batchImportToolStripMenuItem.Size = new System.Drawing.Size(213, 22);
			this.batchImportToolStripMenuItem.Text = "Batch Import...";
			this.batchImportToolStripMenuItem.Click += new System.EventHandler(buttonItemTileSetImportBatch_Click);
			this.fromImportScriptToolStripMenuItem.Name = "fromImportScriptToolStripMenuItem";
			this.fromImportScriptToolStripMenuItem.Size = new System.Drawing.Size(213, 22);
			this.fromImportScriptToolStripMenuItem.Text = "From Import Script...";
			this.fromImportScriptToolStripMenuItem.Click += new System.EventHandler(buttonItemTileSetImportFromScript_Click);
			this.toolStripMenuItem1.Name = "toolStripMenuItem1";
			this.toolStripMenuItem1.Size = new System.Drawing.Size(263, 22);
			this.toolStripMenuItem1.Text = "Properties...";
			this.toolStripMenuItem1.Click += new System.EventHandler(buttonItemTileSetProperties_Click);
			this.openTileSetToolStripMenuItem.Image = GrBuildStudio.Properties.Resources.bar_tilesetviewer;
			this.openTileSetToolStripMenuItem.Name = "openTileSetToolStripMenuItem";
			this.openTileSetToolStripMenuItem.Size = new System.Drawing.Size(263, 22);
			this.openTileSetToolStripMenuItem.Text = "Open Tile Set Output...";
			this.openTileSetToolStripMenuItem.Click += new System.EventHandler(buttonItemTileSetOpenViewer_Click);
			this.contextMenuStripRightClickProject.Items.AddRange(new System.Windows.Forms.ToolStripItem[13]
			{
				this.importSingleAssetToolStripMenuItem, this.seperatorToolStripMenuItem, this.buildToolStripMenuItem, this.rebuildToolStripMenuItem, this.cleanToolStripMenuItem, this.toolStripSeparator1, this.openTileSetToolStripMenuItem, this.showTileSetInWindowsExplorerToolStripMenuItem, this.copyOutputFileNameToolStripMenuItem, this.seperator2ToolStripMenuItem,
				this.excludeFromSolutionToolStripMenuItem, this.toolStripSeparator2, this.toolStripMenuItem1
			});
			this.contextMenuStripRightClickProject.Name = "contextMenuStripAssetSelected";
			this.contextMenuStripRightClickProject.Size = new System.Drawing.Size(264, 226);
			this.contextMenuStripRightClickProject.Opening += new System.ComponentModel.CancelEventHandler(contextMenuStripRightClickProject_Opening);
			this.seperatorToolStripMenuItem.Name = "seperatorToolStripMenuItem";
			this.seperatorToolStripMenuItem.Size = new System.Drawing.Size(260, 6);
			this.buildToolStripMenuItem.Name = "buildToolStripMenuItem";
			this.buildToolStripMenuItem.Size = new System.Drawing.Size(263, 22);
			this.buildToolStripMenuItem.Text = "Build Tileset";
			this.buildToolStripMenuItem.Click += new System.EventHandler(buildToolStripMenuItem_Click);
			this.rebuildToolStripMenuItem.Name = "rebuildToolStripMenuItem";
			this.rebuildToolStripMenuItem.Size = new System.Drawing.Size(263, 22);
			this.rebuildToolStripMenuItem.Text = "Rebuild Tileset";
			this.rebuildToolStripMenuItem.Click += new System.EventHandler(rebuildToolStripMenuItem_Click);
			this.cleanToolStripMenuItem.Name = "cleanToolStripMenuItem";
			this.cleanToolStripMenuItem.Size = new System.Drawing.Size(263, 22);
			this.cleanToolStripMenuItem.Text = "Clean Tileset";
			this.cleanToolStripMenuItem.Click += new System.EventHandler(cleanToolStripMenuItem_Click);
			this.toolStripSeparator1.Name = "toolStripSeparator1";
			this.toolStripSeparator1.Size = new System.Drawing.Size(260, 6);
			this.showTileSetInWindowsExplorerToolStripMenuItem.Name = "showTileSetInWindowsExplorerToolStripMenuItem";
			this.showTileSetInWindowsExplorerToolStripMenuItem.Size = new System.Drawing.Size(263, 22);
			this.showTileSetInWindowsExplorerToolStripMenuItem.Text = "Show Output in Windows Explorer...";
			this.showTileSetInWindowsExplorerToolStripMenuItem.Click += new System.EventHandler(showTileSetInWindowsExplorerToolStripMenuItem_Click);
			this.copyOutputFileNameToolStripMenuItem.Name = "copyOutputFileNameToolStripMenuItem";
			this.copyOutputFileNameToolStripMenuItem.Size = new System.Drawing.Size(263, 22);
			this.copyOutputFileNameToolStripMenuItem.Text = "Copy Output File Name";
			this.copyOutputFileNameToolStripMenuItem.Click += new System.EventHandler(copyOutputFileNameToolStripMenuItem_Click);
			this.seperator2ToolStripMenuItem.Name = "seperator2ToolStripMenuItem";
			this.seperator2ToolStripMenuItem.Size = new System.Drawing.Size(260, 6);
			this.excludeFromSolutionToolStripMenuItem.Name = "excludeFromSolutionToolStripMenuItem";
			this.excludeFromSolutionToolStripMenuItem.Size = new System.Drawing.Size(263, 22);
			this.excludeFromSolutionToolStripMenuItem.Text = "Delete Project...";
			this.excludeFromSolutionToolStripMenuItem.Click += new System.EventHandler(excludeFromSolutionToolStripMenuItem_Click);
			this.toolStripSeparator2.Name = "toolStripSeparator2";
			this.toolStripSeparator2.Size = new System.Drawing.Size(260, 6);
			this.readOnlyMessageBar.Dock = System.Windows.Forms.DockStyle.Top;
			this.readOnlyMessageBar.Location = new System.Drawing.Point(0, 50);
			this.readOnlyMessageBar.MessageImage = (System.Drawing.Image)resources.GetObject("readOnlyMessageBar.MessageImage");
			this.readOnlyMessageBar.MessageText = "The solution or one or more projects are opened in read-only mode. You can build but not add or edit projects.";
			this.readOnlyMessageBar.Name = "readOnlyMessageBar";
			this.readOnlyMessageBar.Padding = new System.Windows.Forms.Padding(10, 0, 0, 0);
			this.readOnlyMessageBar.Size = new System.Drawing.Size(1008, 36);
			this.readOnlyMessageBar.TabIndex = 10;
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.ClientSize = new System.Drawing.Size(1008, 729);
			base.Controls.Add(this.dockSite9);
			base.Controls.Add(this.dockSite2);
			base.Controls.Add(this.dockSite1);
			base.Controls.Add(this.dockSite3);
			base.Controls.Add(this.dockSite4);
			base.Controls.Add(this.dockSite5);
			base.Controls.Add(this.dockSite6);
			base.Controls.Add(this.readOnlyMessageBar);
			base.Controls.Add(this.dockSite7);
			base.Controls.Add(this.dockSite8);
			this.DoubleBuffered = true;
			base.Icon = (System.Drawing.Icon)resources.GetObject("$this.Icon");
			base.KeyPreview = true;
			base.Name = "MainForm";
			this.Text = "Tile Set Studio";
			base.FormClosing += new System.Windows.Forms.FormClosingEventHandler(MainForm_FormClosing);
			base.Load += new System.EventHandler(MainForm_Load);
			this.dockSite9.ResumeLayout(false);
			((System.ComponentModel.ISupportInitialize)this.bar2).EndInit();
			this.bar2.ResumeLayout(false);
			this.panelDockContainer1.ResumeLayout(false);
			this.dockSite2.ResumeLayout(false);
			((System.ComponentModel.ISupportInitialize)this.bar8).EndInit();
			this.bar8.ResumeLayout(false);
			this.panelDockContainer8.ResumeLayout(false);
			this.panelDockContainer8.PerformLayout();
			((System.ComponentModel.ISupportInitialize)this.bar6).EndInit();
			this.bar6.ResumeLayout(false);
			this.panelDockContainer5.ResumeLayout(false);
			this.dockSite7.ResumeLayout(false);
			((System.ComponentModel.ISupportInitialize)this.bar3).EndInit();
			((System.ComponentModel.ISupportInitialize)this.bar4).EndInit();
			((System.ComponentModel.ISupportInitialize)this.advTree1).EndInit();
			((System.ComponentModel.ISupportInitialize)this.advTree2).EndInit();
			((System.ComponentModel.ISupportInitialize)this.advTree3).EndInit();
			this.contextMenuStripAssetSelected.ResumeLayout(false);
			this.contextMenuStripRightClickProject.ResumeLayout(false);
			base.ResumeLayout(false);
		}
	}
	public class AutoBuildReport
	{
		public bool ErrorsOccurred { get; set; }

		public bool AtlassingErrorsOccurred { get; set; }
	}
	public class BatchImportAssetsForm : Office2007Form
	{
		private class ControlRow
		{
			public ChannelPickerControl picker;

			public BatchTemplateControl batchTemplate;

			public ButtonX optionsButton;

			public ButtonX infoButton;

			public LayerAssetDetailsControl details;

			public ImportTemplateInfo[] templateInfo = new ImportTemplateInfo[4];

			public string prevText;

			public int layerIndex;

			public BatchInfo batchInfo;

			public SwizzleControl[] swizzle = new SwizzleControl[4];

			public ButtonItem[] swizzleMenuButton = new ButtonItem[4];
		}

		private struct PresetControlPair
		{
			internal SwizzleControl Control { get; set; }

			internal SwizzlePreset Preset { get; set; }

			internal PresetControlPair(SwizzleControl control, SwizzlePreset preset)
			{
				this = default(PresetControlPair);
				Control = control;
				Preset = preset;
			}
		}

		private SolutionModel model;

		private LayerConfig layerConfig;

		private FolderBrowserDialog folderBrowser;

		private List<ControlRow> controlRows;

		private string suggestedName = "MyAssetName";

		private SlowTaskMonitor slowTaskMonitor;

		private string[] columnNames = new string[6] { "", "Layer", "Path", "Filter", "", "" };

		private int[] columnWidths = new int[6] { 25, 110, 320, 140, 60, 60 };

		private int controlHeight = 20;

		private int controlMargin = 20;

		private ProjectSettings projectSettings;

		private UserSettings userSettings;

		private IContainer components;

		private AdvTree advTreeMatchingFiles;

		private Node node1;

		private Node node2;

		private Node node3;

		private Node node4;

		private Node node6;

		private Node node5;

		private NodeConnector nodeConnector1;

		private ElementStyle elementStyle1;

		private Label label1;

		private Label label2;

		private Button buttonImport;

		private Button buttonCancel;

		private ComboBoxEx comboBoxExName;

		private ComboItem comboItem2;

		private ComboItem comboItem3;

		private ComboItem comboItem4;

		private BackgroundWorker backgroundWorker1;

		private ComboItem comboItem5;

		private ComboItem comboItem6;

		private Button button3;

		private ComboBox comboBox1;

		private Label label3;

		private Button button6;

		private Label labelName;

		private ScrollableEditList scrollableEditList;

		private ToolTip ToolTip;

		public LayerTemplateImportDescription LayerTemplateImportDescription { get; private set; }

		private BatchImportAssetsForm()
		{
			InitializeComponent();
		}

		public BatchImportAssetsForm(LayerConfig layerConfig, SolutionModel model, UserSettings userSettings)
		{
			this.model = model;
			this.userSettings = userSettings;
			InitializeComponent();
			projectSettings = userSettings.Solution[model.ActiveProjectBuilder.ActiveProject.Id];
			folderBrowser = new FolderBrowserDialog();
			this.layerConfig = layerConfig;
			LayerTemplateImportDescription = new LayerTemplateImportDescription();
			for (int i = 0; i < columnNames.Length; i++)
			{
				scrollableEditList.Columns.Add(new ScrollableEditList.ColumnItem(columnNames[i], columnWidths[i]));
			}
			if (layerConfig != null)
			{
				controlRows = new List<ControlRow>();
				for (int j = 0; j < layerConfig.Layers.Count; j++)
				{
					ScrollableEditList.Row row = null;
					MakeRow(j, out row, out var controls);
					scrollableEditList.Rows.Add(row);
					controlRows.Add(controls);
					UpdateInfo(controls, 0);
				}
			}
			updateExampleName();
			updateMatchingFiles();
		}

		private void MakeRow(int layerIndex, out ScrollableEditList.Row row, out ControlRow controls)
		{
			controls = new ControlRow();
			controls.batchInfo = projectSettings.GetBatchInfo(layerIndex);
			controls.layerIndex = layerIndex;
			controls.picker = new ChannelPickerControl(layerConfig.Layers[layerIndex].DataType);
			controls.picker.Name = "folderPicker";
			controls.picker.Size = new Size(500, controls.picker.Size.Height);
			controls.picker.BackColor = System.Drawing.Color.Transparent;
			controls.picker.PickerPicked += picker_Picked;
			controls.picker.PickerUpdate += picker_PickerUpdate;
			controls.picker.SourceModeChanged += picker_SourceModeChanged;
			controls.picker.PickerFileDropped += picker_PickerFileDropped;
			controls.picker.Tag = controls;
			controls.picker.Init(ToolTip, "TT_BATCHIMPORT_FOLDER", layerIndex, ChannelPickerControl.FileFolderMode.Folder);
			controls.picker.SetDisplayText(0, controls.batchInfo.GetImportLocation(0));
			controls.picker.ReadOnly = false;
			controls.batchTemplate = new BatchTemplateControl();
			controls.batchTemplate.Size = new Size(columnWidths[3] - 2 * controlMargin, controls.batchTemplate.Size.Height);
			controls.batchTemplate.Tag = controls;
			controls.batchTemplate.BackColor = System.Drawing.Color.Transparent;
			controls.batchTemplate.Init(ToolTip, "TT_BATCHIMPORT_TEMPLATE", layerIndex, controls.batchInfo);
			controls.batchTemplate.UpdateTemplate += batchTemplate_UpdateTemplate;
			controls.optionsButton = SetupOptionsButton(controls, layerIndex);
			controls.optionsButton.Tag = controls;
			controls.optionsButton.TabIndex = 10 * (layerIndex + 1) + 6;
			controls.details = new LayerAssetDetailsControl();
			controls.details.Tag = controls;
			controls.infoButton = SetupInfoButton(controls.details);
			controls.infoButton.Tag = controls;
			controls.infoButton.TabIndex = 10 * (layerIndex + 1) + 8;
			row = new ScrollableEditList.Row();
			row.RowItems.Add(new ScrollableEditList.RowItem(""));
			row.RowItems.Add(new ScrollableEditList.RowItem(layerConfig.Layers[layerIndex].LayerName));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.picker));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.batchTemplate));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.optionsButton));
			row.RowItems.Add(new ScrollableEditList.RowItem(controls.infoButton));
		}

		private void picker_PickerFileDropped(object sender, int subIndex, string filePath)
		{
			ChannelPickerControl obj = (ChannelPickerControl)sender;
			ControlRow row = (ControlRow)obj.Tag;
			UpdateInfo(row, subIndex);
			obj.SetDisplayText(subIndex, filePath);
		}

		private void picker_PickerUpdate(object sender, EventArgs e, int subtextureIndex)
		{
			ChannelPickerControl channelPickerControl = (ChannelPickerControl)sender;
			ControlRow row = (ControlRow)channelPickerControl.Tag;
			ImportTemplateInfo importTemplateInfo = UpdateInfo(row, subtextureIndex);
			if (importTemplateInfo != null)
			{
				channelPickerControl.SetDisplayText(subtextureIndex, importTemplateInfo.BasePath);
			}
		}

		private void picker_Picked(object sender, EventArgs e, int subtextureIndex)
		{
			ChannelPickerControl channelPickerControl = (ChannelPickerControl)sender;
			ControlRow controlRow = (ControlRow)channelPickerControl.Tag;
			folderBrowser.SelectedPath = controlRow.batchInfo.GetImportLocation(subtextureIndex);
			if (folderBrowser.ShowDialog() == DialogResult.OK && UpdateInfo(controlRow, subtextureIndex) != null)
			{
				channelPickerControl.SetDisplayText(subtextureIndex, folderBrowser.SelectedPath);
			}
		}

		private void batchTemplate_UpdateTemplate(object sender, EventArgs e, int subtextureIndex)
		{
			ControlRow controlRow = (ControlRow)((BatchTemplateControl)sender).Tag;
			string text = controlRow.picker.GetDisplayText(subtextureIndex) + "\\" + controlRow.batchTemplate.GetTemplate(subtextureIndex);
			if (controlRow.prevText != text)
			{
				controlRow.prevText = text;
				ImportTemplateInfo importTemplateInfo = UpdateInfo(controlRow, subtextureIndex);
				if (importTemplateInfo != null)
				{
					controlRow.picker.SetDisplayText(subtextureIndex, importTemplateInfo.BasePath);
				}
			}
		}

		private List<string> EnumToStringList<T>()
		{
			List<string> list = new List<string>();
			Array values = System.Enum.GetValues(typeof(T));
			for (int i = 0; i < values.Length; i++)
			{
				list.Add(values.GetValue(i).ToString());
			}
			return list;
		}

		private ButtonItem SetupEnumButtonItems<T>(T defaultValue, string title)
		{
			ButtonItem buttonItem = new ButtonItem();
			buttonItem.GlobalItem = false;
			buttonItem.Text = title;
			string text = defaultValue.ToString();
			foreach (string item in EnumToStringList<T>())
			{
				bool @checked = text.Equals(item);
				ButtonItem buttonItem2 = new ButtonItem();
				buttonItem2.Checked = @checked;
				buttonItem2.Text = item;
				buttonItem2.Tag = item;
				buttonItem2.Click += sub_Click;
				buttonItem.SubItems.Add(buttonItem2);
			}
			return buttonItem;
		}

		private void sub_Click(object sender, EventArgs e)
		{
			ButtonItem buttonItem = (ButtonItem)sender;
			if (buttonItem == null)
			{
				return;
			}
			ButtonItem buttonItem2 = (ButtonItem)buttonItem.Parent;
			if (buttonItem2 == null)
			{
				return;
			}
			foreach (ButtonItem subItem in buttonItem2.SubItems)
			{
				subItem.Checked = subItem == (ButtonItem)sender;
			}
		}

		private ButtonX SetupOptionsButton(ControlRow row, int layerIndex)
		{
			ButtonX buttonX = new ButtonX();
			buttonX.Name = "button";
			buttonX.Text = "Options";
			buttonX.Size = new Size(columnWidths[4] - 2 * controlMargin, controlHeight);
			buttonX.AccessibleRole = AccessibleRole.PushButton;
			buttonX.AutoExpandOnClick = true;
			buttonX.Style = eDotNetBarStyle.StyleManagerControlled;
			buttonX.SubItems.Add(SetupEnumButtonItems(Constants.DefaultQualityLevel, "QualityLevel"));
			ToolTip.SetSuperTooltip(buttonX.SubItems[0], new SuperTooltipInfo("", "", "TT_OPTION_QUALITYLEVEL", null, null, ToolTip.DefaultTooltipSettings.Color));
			buttonX.SubItems.Add(SetupEnumButtonItems(FlipOption.None, "Flip"));
			ToolTip.SetSuperTooltip(buttonX.SubItems[1], new SuperTooltipInfo("", "", "TT_OPTION_FLIP", null, null, ToolTip.DefaultTooltipSettings.Color));
			buttonX.SubItems.Add(SetupEnumButtonItems(TextureMipSourceType.Default, "Mip map Source"));
			ButtonItem buttonItem = new ButtonItem();
			buttonItem.Name = "swizzleButton";
			buttonItem.Text = "Swizzle";
			buttonX.SubItems.Add(buttonItem);
			for (int i = 0; i < 4; i++)
			{
				row.swizzleMenuButton[i] = SetupSwizzlingButtonItem(i, row, layerIndex);
				buttonItem.SubItems.Add(row.swizzleMenuButton[i]);
			}
			return buttonX;
		}

		private ButtonX SetupInfoButton(LayerAssetDetailsControl detailControl)
		{
			ButtonX obj = new ButtonX
			{
				Name = "button",
				Text = "Info",
				Size = new Size(columnWidths[5] - 2 * controlMargin, controlHeight),
				AccessibleRole = AccessibleRole.PushButton,
				AutoExpandOnClick = true,
				Style = eDotNetBarStyle.StyleManagerControlled
			};
			ControlContainerItem item = new ControlContainerItem
			{
				AllowItemResize = true,
				MenuVisibility = eMenuVisibility.VisibleAlways,
				Control = detailControl
			};
			obj.SubItems.Add(item);
			return obj;
		}

		private ButtonItem SetupSwizzlingButtonItem(int subIdx, ControlRow row, int layerIndex)
		{
			ButtonItem buttonItem = new ButtonItem();
			buttonItem.Name = "swizzleButton" + subIdx;
			buttonItem.Text = "Swizzle " + subIdx;
			ButtonItem buttonItem2 = new ButtonItem();
			buttonItem2.Text = "Load Preset";
			buttonItem.SubItems.Add(buttonItem2);
			SwizzleControl swizzleControl = new SwizzleControl();
			row.swizzle[subIdx] = swizzleControl;
			swizzleControl.Padding = new System.Windows.Forms.Padding(4, 4, 4, 4);
			SwizzlePreset[] swizzlePresets = Constants.SwizzlePresets;
			foreach (SwizzlePreset swizzlePreset in swizzlePresets)
			{
				ButtonItem buttonItem3 = new ButtonItem();
				buttonItem3.Text = swizzlePreset.Name;
				buttonItem3.Tag = new PresetControlPair(swizzleControl, swizzlePreset);
				buttonItem3.Click += presetButton_Click;
				buttonItem2.SubItems.Add(buttonItem3);
			}
			ControlContainerItem controlContainerItem = new ControlContainerItem();
			controlContainerItem.AllowItemResize = false;
			controlContainerItem.BeginGroup = false;
			controlContainerItem.GlobalItem = false;
			controlContainerItem.MenuVisibility = eMenuVisibility.VisibleAlways;
			controlContainerItem.Name = "controlContainerItem1";
			controlContainerItem.Text = "Swizzle";
			LabelItem labelItem = new LabelItem();
			labelItem.Text = "Custom: ";
			labelItem.PaddingLeft = 32;
			ItemContainer itemContainer = new ItemContainer();
			itemContainer.BeginGroup = true;
			itemContainer.SubItems.Add(labelItem);
			itemContainer.SubItems.Add(controlContainerItem);
			int numChannels = DataTypeInfo.GetNumChannels(layerConfig.Layers[layerIndex].DataType);
			swizzleControl.Initialize(numChannels, SwizzlePreset.RGBA.Pattern);
			controlContainerItem.Control = swizzleControl;
			buttonItem.SubItems.Add(itemContainer);
			return buttonItem;
		}

		private void presetButton_Click(object sender, EventArgs e)
		{
			PresetControlPair presetControlPair = (PresetControlPair)((ButtonItem)sender).Tag;
			presetControlPair.Control.LoadSwizzle(presetControlPair.Preset.Pattern);
		}

		private ImportTemplateInfo UpdateInfo(ControlRow row, int subtextureIndex)
		{
			slowTaskMonitor = new SlowTaskMonitor("Scanning", this);
			slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
			slowTaskMonitor.Start();
			ImportTemplateInfo importTemplateInfo = null;
			string displayText = row.picker.GetDisplayText(subtextureIndex);
			string template = row.batchTemplate.GetTemplate(subtextureIndex);
			bool scanRecursively = false;
			if (displayText != string.Empty && Directory.Exists(displayText))
			{
				importTemplateInfo = ImportTemplateInfo.ParseAndScan(displayText, template, 0, scanRecursively);
				row.templateInfo[subtextureIndex] = importTemplateInfo;
			}
			else
			{
				row.templateInfo[subtextureIndex] = null;
			}
			UpdateDetails(row);
			slowTaskMonitor.End();
			updateExampleName();
			updateMatchingFiles();
			return importTemplateInfo;
		}

		private void UpdateDetails(ControlRow row)
		{
			int num = 1;
			ChannelMerging.ChannelMask channelMask = null;
			Dictionary<AssetPackingMode, ChannelMerging.ChannelMask> allMasks = new Dictionary<AssetPackingMode, ChannelMerging.ChannelMask>();
			ChannelMerging.GetAllChannelMasks(layerConfig.Layers[row.layerIndex].DataType, ref allMasks);
			switch (row.picker.ActiveSourceMode)
			{
			case SourceMode.MultiSource4:
				num = 4;
				channelMask = allMasks[AssetPackingMode.Combined4];
				break;
			case SourceMode.MultiSource3:
				num = 3;
				channelMask = allMasks[AssetPackingMode.Combined3];
				break;
			case SourceMode.MultiSource:
				num = 2;
				channelMask = allMasks[AssetPackingMode.Combined];
				break;
			}
			MaskInfo maskInfo = default(MaskInfo);
			maskInfo.MaskCount = num;
			maskInfo.Infos = new ImportTemplateInfo[4];
			maskInfo.Names = new string[4];
			for (int i = 0; i < num; i++)
			{
				maskInfo.Infos[i] = row.templateInfo[i];
				maskInfo.Names[i] = ((channelMask != null) ? channelMask.humanReadable[i] : string.Empty);
			}
			row.details.UpdateTree(maskInfo);
			bool visible = row.picker.ActiveSourceMode == SourceMode.MultiSource || row.picker.ActiveSourceMode == SourceMode.MultiSource3 || row.picker.ActiveSourceMode == SourceMode.MultiSource4;
			bool visible2 = row.picker.ActiveSourceMode == SourceMode.MultiSource3 || row.picker.ActiveSourceMode == SourceMode.MultiSource4;
			bool visible3 = row.picker.ActiveSourceMode == SourceMode.MultiSource4;
			row.swizzleMenuButton[0].Text = ((row.picker.ActiveSourceMode == SourceMode.SingleSource) ? "Swizzle" : "Swizzle 0");
			row.swizzleMenuButton[1].Visible = visible;
			row.swizzleMenuButton[2].Visible = visible2;
			row.swizzleMenuButton[3].Visible = visible3;
		}

		private void updateExampleName()
		{
			string text = comboBoxExName.Text.Replace("*", suggestedName);
			labelName.Text = "Example: \t\"" + text + "\"";
		}

		private string ValidateSubIndex(int layerIdx, int subIdx)
		{
			string text = " :\"";
			if (controlRows[layerIdx].picker.ActiveSourceMode != 0)
			{
				text = " (sub-texture " + subIdx + ") :\"";
			}
			if (!Directory.Exists(controlRows[layerIdx].picker.GetDisplayText(subIdx)))
			{
				return "Unvalid directory of layer " + (layerIdx + 1) + text + layerConfig.Layers[layerIdx].LayerName + "\".";
			}
			if (controlRows[layerIdx].templateInfo[subIdx] == null)
			{
				return "No info found for layer " + (layerIdx + 1) + text + layerConfig.Layers[layerIdx].LayerName + "\".";
			}
			Match match = Regex.Match(controlRows[layerIdx].batchTemplate.Text, "[%@#]");
			if (match.Success)
			{
				return "Unvalid character (" + match.Value + ") for import template in layer " + (layerIdx + 1) + text + layerConfig.Layers[layerIdx].LayerName + "\".";
			}
			if (controlRows[layerIdx].templateInfo[subIdx].FoundTextureFiles.NumberOfTextures == 0)
			{
				return "No files found for layer " + (layerIdx + 1) + text + layerConfig.Layers[layerIdx].LayerName + "\".";
			}
			return null;
		}

		private bool updateMatchingFiles()
		{
			slowTaskMonitor = new SlowTaskMonitor("Updating", this);
			slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
			slowTaskMonitor.Start();
			advTreeMatchingFiles.Nodes.Clear();
			ImportAssetTemplate importAssetTemplate = new ImportAssetTemplate();
			importAssetTemplate.Name = comboBoxExName.Text;
			importAssetTemplate.TilingMethod = AssetTilingMethod.None;
			bool flag = false;
			for (int i = 0; i < controlRows.Count; i++)
			{
				ImportAssetLayerTemplate importAssetLayerTemplate = new ImportAssetLayerTemplate();
				int num = 0;
				num = Math.Min(controlRows[i].picker.ActiveSourceMode switch
				{
					SourceMode.MultiSource => 2, 
					SourceMode.MultiSource3 => 3, 
					SourceMode.MultiSource4 => 4, 
					_ => 1, 
				}, 4);
				for (int j = 0; j < num; j++)
				{
					string text = ValidateSubIndex(i, j);
					if (text == null)
					{
						importAssetLayerTemplate.Source.AddSource(controlRows[i].templateInfo[j].TemplateString, j);
						flag = true;
					}
					else
					{
						advTreeMatchingFiles.Nodes.Add(new Node(text));
					}
				}
				importAssetTemplate.LayerTemplates.Add(importAssetLayerTemplate);
			}
			if (!flag && advTreeMatchingFiles.Nodes.Count != 0)
			{
				slowTaskMonitor.End();
				return false;
			}
			TemplateImportScanner templateImportScanner = new TemplateImportScanner();
			templateImportScanner.Scan(importAssetTemplate);
			Node node = new Node(((templateImportScanner.FoundAssets.Count == 0) ? "No m" : (templateImportScanner.FoundAssets.Count + " M")) + "atching files found.");
			advTreeMatchingFiles.Nodes.Add(node);
			if (templateImportScanner.FoundAssets.Count == 0)
			{
				slowTaskMonitor.End();
				return false;
			}
			for (int k = 0; k < templateImportScanner.FoundAssets.Count; k++)
			{
				node.Nodes.Add(new Node(templateImportScanner.FoundAssets[k].Name));
				for (int l = 0; l < templateImportScanner.FoundAssets[k].LayerSourceTextures.Count; l++)
				{
					node.Nodes[k].Nodes.Add(new Node(l + 1 + ": \"" + layerConfig.Layers[l].LayerName + "\""));
					AssetPackingMode assetPackingMode = AssetPackingMode.None;
					assetPackingMode = controlRows[l].picker.ActiveSourceMode switch
					{
						SourceMode.MultiSource => AssetPackingMode.Combined, 
						SourceMode.MultiSource3 => AssetPackingMode.Combined3, 
						SourceMode.MultiSource4 => AssetPackingMode.Combined4, 
						_ => AssetPackingMode.None, 
					};
					int num2 = 0;
					int numChannels = DataTypeInfo.GetNumChannels(layerConfig.Layers[l].DataType);
					int subIdx;
					for (subIdx = 0; subIdx < 4; subIdx++)
					{
						int channelCount = ChannelMerging.GetChannelCount(assetPackingMode, layerConfig.Layers[l].DataType, l, subIdx);
						List<CombinedTextureSource.Item> list = templateImportScanner.FoundAssets[k].LayerSourceTextures[l].Sources.Where((CombinedTextureSource.Item _src) => _src.SubIndex == subIdx).ToList();
						if (list.Count == 0)
						{
							if (ChannelMerging.IsCombinedMode(assetPackingMode))
							{
								string text2 = "(";
								text2 += ChannelMerging.GetChannelMaskHumanReadable(layerConfig.Layers[l].DataType, assetPackingMode, subIdx);
								text2 += ")";
								node.Nodes[k].Nodes[l].Nodes.Add(new Node("Default layer color " + text2));
							}
						}
						else
						{
							foreach (CombinedTextureSource.Item item in list)
							{
								string text3 = "";
								if (ChannelMerging.IsCombinedMode(assetPackingMode))
								{
									text3 = " (";
									text3 += ChannelMerging.GetChannelMaskHumanReadable(layerConfig.Layers[l].DataType, assetPackingMode, item.SubIndex);
									text3 += ")";
								}
								node.Nodes[k].Nodes[l].Nodes.Add(new Node(item.Source + text3));
							}
						}
						num2 += channelCount;
						if (num2 >= numChannels)
						{
							break;
						}
					}
				}
			}
			node.Expanded = true;
			slowTaskMonitor.End();
			return true;
		}

		private void comboBoxExName_Leave(object sender, EventArgs e)
		{
			updateExampleName();
			updateMatchingFiles();
		}

		private void buttonImport_Click(object sender, EventArgs e)
		{
			if (!updateMatchingFiles())
			{
				return;
			}
			slowTaskMonitor = new SlowTaskMonitor("Preparing Import", this);
			slowTaskMonitor.Type = SlowTaskMonitor.ProgressBarType.Marquee;
			slowTaskMonitor.Start();
			LayerTemplateImportDescription.Name = comboBoxExName.Text;
			int num = 0;
			foreach (ControlRow controlRow in controlRows)
			{
				LayerAssetImportDescription layerAssetImportDescription = new LayerAssetImportDescription();
				layerAssetImportDescription.Name = layerConfig.Layers[num].LayerName;
				for (int i = 0; i < 4; i++)
				{
					if (controlRow.templateInfo[i] != null)
					{
						layerAssetImportDescription.FileSources.AddSource(controlRow.templateInfo[i].TemplateString, i);
						controlRow.batchInfo.SetImportLocation(i, controlRow.picker.GetDisplayText(i));
						controlRow.batchInfo.PushTemplate(i, controlRow.batchTemplate.GetTemplate(i));
					}
				}
				AssetPackingMode packingMode = AssetPackingMode.None;
				switch (controlRow.picker.ActiveSourceMode)
				{
				case SourceMode.MultiSource:
					packingMode = AssetPackingMode.Combined;
					break;
				case SourceMode.MultiSource3:
					packingMode = AssetPackingMode.Combined3;
					break;
				case SourceMode.MultiSource4:
					packingMode = AssetPackingMode.Combined4;
					break;
				}
				layerAssetImportDescription.PackingMode = packingMode;
				for (int j = 0; j < 4; j++)
				{
					layerAssetImportDescription.Swizzle[j] = controlRows[num].swizzle[j].Swizzle;
					if (layerAssetImportDescription.Swizzle[j].Equals(SwizzlePreset.Default.Pattern))
					{
						layerAssetImportDescription.Swizzle[j] = "";
					}
				}
				foreach (ButtonItem subItem in controlRow.optionsButton.SubItems[0].SubItems)
				{
					if (subItem.Checked)
					{
						layerAssetImportDescription.Quality = (QualityLevel)System.Enum.Parse(typeof(QualityLevel), subItem.Text);
						break;
					}
				}
				foreach (ButtonItem subItem2 in controlRow.optionsButton.SubItems[1].SubItems)
				{
					if (subItem2.Checked)
					{
						layerAssetImportDescription.Flip = (FlipOption)System.Enum.Parse(typeof(FlipOption), subItem2.Text);
						break;
					}
				}
				foreach (ButtonItem subItem3 in controlRow.optionsButton.SubItems[2].SubItems)
				{
					if (subItem3.Checked)
					{
						layerAssetImportDescription.MipSourceType = (TextureMipSourceType)System.Enum.Parse(typeof(TextureMipSourceType), subItem3.Text);
						break;
					}
				}
				LayerTemplateImportDescription.LayerTemplates.Add(layerAssetImportDescription);
				projectSettings.SetBatchInfo(num, controlRow.batchInfo);
				num++;
			}
			slowTaskMonitor.End();
			userSettings.Solution[model.ActiveProjectBuilder.ActiveProject.Id] = projectSettings;
			base.DialogResult = DialogResult.OK;
		}

		private void picker_SourceModeChanged(object sender, SourceMode mode)
		{
			ChannelPickerControl channelPickerControl = (ChannelPickerControl)sender;
			ControlRow controlRow = (ControlRow)channelPickerControl.Tag;
			controlRow.batchTemplate.ActiveSourceMode = channelPickerControl.ActiveSourceMode;
			int num = 0;
			num = channelPickerControl.ActiveSourceMode switch
			{
				SourceMode.MultiSource => 2, 
				SourceMode.MultiSource3 => 3, 
				SourceMode.MultiSource4 => 4, 
				_ => 1, 
			};
			for (int i = 0; i < num; i++)
			{
				UpdateInfo(controlRow, i);
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.advTreeMatchingFiles = new DevComponents.AdvTree.AdvTree();
			this.node1 = new DevComponents.AdvTree.Node();
			this.node2 = new DevComponents.AdvTree.Node();
			this.node6 = new DevComponents.AdvTree.Node();
			this.node3 = new DevComponents.AdvTree.Node();
			this.node4 = new DevComponents.AdvTree.Node();
			this.node5 = new DevComponents.AdvTree.Node();
			this.nodeConnector1 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle1 = new DevComponents.DotNetBar.ElementStyle();
			this.label1 = new System.Windows.Forms.Label();
			this.label2 = new System.Windows.Forms.Label();
			this.buttonImport = new System.Windows.Forms.Button();
			this.buttonCancel = new System.Windows.Forms.Button();
			this.comboBoxExName = new DevComponents.DotNetBar.Controls.ComboBoxEx();
			this.comboItem2 = new DevComponents.Editors.ComboItem();
			this.comboItem3 = new DevComponents.Editors.ComboItem();
			this.comboItem4 = new DevComponents.Editors.ComboItem();
			this.backgroundWorker1 = new System.ComponentModel.BackgroundWorker();
			this.comboItem5 = new DevComponents.Editors.ComboItem();
			this.comboItem6 = new DevComponents.Editors.ComboItem();
			this.button3 = new System.Windows.Forms.Button();
			this.comboBox1 = new System.Windows.Forms.ComboBox();
			this.label3 = new System.Windows.Forms.Label();
			this.button6 = new System.Windows.Forms.Button();
			this.labelName = new System.Windows.Forms.Label();
			this.scrollableEditList = new GrBuildStudio.Controls.ScrollableEditList();
			this.ToolTip = new GrBuildStudio.ToolTip();
			((System.ComponentModel.ISupportInitialize)this.advTreeMatchingFiles).BeginInit();
			base.SuspendLayout();
			this.advTreeMatchingFiles.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.advTreeMatchingFiles.AllowDrop = true;
			this.advTreeMatchingFiles.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.advTreeMatchingFiles.BackColor = System.Drawing.SystemColors.Window;
			this.advTreeMatchingFiles.BackgroundStyle.Class = "TreeBorderKey";
			this.advTreeMatchingFiles.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.advTreeMatchingFiles.DragDropEnabled = false;
			this.advTreeMatchingFiles.DragDropNodeCopyEnabled = false;
			this.advTreeMatchingFiles.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.advTreeMatchingFiles.Location = new System.Drawing.Point(12, 313);
			this.advTreeMatchingFiles.Name = "advTreeMatchingFiles";
			this.advTreeMatchingFiles.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node1 });
			this.advTreeMatchingFiles.NodesConnector = this.nodeConnector1;
			this.advTreeMatchingFiles.NodeStyle = this.elementStyle1;
			this.advTreeMatchingFiles.PathSeparator = ";";
			this.advTreeMatchingFiles.Size = new System.Drawing.Size(788, 209);
			this.advTreeMatchingFiles.Styles.Add(this.elementStyle1);
			this.ToolTip.SetSuperTooltip(this.advTreeMatchingFiles, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_BATCHIMPORT_MATCHINGFILES", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.advTreeMatchingFiles.TabIndex = 36;
			this.advTreeMatchingFiles.Text = "advTreeMatchingFiles";
			this.node1.Expanded = true;
			this.node1.Name = "node1";
			this.node1.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node2, this.node3 });
			this.node1.Text = "Blue Marble";
			this.node2.Expanded = true;
			this.node2.Name = "node2";
			this.node2.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node6 });
			this.node2.Text = "Diffuse - Found 0 files";
			this.node6.Expanded = true;
			this.node6.Name = "node6";
			this.node6.Text = "Empty";
			this.node3.DragDropEnabled = false;
			this.node3.Editable = false;
			this.node3.Expanded = true;
			this.node3.Name = "node3";
			this.node3.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node4, this.node5 });
			this.node3.Text = "Normals - Found 2 files";
			this.node4.Expanded = true;
			this.node4.Name = "node4";
			this.node4.Text = "world.topo.bathy.200412.3x21600x21600.A0.png";
			this.node5.Expanded = true;
			this.node5.Name = "node5";
			this.node5.Text = "world.topo.bathy.200412.3x21600x21600.A1.png";
			this.nodeConnector1.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle1.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle1.Name = "elementStyle1";
			this.elementStyle1.TextColor = System.Drawing.SystemColors.ControlText;
			this.label1.AutoSize = true;
			this.label1.Location = new System.Drawing.Point(13, 263);
			this.label1.Name = "label1";
			this.label1.Size = new System.Drawing.Size(35, 13);
			this.label1.TabIndex = 27;
			this.label1.Text = "Name";
			this.label2.AutoSize = true;
			this.label2.Location = new System.Drawing.Point(13, 292);
			this.label2.Name = "label2";
			this.label2.Size = new System.Drawing.Size(72, 13);
			this.label2.TabIndex = 27;
			this.label2.Text = "Matching files";
			this.buttonImport.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonImport.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.buttonImport.Location = new System.Drawing.Point(645, 539);
			this.buttonImport.Name = "buttonImport";
			this.buttonImport.Size = new System.Drawing.Size(75, 23);
			this.buttonImport.TabIndex = 500;
			this.buttonImport.Text = "Add";
			this.buttonImport.UseVisualStyleBackColor = true;
			this.buttonImport.Click += new System.EventHandler(buttonImport_Click);
			this.buttonCancel.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.buttonCancel.Location = new System.Drawing.Point(726, 539);
			this.buttonCancel.Name = "buttonCancel";
			this.buttonCancel.Size = new System.Drawing.Size(75, 23);
			this.buttonCancel.TabIndex = 520;
			this.buttonCancel.Text = "Cancel";
			this.buttonCancel.UseVisualStyleBackColor = true;
			this.comboBoxExName.DisplayMember = "Text";
			this.comboBoxExName.DrawMode = System.Windows.Forms.DrawMode.OwnerDrawFixed;
			this.comboBoxExName.ForeColor = System.Drawing.Color.Black;
			this.comboBoxExName.FormattingEnabled = true;
			this.comboBoxExName.ItemHeight = 14;
			this.comboBoxExName.Items.AddRange(new object[3] { this.comboItem2, this.comboItem3, this.comboItem4 });
			this.comboBoxExName.Location = new System.Drawing.Point(64, 259);
			this.comboBoxExName.Name = "comboBoxExName";
			this.comboBoxExName.Size = new System.Drawing.Size(269, 20);
			this.comboBoxExName.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.ToolTip.SetSuperTooltip(this.comboBoxExName, new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_BATCHIMPORT_NAMETEMPLATE", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.comboBoxExName.TabIndex = 480;
			this.comboBoxExName.Text = "*";
			this.comboBoxExName.Leave += new System.EventHandler(comboBoxExName_Leave);
			this.comboItem2.Text = "*";
			this.comboItem3.Text = "myprefix_*";
			this.comboItem4.Text = "*_mypostfix";
			this.comboItem5.Text = "Fast";
			this.comboItem6.Text = "Optimized";
			this.button3.Enabled = false;
			this.button3.Location = new System.Drawing.Point(284, 539);
			this.button3.Name = "button3";
			this.button3.Size = new System.Drawing.Size(91, 23);
			this.button3.TabIndex = 40;
			this.button3.Text = "Load Preset...";
			this.button3.UseVisualStyleBackColor = true;
			this.button3.Visible = false;
			this.comboBox1.Enabled = false;
			this.comboBox1.FormattingEnabled = true;
			this.comboBox1.Location = new System.Drawing.Point(71, 540);
			this.comboBox1.Name = "comboBox1";
			this.comboBox1.Size = new System.Drawing.Size(209, 21);
			this.comboBox1.TabIndex = 42;
			this.comboBox1.Visible = false;
			this.label3.AutoSize = true;
			this.label3.Location = new System.Drawing.Point(20, 544);
			this.label3.Name = "label3";
			this.label3.Size = new System.Drawing.Size(42, 13);
			this.label3.TabIndex = 43;
			this.label3.Text = "Presets";
			this.label3.Visible = false;
			this.button6.Enabled = false;
			this.button6.Location = new System.Drawing.Point(377, 539);
			this.button6.Name = "button6";
			this.button6.Size = new System.Drawing.Size(112, 23);
			this.button6.TabIndex = 44;
			this.button6.Text = "Save as Preset...";
			this.button6.UseVisualStyleBackColor = true;
			this.button6.Visible = false;
			this.labelName.Location = new System.Drawing.Point(339, 263);
			this.labelName.Name = "labelName";
			this.labelName.Size = new System.Drawing.Size(323, 18);
			this.labelName.TabIndex = 46;
			this.labelName.Text = "world.topo.bathy.200412.3x21600x21600";
			this.scrollableEditList.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.scrollableEditList.Location = new System.Drawing.Point(16, 12);
			this.scrollableEditList.Name = "scrollableEditList";
			this.scrollableEditList.Size = new System.Drawing.Size(786, 238);
			this.scrollableEditList.TabIndex = 1;
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			base.AcceptButton = this.buttonImport;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.CancelButton = this.buttonCancel;
			base.ClientSize = new System.Drawing.Size(813, 574);
			base.Controls.Add(this.scrollableEditList);
			base.Controls.Add(this.labelName);
			base.Controls.Add(this.button6);
			base.Controls.Add(this.label3);
			base.Controls.Add(this.comboBox1);
			base.Controls.Add(this.button3);
			base.Controls.Add(this.comboBoxExName);
			base.Controls.Add(this.buttonCancel);
			base.Controls.Add(this.buttonImport);
			base.Controls.Add(this.advTreeMatchingFiles);
			base.Controls.Add(this.label2);
			base.Controls.Add(this.label1);
			this.DoubleBuffered = true;
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "BatchImportAssetsForm";
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "Import Multiple Stacked textures in Tile Set 'Loft'";
			((System.ComponentModel.ISupportInitialize)this.advTreeMatchingFiles).EndInit();
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	public class SolutionModel
	{
		public delegate void AssetImportStartedEventHandler(object sender, ProjectBuilder builder);

		public delegate void AssetImportFinishedEventHandler(object sender, ProjectBuilder builder);

		public delegate void ActiveProjectChangedEventHandler(object sender);

		public delegate void AssetAddedEventHandler(object sender, string assetName, Guid projectId);

		public delegate void AssetRemovedEventHandler(object sender, string assetName, Guid projectId);

		public delegate void AssetRemovingEventHandler(object sender, Guid assetId, Guid projectId);

		public delegate void AssetsRemovingEventHandler(object sender, Guid projectId, List<Guid> assets);

		public delegate void AssetsRemovedEventHandler(object sender, Guid projectId);

		public delegate void AssetsAddedEventHandler(object sender, Guid projectId);

		public delegate void ProjectStateChangedEventHandler(object sender, Guid projectId);

		public delegate void ProjectAssetChangedEventHandler(object sender, Guid projectId, Asset asset);

		public delegate void ProjectOutputChangedEventHandler(object sender, Guid projectId);

		public delegate void TargetConfigurationChangedEventHandler(object sender, TargetConfiguration newConfig);

		public class MoveAssetReport
		{
			public int TotalAssetCount { get; set; }

			public bool HasErrors { get; set; }

			public bool HasImportErrors { get; set; }

			public bool HasDeletionErrors { get; set; }

			public bool Canceled { get; set; }

			public BuildLoggerReporter BuildLoggerReporterImport { get; set; }

			public List<BuildLoggerReporter> BuildLoggerReporterDeletion { get; set; }

			public MoveAssetReport()
			{
				BuildLoggerReporterImport = new BuildLoggerReporter();
				BuildLoggerReporterDeletion = new List<BuildLoggerReporter>();
			}
		}

		public class MoveAssetConvProblemsArgs
		{
			public AssetTools.AssetToImportAssetConversionOptions Options { get; set; }

			public bool Continue { get; set; }

			public MoveAssetConvProblemsArgs()
			{
				Continue = true;
				Options = AssetTools.AssetToImportAssetConversionOptions.AllowExtend;
			}
		}

		public delegate void ConversionProblemsCallback(object sender, MoveAssetConvProblemsArgs e);

		public SolutionBuilder SolutionBuilder { get; private set; }

		public ProjectBuilder ActiveProjectBuilder
		{
			get
			{
				if (ActiveSolutionProject == null)
				{
					return null;
				}
				return GetProjectBuilder(ActiveSolutionProject.Id);
			}
		}

		public SolutionProjectDecriptor ActiveSolutionProject { get; private set; }

		public TargetConfiguration TargetConfiguration { get; private set; }

		public bool ReadOnlyMode
		{
			get
			{
				if (SolutionBuilder == null)
				{
					return false;
				}
				if (!SolutionBuilder.ReadOnly)
				{
					return SolutionBuilder.ProjectsReadOnly;
				}
				return true;
			}
		}

		public Solution ActiveSolution => SolutionBuilder.ActiveSolution;

		public event AssetImportStartedEventHandler AssetImportStarted;

		public event AssetImportFinishedEventHandler AssetImportFinished;

		public event ActiveProjectChangedEventHandler ActiveProjectChanged;

		public event AssetAddedEventHandler AssetAdded;

		public event AssetRemovedEventHandler AssetRemoved;

		public event AssetRemovingEventHandler AssetRemoving;

		public event AssetsRemovingEventHandler AssetsRemoving;

		public event AssetsRemovedEventHandler AssetsRemoved;

		public event AssetsAddedEventHandler AssetsAdded;

		public event ProjectStateChangedEventHandler ProjectStateChanged;

		public event ProjectAssetChangedEventHandler ProjectAssetChanged;

		public event ProjectOutputChangedEventHandler ProjectOutputChanged;

		public event TargetConfigurationChangedEventHandler TargetConfigurationChanged;

		protected virtual void OnAssetImportStarted(ProjectBuilder builder)
		{
			this.AssetImportStarted?.Invoke(this, builder);
		}

		protected virtual void OnAssetImportFinished(ProjectBuilder builder)
		{
			this.AssetImportFinished?.Invoke(this, builder);
		}

		protected virtual void OnActiveProjectChanged()
		{
			this.ActiveProjectChanged?.Invoke(this);
		}

		protected virtual void OnAssetAdded(string assetName, Guid projectId)
		{
			this.AssetAdded?.Invoke(this, assetName, projectId);
		}

		protected virtual void OnAssetRemoved(string assetName, Guid projectId)
		{
			this.AssetRemoved?.Invoke(this, assetName, projectId);
		}

		protected virtual void OnAssetRemoving(Guid assetId, Guid projectId)
		{
			this.AssetRemoving?.Invoke(this, assetId, projectId);
		}

		protected virtual void OnAssetsRemoving(Guid projectId, List<Guid> assets)
		{
			this.AssetsRemoving?.Invoke(this, projectId, assets);
		}

		protected virtual void OnAssetsRemoved(Guid projectId)
		{
			this.AssetsRemoved?.Invoke(this, projectId);
		}

		protected virtual void OnAssetsAdded(Guid projectId)
		{
			this.AssetsAdded?.Invoke(this, projectId);
		}

		protected virtual void OnProjectStateChanged(Guid projectId)
		{
			this.ProjectStateChanged?.Invoke(this, projectId);
		}

		protected virtual void OnProjectAssetChanged(Guid projectId, Asset asset)
		{
			this.ProjectAssetChanged?.Invoke(this, projectId, asset);
		}

		protected virtual void OnProjectOutputChanged(Guid projectId)
		{
			this.ProjectOutputChanged?.Invoke(this, projectId);
		}

		protected virtual void OnTargetConfigurationChanged(TargetConfiguration newConfig)
		{
			this.TargetConfigurationChanged?.Invoke(this, newConfig);
		}

		public SolutionModel()
		{
			SolutionBuilder = new SolutionBuilder();
			SolutionBuilder.ExportImportScriptOnSave = true;
			TargetConfiguration = TargetConfiguration.Default;
			SolutionBuilder.ProjectBuildFinished += SolutionBuilder_ProjectBuildFinished;
			SolutionBuilder.ProjectCleanFinished += SolutionBuilder_ProjectCleanFinished;
			SolutionBuilder.ProjectRepageFinished += SolutionBuilder_ProjectRepageFinished;
		}

		public void Close()
		{
			SetActiveProject(Guid.Empty);
			SolutionBuilder.CloseSolution();
		}

		private void SolutionBuilder_ProjectCleanFinished(object sender, ProjectBuilder builder)
		{
			UpdateProjectState(builder);
			OnProjectOutputChanged(builder.ActiveProject.Id);
		}

		private void SolutionBuilder_ProjectRepageFinished(object sender, ProjectBuilder builder)
		{
			UpdateProjectState(builder);
			OnProjectOutputChanged(builder.ActiveProject.Id);
		}

		private void UpdateProjectState(ProjectBuilder builder)
		{
			builder.QueryAssetBuildStates();
			OnProjectStateChanged(builder.ActiveProject.Id);
		}

		private void SolutionBuilder_ProjectBuildFinished(object sender, ProjectBuilder builder)
		{
			UpdateProjectState(builder);
			OnProjectOutputChanged(builder.ActiveProject.Id);
		}

		internal bool IsAssetNameAvailable(Guid projectId, string value)
		{
			ProjectBuilder projectBuilder = GetProjectBuilder(projectId);
			if (projectBuilder != null)
			{
				Asset conflict = null;
				return projectBuilder.IsAssetNameAvavailable(value, out conflict);
			}
			return false;
		}

		public ProjectBuilder GetProjectBuilder(Guid projectId)
		{
			if (!SolutionBuilder.ProjectBuilders.ContainsKey(projectId))
			{
				return null;
			}
			return SolutionBuilder.ProjectBuilders[projectId];
		}

		public ProjectBuilder GetProjectBuilder(string name)
		{
			return SolutionBuilder.GetProjectBuilder(name);
		}

		public bool SetActiveProject(Guid projectId)
		{
			if (projectId == Guid.Empty)
			{
				ActiveSolutionProject = null;
				OnActiveProjectChanged();
				return true;
			}
			if (ActiveSolutionProject != null && ActiveSolutionProject.Id.Equals(projectId))
			{
				return true;
			}
			if (!ActiveSolution.Projects.ContainsKey(projectId))
			{
				return false;
			}
			ActiveSolutionProject = ActiveSolution.Projects[projectId];
			OnActiveProjectChanged();
			return true;
		}

		public bool SetActiveProject(string name)
		{
			Guid key = ActiveSolution.Projects.Where((KeyValuePair<Guid, SolutionProjectDecriptor> _p) => _p.Value.Name == name).FirstOrDefault().Key;
			OnActiveProjectChanged();
			return SetActiveProject(key);
		}

		public void SetTargetConfiguration(TargetConfiguration configuration)
		{
			configuration = TargetConfiguration.Optimized;
			if (configuration != TargetConfiguration)
			{
				TargetConfiguration = configuration;
				SolutionBuilder.LoadConfiguration(configuration);
				ScanAssets();
			}
		}

		public GrBuildLib.Error CreateProject(string name, ProjectTemplate template)
		{
			string path = Path.Combine(Paths.GetDirectoryName(SolutionBuilder.ActiveSolutionFullPath), name);
			Guid projectId;
			GrBuildLib.Error error = SolutionBuilder.CreateNewProject(name, path, template.LayerConfig, out projectId);
			if (error != 0)
			{
				return error;
			}
			SetActiveProject(projectId);
			return GrBuildLib.Error.Ok;
		}

		public GrBuildLib.Error CreateProjectFromXML(string name, string xmlPath, SolutionBuilder.OnSetBuildErrorHandles setBuildErrorHandles = null, bool overwrite = false)
		{
			string path = Path.Combine(Paths.GetDirectoryName(SolutionBuilder.ActiveSolutionFullPath), name);
			Guid projectId;
			GrBuildLib.Error error = SolutionBuilder.CreateNewProjectFromXML(name, path, xmlPath, out projectId, setBuildErrorHandles, overwrite);
			if (error != 0)
			{
				return error;
			}
			SetActiveProject(projectId);
			return GrBuildLib.Error.Ok;
		}

		public GrBuildLib.Error RemoveProject(Guid projectGuid, bool clean, bool removeOutputFromDisk, bool removeAllProjectFilesFromDisk)
		{
			if (!ActiveSolution.Projects.ContainsKey(projectGuid))
			{
				return GrBuildLib.Error.NoProjectLoaded;
			}
			SetActiveProject(Guid.Empty);
			SolutionProjectDecriptor solutionProjectDecriptor = ActiveSolution.Projects[projectGuid];
			string text = null;
			ProjectBuilder projectBuilder = SolutionBuilder.GetProjectBuilder(solutionProjectDecriptor.Id);
			if (projectBuilder != null)
			{
				if (clean)
				{
					SolutionBuilder.CleanProject(projectGuid);
				}
				if (removeOutputFromDisk)
				{
					string fullPath = Path.GetFullPath(projectBuilder.ActiveProject.BuildConfiguration.OutputDirectory);
					string outputFilename = projectBuilder.ActiveProject.BuildConfiguration.OutputFilename;
					string text2 = Path.Combine(fullPath, outputFilename);
					GtsInfo info = default(GtsInfo);
					if (GTSBuilderTools.GetGtsInfo(text2, out info) == Nixel.Error.Ok && GTSBuilderTools.GetGTPFiles(text2, out var gtpFilenames))
					{
						try
						{
							File.Delete(text2);
							foreach (string item in gtpFilenames)
							{
								File.Delete(Path.Combine(fullPath, item));
							}
						}
						catch
						{
						}
					}
				}
				if (removeAllProjectFilesFromDisk)
				{
					text = projectBuilder.GetProjectPath();
				}
			}
			GrBuildLib.Error error = SolutionBuilder.RemoveProject(projectGuid);
			if (error != 0)
			{
				return error;
			}
			if (text != null)
			{
				try
				{
					string[] array = new string[3]
					{
						Path.Combine(text, solutionProjectDecriptor.Name + "." + Constants.ProjectExtension),
						Path.Combine(text, solutionProjectDecriptor.Name + ".import.bak"),
						Path.Combine(text, solutionProjectDecriptor.Name + ".log")
					};
					foreach (string path in array)
					{
						if (File.Exists(path))
						{
							File.Delete(path);
						}
					}
					Directory.Delete(Path.Combine(text, GrBuildLib.Constants.StateDirName), recursive: true);
					try
					{
						if (!Directory.EnumerateFileSystemEntries(text).Any())
						{
							Directory.Delete(text);
						}
					}
					catch
					{
					}
				}
				catch
				{
					return GrBuildLib.Error.IOError;
				}
			}
			return GrBuildLib.Error.Ok;
		}

		private void ImportAssetInternal(AssetImportDescription importDescription)
		{
			ImportAsset importAsset = new ImportAsset();
			importAsset.Name = importDescription.Name;
			importAsset.Type = importDescription.Type;
			for (int i = 0; i < importDescription.LayerAssets.Count; i++)
			{
				ImportAssetLayer importAssetLayer = new ImportAssetLayer();
				importAssetLayer.Source = importDescription.LayerAssets[i].FileSources;
				importAssetLayer.QualityProfile = importDescription.LayerAssets[i].Quality.ToString();
				importAssetLayer.Flip = (Flip)importDescription.LayerAssets[i].Flip;
				importAssetLayer.Swizzle[0] = "";
				importAssetLayer.InvertChannels[0] = "";
				importAssetLayer.MipSourceType = importDescription.LayerAssets[i].MipSourceType;
				importAssetLayer.ColorSpace = importDescription.LayerAssets[i].ColorSpace;
				importAssetLayer.PackingMode = importDescription.LayerAssets[i].PackingMode;
				importAssetLayer.Swizzle = importDescription.LayerAssets[i].Swizzle;
				importAsset.AddAssetLayer(importAssetLayer);
			}
			ProjectBuilder activeProjectBuilder = ActiveProjectBuilder;
			OnAssetImportStarted(activeProjectBuilder);
			SolutionBuilder.BuildReportingHandler.DefaultErrorAction = ErrorAction.ForceContinue;
			activeProjectBuilder.Import(importAsset);
			SolutionBuilder.BuildReportingHandler.DefaultErrorAction = ErrorAction.Stop;
			OnAssetImportFinished(activeProjectBuilder);
		}

		public void ReImportAsset(AssetImportDescription importDescription)
		{
			ImportAssetInternal(importDescription);
			Asset asset = FindAssetByName(ActiveProjectBuilder.ActiveProject.Id, importDescription.Name);
			OnProjectAssetChanged(ActiveProjectBuilder.ActiveProject.Id, asset);
		}

		public void ImportAsset(AssetImportDescription importDescription)
		{
			ImportAssetInternal(importDescription);
			OnAssetAdded(importDescription.Name, ActiveSolutionProject.Id);
		}

		public void ImportAssetTemplate(LayerTemplateImportDescription templateDescription)
		{
			ImportAssetTemplate importAssetTemplate = new ImportAssetTemplate();
			importAssetTemplate.Name = templateDescription.Name;
			for (int i = 0; i < templateDescription.LayerTemplates.Count; i++)
			{
				ImportAssetLayerTemplate importAssetLayerTemplate = new ImportAssetLayerTemplate();
				importAssetLayerTemplate.Source = templateDescription.LayerTemplates[i].FileSources;
				importAssetLayerTemplate.QualityProfile = templateDescription.LayerTemplates[i].Quality.ToString();
				importAssetLayerTemplate.Flip = (Flip)templateDescription.LayerTemplates[i].Flip;
				importAssetLayerTemplate.PackingMode = templateDescription.LayerTemplates[i].PackingMode;
				importAssetLayerTemplate.MipSourceType = templateDescription.LayerTemplates[i].MipSourceType;
				importAssetLayerTemplate.ColorSpace = templateDescription.LayerTemplates[i].ColorSpace;
				importAssetLayerTemplate.Swizzle = templateDescription.LayerTemplates[i].Swizzle;
				importAssetLayerTemplate.ColorSpace = templateDescription.LayerTemplates[i].ColorSpace;
				importAssetTemplate.LayerTemplates.Add(importAssetLayerTemplate);
			}
			ProjectBuilder activeProjectBuilder = ActiveProjectBuilder;
			OnAssetImportStarted(activeProjectBuilder);
			SolutionBuilder.BuildReportingHandler.DefaultErrorAction = ErrorAction.ForceContinue;
			activeProjectBuilder.Import(importAssetTemplate);
			SolutionBuilder.BuildReportingHandler.DefaultErrorAction = ErrorAction.Stop;
			OnAssetImportFinished(activeProjectBuilder);
			OnAssetsAdded(ActiveSolutionProject.Id);
		}

		public bool ImportFromScript(string filename)
		{
			ProjectBuilder activeProjectBuilder = ActiveProjectBuilder;
			OnAssetImportStarted(activeProjectBuilder);
			SolutionBuilder.BuildReportingHandler.DefaultErrorAction = ErrorAction.ForceContinue;
			GrBuildLib.Error error = GrBuildLib.Error.Ok;
			try
			{
				error = activeProjectBuilder.Import(filename);
			}
			catch (Exception ex)
			{
				throw ex;
			}
			SolutionBuilder.BuildReportingHandler.DefaultErrorAction = ErrorAction.Stop;
			OnAssetImportFinished(activeProjectBuilder);
			if (error != 0)
			{
				return false;
			}
			OnAssetsAdded(ActiveSolutionProject.Id);
			return true;
		}

		public bool RemoveAsset(Guid assetId)
		{
			ProjectBuilder activeProjectBuilder = ActiveProjectBuilder;
			if (!activeProjectBuilder.ActiveProject.Assets.ContainsKey(assetId))
			{
				return false;
			}
			Asset asset = activeProjectBuilder.ActiveProject.Assets[assetId];
			OnAssetRemoving(asset.Id, ActiveSolutionProject.Id);
			if (!activeProjectBuilder.RemoveAsset(assetId))
			{
				return false;
			}
			OnAssetRemoved(asset.Name, ActiveSolutionProject.Id);
			OnProjectAssetChanged(ActiveProjectBuilder.ActiveProject.Id, null);
			return true;
		}

		public bool RemoveAssets(List<Guid> assetIds, bool autoRemoveGroups)
		{
			ProjectBuilder activeProjectBuilder = ActiveProjectBuilder;
			OnAssetsRemoving(ActiveSolutionProject.Id, assetIds);
			if (!activeProjectBuilder.RemoveAssets(assetIds, autoRemoveGroups))
			{
				return false;
			}
			OnAssetsRemoved(ActiveSolutionProject.Id);
			OnProjectAssetChanged(ActiveProjectBuilder.ActiveProject.Id, null);
			return true;
		}

		public void UpdateAsset(Guid projectId, Asset asset)
		{
			OnProjectAssetChanged(projectId, asset);
		}

		public bool RenameAsset(Guid projectId, Guid assetId, string name)
		{
			ProjectBuilder projectBuilder = GetProjectBuilder(projectId);
			List<Asset> list = null;
			if (projectBuilder != null)
			{
				list = projectBuilder.RenameAsset(assetId, name);
			}
			if (list.Count > 1)
			{
				OnProjectAssetChanged(projectId, null);
			}
			else
			{
				OnProjectAssetChanged(projectId, list[0]);
			}
			return true;
		}

		public void ScanAssets()
		{
			foreach (ProjectBuilder value in SolutionBuilder.ProjectBuilders.Values)
			{
				value.QueryAssetBuildStates();
				OnProjectStateChanged(value.ActiveProject.Id);
			}
		}

		public Asset FindAsset(Guid projectId, Guid assetId)
		{
			ProjectBuilder projectBuilder = GetProjectBuilder(projectId);
			if (projectBuilder == null || projectBuilder.ActiveProject == null)
			{
				return null;
			}
			if (!projectBuilder.ActiveProject.Assets.ContainsKey(assetId))
			{
				return null;
			}
			return projectBuilder.ActiveProject.Assets[assetId];
		}

		public Asset FindAssetByName(Guid projectId, string name)
		{
			ProjectBuilder projectBuilder = GetProjectBuilder(projectId);
			if (projectBuilder == null || projectBuilder.ActiveProject == null)
			{
				return null;
			}
			foreach (Asset value in projectBuilder.ActiveProject.Assets.Values)
			{
				if (value.Name == name)
				{
					return value;
				}
			}
			return null;
		}

		public List<Asset> FindAssetGroupAsset(Guid projectId, string groupAssetId)
		{
			ProjectBuilder projectBuilder = GetProjectBuilder(projectId);
			if (projectBuilder == null || projectBuilder.ActiveProject == null)
			{
				return new List<Asset>();
			}
			if (groupAssetId == null)
			{
				return new List<Asset>(projectBuilder.ActiveProject.Assets.Values.Where((Asset x) => groupAssetId == null));
			}
			return new List<Asset>(projectBuilder.ActiveProject.Assets.Values.Where((Asset x) => groupAssetId.Equals(x.AssetGroupId)));
		}

		public void UpdateProfiles(string buildProfile)
		{
			if (ActiveProjectBuilder != null)
			{
				if (!ActiveProjectBuilder.ActiveProject.BuildProfile.ToLower().Equals(buildProfile.ToLower()))
				{
					ActiveProjectBuilder.SetBuildProfile(buildProfile);
				}
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateGTSOutputFilename(string filePath)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetOutputLocation(filePath);
				OnProjectOutputChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateSoupOutputFilename(string folderPath)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetSoupOutputDirectory(folderPath, tryToMake: false);
				OnProjectOutputChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdatePageFiles(string folderPath)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetPagesDirectory(folderPath);
				OnProjectOutputChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdatePatching(bool enable)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.NoPatching = !enable;
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateNoRedirection(bool enable)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.EnableRedirection = !enable;
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateNoSharedMips(bool enable)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.EnableSharedMipGeneration = !enable;
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateMipStripping(bool enable)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.EnableMipStripping = enable;
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateHighQualityCoding(bool enable)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.EnableHighQualityCoding = enable;
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateNoUniform(bool enable)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.EnableUniformCoding = !enable;
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateMaxAnisotropy(uint maxAni)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetMaximumAnisotropy(maxAni);
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdatePageSize(uint size)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetPageSize(size);
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdatePagingStrategy(PagingStrategy strategy)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetPagingStrategy(strategy);
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateTargetDisk(TargetDisk targetDisk)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetTargetDisk(targetDisk);
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateTileSize(uint width, uint height)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetTileWidth(width);
				ActiveProjectBuilder.SetTileHeight(height);
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateTilingmode(TilingMode mode)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.SetTilingMode(mode);
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public void UpdateLayerConfiguration(LayerConfig config)
		{
			if (ActiveProjectBuilder != null)
			{
				ActiveProjectBuilder.UpdateLayerConfig(config);
				OnProjectStateChanged(ActiveProjectBuilder.ActiveProject.Id);
			}
		}

		public bool HasProject(string name)
		{
			foreach (ProjectBuilder value in SolutionBuilder.ProjectBuilders.Values)
			{
				if (value.ActiveProject.Name.ToLower().Equals(name.ToLower()))
				{
					return true;
				}
			}
			return false;
		}

		public void RenameProject(string name)
		{
			throw new NotImplementedException();
		}

		public bool ProjectExists(string name)
		{
			return File.Exists(Path.Combine(Path.Combine(Paths.GetDirectoryName(SolutionBuilder.ActiveSolutionFullPath), name), name + "." + Constants.ProjectExtension));
		}

		public bool ExportToImportScript(string filename)
		{
			try
			{
				ActiveProjectBuilder.ExportToImportScript(filename);
			}
			catch
			{
				return false;
			}
			return true;
		}

		public Asset FindFirstAssetInGroup(Guid projectGuid, string assetGroupId)
		{
			if (string.IsNullOrEmpty(assetGroupId))
			{
				return null;
			}
			List<Asset> list = FindAssetGroupAsset(projectGuid, assetGroupId);
			if (list == null)
			{
				return null;
			}
			List<Asset> list2 = list.Where((Asset _asset) => _asset.Face == 0).ToList();
			if (list2 == null || list2.Count < 1)
			{
				return null;
			}
			return list2.First();
		}

		public string GetProjectAbsolutePath(Guid projectGuid)
		{
			string directoryName = Paths.GetDirectoryName(SolutionBuilder.ActiveSolutionFullPath);
			string name = ActiveSolution.Projects[projectGuid].Name;
			return Path.Combine(directoryName, name);
		}

		public void MoveAssets(Guid srcProjectId, List<Asset> assets, Guid destProjectId, bool keepCopy, ConversionProblemsCallback callback)
		{
			ProjectBuilder projectBuilder = SolutionBuilder.ProjectBuilders[srcProjectId];
			ProjectBuilder projectBuilder2 = SolutionBuilder.ProjectBuilders[destProjectId];
			MoveAssetConvProblemsArgs moveAssetConvProblemsArgs = null;
			foreach (Asset asset2 in assets)
			{
				Asset asset = asset2;
				ImportAsset import = null;
				if (asset.Type == AssetType.CubeMap)
				{
					asset = projectBuilder.GetCubeMapFace0(asset.AssetGroupId);
					if (asset == null)
					{
						string innerMessage = $"Could not import cube map '{asset.AssetGroupId}', face 0 is not present. Please reimport the cube map to make sure face 0 is present.";
						projectBuilder.BuildReportingHandler.OnError(BuildProcess.Import, new ImportIssue(innerMessage));
						break;
					}
				}
				bool flag = AssetTools.ConvertAssetToImportAsset(asset, projectBuilder.GetProjectPath(), projectBuilder.ActiveProject.LayerConfiguration, projectBuilder2.ActiveProject.LayerConfiguration, out import, AssetTools.AssetToImportAssetConversionOptions.AllowExtend);
				if (!flag && callback != null)
				{
					if (moveAssetConvProblemsArgs == null)
					{
						moveAssetConvProblemsArgs = new MoveAssetConvProblemsArgs();
						callback(this, moveAssetConvProblemsArgs);
					}
					if (moveAssetConvProblemsArgs.Continue)
					{
						flag = AssetTools.ConvertAssetToImportAsset(asset, projectBuilder.GetProjectPath(), projectBuilder.ActiveProject.LayerConfiguration, projectBuilder2.ActiveProject.LayerConfiguration, out import, moveAssetConvProblemsArgs.Options);
					}
				}
				if (moveAssetConvProblemsArgs != null && !moveAssetConvProblemsArgs.Continue)
				{
					break;
				}
				if (flag)
				{
					OnAssetImportStarted(projectBuilder2);
					BuildLoggerReporter buildLoggerReporter = new BuildLoggerReporter();
					buildLoggerReporter.StartListening(projectBuilder2);
					projectBuilder2.Import(import);
					buildLoggerReporter.StopListening();
					if (!buildLoggerReporter.HasErrors && !keepCopy)
					{
						projectBuilder.RemoveAsset(asset.Id);
					}
					projectBuilder2.ClearImportAssets();
					OnAssetImportFinished(projectBuilder2);
					OnAssetRemoved(asset.Name, srcProjectId);
					OnAssetAdded(asset.Name, destProjectId);
				}
			}
		}

		public void MoveAssets(Dictionary<Guid, List<Asset>> assets, SolutionBuilder targetSolution, Guid targetProjectId, bool keepCopy, out MoveAssetReport report, ConversionProblemsCallback callback)
		{
			report = new MoveAssetReport();
			List<ImportAsset> list = new List<ImportAsset>();
			ProjectBuilder projectBuilder = targetSolution.ProjectBuilders[targetProjectId];
			report.TotalAssetCount = 0;
			foreach (Guid key in assets.Keys)
			{
				List<Asset> list2 = assets[key];
				report.TotalAssetCount += list2.Count;
				ProjectBuilder projectBuilder2 = SolutionBuilder.ProjectBuilders[key];
				MoveAssetConvProblemsArgs moveAssetConvProblemsArgs = null;
				foreach (Asset item in list2)
				{
					Asset asset = item;
					if (asset.Type == AssetType.CubeMap)
					{
						asset = projectBuilder2.GetCubeMapFace0(item.AssetGroupId);
					}
					ImportAsset import = null;
					bool flag = AssetTools.ConvertAssetToImportAsset(asset, projectBuilder2.GetProjectPath(), projectBuilder2.ActiveProject.LayerConfiguration, projectBuilder.ActiveProject.LayerConfiguration, out import, AssetTools.AssetToImportAssetConversionOptions.AllowExtend);
					if (!flag && callback != null)
					{
						if (moveAssetConvProblemsArgs == null)
						{
							moveAssetConvProblemsArgs = new MoveAssetConvProblemsArgs();
							callback(this, moveAssetConvProblemsArgs);
						}
						if (moveAssetConvProblemsArgs.Continue)
						{
							flag = AssetTools.ConvertAssetToImportAsset(asset, projectBuilder2.GetProjectPath(), projectBuilder2.ActiveProject.LayerConfiguration, projectBuilder.ActiveProject.LayerConfiguration, out import, moveAssetConvProblemsArgs.Options);
						}
					}
					if (moveAssetConvProblemsArgs != null && !moveAssetConvProblemsArgs.Continue)
					{
						report.Canceled = true;
						return;
					}
					if (flag)
					{
						list.Add(import);
						continue;
					}
					string innerMessage = $"Asset '{item.Name}' could not converted to the configuration of the target project.";
					projectBuilder2.BuildReportingHandler.OnError(BuildProcess.Import, new ImportIssue(innerMessage));
				}
			}
			foreach (ImportAsset item2 in list)
			{
				projectBuilder.AddImportAsset(item2);
			}
			try
			{
				OnAssetImportStarted(projectBuilder);
				report.BuildLoggerReporterImport.StartListening(projectBuilder);
				projectBuilder.Import();
				report.BuildLoggerReporterImport.StopListening();
				OnAssetImportFinished(projectBuilder);
				report.HasImportErrors = report.BuildLoggerReporterImport.HasErrors;
				projectBuilder.ClearImportAssets();
			}
			catch (Exception ex)
			{
				throw ex;
			}
			if (!report.HasErrors && !keepCopy)
			{
				foreach (Guid key2 in assets.Keys)
				{
					List<Asset> list3 = assets[key2];
					ProjectBuilder projectBuilder3 = SolutionBuilder.ProjectBuilders[key2];
					List<Guid> assets2 = new List<Guid>(list3.Select((Asset a) => a.Id));
					projectBuilder3.AddAssetsToRemove(list3);
					OnAssetsRemoving(key2, assets2);
					BuildLoggerReporter buildLoggerReporter = new BuildLoggerReporter();
					buildLoggerReporter.StartListening(projectBuilder3);
					projectBuilder3.Import();
					buildLoggerReporter.StopListening();
					report.HasErrors = report.HasErrors || buildLoggerReporter.HasErrors;
					report.BuildLoggerReporterDeletion.Add(buildLoggerReporter);
					OnAssetsRemoved(key2);
				}
			}
			report.HasErrors = report.HasImportErrors || report.HasDeletionErrors;
		}
	}
	[Obfuscation(Exclude = true, ApplyToMembers = true)]
	internal class CommandLineOptions
	{
		[CommandLineParameter(Name = "open", ShortName = "o", ValueName = "<solution>", Atomic = false, Description = "(-o) Open an existing solution")]
		public string solutionPath;

		[CommandLineParameter(Name = "build", ShortName = "b", Description = "(-b) Build the solution after opening. Should be used with -o or -i.")]
		public bool build;

		[CommandLineParameter(Name = "rebuild", ShortName = "reb", Description = "(-reb) Rebuild the solution. Should be used with -b")]
		public bool rebuild;

		[CommandLineParameter(Name = "optimal", ShortName = "opt", Description = "(-opt) Build the solution using the 'Optimized' code path. If not specified, use the 'Fast' build path. Should be used with -b.")]
		public bool optimized;

		[CommandLineParameter(Name = "quit", ShortName = "q", Description = "(-q) Quit after successful building. Should be used with -b.")]
		public bool quit;

		[CommandLineParameter(Name = "import", ShortName = "i", ValueName = "<solution_xml>", Atomic = false, Description = "(-i) Import a solution based on the provided xml file")]
		public string ImportSolutionFromXml;

		[CommandLineParameter(Name = "exclusive", ShortName = "e", Description = "(-e) Import the solution in exclusive mode. Should be used with -i")]
		public bool ImportExclusive;

		[CommandLineParameter(Name = "deamon", ShortName = "d", Description = "(-d) Deamon mode. Deletes the entire folder of the imported solution, should be used with -i")]
		public bool deamon;

		[CommandLineParameter(Name = "Hidden", ShortName = "h", Description = "(-h) Only show the building form. should always be used with -b AND -q")]
		public bool hidden;

		[CommandLineParameter(Name = "SilentAtlasErrors", ShortName = "silatl", Description = "(-silatl) Application silently exits on atlas errors which are only reported by the return code")]
		public bool silentAtlasErrors;

		[CommandLineParameter(Name = "SilentImport", ShortName = "SilImp", Description = "(-SilImp) Do not show any import warnings")]
		public bool IgnoreImportWarnings;

		[CommandLineParameter(Name = "buildgtsforgtex", ShortName = "buildgtsforgtex", Description = "Build a GTS file")]
		public bool buildGTSforGTex;

		[CommandLineParameter(Name = "forceusegtex", ShortName = "forceusegtex", Description = "Force using existing GTex files, even if the GTex files are out dated.")]
		public bool forceUseGTex;

		[CommandLineParameter(Name = "allowforeigngtex", ShortName = "allowforeigngtex", Description = "Allow the use of GTex files built by another project (use together with the 'forceusegtex' flag).")]
		public bool allowForeignGTex;

		[CommandLineParameter(Name = "buildnotileset", ShortName = "buildnotileset", Description = "No GTS file is written by the tools. The build process ends after GTex files are created.")]
		public bool omitGTS;
	}
	[Obfuscation(Exclude = true, ApplyToMembers = true)]
	public class CommandLineParser
	{
		private readonly object _optionsObject;

		private readonly Queue<MemberInfo> _requiredOptions = new Queue<MemberInfo>();

		private readonly Dictionary<string, MemberInfo> _optionalOptions = new Dictionary<string, MemberInfo>();

		private readonly Dictionary<string, MemberInfo> _shortOptions = new Dictionary<string, MemberInfo>();

		private readonly Dictionary<string, MemberInfo> _atomicOptions = new Dictionary<string, MemberInfo>();

		private readonly Dictionary<string, MemberInfo> _atomicShortOptions = new Dictionary<string, MemberInfo>();

		private readonly List<string> _requiredUsageHelp = new List<string>();

		public string Title { get; set; }

		public CommandLineParser(object optionsObject)
		{
			_optionsObject = optionsObject;
			FieldInfo[] fields = optionsObject.GetType().GetFields();
			foreach (FieldInfo fieldInfo in fields)
			{
				CommandLineParameterAttribute attribute = GetAttribute<CommandLineParameterAttribute>(fieldInfo);
				if (attribute == null)
				{
					continue;
				}
				if (attribute.RequiredSequential)
				{
					_requiredOptions.Enqueue(fieldInfo);
					_requiredUsageHelp.Add($"<{attribute.Name}>");
				}
				else if (attribute.Atomic)
				{
					_atomicOptions.Add(attribute.Name.ToLowerInvariant(), fieldInfo);
					if (!string.IsNullOrEmpty(attribute.ShortName))
					{
						_atomicShortOptions.Add(attribute.ShortName.ToLowerInvariant(), fieldInfo);
					}
				}
				else
				{
					_optionalOptions.Add(attribute.Name.ToLowerInvariant(), fieldInfo);
					if (!string.IsNullOrEmpty(attribute.ShortName))
					{
						_shortOptions.Add(attribute.ShortName.ToLowerInvariant(), fieldInfo);
					}
				}
			}
			MethodInfo[] methods = optionsObject.GetType().GetMethods();
			foreach (MethodInfo methodInfo in methods)
			{
				CommandLineParameterAttribute attribute2 = GetAttribute<CommandLineParameterAttribute>(methodInfo);
				if (attribute2 == null)
				{
					continue;
				}
				if (methodInfo.GetParameters().Length > 1)
				{
					throw new NotSupportedException("Methods must have one or zero parameters.");
				}
				if (attribute2.RequiredSequential)
				{
					_requiredOptions.Enqueue(methodInfo);
					_requiredUsageHelp.Add($"<{attribute2.Name}>");
				}
				else if (attribute2.Atomic)
				{
					_atomicOptions.Add(attribute2.Name.ToLowerInvariant(), methodInfo);
					if (!string.IsNullOrEmpty(attribute2.ShortName))
					{
						_atomicShortOptions.Add(attribute2.ShortName.ToLowerInvariant(), methodInfo);
					}
				}
				else
				{
					_optionalOptions.Add(attribute2.Name.ToLowerInvariant(), methodInfo);
					if (!string.IsNullOrEmpty(attribute2.ShortName))
					{
						_shortOptions.Add(attribute2.ShortName.ToLowerInvariant(), methodInfo);
					}
				}
			}
		}

		public bool ParseCommandLine(string[] args)
		{
			bool result = true;
			for (int i = 0; i < args.Length; i++)
			{
				if (args[i].StartsWith("-"))
				{
					string text = args[i];
					string value = "true";
					if (i + 1 < args.Length && !args[i + 1].StartsWith("-"))
					{
						value = args[i + 1];
						i++;
					}
					MemberInfo value2;
					if (text.StartsWith("--"))
					{
						text = text.Substring(2);
						if (_atomicOptions.TryGetValue(text.ToLowerInvariant(), out value2))
						{
							return SetOption(value2, value);
						}
						if (!_optionalOptions.TryGetValue(text.ToLowerInvariant(), out value2))
						{
							ShowError("Unknown option '{0}'", text);
							return false;
						}
					}
					else
					{
						text = text.Substring(1);
						if (_atomicShortOptions.TryGetValue(text.ToLowerInvariant(), out value2))
						{
							return SetOption(value2, value);
						}
						if (!_shortOptions.TryGetValue(text.ToLowerInvariant(), out value2))
						{
							ShowError("Unknown option '{0}'", text);
							return false;
						}
					}
					if (!SetOption(value2, value))
					{
						return false;
					}
				}
				else
				{
					if (_requiredOptions.Count <= 0)
					{
						ShowError("Too many arguments");
						return false;
					}
					MemberInfo memberInfo = _requiredOptions.Peek();
					if (!IsList(memberInfo))
					{
						_requiredOptions.Dequeue();
					}
					SetOption(memberInfo, args[i]);
				}
			}
			MemberInfo memberInfo2 = _requiredOptions.FirstOrDefault((MemberInfo field) => !IsList(field) || GetList(field).Count == 0);
			if (memberInfo2 != null)
			{
				ShowError("Missing argument '{0}'", GetAttribute<CommandLineParameterAttribute>(memberInfo2).Name);
				return false;
			}
			return result;
		}

		private bool SetOption(MemberInfo member, string value)
		{
			try
			{
				if (IsList(member))
				{
					GetList(member).Add(ChangeType(value, ListElementType(member as FieldInfo)));
				}
				else if (member is MethodInfo)
				{
					MethodInfo methodInfo = member as MethodInfo;
					ParameterInfo[] parameters = methodInfo.GetParameters();
					if (parameters.Length == 0)
					{
						methodInfo.Invoke(_optionsObject, null);
					}
					else
					{
						methodInfo.Invoke(_optionsObject, new object[1] { ChangeType(value, parameters[0].ParameterType) });
					}
				}
				else
				{
					FieldInfo fieldInfo = member as FieldInfo;
					fieldInfo.SetValue(_optionsObject, ChangeType(value, fieldInfo.FieldType));
				}
				return true;
			}
			catch
			{
				ShowError("Invalid value '{0}' for option '{1}'", value, GetAttribute<CommandLineParameterAttribute>(member).Name);
				return false;
			}
		}

		private static object ChangeType(string value, Type type)
		{
			return TypeDescriptor.GetConverter(type).ConvertFromInvariantString(value);
		}

		private static bool IsList(MemberInfo field)
		{
			if (field is MethodInfo)
			{
				return false;
			}
			return typeof(IList).IsAssignableFrom((field as FieldInfo).FieldType);
		}

		private IList GetList(MemberInfo field)
		{
			return (IList)(field as FieldInfo).GetValue(_optionsObject);
		}

		private static Type ListElementType(FieldInfo field)
		{
			return (from i in field.FieldType.GetInterfaces()
				where i.IsGenericType && i.GetGenericTypeDefinition() == typeof(IEnumerable<>)
				select i).First().GetGenericArguments()[0];
		}

		public void ShowUsage()
		{
			ShowError(null);
		}

		public void ShowError(string message, params object[] args)
		{
			string fileNameWithoutExtension = Path.GetFileNameWithoutExtension(System.Diagnostics.Process.GetCurrentProcess().ProcessName);
			if (!string.IsNullOrEmpty(Title))
			{
				Console.Error.WriteLine(Title);
				Console.Error.WriteLine();
			}
			if (!string.IsNullOrEmpty(message))
			{
				Console.Error.WriteLine(message, args);
				Console.Error.WriteLine();
			}
			Dictionary<string, MemberInfo> dictionary = _optionalOptions.Concat(_atomicOptions).ToDictionary((KeyValuePair<string, MemberInfo> e) => e.Key, (KeyValuePair<string, MemberInfo> e) => e.Value);
			Console.Error.WriteLine("Usage: {0} {1}{2}", fileNameWithoutExtension, string.Join(" ", _requiredUsageHelp.ToArray()), (dictionary.Count > 0) ? " <Options>" : string.Empty);
			if (dictionary.Count <= 0)
			{
				return;
			}
			Console.Error.WriteLine();
			Console.Error.WriteLine("Options:\n");
			foreach (KeyValuePair<string, MemberInfo> item in dictionary)
			{
				FieldInfo fieldInfo = item.Value as FieldInfo;
				MethodInfo methodInfo = item.Value as MethodInfo;
				CommandLineParameterAttribute attribute = GetAttribute<CommandLineParameterAttribute>(item.Value);
				if ((fieldInfo != null && fieldInfo.FieldType != typeof(bool)) || (methodInfo != null && methodInfo.GetParameters().Length != 0))
				{
					if (string.IsNullOrEmpty(attribute.ShortName))
					{
						Console.Error.WriteLine("  -{0} {1}\n", attribute.ShortName, attribute.ValueName);
					}
					Console.Error.WriteLine("  --{0} {1}\n     {2}\n", attribute.Name, attribute.ValueName, attribute.Description);
				}
				else if (!attribute.Hidden)
				{
					if (string.IsNullOrEmpty(attribute.ShortName))
					{
						Console.Error.WriteLine("  -{0}\n", attribute.ShortName);
					}
					Console.Error.WriteLine("  --{0}\n     {1}\n", attribute.Name, attribute.Description);
				}
			}
		}

		private static T GetAttribute<T>(ICustomAttributeProvider provider) where T : Attribute
		{
			return provider.GetCustomAttributes(typeof(T), inherit: false).OfType<T>().FirstOrDefault();
		}
	}
	[AttributeUsage(AttributeTargets.Method | AttributeTargets.Field)]
	[Obfuscation(Exclude = true, ApplyToMembers = true)]
	public sealed class CommandLineParameterAttribute : Attribute
	{
		public string Name { get; set; }

		public string ShortName { get; set; }

		public bool RequiredSequential { get; set; }

		public string ValueName { get; set; }

		public string Description { get; set; }

		public bool Atomic { get; set; }

		public bool Hidden { get; set; }

		public CommandLineParameterAttribute()
		{
			ValueName = "value";
		}
	}
	internal class SolutionImporter
	{
		public class ImportException : Exception
		{
			public ImportException(string message)
				: base(message)
			{
			}
		}

		public class ImportData
		{
			internal class ProjectData
			{
				public string xmlImportPath;

				public string name;

				public uint pageSize;

				public PagingStrategy pagingStrategy;
			}

			public string outputPath;

			public string buildProfile;

			public string solutionName;

			public string solutionPath;

			public string gtexPath;

			public List<ProjectData> projects = new List<ProjectData>();

			public string SolutionFile => Path.Combine(solutionPath, solutionName + "." + Constants.SolutionExtension);
		}

		public static string CreateSolutionFromXML(Logger logger, CommandLineOptions options, BuildLoggerReporter buildLoggerReporter)
		{
			string importSolutionFromXml = options.ImportSolutionFromXml;
			if (importSolutionFromXml == null)
			{
				return null;
			}
			if (!File.Exists(importSolutionFromXml))
			{
				throw new FileNotFoundException("The XML file could not be found.");
			}
			ImportData data = new ImportData();
			if (!Import(importSolutionFromXml, ref data))
			{
				throw new ImportException("failed to read import xml");
			}
			SolutionModel solutionModel = new SolutionModel();
			try
			{
				solutionModel.SolutionBuilder.NewSolution(data.SolutionFile);
			}
			catch (UnspecifiedException ex)
			{
				GrBuildLib.Error errorCode = ex.ErrorCode;
				switch (errorCode)
				{
				case GrBuildLib.Error.FileAlreadyExists:
					try
					{
						errorCode = solutionModel.SolutionBuilder.LoadSolution(data.SolutionFile, createIfNotExist: false);
					}
					catch (UnspecifiedException ex2)
					{
						throw new ImportException("Failed to create new solution. Detailed error: " + ex2.Message);
					}
					catch (Exception ex3)
					{
						throw new ImportException("Failed to create new solution: Unspecified error: " + ex3.Message);
					}
					if (errorCode != 0)
					{
						throw new ImportException("Failed to create new solution");
					}
					break;
				default:
					throw new ImportException("Failed to create new solution " + errorCode);
				case GrBuildLib.Error.Ok:
					throw;
				}
			}
			foreach (ImportData.ProjectData project in data.projects)
			{
				if (!solutionModel.HasProject(project.name))
				{
					GrBuildLib.Error error = solutionModel.CreateProjectFromXML(project.name, null, OnProjectCreateErrorHandles, overwrite: true);
					if (error != 0)
					{
						throw new ImportException("Error creating project from xml script: " + error);
					}
				}
				solutionModel.SetActiveProject(project.name);
				solutionModel.UpdateProfiles(data.buildProfile);
				solutionModel.UpdatePageSize(project.pageSize);
				solutionModel.UpdatePagingStrategy(project.pagingStrategy);
				solutionModel.ActiveProjectBuilder.SetOutputDirectory(data.outputPath, tryToMake: true);
				solutionModel.ActiveProjectBuilder.SetExclusiveImport(options.ImportExclusive);
				if (data.gtexPath.Length > 0)
				{
					solutionModel.ActiveProjectBuilder.SetSoupOutputDirectory(data.gtexPath, tryToMake: true);
				}
				solutionModel.ActiveProjectBuilder.AllowForeignGTex = options.allowForeignGTex;
				solutionModel.ActiveProjectBuilder.ForceUseGTex = options.forceUseGTex;
				solutionModel.ActiveProjectBuilder.NoGTSBuilding = options.omitGTS;
				solutionModel.ActiveProjectBuilder.SaveProject();
				GrBuildLib.Error error2 = GrBuildLib.Error.Ok;
				try
				{
					buildLoggerReporter?.StartListening(solutionModel.ActiveProjectBuilder);
					error2 = ((!solutionModel.ImportFromScript(project.xmlImportPath)) ? GrBuildLib.Error.Fail : GrBuildLib.Error.Ok);
					buildLoggerReporter?.StopListening();
				}
				catch (GrXmlException ex4)
				{
					throw new XmlException("Failed importing project from XML script: " + ((ConfigurationException)(object)ex4).Filename, (Exception)(object)ex4);
				}
				catch (InvalidLayerConfigurationException ex5)
				{
					throw new Exception("Invalid layer configuration at layer index: " + ex5.LayerIndex, ex5);
				}
				catch (MissingLayerConfigurationException ex6)
				{
					throw new Exception("Missing layer configuration at layer index: " + ex6.LayerIndex, ex6);
				}
				catch (FileNotFoundException ex7)
				{
					throw new FileNotFoundException("File not found: " + ex7.FileName, ex7);
				}
				catch (Exception ex8)
				{
					throw new Exception("Failed to update project: " + ex8.Message, ex8);
				}
				if (error2 != 0)
				{
					throw new Exception("GrBuild Error: " + error2);
				}
			}
			string activeSolutionFullPath = solutionModel.SolutionBuilder.ActiveSolutionFullPath;
			foreach (KeyValuePair<Guid, SolutionProjectDecriptor> item in solutionModel.SolutionBuilder.ActiveSolution.Projects.Where((KeyValuePair<Guid, SolutionProjectDecriptor> _project) => data.projects.Find((ImportData.ProjectData _proj) => _proj.name == _project.Value.Name) == null).ToList())
			{
				solutionModel.RemoveProject(item.Key, clean: true, removeOutputFromDisk: true, removeAllProjectFilesFromDisk: true);
			}
			solutionModel.SolutionBuilder.SaveSolution();
			solutionModel.SolutionBuilder.CloseSolution();
			return activeSolutionFullPath;
		}

		private static void OnProjectCreateErrorHandles(ProjectBuilder builder)
		{
			builder.BuildReportingHandler.OnErrorHandler += BuildReportingHandler_OnErrorHandler;
		}

		private static ErrorAction BuildReportingHandler_OnErrorHandler(ProjectBuilder source, BuildProcess processId, BuildIssue buildIssue)
		{
			throw new ImportException(buildIssue.InnerMessage);
		}

		private static bool Import(string filename, ref ImportData data)
		{
			try
			{
				ConfigXmlDocument configXmlDocument = new ConfigXmlDocument();
				configXmlDocument.Load(filename);
				XmlNode documentElement = configXmlDocument.DocumentElement;
				data.solutionName = GetNode(documentElement, "name").InnerText;
				data.solutionPath = GetNode(documentElement, "path").InnerText;
				data.outputPath = GetNode(documentElement, "output").InnerText;
				XmlNode xmlNode = TryGetNode(documentElement, "buildProfile");
				data.buildProfile = ((xmlNode != null) ? xmlNode.InnerText : "default");
				data.buildProfile = data.buildProfile.ToLower();
				XmlNode xmlNode2 = TryGetNode(documentElement, "gtexPath");
				data.gtexPath = ((xmlNode2 != null) ? xmlNode2.InnerText : "");
				XmlNode xmlNode3 = TryGetNode(documentElement, "pagingStrategy");
				PagingStrategy pagingStrategy = PagingStrategy.Default;
				if (xmlNode3 != null)
				{
					if (xmlNode3.InnerText == "GTPPerLevel")
					{
						pagingStrategy = PagingStrategy.GTPPerLevel;
					}
					else
					{
						if (!(xmlNode3.InnerText == "GTPPerGTex"))
						{
							throw new ImportException("Paging Strategy not valid: " + xmlNode3.InnerText);
						}
						pagingStrategy = PagingStrategy.GTPPerGTex;
					}
				}
				XmlNodeList xmlNodeList = documentElement.SelectNodes("project");
				if (xmlNodeList.Count == 0)
				{
					throw new ImportException("No Projects found in import script");
				}
				foreach (XmlNode item in xmlNodeList)
				{
					ImportData.ProjectData projectData = new ImportData.ProjectData();
					projectData.name = GetNode(item, "name").InnerText;
					projectData.xmlImportPath = GetNode(item, "import").InnerText;
					XmlNode xmlNode4 = null;
					try
					{
						xmlNode4 = GetNode(item, "pageSize");
					}
					catch (GrMissingNodeException)
					{
					}
					if (xmlNode4 != null)
					{
						projectData.pageSize = Convert.ToUInt32(xmlNode4.InnerText);
					}
					projectData.pagingStrategy = pagingStrategy;
					data.projects.Add(projectData);
				}
				return true;
			}
			catch
			{
				return false;
			}
		}

		private static XmlNode GetNode(XmlNode parent, string name)
		{
			XmlNode xmlNode = parent.SelectSingleNode(name);
			if (xmlNode != null)
			{
				return xmlNode;
			}
			throw new GrMissingNodeException(name, parent);
		}

		private static XmlNode TryGetNode(XmlNode parent, string name)
		{
			try
			{
				return GetNode(parent, name);
			}
			catch
			{
				return null;
			}
		}
	}
	public class NewProjectForm : OfficeForm
	{
		private class TemplateLayerDescription
		{
			public string Title { get; set; }

			public string LayerName { get; set; }

			public DataType Datatype { get; set; }

			public TemplateLayerDescription(string title, string layername, DataType datatype)
			{
				Title = title;
				LayerName = layername;
				Datatype = datatype;
			}
		}

		private class TemplateDescription
		{
			public string Title { get; set; }

			public TemplateLayerDescription[] Layers { get; set; }

			public string GroupName { get; set; }

			public int ImageIndex { get; set; }

			public string Description { get; set; }

			public TemplateDescription(string title, TemplateLayerDescription[] layers, string groupName, int imageIndex, string description)
			{
				Title = title;
				Layers = layers;
				GroupName = groupName;
				ImageIndex = imageIndex;
				Description = description;
			}

			public TemplateDescription(TemplateLayerDescription[] layers, string groupName, int imageIndex, string description)
			{
				Layers = layers;
				GroupName = groupName;
				ImageIndex = imageIndex;
				Description = description;
				Title = FormatTitle(layers);
			}

			private string FormatTitle(TemplateLayerDescription[] layers)
			{
				StringBuilder stringBuilder = new StringBuilder();
				for (int i = 0; i < layers.Length; i++)
				{
					stringBuilder.Append(layers[i].Title);
					if (i != layers.Length - 1)
					{
						stringBuilder.Append(" + ");
					}
				}
				return stringBuilder.ToString();
			}
		}

		private struct TemplateButton
		{
			public TemplateDescription template;

			public string groupname;

			public string title;

			public int imageIndex;

			public string description;

			public TemplateButton(TemplateDescription template)
			{
				groupname = template.GroupName;
				title = template.Title;
				imageIndex = template.ImageIndex;
				description = template.Description;
				this.template = template;
			}
		}

		private List<TemplateButton> buttons;

		private IContainer components;

		private ListView listView;

		private ImageList imageList1;

		private Label label1;

		private TextBox textBoxProjectName;

		private Button buttonCancel;

		private Button buttonCreate;

		private Label label3;

		private TextBox textBoxSolutionName;

		private Label label4;

		private PathBoxControl pathBoxSolutionLocation;

		private Label label2;

		private ToolTip ToolTip;

		private Panel NewSolutionPanel;

		private ListViewEx listViewInfo;

		private System.Windows.Forms.ColumnHeader columnHeaderLayer;

		private System.Windows.Forms.ColumnHeader columnHeaderType;

		private Label label5;

		private Label labelLayers;

		private RichTextBoxEx richTextBoxExSelection;

		private Label label7;

		private Label labelSelection;

		public string ProjectName
		{
			get
			{
				return textBoxProjectName.Text;
			}
			set
			{
				textBoxProjectName.Text = value;
			}
		}

		public string SolutionName
		{
			get
			{
				return textBoxSolutionName.Text;
			}
			set
			{
				textBoxSolutionName.Text = value;
			}
		}

		public string SolutionPath
		{
			get
			{
				return pathBoxSolutionLocation.Path;
			}
			set
			{
				pathBoxSolutionLocation.Path = value;
			}
		}

		public ProjectTemplate ProjectTemplate { get; set; }

		public bool AllowUserNewSolutionCreation { get; set; }

		public bool CreateNewSolutionDefault { get; set; }

		private List<TemplateDescription> CreateDefaultTemplates()
		{
			TemplateLayerDescription templateLayerDescription = new TemplateLayerDescription("Diffuse", "diffuse", DataType.R8G8B8A8_SRGB);
			TemplateLayerDescription templateLayerDescription2 = new TemplateLayerDescription("Normals", "normals", DataType.X8Y8Z0_TANGENT);
			TemplateLayerDescription templateLayerDescription3 = new TemplateLayerDescription("Specular", "specular", DataType.R8G8B8_SRGB);
			TemplateLayerDescription templateLayerDescription4 = new TemplateLayerDescription("Roughness", "roughness", DataType.R8G8B8_SRGB);
			TemplateLayerDescription templateLayerDescription5 = new TemplateLayerDescription("Grayscale/Heightmap", "grayscale", DataType.X8);
			new TemplateLayerDescription("Metallic", "metallic", DataType.X8);
			new TemplateLayerDescription("Glossiness", "glossiness", DataType.X8);
			TemplateLayerDescription templateLayerDescription6 = new TemplateLayerDescription("Diffuse", "diffuse", DataType.R16G16B16_FLOAT);
			TemplateLayerDescription templateLayerDescription7 = new TemplateLayerDescription("Normals", "normals", DataType.R16G16B16_FLOAT);
			TemplateLayerDescription templateLayerDescription8 = new TemplateLayerDescription("Specular", "specular", DataType.R16G16B16_FLOAT);
			TemplateLayerDescription templateLayerDescription9 = new TemplateLayerDescription("Roughness", "roughness", DataType.R16G16B16_FLOAT);
			TemplateLayerDescription templateLayerDescription10 = new TemplateLayerDescription("Base Color", "basecolor", DataType.R8G8B8_SRGB);
			TemplateLayerDescription templateLayerDescription11 = new TemplateLayerDescription("Base Color", "basecolor", DataType.R8G8B8A8_SRGB);
			TemplateLayerDescription templateLayerDescription12 = templateLayerDescription2;
			TemplateLayerDescription templateLayerDescription13 = new TemplateLayerDescription("Roughness+Metallic", "roughness+metallic", DataType.X8Y8);
			new TemplateLayerDescription("Specular+Glossiness", "specular+glossiness", DataType.X8Y8);
			TemplateLayerDescription templateLayerDescription14 = new TemplateLayerDescription("Displacement", "displacement", DataType.X8);
			List<TemplateDescription> list = new List<TemplateDescription>();
			string groupName = "8-bit LDR SRGB";
			list.Add(new TemplateDescription(new TemplateLayerDescription[1] { templateLayerDescription }, groupName, 0, "Template for a single diffuse with alpha rendering workflow, low dynamic range (8-bit)."));
			list.Add(new TemplateDescription(new TemplateLayerDescription[2] { templateLayerDescription, templateLayerDescription2 }, groupName, 1, "Template for diffuse(with alpha)/normal map rendering workflow, low dynamic range (8-bit)"));
			list.Add(new TemplateDescription(new TemplateLayerDescription[3] { templateLayerDescription, templateLayerDescription2, templateLayerDescription3 }, groupName, 2, "Template for diffuse(with alpha)/normal/specular rendering workflow, low dynamic range (8-bit)."));
			list.Add(new TemplateDescription(new TemplateLayerDescription[4] { templateLayerDescription, templateLayerDescription2, templateLayerDescription3, templateLayerDescription4 }, groupName, 3, "Template for diffuse(with alpha)/normal/specular/roughness rendering workflow, low dynamic range (8-bit)"));
			list.Add(new TemplateDescription(new TemplateLayerDescription[1] { templateLayerDescription5 }, groupName, 6, ""));
			string groupName2 = "Unreal 4 PBR Compatible";
			list.Add(new TemplateDescription("Physically Based (Metallic/Roughness)", new TemplateLayerDescription[3] { templateLayerDescription10, templateLayerDescription12, templateLayerDescription13 }, groupName2, 5, "UE4-compatible template for physically based rendering using a metallic/roughness workflow. Roughness (X8) and metallic (X8) channels are combined (X8Y8)."));
			list.Add(new TemplateDescription("Physically Based (Metallic/Roughness) w/ Displacement", new TemplateLayerDescription[4] { templateLayerDescription10, templateLayerDescription12, templateLayerDescription13, templateLayerDescription14 }, groupName2, 7, "UE4-compatible template for physically based rendering using a metallic/roughness workflow including a diffuse and a displacement map. Roughness (X8) and metallic (X8) channels are combined (X8Y8)."));
			list.Add(new TemplateDescription("Physically Based (Metallic/Roughness) w/ Alpha", new TemplateLayerDescription[3] { templateLayerDescription11, templateLayerDescription12, templateLayerDescription13 }, groupName2, 5, "UE4-compatible template for physically based rendering using a metallic/roughness workflow including a diffuse with an alpha channel. Roughness (X8) and metallic (X8) channels are combined (X8Y8)."));
			list.Add(new TemplateDescription("Physically Based (Metallic/Roughness) w/ Alpha and Displacement", new TemplateLayerDescription[4] { templateLayerDescription11, templateLayerDescription12, templateLayerDescription13, templateLayerDescription14 }, groupName2, 7, "UE4-compatible template for physically based rendering using a metallic/roughness workflow including a diffuse with an alpha channel, in addition to a displacement map. Roughness (X8) and metallic (X8) channels are combined (X8Y8)."));
			string groupName3 = "16-bit HDR Float";
			list.Add(new TemplateDescription(new TemplateLayerDescription[1] { templateLayerDescription6 }, groupName3, 0, "Template for a single diffuse without alpha rendering workflow, high dynamic range (16-bit)."));
			list.Add(new TemplateDescription(new TemplateLayerDescription[2] { templateLayerDescription6, templateLayerDescription7 }, groupName3, 1, "Template for diffuse(without alpha)/normal map rendering workflow, high dynamic range (16-bit)"));
			list.Add(new TemplateDescription(new TemplateLayerDescription[3] { templateLayerDescription6, templateLayerDescription7, templateLayerDescription8 }, groupName3, 2, "Template for diffuse(without alpha)/normal/specular rendering workflow, high dynamic range (16-bit)."));
			list.Add(new TemplateDescription(new TemplateLayerDescription[4] { templateLayerDescription6, templateLayerDescription7, templateLayerDescription8, templateLayerDescription9 }, groupName3, 3, "Template for diffuse(without alpha)/normal/specular/roughness rendering workflow, high dynamic range (16-bit)"));
			return list;
		}

		public NewProjectForm()
		{
			InitializeComponent();
			CreateTemplates();
			if (listView.Items.Count > 0)
			{
				listView.Items[0].Selected = true;
			}
		}

		private void EnableNewSolutionControls()
		{
			NewSolutionPanel.Visible = AllowUserNewSolutionCreation;
			if (AllowUserNewSolutionCreation)
			{
				Text = "New Solution";
				textBoxSolutionName.Text = UserExperience.SuggestSolutionName(SolutionPath);
				ProjectName = UserExperience.SuggestProjectNameOnDisk(SolutionPath);
			}
			else
			{
				Text = "New Tile Set Project";
			}
			if (!NewSolutionPanel.Visible)
			{
				base.Height -= NewSolutionPanel.Height;
			}
		}

		private void checkBoxNewSolution_CheckedChanged(object sender, EventArgs e)
		{
			EnableNewSolutionControls();
		}

		private void buttonCreate_Click(object sender, EventArgs e)
		{
			if (listView.SelectedItems.Count != 1)
			{
				return;
			}
			TemplateButton templateButton = (TemplateButton)listView.SelectedItems[0].Tag;
			if (templateButton.template == null || templateButton.template.Layers.Length == 0)
			{
				CustomLayerLayoutForm customLayerLayoutForm = new CustomLayerLayoutForm();
				customLayerLayoutForm.InitializeForCreation();
				if (customLayerLayoutForm.ShowDialog(this) == DialogResult.OK)
				{
					ProjectTemplate = customLayerLayoutForm.ProjectTemplate;
				}
				else
				{
					base.DialogResult = DialogResult.None;
				}
			}
			else
			{
				ProjectTemplate = CreateGrBuildProjectTemplate(templateButton.template);
			}
		}

		private void NewProjectForm_Load(object sender, EventArgs e)
		{
			EnableNewSolutionControls();
			pathBoxSolutionLocation.Path = SolutionPath;
		}

		private ProjectTemplate CreateGrBuildProjectTemplate(TemplateDescription descr)
		{
			ProfileLoader.LoadBuildProfile(ProfileLoader.GetDefaultBuildProfile(), out var profile);
			ProjectTemplate projectTemplate = new ProjectTemplate();
			for (int i = 0; i < descr.Layers.Length; i++)
			{
				string codingProfile = profile.DefaultCodingProfiles[descr.Layers[i].Datatype];
				LayerDescription item = new LayerDescription(descr.Layers[i].Datatype, codingProfile, "Default", descr.Layers[i].LayerName);
				projectTemplate.LayerConfig.Layers.Add(item);
			}
			return projectTemplate;
		}

		private void AddTemplate(TemplateDescription descr)
		{
			buttons.Add(new TemplateButton(descr));
		}

		private void CreateTemplates()
		{
			buttons = new List<TemplateButton>();
			listView.Groups.Clear();
			listView.Items.Clear();
			foreach (TemplateDescription item in CreateDefaultTemplates())
			{
				AddTemplate(item);
			}
			TemplateDescription template = new TemplateDescription("Custom...", new TemplateLayerDescription[0], "Custom", 4, "Create your custom layer configuration after you click the Create button.");
			buttons.Add(new TemplateButton(template));
			Dictionary<string, ListViewGroup> dictionary = new Dictionary<string, ListViewGroup>();
			foreach (TemplateButton button in buttons)
			{
				if (!dictionary.ContainsKey(button.groupname))
				{
					ListViewGroup listViewGroup = new ListViewGroup(button.groupname);
					dictionary.Add(button.groupname, listViewGroup);
					listView.Groups.Add(listViewGroup);
				}
				ListViewGroup group = dictionary[button.groupname];
				ListViewItem listViewItem = new ListViewItem(button.title, button.imageIndex, group);
				listViewItem.Tag = button;
				listViewItem.ToolTipText = button.description;
				listView.Items.Add(listViewItem);
			}
			listView.TileSize = new Size(128, 128);
		}

		private void listView_SelectedIndexChanged(object sender, EventArgs e)
		{
			buttonCreate.Enabled = listView.SelectedItems.Count > 0;
			if (listView.SelectedItems.Count == 1)
			{
				listViewInfo.Items.Clear();
				TemplateButton templateButton = (TemplateButton)listView.SelectedItems[0].Tag;
				richTextBoxExSelection.Text = templateButton.template.Description;
				labelSelection.Text = templateButton.template.Title;
				labelLayers.Text = "Layers (" + templateButton.template.Layers.Length + "):";
				for (int i = 0; i < templateButton.template.Layers.Length; i++)
				{
					TemplateLayerDescription templateLayerDescription = templateButton.template.Layers[i];
					ListViewItem value = new ListViewItem(new string[2]
					{
						templateLayerDescription.Title,
						templateLayerDescription.Datatype.ToString()
					});
					listViewInfo.Items.Add(value);
				}
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.components = new System.ComponentModel.Container();
			System.Windows.Forms.ListViewGroup listViewGroup = new System.Windows.Forms.ListViewGroup("8-bit Low Dynamic Range", System.Windows.Forms.HorizontalAlignment.Left);
			System.Windows.Forms.ListViewGroup listViewGroup2 = new System.Windows.Forms.ListViewGroup("16-bit High Dynamic Range", System.Windows.Forms.HorizontalAlignment.Left);
			System.Windows.Forms.ListViewGroup listViewGroup3 = new System.Windows.Forms.ListViewGroup("Custom", System.Windows.Forms.HorizontalAlignment.Left);
			System.Windows.Forms.ListViewItem listViewItem = new System.Windows.Forms.ListViewItem("Diffuse", 0);
			System.Windows.Forms.ListViewItem listViewItem2 = new System.Windows.Forms.ListViewItem("Diffuse + Normals", 1);
			System.Windows.Forms.ListViewItem listViewItem3 = new System.Windows.Forms.ListViewItem("Diffuse + Normals + Specular", 2);
			System.Windows.Forms.ListViewItem listViewItem4 = new System.Windows.Forms.ListViewItem("Custom...", 4);
			System.Windows.Forms.ListViewItem listViewItem5 = new System.Windows.Forms.ListViewItem("Diffuse", 0);
			System.Windows.Forms.ListViewItem listViewItem6 = new System.Windows.Forms.ListViewItem("Diffuse + Normals", 1);
			System.Windows.Forms.ListViewItem listViewItem7 = new System.Windows.Forms.ListViewItem("Diffuse + Normals + Specular", 2);
			System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(GrBuildStudio.NewProjectForm));
			this.listView = new System.Windows.Forms.ListView();
			this.imageList1 = new System.Windows.Forms.ImageList(this.components);
			this.label1 = new System.Windows.Forms.Label();
			this.textBoxProjectName = new System.Windows.Forms.TextBox();
			this.buttonCancel = new System.Windows.Forms.Button();
			this.buttonCreate = new System.Windows.Forms.Button();
			this.label3 = new System.Windows.Forms.Label();
			this.textBoxSolutionName = new System.Windows.Forms.TextBox();
			this.label4 = new System.Windows.Forms.Label();
			this.label2 = new System.Windows.Forms.Label();
			this.NewSolutionPanel = new System.Windows.Forms.Panel();
			this.listViewInfo = new DevComponents.DotNetBar.Controls.ListViewEx();
			this.columnHeaderLayer = new System.Windows.Forms.ColumnHeader();
			this.columnHeaderType = new System.Windows.Forms.ColumnHeader();
			this.label5 = new System.Windows.Forms.Label();
			this.labelLayers = new System.Windows.Forms.Label();
			this.richTextBoxExSelection = new DevComponents.DotNetBar.Controls.RichTextBoxEx();
			this.label7 = new System.Windows.Forms.Label();
			this.labelSelection = new System.Windows.Forms.Label();
			this.pathBoxSolutionLocation = new GrBuildStudio.Controls.PathBoxControl();
			this.ToolTip = new GrBuildStudio.ToolTip();
			this.NewSolutionPanel.SuspendLayout();
			base.SuspendLayout();
			this.listView.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			listViewGroup.Header = "8-bit Low Dynamic Range";
			listViewGroup.Name = "listViewGroup1";
			listViewGroup2.Header = "16-bit High Dynamic Range";
			listViewGroup2.Name = "listViewGroup2";
			listViewGroup3.Header = "Custom";
			listViewGroup3.Name = "listViewGroup3";
			this.listView.Groups.AddRange(new System.Windows.Forms.ListViewGroup[3] { listViewGroup, listViewGroup2, listViewGroup3 });
			this.listView.HideSelection = false;
			listViewItem.Group = listViewGroup;
			listViewItem2.Group = listViewGroup;
			listViewItem3.Group = listViewGroup;
			listViewItem4.Group = listViewGroup3;
			listViewItem5.Group = listViewGroup2;
			listViewItem6.Group = listViewGroup2;
			listViewItem7.Group = listViewGroup2;
			this.listView.Items.AddRange(new System.Windows.Forms.ListViewItem[7] { listViewItem, listViewItem2, listViewItem3, listViewItem4, listViewItem5, listViewItem6, listViewItem7 });
			this.listView.LargeImageList = this.imageList1;
			this.listView.Location = new System.Drawing.Point(12, 37);
			this.listView.MultiSelect = false;
			this.listView.Name = "listView";
			this.listView.Size = new System.Drawing.Size(597, 539);
			this.listView.TabIndex = 0;
			this.listView.TileSize = new System.Drawing.Size(128, 128);
			this.listView.UseCompatibleStateImageBehavior = false;
			this.listView.SelectedIndexChanged += new System.EventHandler(listView_SelectedIndexChanged);
			this.imageList1.ImageStream = (System.Windows.Forms.ImageListStreamer)resources.GetObject("imageList1.ImageStream");
			this.imageList1.TransparentColor = System.Drawing.Color.Transparent;
			this.imageList1.Images.SetKeyName(0, "template_1layers.png");
			this.imageList1.Images.SetKeyName(1, "template_2layers.png");
			this.imageList1.Images.SetKeyName(2, "template_3layers.png");
			this.imageList1.Images.SetKeyName(3, "template_4layers.png");
			this.imageList1.Images.SetKeyName(4, "template_4layers_blank.png");
			this.imageList1.Images.SetKeyName(5, "template_u4_4layers.png");
			this.imageList1.Images.SetKeyName(6, "template_1layers_gray.png");
			this.imageList1.Images.SetKeyName(7, "template_5layers.png");
			this.label1.AutoSize = true;
			this.label1.Location = new System.Drawing.Point(15, 603);
			this.label1.Name = "label1";
			this.label1.Size = new System.Drawing.Size(74, 13);
			this.label1.TabIndex = 3;
			this.label1.Text = "Tile Set Name";
			this.textBoxProjectName.Location = new System.Drawing.Point(106, 600);
			this.textBoxProjectName.Name = "textBoxProjectName";
			this.textBoxProjectName.Size = new System.Drawing.Size(340, 20);
			this.ToolTip.SetSuperTooltip(this.textBoxProjectName, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NEWPROJECT_TILESETNAME", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.textBoxProjectName.TabIndex = 2;
			this.textBoxProjectName.Text = "tileSet";
			this.buttonCancel.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.buttonCancel.Location = new System.Drawing.Point(854, 685);
			this.buttonCancel.Name = "buttonCancel";
			this.buttonCancel.Size = new System.Drawing.Size(75, 23);
			this.buttonCancel.TabIndex = 20;
			this.buttonCancel.Text = "Cancel";
			this.buttonCancel.UseVisualStyleBackColor = true;
			this.buttonCreate.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCreate.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.buttonCreate.Location = new System.Drawing.Point(773, 685);
			this.buttonCreate.Name = "buttonCreate";
			this.buttonCreate.Size = new System.Drawing.Size(75, 23);
			this.buttonCreate.TabIndex = 10;
			this.buttonCreate.Text = "Create";
			this.buttonCreate.UseVisualStyleBackColor = true;
			this.buttonCreate.Click += new System.EventHandler(buttonCreate_Click);
			this.label3.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.label3.AutoSize = true;
			this.label3.Location = new System.Drawing.Point(0, 29);
			this.label3.Name = "label3";
			this.label3.Size = new System.Drawing.Size(76, 13);
			this.label3.TabIndex = 6;
			this.label3.Text = "Solution Name";
			this.textBoxSolutionName.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.textBoxSolutionName.Location = new System.Drawing.Point(91, 26);
			this.textBoxSolutionName.Name = "textBoxSolutionName";
			this.textBoxSolutionName.Size = new System.Drawing.Size(340, 20);
			this.ToolTip.SetSuperTooltip(this.textBoxSolutionName, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NEWPROJECT_SOLUTIONNAME", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.textBoxSolutionName.TabIndex = 5;
			this.textBoxSolutionName.Text = "Solution1";
			this.label4.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.label4.AutoSize = true;
			this.label4.Location = new System.Drawing.Point(0, 55);
			this.label4.Name = "label4";
			this.label4.Size = new System.Drawing.Size(89, 13);
			this.label4.TabIndex = 6;
			this.label4.Text = "Solution Location";
			this.label2.AutoSize = true;
			this.label2.Location = new System.Drawing.Point(9, 17);
			this.label2.Name = "label2";
			this.label2.Size = new System.Drawing.Size(51, 13);
			this.label2.TabIndex = 10;
			this.label2.Text = "Template";
			this.NewSolutionPanel.Controls.Add(this.label3);
			this.NewSolutionPanel.Controls.Add(this.textBoxSolutionName);
			this.NewSolutionPanel.Controls.Add(this.label4);
			this.NewSolutionPanel.Controls.Add(this.pathBoxSolutionLocation);
			this.NewSolutionPanel.Location = new System.Drawing.Point(15, 626);
			this.NewSolutionPanel.Name = "NewSolutionPanel";
			this.NewSolutionPanel.Size = new System.Drawing.Size(460, 86);
			this.NewSolutionPanel.TabIndex = 21;
			this.listViewInfo.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.listViewInfo.BackColor = System.Drawing.Color.White;
			this.listViewInfo.Border.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.listViewInfo.Columns.AddRange(new System.Windows.Forms.ColumnHeader[2] { this.columnHeaderLayer, this.columnHeaderType });
			this.listViewInfo.DisabledBackColor = System.Drawing.Color.Empty;
			this.listViewInfo.ForeColor = System.Drawing.Color.Black;
			this.listViewInfo.FullRowSelect = true;
			this.listViewInfo.HeaderStyle = System.Windows.Forms.ColumnHeaderStyle.Nonclickable;
			this.listViewInfo.Location = new System.Drawing.Point(633, 264);
			this.listViewInfo.MultiSelect = false;
			this.listViewInfo.Name = "listViewInfo";
			this.listViewInfo.Size = new System.Drawing.Size(292, 312);
			this.ToolTip.SetSuperTooltip(this.listViewInfo, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NEWPROJECT_LAYERLIST", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.listViewInfo.TabIndex = 22;
			this.listViewInfo.UseCompatibleStateImageBehavior = false;
			this.listViewInfo.View = System.Windows.Forms.View.Details;
			this.columnHeaderLayer.Text = "Name";
			this.columnHeaderLayer.Width = 120;
			this.columnHeaderType.Text = "Type";
			this.columnHeaderType.Width = 130;
			this.label5.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.label5.AutoSize = true;
			this.label5.Location = new System.Drawing.Point(630, 36);
			this.label5.Name = "label5";
			this.label5.Size = new System.Drawing.Size(52, 13);
			this.label5.TabIndex = 24;
			this.label5.Text = "Selected:";
			this.labelLayers.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.labelLayers.AutoSize = true;
			this.labelLayers.Location = new System.Drawing.Point(630, 246);
			this.labelLayers.Name = "labelLayers";
			this.labelLayers.Size = new System.Drawing.Size(41, 13);
			this.labelLayers.TabIndex = 25;
			this.labelLayers.Text = "Layers:";
			this.richTextBoxExSelection.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.richTextBoxExSelection.BackgroundStyle.Class = "RichTextBoxBorder";
			this.richTextBoxExSelection.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.richTextBoxExSelection.Location = new System.Drawing.Point(633, 132);
			this.richTextBoxExSelection.Name = "richTextBoxExSelection";
			this.richTextBoxExSelection.ReadOnly = true;
			this.richTextBoxExSelection.Rtf = "{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang2067{\\fonttbl{\\f0\\fnil\\fcharset0 Microsoft Sans Serif;}}\r\n\\viewkind4\\uc1\\pard\\f0\\fs17\\par\r\n}\r\n";
			this.richTextBoxExSelection.Size = new System.Drawing.Size(292, 100);
			this.richTextBoxExSelection.TabIndex = 26;
			this.label7.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.label7.AutoSize = true;
			this.label7.Location = new System.Drawing.Point(630, 113);
			this.label7.Name = "label7";
			this.label7.Size = new System.Drawing.Size(63, 13);
			this.label7.TabIndex = 27;
			this.label7.Text = "Description:";
			this.labelSelection.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.labelSelection.Location = new System.Drawing.Point(630, 57);
			this.labelSelection.Name = "labelSelection";
			this.labelSelection.Size = new System.Drawing.Size(295, 51);
			this.labelSelection.TabIndex = 28;
			this.labelSelection.Text = "Title";
			this.pathBoxSolutionLocation.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left;
			this.pathBoxSolutionLocation.LoadSave = GrBuildStudio.Controls.PathBoxControl.PathBoxLoadSave.Load;
			this.pathBoxSolutionLocation.Location = new System.Drawing.Point(91, 51);
			this.pathBoxSolutionLocation.Margin = new System.Windows.Forms.Padding(2);
			this.pathBoxSolutionLocation.Name = "pathBoxSolutionLocation";
			this.pathBoxSolutionLocation.Path = null;
			this.pathBoxSolutionLocation.PathType = GrBuildStudio.Controls.PathBoxControl.PathBoxPathType.Folder;
			this.pathBoxSolutionLocation.Size = new System.Drawing.Size(340, 20);
			this.ToolTip.SetSuperTooltip(this.pathBoxSolutionLocation, new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NEWPROJECT_SOLUTIONLOCATION", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.pathBoxSolutionLocation.TabIndex = 7;
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Replace the resource tag in text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			base.AcceptButton = this.buttonCreate;
			base.CancelButton = this.buttonCancel;
			base.ClientSize = new System.Drawing.Size(941, 720);
			base.Controls.Add(this.labelSelection);
			base.Controls.Add(this.label7);
			base.Controls.Add(this.richTextBoxExSelection);
			base.Controls.Add(this.labelLayers);
			base.Controls.Add(this.label5);
			base.Controls.Add(this.listViewInfo);
			base.Controls.Add(this.NewSolutionPanel);
			base.Controls.Add(this.label2);
			base.Controls.Add(this.label1);
			base.Controls.Add(this.textBoxProjectName);
			base.Controls.Add(this.buttonCreate);
			base.Controls.Add(this.buttonCancel);
			base.Controls.Add(this.listView);
			this.DoubleBuffered = true;
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "NewProjectForm";
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "This title is set at run-time";
			base.Load += new System.EventHandler(NewProjectForm_Load);
			this.NewSolutionPanel.ResumeLayout(false);
			this.NewSolutionPanel.PerformLayout();
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	internal enum ReturnCode
	{
		Success = 0,
		InvalidCommandLine = 1,
		FailedImportingSolution = 2,
		FailedUnknown = 3,
		BuildErrorAtlassing = 110,
		MissingDlls = 200
	}
	public enum ProductModeType
	{
		GraniteSDK,
		GraniteUnity
	}
	internal static class Program
	{
		public static CommandLineOptions options = new CommandLineOptions();

		public static ProductModeType ProductMode;

		public static byte[] CurrentProductModeTag = new byte[64]
		{
			236, 37, 109, 138, 187, 84, 251, 169, 47, 23,
			121, 94, 0, 61, 237, 29, 34, 54, 17, 107,
			229, 108, 40, 1, 250, 15, 78, 27, 167, 76,
			35, 216, 192, 240, 193, 62, 114, 254, 207, 162,
			103, 189, 91, 225, 85, 199, 81, 239, 68, 146,
			39, 203, 218, 69, 60, 205, 140, 44, 130, 173,
			183, 72, 230, 9
		};

		public static byte[] UnityProductModeTag = new byte[64]
		{
			236, 37, 109, 138, 187, 84, 251, 169, 47, 23,
			121, 94, 0, 61, 237, 29, 34, 54, 17, 107,
			229, 108, 40, 1, 250, 15, 78, 27, 167, 76,
			35, 216, 192, 240, 193, 62, 114, 254, 207, 162,
			103, 189, 91, 225, 85, 199, 81, 239, 68, 146,
			39, 203, 218, 69, 60, 205, 140, 44, 130, 173,
			183, 72, 230, 10
		};

		[STAThread]
		private static int Main(string[] args)
		{
			try
			{
				Application.ThreadException += Application_ThreadException;
				Application.SetUnhandledExceptionMode(UnhandledExceptionMode.ThrowException);
				AppDomain.CurrentDomain.UnhandledException += CurrentDomain_UnhandledException;
				if (!GrBuildLibInterface.IsInitialized)
				{
					GrBuildLibInterface.InitializeGrBuild();
				}
				if (CurrentProductModeTag.SequenceEqual(UnityProductModeTag))
				{
					ProductMode = ProductModeType.GraniteUnity;
				}
				else
				{
					ProductMode = ProductModeType.GraniteSDK;
				}
				string currentDirectory = Directory.GetCurrentDirectory();
				Application.EnableVisualStyles();
				Application.SetCompatibleTextRenderingDefault(defaultValue: false);
				if (!new CommandLineParser(options).ParseCommandLine(args))
				{
					StudioLogger.Global.LogError("Invalid command line arguments");
					return 1;
				}
				if (ProductMode == ProductModeType.GraniteUnity && !options.hidden)
				{
					MessageBox.Show("This application is automatically launched through the Unity editor.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
					StudioLogger.Global.LogError("Only hidden mode is compatible with Unity.");
					return 1;
				}
				if (options.build && options.solutionPath == null && options.ImportSolutionFromXml == null)
				{
					StudioLogger.Global.LogError("-b requires the -o or -i option to be present.");
					return 1;
				}
				if (options.quit && !options.build)
				{
					StudioLogger.Global.LogError("-q requires the -b option to be present.");
					return 1;
				}
				MainForm.StartupContext startupContext = new MainForm.StartupContext();
				if (options.solutionPath != null)
				{
					startupContext.solutionToLoadPath = options.solutionPath;
				}
				else if (options.ImportSolutionFromXml != null)
				{
					string text = null;
					try
					{
						BuildLoggerReporter buildLoggerReporter = new BuildLoggerReporter(FormMode.Standalone);
						text = SolutionImporter.CreateSolutionFromXML(StudioLogger.Global, options, buildLoggerReporter);
						if (buildLoggerReporter.HasSomethingToReport && (buildLoggerReporter.HasErrors || !options.IgnoreImportWarnings))
						{
							buildLoggerReporter.AddFinishedMessage();
							buildLoggerReporter.ShowDialog();
						}
					}
					catch (Exception ex)
					{
						string message = "Unable to create solution from import file '" + options.ImportSolutionFromXml + "'.";
						string text2 = "Error description: '" + ex.Message + "'";
						if (ex.InnerException != null && !string.IsNullOrEmpty(ex.InnerException.Message))
						{
							text2 = text2 + " (" + ex.InnerException.Message + ")";
						}
						text2 += ". If the problem persists, please contact Graphine.";
						StudioLogger.Global.LogError(message, text2);
						return 2;
					}
					if (text != null)
					{
						startupContext.solutionToLoadPath = text;
					}
				}
				startupContext.buildSolution = options.build;
				startupContext.rebuildSolution = options.rebuild;
				startupContext.optimizedBuild = options.optimized;
				startupContext.quitAfterSuccessBuild = options.quit;
				startupContext.hideMainWindow = options.hidden;
				startupContext.silentAtlasErrors = options.silentAtlasErrors;
				startupContext.buildForGtex = options.buildGTSforGTex;
				startupContext.allowForeignGtex = options.allowForeignGTex;
				startupContext.forceGtex = options.forceUseGTex;
				startupContext.buildnotileset = options.omitGTS;
				MainForm mainForm = new MainForm();
				mainForm.SetStartupContext(startupContext);
				SlowTaskMonitor.DefaultParent = mainForm;
				ReturnCode result = ReturnCode.Success;
				if (options.hidden && options.build && options.quit)
				{
					mainForm.LoadAndBuild();
					if (mainForm.AutoBuildReport.AtlassingErrorsOccurred && startupContext.silentAtlasErrors)
					{
						result = ReturnCode.BuildErrorAtlassing;
					}
				}
				else
				{
					Application.Run(mainForm);
				}
				if (options.deamon)
				{
					string directoryName = Paths.GetDirectoryName(options.ImportSolutionFromXml);
					if (Directory.Exists(directoryName))
					{
						Directory.SetCurrentDirectory(currentDirectory);
						Directory.Delete(directoryName, recursive: true);
					}
				}
				return (int)result;
			}
			catch (Exception ex2)
			{
				CrashReportForm crashReportForm = new CrashReportForm();
				crashReportForm.Exception = ex2;
				crashReportForm.Message = ex2.Message;
				crashReportForm.Mode = CrashReportForm.DisplayMode.FatalError;
				crashReportForm.ShowDialog();
				return 3;
			}
			finally
			{
				GrBuildLibInterface.ReleaseGrBuild();
			}
		}

		private static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
		{
			Exception ex = (Exception)e.ExceptionObject;
			CrashReportForm crashReportForm = new CrashReportForm();
			crashReportForm.Exception = ex;
			crashReportForm.Message = ex.Message;
			crashReportForm.Mode = ((!e.IsTerminating) ? CrashReportForm.DisplayMode.Error : CrashReportForm.DisplayMode.FatalError);
			crashReportForm.ShowDialog();
		}

		private static void Application_ThreadException(object sender, ThreadExceptionEventArgs e)
		{
			CrashReportForm crashReportForm = new CrashReportForm();
			crashReportForm.Exception = e.Exception;
			crashReportForm.Message = e.Exception.Message;
			crashReportForm.Mode = CrashReportForm.DisplayMode.Error;
			crashReportForm.ShowDialog();
		}
	}
	public class ProjectNodeModel
	{
		public delegate void ProjectNodeClickedEventHandler(object sender, Guid id);

		public delegate void ProjectNodeRightClickedEventHandler(object sender, Point location);

		private ProjectBuilder projectBuilder;

		public Node Node { get; set; }

		public ProjectTree Tree { get; private set; }

		public event ProjectNodeClickedEventHandler ProjectNodeClicked;

		public event ProjectNodeRightClickedEventHandler ProjectNodeRightClicked;

		protected virtual void OnProjectNodeClicked(Guid id)
		{
			this.ProjectNodeClicked?.Invoke(this, id);
		}

		protected virtual void OnProjectNodeRightClicked(Point location)
		{
			this.ProjectNodeRightClicked?.Invoke(this, location);
		}

		public ProjectNodeModel(ProjectBuilder builder)
		{
			Node = new Node();
			projectBuilder = builder;
			CreateNode();
		}

		private string ToStringArray<T>(List<T> a, string seperator)
		{
			StringBuilder stringBuilder = new StringBuilder();
			for (int i = 0; i < a.Count; i++)
			{
				stringBuilder.Append(a[i]);
				if (i != a.Count - 1)
				{
					stringBuilder.Append(seperator);
				}
			}
			return stringBuilder.ToString();
		}

		public void Delete()
		{
			Tree.DeleteTree();
			Tree.Dispose();
			Tree = null;
			projectBuilder = null;
		}

		private string CreateRootNodeText()
		{
			LayerConfig layerConfiguration = projectBuilder.ActiveProject.LayerConfiguration;
			if (layerConfiguration == null)
			{
				return "<b>Tile Set in invalid state.</b>";
			}
			int count = layerConfiguration.Layers.Count;
			IEnumerable<string> source = layerConfiguration.Layers.Select((LayerDescription x) => x.LayerName);
			string text = ToStringArray(source.ToList(), ", ");
			string text2 = ((count > 1) ? "layers" : "layer");
			string text3 = "No Items";
			if (projectBuilder.ActiveProject.Assets.Count > 0)
			{
				text3 = projectBuilder.ActiveProject.Assets.Count + " Item";
				if (projectBuilder.ActiveProject.Assets.Count > 1)
				{
					text3 += "s";
				}
			}
			return $"<b>Tile Set '{projectBuilder.ActiveProject.Name}'</b> - {count} {text2} ({text}) - {text3}";
		}

		private ProjectTree CreateSubTree()
		{
			ProjectTree projectTree = new ProjectTree();
			projectTree.TreeSelected += tree_TreeSelected;
			projectTree.ProjectBuilder = projectBuilder;
			return projectTree;
		}

		private void tree_TreeSelected(object sender)
		{
			OnProjectNodeClicked(projectBuilder.ActiveProject.Id);
		}

		private ElementStyle GetRootNodeStyle()
		{
			return new ElementStyle
			{
				CornerType = eCornerType.Square,
				Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, 0),
				MarginBottom = 6,
				MarginTop = 6,
				Name = "rootNodeStyle"
			};
		}

		private void CreateNode()
		{
			Node.Tag = this;
			Node.Text = CreateRootNodeText();
			Node.Expanded = true;
			Node.Name = "node";
			Node.Style = GetRootNodeStyle();
			Node.NodeMouseUp += Node_NodeClick;
			Node.Image = (projectBuilder.ReadOnly ? Resources.icon_readonly : null);
			Node node = new Node();
			node.Expanded = true;
			Tree = CreateSubTree();
			node.HostedControl = Tree;
			node.Name = "treeNode";
			Node.Nodes.AddRange(new Node[1] { node });
		}

		public void UpdateNode()
		{
			Node.Text = CreateRootNodeText();
		}

		private void Node_NodeClick(object sender, MouseEventArgs e)
		{
			OnProjectNodeClicked(projectBuilder.ActiveProject.Id);
			if (e.Button == MouseButtons.Right)
			{
				OnProjectNodeRightClicked(e.Location);
			}
		}

		public void Refresh()
		{
			if (Tree.InvokeRequired)
			{
				Tree.Invoke((Action)delegate
				{
					Tree.PopulateTree();
				});
			}
			else
			{
				Tree.PopulateTree();
			}
		}

		public void UpdateAllAssets()
		{
			Tree.UpdateAllAssets();
		}

		public void RefreshAsset(Asset asset)
		{
			Tree.UpdateAssetInTree(asset);
		}

		public void StartRename()
		{
			Tree.StartRename();
		}

		public void Filter(string searchString)
		{
			Tree.Filter(searchString);
		}

		public void ClearFilter()
		{
			Tree.ClearFilter();
		}
	}
	public class ProjectPropertiesForm : OfficeForm
	{
		private class ComboBoxItem
		{
			public string Text { get; set; }

			public object Tag { get; set; }

			public ComboBoxItem()
			{
				Text = string.Empty;
				Tag = null;
			}

			public ComboBoxItem(string text)
			{
				Text = text;
				Tag = null;
			}

			public ComboBoxItem(string text, object tag)
			{
				Text = text;
				Tag = tag;
			}

			public override string ToString()
			{
				return Text;
			}
		}

		private string const_fromBuildSuffix = " (Auto set to '{0}' from profile)";

		private string const_fromBuildSuffixBehindScenes = " (Auto set from profile)";

		private uint[] DefaultMaxAnisoValues = new uint[5] { 0u, 2u, 4u, 8u, 16u };

		private uint DefaultMaxAnisoAutoValue = 8u;

		private uint[] DefaultTileSizes = new uint[5] { 0u, 64u, 128u, 256u, 512u };

		private uint DefaultTileSizesAutoValue;

		private uint[] DefaultPageSizes = new uint[1];

		private uint DefaultPageSizeValue;

		private BuildProfile activeBuildProfile;

		private bool readOnly;

		private IContainer components;

		private Button buttonAccept;

		private Button buttonCancel;

		private SuperTabControl superTabControl1;

		private SuperTabControlPanel superTabControlPanel1;

		private SuperTabItem superTabItem1;

		private Label label4;

		private ComboBox comboBoxProfiles;

		private Label label7;

		private TextBox textBoxProjectName;

		private SuperTabControlPanel superTabControlPanel2;

		private Label label1;

		private SuperTabItem superTabItem2;

		private SuperTabControlPanel superTabControlPanel3;

		private LabelX labelX1;

		private Label label14;

		private ComboBox comboBoxBlockSize;

		private Label label13;

		private ComboBox comboBoxTileHeight;

		private ComboBox comboBoxTileWidth;

		private Label label12;

		private Label label11;

		private ComboBox comboBoxPageSize;

		private Label label10;

		private ComboBox comboBoxMaxAniso;

		private SuperTabItem superTabItem3;

		private PathBoxControl pathBoxControlOutput;

		private ToolTip ToolTip;

		private SuperTabControlPanel superTabControlPanel4;

		private SuperTabItem superTabItem4;

		private CustomLayerLayoutControl customLayerLayoutControl1;

		private TextBox textBoxFixedTileWidth;

		private TextBox textBoxFixedTileHeight;

		private Label label5;

		private Label label9;

		private ComboBox comboBoxTargetDisk;

		private LabelX labelBuildProfileDescription;

		private Label label3;

		private PathBoxControl pathBoxControlSoupOutput;

		private CheckBox checkBoxNoRedirection;

		private Label label16;

		private CheckBox checkBoxHighQualityCoding;

		private Label label15;

		private CheckBox checkBoxNoUniformCoding;

		private CheckBox checkBoxPatching;

		private Label label8;

		private Label label6;

		private CheckBox checkBoxNoSharedMips;

		private Label label17;

		private ComboBox comboBoxPagingStrategy;

		private Label label18;

		private CheckBox checkBoxMipStripping;

		private Label label19;

		private Label label2;

		private Label label20;

		private TextBoxX textBoxPagesFolder;

		public ProjectProperties Properties { get; set; }

		public string ProjectPath { get; set; }

		public ProjectBuilder ProjectBuilder { get; set; }

		private ProjectPropertiesForm()
		{
			InitializeComponent();
		}

		public ProjectPropertiesForm(bool readOnly)
		{
			InitializeComponent();
			Properties = new ProjectProperties();
			superTabControl1.SelectedTabIndex = 0;
			this.readOnly = readOnly;
			EnableControls(readOnly);
		}

		private void EnableControls(bool readOnly)
		{
			Control[] array = new Control[13]
			{
				textBoxProjectName, comboBoxProfiles, pathBoxControlOutput, pathBoxControlSoupOutput, textBoxPagesFolder, comboBoxMaxAniso, comboBoxTargetDisk, comboBoxPageSize, comboBoxTileWidth, comboBoxTileHeight,
				comboBoxBlockSize, comboBoxPagingStrategy, customLayerLayoutControl1
			};
			for (int i = 0; i < array.Length; i++)
			{
				array[i].Enabled = !readOnly;
			}
		}

		private void LoadBuildProfiles()
		{
			ComboBoxHelper.FillComboboxValues(values: ProfileLoader.GetAvailableBuildProfiles(), toString: (BuildProfile bp) => string.IsNullOrEmpty(bp.DisplayName) ? "unnamed" : bp.DisplayName, combo: comboBoxProfiles);
			string selected = ((Properties.BuildProfile.Length > 0) ? Properties.BuildProfile : "default");
			ComboBoxHelper.SelectComboBoxItem(selector: (BuildProfile bp) => bp.Name.ToLowerInvariant().Equals(selected.ToLowerInvariant()), combo: comboBoxProfiles);
			comboBoxProfiles.SelectedIndexChanged += comboBoxProfiles_SelectedIndexChanged;
			ProfileLoader.LoadBuildProfile(selected, out activeBuildProfile);
			ProfileLoader.ActivateBuildProfile(activeBuildProfile);
			labelBuildProfileDescription.Text = activeBuildProfile.Description;
		}

		private void LoadAdvancedCombos()
		{
			LoadComboboxValues(comboBoxPageSize, DefaultPageSizes, DefaultPageSizeValue, Defaults.PageSize);
			LoadComboboxValues(comboBoxMaxAniso, DefaultMaxAnisoValues, DefaultMaxAnisoAutoValue, Defaults.Aniso);
			LoadComboboxValues(comboBoxTileWidth, DefaultTileSizes, DefaultTileSizesAutoValue, Defaults.TileWidth);
			LoadComboboxValues(comboBoxTileHeight, DefaultTileSizes, DefaultTileSizesAutoValue, Defaults.TileHeight);
			LoadComboboxEnumValues(comboBoxTargetDisk, TargetDisk.Default, Defaults.TargetDisk);
			LoadComboboxEnumValues(comboBoxPagingStrategy, activeBuildProfile.AvailablePagingStrategies, PagingStrategy.Default, activeBuildProfile.DefaultPagingStrategyMapsTo);
			if (GrBuildLib.Constants.FixedTileSize.X > 0 || GrBuildLib.Constants.FixedTileSize.Y > 0)
			{
				comboBoxTileWidth.Visible = false;
				comboBoxTileHeight.Visible = false;
				textBoxFixedTileWidth.Text = GrBuildLib.Constants.FixedTileSize.X + " (Determined by License)";
				textBoxFixedTileHeight.Text = GrBuildLib.Constants.FixedTileSize.Y + " (Determined by License)";
				ReplaceControl(comboBoxTileWidth, textBoxFixedTileWidth);
				ReplaceControl(comboBoxTileHeight, textBoxFixedTileHeight);
				ToolTip.SetSuperTooltip(textBoxFixedTileWidth, new SuperTooltipInfo("", "", "TT_PROPERTIES_INDIE_TILEWIDTH", null, null, eTooltipColor.Gray));
				ToolTip.SetSuperTooltip(textBoxFixedTileHeight, new SuperTooltipInfo("", "", "TT_PROPERTIES_INDIE_TILEHEIGHT", null, null, eTooltipColor.Gray));
				ToolTip.SetSuperTooltip(comboBoxTileWidth, new SuperTooltipInfo("Test", "", "TT_PROPERTIES_INDIE_TILEWIDTH", null, null, eTooltipColor.Gray));
				ToolTip.SetSuperTooltip(comboBoxTileHeight, new SuperTooltipInfo("Test", "", "TT_PROPERTIES_INDIE_TILEHEIGHT", null, null, eTooltipColor.Gray));
			}
		}

		private bool IsCodingProfileChanged(LayerConfig config1, LayerConfig config2, out bool[] changes)
		{
			int num = Math.Min(config1.Layers.Count, config2.Layers.Count);
			changes = new bool[num];
			bool result = false;
			for (int i = 0; i < num; i++)
			{
				if (!config1.Layers[i].CodingProfile.Equals(config2.Layers[i].CodingProfile, StringComparison.OrdinalIgnoreCase))
				{
					changes[i] = true;
					result = true;
				}
			}
			return result;
		}

		private bool IsDataTypeChanged(LayerConfig config1, LayerConfig config2, out bool[] changes)
		{
			int num = Math.Min(config1.Layers.Count, config2.Layers.Count);
			changes = new bool[num];
			bool result = false;
			for (int i = 0; i < num; i++)
			{
				if (config1.Layers[i].DataType != config2.Layers[i].DataType)
				{
					changes[i] = true;
					result = true;
				}
			}
			return result;
		}

		private void LoadForm()
		{
			Directory.SetCurrentDirectory(ProjectPath);
			LoadBuildProfiles();
			LoadAdvancedCombos();
			textBoxProjectName.Text = Properties.ProjectName;
			checkBoxNoUniformCoding.Checked = Properties.NoUniformCoding;
			checkBoxPatching.Checked = Properties.Patching;
			checkBoxHighQualityCoding.Checked = Properties.HighQualityCoding;
			checkBoxNoRedirection.Checked = Properties.NoRedirection;
			checkBoxNoSharedMips.Checked = Properties.NoSharedMipGeneration;
			checkBoxMipStripping.Checked = Properties.MipStripping;
			pathBoxControlOutput.Path = Path.GetFullPath(Properties.OutputFilename);
			pathBoxControlSoupOutput.Path = Path.GetFullPath(Properties.SoupOutputFolder);
			textBoxPagesFolder.Text = Properties.PagesFolder;
			SelectComboboxValue(comboBoxPageSize, Properties.PageSize);
			SelectComboboxValue(comboBoxTileHeight, Properties.TileHeight);
			SelectComboboxValue(comboBoxTileWidth, Properties.TileWidth);
			SelectComboboxValue(comboBoxMaxAniso, Properties.MaxAnisotropy);
			SelectComboboxValue(comboBoxTargetDisk, Properties.TargetDisk);
			SelectComboboxValue(comboBoxPagingStrategy, Properties.PagingStrategy);
			customLayerLayoutControl1.InitializeForLayerConfig(Properties.LayerConfiguration, activeBuildProfile);
		}

		private void SaveForm()
		{
			Properties.BuildProfile = ComboBoxHelper.GetSelectedValue<BuildProfile>(comboBoxProfiles).Name;
			Properties.NoUniformCoding = checkBoxNoUniformCoding.Checked;
			Properties.Patching = checkBoxPatching.Checked;
			Properties.NoRedirection = checkBoxNoRedirection.Checked;
			Properties.NoSharedMipGeneration = checkBoxNoSharedMips.Checked;
			Properties.MipStripping = checkBoxMipStripping.Checked;
			Properties.HighQualityCoding = checkBoxHighQualityCoding.Checked;
			Properties.OutputFilename = Paths.GetRelativePathForFile(ProjectPath, pathBoxControlOutput.Path);
			Properties.PagesFolder = CleanRelativePath(textBoxPagesFolder.Text);
			Properties.SoupOutputFolder = Paths.GetRelativePathForDirectory(ProjectPath, pathBoxControlSoupOutput.Path);
			Properties.TileWidth = (uint)GetComboboxValue(comboBoxTileWidth, Defaults.TileWidth);
			Properties.TileHeight = (uint)GetComboboxValue(comboBoxTileHeight, Defaults.TileHeight);
			Properties.MaxAnisotropy = (uint)GetComboboxValue(comboBoxMaxAniso, Defaults.Aniso);
			Properties.TargetDisk = (TargetDisk)GetComboboxValue(comboBoxTargetDisk, Defaults.TargetDisk);
			Properties.PageSize = GetComboboxCustomValueUint(comboBoxPageSize, Defaults.PageSize);
			Properties.PagingStrategy = (PagingStrategy)GetComboboxValue(comboBoxPagingStrategy, PagingStrategy.Default);
			customLayerLayoutControl1.ApplyLayerConfiguration();
			bool flag = false;
			if (IsCodingProfileChanged(Properties.LayerConfiguration, customLayerLayoutControl1.ProjectTemplate.LayerConfig, out var changes))
			{
				for (int i = 0; i < changes.Length; i++)
				{
					if (changes[i] && ProjectBuilder.HasCustomQualityProfilesSet(i))
					{
						string text = "You have custom-set quality profiles for Stacked Textures and have changed the compression format. All quality profiles will be reverted for the layer to their defaults. Continue?";
						flag = MessageBox.Show(this, text, "Compression Format changed", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.No;
						break;
					}
				}
			}
			Properties.DataTypesChanged = IsDataTypeChanged(Properties.LayerConfiguration, customLayerLayoutControl1.ProjectTemplate.LayerConfig, out var changes2);
			Properties.DataTypeLayerChanged = changes2;
			if (!flag)
			{
				Properties.LayerConfiguration = customLayerLayoutControl1.ProjectTemplate.LayerConfig;
			}
			Properties.CodingProfileChanged = !flag;
			Properties.CodingProfileLayerChanged = changes;
		}

		private void ProjectPropertiesForm_Load(object sender, EventArgs e)
		{
			LoadForm();
		}

		private void buttonAccept_Click(object sender, EventArgs e)
		{
			if (!readOnly)
			{
				SaveForm();
			}
		}

		private void comboBoxProfiles_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (MessageBox.Show(this, "Loading a Build Profile will result in custom set properties in the advanced tab being reset. Do you want to continue?", "", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.Yes)
			{
				activeBuildProfile = ComboBoxHelper.GetSelectedValue<BuildProfile>(comboBoxProfiles);
				ProfileLoader.ActivateBuildProfile(activeBuildProfile);
				labelBuildProfileDescription.Text = activeBuildProfile.Description;
				customLayerLayoutControl1.InitializeForLayerConfig(Properties.LayerConfiguration, activeBuildProfile);
				LoadAdvancedCombos();
				SelectComboboxValue(comboBoxPageSize, Defaults.PageSize);
				SelectComboboxValue(comboBoxMaxAniso, Defaults.Aniso);
				SelectComboboxValue(comboBoxTileHeight, Defaults.TileWidth);
				SelectComboboxValue(comboBoxTileWidth, Defaults.TileHeight);
				SelectComboboxValue(comboBoxTargetDisk, Defaults.TargetDisk);
				SelectComboboxValue(comboBoxPagingStrategy, PagingStrategy.Default);
			}
		}

		private object GetComboboxValue(ComboBox box, object defaultValue)
		{
			if (box.SelectedItem != null)
			{
				return ((ComboBoxItem)box.SelectedItem).Tag;
			}
			return defaultValue;
		}

		private uint GetComboboxCustomValueUint(ComboBox box, uint defaultValue)
		{
			_ = box.DropDownStyle;
			_ = 2;
			try
			{
				return uint.Parse(box.Text);
			}
			catch
			{
				return defaultValue;
			}
		}

		private void SelectComboboxValue(ComboBox box, object value)
		{
			object obj = null;
			foreach (ComboBoxItem item in box.Items)
			{
				if (ObjEquals(item.Tag, value))
				{
					obj = item;
					break;
				}
			}
			if (obj != null)
			{
				box.SelectedItem = obj;
			}
			else if (box.DropDownStyle == ComboBoxStyle.DropDown)
			{
				ComboBoxItem comboBoxItem2 = new ComboBoxItem();
				comboBoxItem2.Tag = value;
				comboBoxItem2.Text = value.ToString();
				box.Items.Add(comboBoxItem2);
				box.SelectedItem = comboBoxItem2;
			}
		}

		private void LoadComboboxValues<T>(ComboBox combo, T[] values, T autoValue, T profileValue)
		{
			combo.Items.Clear();
			int num = -1;
			for (int i = 0; i < values.Length; i++)
			{
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				comboBoxItem.Tag = values[i];
				comboBoxItem.Text = values[i].ToString();
				if (ObjEquals(values[i], autoValue))
				{
					if (ObjEquals(autoValue, profileValue))
					{
						comboBoxItem.Text += const_fromBuildSuffixBehindScenes;
					}
					else
					{
						comboBoxItem.Text += string.Format(const_fromBuildSuffix, profileValue.ToString());
					}
					num = i;
				}
				combo.Items.Add(comboBoxItem);
			}
			if (num != -1)
			{
				combo.SelectedIndex = num;
			}
		}

		private void LoadComboboxValues<T>(ComboBox combo, T[] values, T profileValue)
		{
			combo.Items.Clear();
			int num = -1;
			for (int i = 0; i < values.Length; i++)
			{
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				comboBoxItem.Tag = values[i];
				comboBoxItem.Text = values[i].ToString();
				if (ObjEquals(values[i], profileValue))
				{
					comboBoxItem.Text += const_fromBuildSuffixBehindScenes;
					num = i;
				}
				combo.Items.Add(comboBoxItem);
			}
			if (num != -1)
			{
				combo.SelectedIndex = num;
			}
		}

		private void LoadComboboxEnumValues<T>(ComboBox combo, T autoValue, T profileValue)
		{
			LoadComboboxEnumValues(combo, null, autoValue, profileValue);
		}

		private void LoadComboboxEnumValues<T>(ComboBox combo, List<T> filter, T autoValue, T profileValue)
		{
			combo.Items.Clear();
			int num = -1;
			List<T> list = EnumToList<T>();
			for (int i = 0; i < list.Count; i++)
			{
				if (filter != null && !filter.Contains(list[i]))
				{
					continue;
				}
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				comboBoxItem.Tag = list[i];
				comboBoxItem.Text = list[i].ToString();
				if (ObjEquals(list[i], autoValue))
				{
					if (ObjEquals(autoValue, profileValue))
					{
						comboBoxItem.Text += const_fromBuildSuffixBehindScenes;
					}
					else
					{
						comboBoxItem.Text += string.Format(const_fromBuildSuffix, profileValue.ToString());
					}
					num = i;
				}
				combo.Items.Add(comboBoxItem);
			}
			if (num != -1)
			{
				combo.SelectedIndex = num;
			}
		}

		private void ReplaceControl(Control replacee, Control replacer)
		{
			replacer.Location = replacee.Location;
			replacer.Size = replacee.Size;
			replacer.Visible = true;
			replacee.Visible = false;
		}

		private List<T> EnumToList<T>()
		{
			List<T> list = new List<T>();
			Array values = System.Enum.GetValues(typeof(T));
			for (int i = 0; i < values.Length; i++)
			{
				list.Add((T)values.GetValue(i));
			}
			return list;
		}

		private bool ObjEquals(object a, object b)
		{
			if (a is string && b is string)
			{
				return ((string)a).ToLower().Equals(((string)b).ToLower());
			}
			return a.Equals(b);
		}

		private bool CheckPagesFolder()
		{
			string text = textBoxPagesFolder.Text;
			if (string.IsNullOrEmpty(text))
			{
				return true;
			}
			if (!Paths.IsValidDirectory(text))
			{
				MessageBox.Show(this, "The pages output path is not a valid path. Please make sure you select a path residing in the output folder of the output file.", "Error with Page Output Folder");
				return false;
			}
			if (Paths.IsAbsolutePath(text))
			{
				MessageBox.Show(this, "The pages output path is not related to the output file path. Please make sure you select a path on the same drive as the output file path or enter a manually enter a relative path.", "Error with Page Output Folder");
				return false;
			}
			if (text.Contains(".."))
			{
				MessageBox.Show(this, "The pages output lies outside the output file path. Please make sure you select a path residing in the output folder of the output file.", "Error with Page Output Folder");
				return false;
			}
			if (text.StartsWith(".\\") || text.StartsWith("./"))
			{
				MessageBox.Show(this, "The pages output cannot start with a '.' or '..'. Please start the path with a directory name, e.g., 'subfolder\\gtp'.", "Error with Page Output Folder");
				return false;
			}
			return true;
		}

		private string CleanRelativePath(string relativePath)
		{
			if (relativePath.StartsWith(".\\") || relativePath.StartsWith("./"))
			{
				return relativePath.Substring(2);
			}
			return relativePath;
		}

		private void textBoxPagesFolder_Leave(object sender, EventArgs e)
		{
			CheckPagesFolder();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.buttonAccept = new System.Windows.Forms.Button();
			this.buttonCancel = new System.Windows.Forms.Button();
			this.comboBoxProfiles = new System.Windows.Forms.ComboBox();
			this.superTabControl1 = new DevComponents.DotNetBar.SuperTabControl();
			this.superTabControlPanel2 = new DevComponents.DotNetBar.SuperTabControlPanel();
			this.textBoxPagesFolder = new DevComponents.DotNetBar.Controls.TextBoxX();
			this.label3 = new System.Windows.Forms.Label();
			this.label20 = new System.Windows.Forms.Label();
			this.label2 = new System.Windows.Forms.Label();
			this.label1 = new System.Windows.Forms.Label();
			this.superTabItem2 = new DevComponents.DotNetBar.SuperTabItem();
			this.superTabControlPanel3 = new DevComponents.DotNetBar.SuperTabControlPanel();
			this.checkBoxMipStripping = new System.Windows.Forms.CheckBox();
			this.label19 = new System.Windows.Forms.Label();
			this.comboBoxPagingStrategy = new System.Windows.Forms.ComboBox();
			this.label18 = new System.Windows.Forms.Label();
			this.checkBoxNoSharedMips = new System.Windows.Forms.CheckBox();
			this.label17 = new System.Windows.Forms.Label();
			this.checkBoxNoRedirection = new System.Windows.Forms.CheckBox();
			this.label16 = new System.Windows.Forms.Label();
			this.checkBoxHighQualityCoding = new System.Windows.Forms.CheckBox();
			this.label15 = new System.Windows.Forms.Label();
			this.checkBoxNoUniformCoding = new System.Windows.Forms.CheckBox();
			this.checkBoxPatching = new System.Windows.Forms.CheckBox();
			this.label8 = new System.Windows.Forms.Label();
			this.label6 = new System.Windows.Forms.Label();
			this.comboBoxBlockSize = new System.Windows.Forms.ComboBox();
			this.label9 = new System.Windows.Forms.Label();
			this.comboBoxTargetDisk = new System.Windows.Forms.ComboBox();
			this.label5 = new System.Windows.Forms.Label();
			this.textBoxFixedTileHeight = new System.Windows.Forms.TextBox();
			this.textBoxFixedTileWidth = new System.Windows.Forms.TextBox();
			this.labelX1 = new DevComponents.DotNetBar.LabelX();
			this.label14 = new System.Windows.Forms.Label();
			this.label13 = new System.Windows.Forms.Label();
			this.comboBoxTileHeight = new System.Windows.Forms.ComboBox();
			this.label12 = new System.Windows.Forms.Label();
			this.comboBoxTileWidth = new System.Windows.Forms.ComboBox();
			this.label11 = new System.Windows.Forms.Label();
			this.comboBoxPageSize = new System.Windows.Forms.ComboBox();
			this.label10 = new System.Windows.Forms.Label();
			this.comboBoxMaxAniso = new System.Windows.Forms.ComboBox();
			this.superTabItem3 = new DevComponents.DotNetBar.SuperTabItem();
			this.superTabControlPanel4 = new DevComponents.DotNetBar.SuperTabControlPanel();
			this.superTabItem4 = new DevComponents.DotNetBar.SuperTabItem();
			this.superTabControlPanel1 = new DevComponents.DotNetBar.SuperTabControlPanel();
			this.labelBuildProfileDescription = new DevComponents.DotNetBar.LabelX();
			this.label4 = new System.Windows.Forms.Label();
			this.label7 = new System.Windows.Forms.Label();
			this.textBoxProjectName = new System.Windows.Forms.TextBox();
			this.superTabItem1 = new DevComponents.DotNetBar.SuperTabItem();
			this.pathBoxControlSoupOutput = new GrBuildStudio.Controls.PathBoxControl();
			this.pathBoxControlOutput = new GrBuildStudio.Controls.PathBoxControl();
			this.customLayerLayoutControl1 = new GrBuildStudio.CustomLayerLayoutControl();
			this.ToolTip = new GrBuildStudio.ToolTip();
			((System.ComponentModel.ISupportInitialize)this.superTabControl1).BeginInit();
			this.superTabControl1.SuspendLayout();
			this.superTabControlPanel2.SuspendLayout();
			this.superTabControlPanel3.SuspendLayout();
			this.superTabControlPanel4.SuspendLayout();
			this.superTabControlPanel1.SuspendLayout();
			base.SuspendLayout();
			this.buttonAccept.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonAccept.DialogResult = System.Windows.Forms.DialogResult.OK;
			this.buttonAccept.Location = new System.Drawing.Point(592, 308);
			this.buttonAccept.Name = "buttonAccept";
			this.buttonAccept.Size = new System.Drawing.Size(75, 23);
			this.buttonAccept.TabIndex = 100;
			this.buttonAccept.Text = "Accept";
			this.buttonAccept.UseVisualStyleBackColor = true;
			this.buttonAccept.Click += new System.EventHandler(buttonAccept_Click);
			this.buttonCancel.Anchor = System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right;
			this.buttonCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
			this.buttonCancel.Location = new System.Drawing.Point(673, 308);
			this.buttonCancel.Name = "buttonCancel";
			this.buttonCancel.Size = new System.Drawing.Size(75, 23);
			this.buttonCancel.TabIndex = 110;
			this.buttonCancel.Text = "Cancel";
			this.buttonCancel.UseVisualStyleBackColor = true;
			this.comboBoxProfiles.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxProfiles.FormattingEnabled = true;
			this.comboBoxProfiles.Location = new System.Drawing.Point(148, 58);
			this.comboBoxProfiles.Name = "comboBoxProfiles";
			this.comboBoxProfiles.Size = new System.Drawing.Size(268, 21);
			this.ToolTip.SetSuperTooltip(this.comboBoxProfiles, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_BUILDPROFILE_COMBOBOX", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.comboBoxProfiles.TabIndex = 42;
			this.superTabControl1.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.superTabControl1.BackColor = System.Drawing.Color.FromArgb(239, 239, 242);
			this.superTabControl1.ControlBox.CloseBox.Name = "";
			this.superTabControl1.ControlBox.MenuBox.Name = "";
			this.superTabControl1.ControlBox.Name = "";
			this.superTabControl1.ControlBox.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[2]
			{
				this.superTabControl1.ControlBox.MenuBox,
				this.superTabControl1.ControlBox.CloseBox
			});
			this.superTabControl1.Controls.Add(this.superTabControlPanel2);
			this.superTabControl1.Controls.Add(this.superTabControlPanel1);
			this.superTabControl1.Controls.Add(this.superTabControlPanel3);
			this.superTabControl1.Controls.Add(this.superTabControlPanel4);
			this.superTabControl1.ForeColor = System.Drawing.Color.Black;
			this.superTabControl1.Location = new System.Drawing.Point(12, 12);
			this.superTabControl1.Name = "superTabControl1";
			this.superTabControl1.ReorderTabsEnabled = false;
			this.superTabControl1.SelectedTabFont = new System.Drawing.Font("Microsoft Sans Serif", 8.25f);
			this.superTabControl1.SelectedTabIndex = 0;
			this.superTabControl1.Size = new System.Drawing.Size(736, 279);
			this.superTabControl1.TabFont = new System.Drawing.Font("Microsoft Sans Serif", 8.25f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			this.superTabControl1.TabIndex = 45;
			this.superTabControl1.Tabs.AddRange(new DevComponents.DotNetBar.BaseItem[4] { this.superTabItem1, this.superTabItem4, this.superTabItem2, this.superTabItem3 });
			this.superTabControl1.Text = "superTabControl1";
			this.superTabControlPanel2.Controls.Add(this.textBoxPagesFolder);
			this.superTabControlPanel2.Controls.Add(this.label3);
			this.superTabControlPanel2.Controls.Add(this.label20);
			this.superTabControlPanel2.Controls.Add(this.label2);
			this.superTabControlPanel2.Controls.Add(this.label1);
			this.superTabControlPanel2.Controls.Add(this.pathBoxControlSoupOutput);
			this.superTabControlPanel2.Controls.Add(this.pathBoxControlOutput);
			this.superTabControlPanel2.Dock = System.Windows.Forms.DockStyle.Fill;
			this.superTabControlPanel2.Location = new System.Drawing.Point(0, 25);
			this.superTabControlPanel2.Name = "superTabControlPanel2";
			this.superTabControlPanel2.Size = new System.Drawing.Size(736, 254);
			this.superTabControlPanel2.TabIndex = 2;
			this.superTabControlPanel2.TabItem = this.superTabItem2;
			this.textBoxPagesFolder.Border.Class = "TextBoxBorder";
			this.textBoxPagesFolder.Border.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.textBoxPagesFolder.Location = new System.Drawing.Point(148, 88);
			this.textBoxPagesFolder.Name = "textBoxPagesFolder";
			this.textBoxPagesFolder.PreventEnterBeep = true;
			this.textBoxPagesFolder.Size = new System.Drawing.Size(273, 20);
			this.textBoxPagesFolder.TabIndex = 53;
			this.textBoxPagesFolder.Leave += new System.EventHandler(textBoxPagesFolder_Leave);
			this.label3.AutoSize = true;
			this.label3.BackColor = System.Drawing.Color.Transparent;
			this.label3.Location = new System.Drawing.Point(32, 62);
			this.label3.Name = "label3";
			this.label3.Size = new System.Drawing.Size(101, 13);
			this.ToolTip.SetSuperTooltip(this.label3, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_GTEXOUTPUTFOLDER_LABEL", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.label3.TabIndex = 51;
			this.label3.Text = "GTEX output folder:";
			this.label20.BackColor = System.Drawing.Color.Transparent;
			this.label20.Location = new System.Drawing.Point(433, 91);
			this.label20.Name = "label20";
			this.label20.Size = new System.Drawing.Size(283, 76);
			this.label20.TabIndex = 41;
			this.label20.Text = "A relative path within the output file folder (default is empty), e.g., 'pagesfolder\\out\\'";
			this.label2.AutoSize = true;
			this.label2.BackColor = System.Drawing.Color.Transparent;
			this.label2.Location = new System.Drawing.Point(32, 91);
			this.label2.Name = "label2";
			this.label2.Size = new System.Drawing.Size(110, 13);
			this.ToolTip.SetSuperTooltip(this.label2, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_PAGEFOLDER_LABEL", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.label2.TabIndex = 41;
			this.label2.Text = "GTP pages subfolder:";
			this.label1.AutoSize = true;
			this.label1.BackColor = System.Drawing.Color.Transparent;
			this.label1.Location = new System.Drawing.Point(32, 35);
			this.label1.Name = "label1";
			this.label1.Size = new System.Drawing.Size(81, 13);
			this.ToolTip.SetSuperTooltip(this.label1, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_OUTPUTFILE_LABEL", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.label1.TabIndex = 38;
			this.label1.Text = "Output filename";
			this.superTabItem2.AttachedControl = this.superTabControlPanel2;
			this.superTabItem2.GlobalItem = false;
			this.superTabItem2.Name = "superTabItem2";
			this.superTabItem2.Text = "Output";
			this.superTabControlPanel3.Controls.Add(this.checkBoxMipStripping);
			this.superTabControlPanel3.Controls.Add(this.label19);
			this.superTabControlPanel3.Controls.Add(this.comboBoxPagingStrategy);
			this.superTabControlPanel3.Controls.Add(this.label18);
			this.superTabControlPanel3.Controls.Add(this.checkBoxNoSharedMips);
			this.superTabControlPanel3.Controls.Add(this.label17);
			this.superTabControlPanel3.Controls.Add(this.checkBoxNoRedirection);
			this.superTabControlPanel3.Controls.Add(this.label16);
			this.superTabControlPanel3.Controls.Add(this.checkBoxHighQualityCoding);
			this.superTabControlPanel3.Controls.Add(this.label15);
			this.superTabControlPanel3.Controls.Add(this.checkBoxNoUniformCoding);
			this.superTabControlPanel3.Controls.Add(this.checkBoxPatching);
			this.superTabControlPanel3.Controls.Add(this.label8);
			this.superTabControlPanel3.Controls.Add(this.label6);
			this.superTabControlPanel3.Controls.Add(this.comboBoxBlockSize);
			this.superTabControlPanel3.Controls.Add(this.label9);
			this.superTabControlPanel3.Controls.Add(this.comboBoxTargetDisk);
			this.superTabControlPanel3.Controls.Add(this.label5);
			this.superTabControlPanel3.Controls.Add(this.textBoxFixedTileHeight);
			this.superTabControlPanel3.Controls.Add(this.textBoxFixedTileWidth);
			this.superTabControlPanel3.Controls.Add(this.labelX1);
			this.superTabControlPanel3.Controls.Add(this.label14);
			this.superTabControlPanel3.Controls.Add(this.label13);
			this.superTabControlPanel3.Controls.Add(this.comboBoxTileHeight);
			this.superTabControlPanel3.Controls.Add(this.label12);
			this.superTabControlPanel3.Controls.Add(this.comboBoxTileWidth);
			this.superTabControlPanel3.Controls.Add(this.label11);
			this.superTabControlPanel3.Controls.Add(this.comboBoxPageSize);
			this.superTabControlPanel3.Controls.Add(this.label10);
			this.superTabControlPanel3.Controls.Add(this.comboBoxMaxAniso);
			this.superTabControlPanel3.Dock = System.Windows.Forms.DockStyle.Fill;
			this.superTabControlPanel3.Location = new System.Drawing.Point(0, 25);
			this.superTabControlPanel3.Name = "superTabControlPanel3";
			this.superTabControlPanel3.Size = new System.Drawing.Size(736, 254);
			this.superTabControlPanel3.TabIndex = 0;
			this.superTabControlPanel3.TabItem = this.superTabItem3;
			this.checkBoxMipStripping.AutoSize = true;
			this.checkBoxMipStripping.Location = new System.Drawing.Point(609, 185);
			this.checkBoxMipStripping.Name = "checkBoxMipStripping";
			this.checkBoxMipStripping.Size = new System.Drawing.Size(15, 14);
			this.ToolTip.SetSuperTooltip(this.checkBoxMipStripping, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_PROPERTIES_MIPSTRIPPING", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.checkBoxMipStripping.TabIndex = 89;
			this.checkBoxMipStripping.UseVisualStyleBackColor = true;
			this.label19.AutoSize = true;
			this.label19.BackColor = System.Drawing.Color.Transparent;
			this.label19.Location = new System.Drawing.Point(474, 186);
			this.label19.Name = "label19";
			this.label19.Size = new System.Drawing.Size(101, 13);
			this.label19.TabIndex = 88;
			this.label19.Text = "Enable mip stripping";
			this.comboBoxPagingStrategy.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxPagingStrategy.FormattingEnabled = true;
			this.comboBoxPagingStrategy.Location = new System.Drawing.Point(158, 189);
			this.comboBoxPagingStrategy.Name = "comboBoxPagingStrategy";
			this.comboBoxPagingStrategy.Size = new System.Drawing.Size(255, 21);
			this.comboBoxPagingStrategy.TabIndex = 87;
			this.label18.AutoSize = true;
			this.label18.BackColor = System.Drawing.Color.Transparent;
			this.label18.Location = new System.Drawing.Point(49, 192);
			this.label18.Name = "label18";
			this.label18.Size = new System.Drawing.Size(83, 13);
			this.label18.TabIndex = 86;
			this.label18.Text = "Paging strategy:";
			this.checkBoxNoSharedMips.AutoSize = true;
			this.checkBoxNoSharedMips.Location = new System.Drawing.Point(609, 160);
			this.checkBoxNoSharedMips.Name = "checkBoxNoSharedMips";
			this.checkBoxNoSharedMips.Size = new System.Drawing.Size(15, 14);
			this.ToolTip.SetSuperTooltip(this.checkBoxNoSharedMips, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_PROPERTIES_NOSHAREDMIPS", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.checkBoxNoSharedMips.TabIndex = 85;
			this.checkBoxNoSharedMips.UseVisualStyleBackColor = true;
			this.label17.AutoSize = true;
			this.label17.BackColor = System.Drawing.Color.Transparent;
			this.label17.Location = new System.Drawing.Point(474, 161);
			this.label17.Name = "label17";
			this.label17.Size = new System.Drawing.Size(120, 13);
			this.label17.TabIndex = 84;
			this.label17.Text = "Disable shared mip gen.";
			this.checkBoxNoRedirection.AutoSize = true;
			this.checkBoxNoRedirection.Location = new System.Drawing.Point(609, 134);
			this.checkBoxNoRedirection.Name = "checkBoxNoRedirection";
			this.checkBoxNoRedirection.Size = new System.Drawing.Size(15, 14);
			this.ToolTip.SetSuperTooltip(this.checkBoxNoRedirection, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_PROPERTIES_NOREDIRECTION", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.checkBoxNoRedirection.TabIndex = 83;
			this.checkBoxNoRedirection.UseVisualStyleBackColor = true;
			this.label16.AutoSize = true;
			this.label16.BackColor = System.Drawing.Color.Transparent;
			this.label16.Location = new System.Drawing.Point(474, 135);
			this.label16.Name = "label16";
			this.label16.Size = new System.Drawing.Size(110, 13);
			this.label16.TabIndex = 82;
			this.label16.Text = "Disable tile redirection";
			this.checkBoxHighQualityCoding.AutoSize = true;
			this.checkBoxHighQualityCoding.Location = new System.Drawing.Point(609, 82);
			this.checkBoxHighQualityCoding.Name = "checkBoxHighQualityCoding";
			this.checkBoxHighQualityCoding.Size = new System.Drawing.Size(15, 14);
			this.ToolTip.SetSuperTooltip(this.checkBoxHighQualityCoding, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_PROPERTIES_HIGHQUALCODING", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.checkBoxHighQualityCoding.TabIndex = 81;
			this.checkBoxHighQualityCoding.UseVisualStyleBackColor = true;
			this.label15.AutoSize = true;
			this.label15.BackColor = System.Drawing.Color.Transparent;
			this.label15.Location = new System.Drawing.Point(474, 83);
			this.label15.Name = "label15";
			this.label15.Size = new System.Drawing.Size(97, 13);
			this.label15.TabIndex = 80;
			this.label15.Text = "High quality coding";
			this.checkBoxNoUniformCoding.AutoSize = true;
			this.checkBoxNoUniformCoding.Location = new System.Drawing.Point(609, 108);
			this.checkBoxNoUniformCoding.Name = "checkBoxNoUniformCoding";
			this.checkBoxNoUniformCoding.Size = new System.Drawing.Size(15, 14);
			this.ToolTip.SetSuperTooltip(this.checkBoxNoUniformCoding, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_UNIFORMCODING_CHECKBOX", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.checkBoxNoUniformCoding.TabIndex = 79;
			this.checkBoxNoUniformCoding.UseVisualStyleBackColor = true;
			this.checkBoxPatching.AutoSize = true;
			this.checkBoxPatching.Location = new System.Drawing.Point(609, 56);
			this.checkBoxPatching.Name = "checkBoxPatching";
			this.checkBoxPatching.Size = new System.Drawing.Size(15, 14);
			this.ToolTip.SetSuperTooltip(this.checkBoxPatching, new DevComponents.DotNetBar.SuperTooltipInfo("", "", "TT_PROPERTIES_PATCHING", null, null, DevComponents.DotNetBar.eTooltipColor.Gray));
			this.checkBoxPatching.TabIndex = 78;
			this.checkBoxPatching.UseVisualStyleBackColor = true;
			this.label8.AutoSize = true;
			this.label8.BackColor = System.Drawing.Color.Transparent;
			this.label8.Location = new System.Drawing.Point(474, 109);
			this.label8.Name = "label8";
			this.label8.Size = new System.Drawing.Size(114, 13);
			this.label8.TabIndex = 77;
			this.label8.Text = "Disable uniform coding";
			this.label6.AutoSize = true;
			this.label6.BackColor = System.Drawing.Color.Transparent;
			this.label6.Location = new System.Drawing.Point(474, 57);
			this.label6.Name = "label6";
			this.label6.Size = new System.Drawing.Size(109, 13);
			this.label6.TabIndex = 76;
			this.label6.Text = "Fast incremental build";
			this.comboBoxBlockSize.FormattingEnabled = true;
			this.comboBoxBlockSize.Location = new System.Drawing.Point(158, 217);
			this.comboBoxBlockSize.Name = "comboBoxBlockSize";
			this.comboBoxBlockSize.Size = new System.Drawing.Size(255, 21);
			this.comboBoxBlockSize.TabIndex = 67;
			this.comboBoxBlockSize.Visible = false;
			this.label9.AutoSize = true;
			this.label9.BackColor = System.Drawing.Color.Transparent;
			this.label9.Location = new System.Drawing.Point(49, 83);
			this.label9.Name = "label9";
			this.label9.Size = new System.Drawing.Size(65, 13);
			this.label9.TabIndex = 75;
			this.label9.Text = "Target Disk:";
			this.comboBoxTargetDisk.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxTargetDisk.FormattingEnabled = true;
			this.comboBoxTargetDisk.Location = new System.Drawing.Point(158, 80);
			this.comboBoxTargetDisk.Name = "comboBoxTargetDisk";
			this.comboBoxTargetDisk.Size = new System.Drawing.Size(255, 21);
			this.comboBoxTargetDisk.TabIndex = 74;
			this.label5.AutoSize = true;
			this.label5.Location = new System.Drawing.Point(440, 199);
			this.label5.Name = "label5";
			this.label5.Size = new System.Drawing.Size(213, 13);
			this.label5.TabIndex = 73;
			this.label5.Text = "The controls below are organized at runtime";
			this.label5.Visible = false;
			this.textBoxFixedTileHeight.Location = new System.Drawing.Point(459, 240);
			this.textBoxFixedTileHeight.Name = "textBoxFixedTileHeight";
			this.textBoxFixedTileHeight.ReadOnly = true;
			this.textBoxFixedTileHeight.Size = new System.Drawing.Size(145, 20);
			this.textBoxFixedTileHeight.TabIndex = 72;
			this.textBoxFixedTileHeight.Visible = false;
			this.textBoxFixedTileWidth.Location = new System.Drawing.Point(459, 219);
			this.textBoxFixedTileWidth.Name = "textBoxFixedTileWidth";
			this.textBoxFixedTileWidth.ReadOnly = true;
			this.textBoxFixedTileWidth.Size = new System.Drawing.Size(145, 20);
			this.textBoxFixedTileWidth.TabIndex = 71;
			this.textBoxFixedTileWidth.Visible = false;
			this.labelX1.BackColor = System.Drawing.Color.Transparent;
			this.labelX1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelX1.Image = GrBuildStudio.Properties.Resources.warning;
			this.labelX1.Location = new System.Drawing.Point(41, 12);
			this.labelX1.Name = "labelX1";
			this.labelX1.Size = new System.Drawing.Size(497, 23);
			this.labelX1.TabIndex = 69;
			this.labelX1.Text = "Warning: Advanced properties, please read the documentation before making any changes here.";
			this.label14.AutoSize = true;
			this.label14.BackColor = System.Drawing.Color.Transparent;
			this.label14.Location = new System.Drawing.Point(49, 220);
			this.label14.Name = "label14";
			this.label14.Size = new System.Drawing.Size(57, 13);
			this.label14.TabIndex = 68;
			this.label14.Text = "Block Size";
			this.label14.Visible = false;
			this.label13.AutoSize = true;
			this.label13.BackColor = System.Drawing.Color.Transparent;
			this.label13.Location = new System.Drawing.Point(49, 164);
			this.label13.Name = "label13";
			this.label13.Size = new System.Drawing.Size(58, 13);
			this.label13.TabIndex = 66;
			this.label13.Text = "Tile Height";
			this.comboBoxTileHeight.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxTileHeight.FormattingEnabled = true;
			this.comboBoxTileHeight.Location = new System.Drawing.Point(158, 161);
			this.comboBoxTileHeight.Name = "comboBoxTileHeight";
			this.comboBoxTileHeight.Size = new System.Drawing.Size(255, 21);
			this.comboBoxTileHeight.TabIndex = 65;
			this.label12.AutoSize = true;
			this.label12.BackColor = System.Drawing.Color.Transparent;
			this.label12.Location = new System.Drawing.Point(49, 137);
			this.label12.Name = "label12";
			this.label12.Size = new System.Drawing.Size(55, 13);
			this.label12.TabIndex = 64;
			this.label12.Text = "Tile Width";
			this.comboBoxTileWidth.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxTileWidth.FormattingEnabled = true;
			this.comboBoxTileWidth.Location = new System.Drawing.Point(158, 134);
			this.comboBoxTileWidth.Name = "comboBoxTileWidth";
			this.comboBoxTileWidth.Size = new System.Drawing.Size(255, 21);
			this.comboBoxTileWidth.TabIndex = 63;
			this.label11.AutoSize = true;
			this.label11.BackColor = System.Drawing.Color.Transparent;
			this.label11.Location = new System.Drawing.Point(49, 110);
			this.label11.Name = "label11";
			this.label11.Size = new System.Drawing.Size(55, 13);
			this.label11.TabIndex = 62;
			this.label11.Text = "Page Size";
			this.comboBoxPageSize.FormattingEnabled = true;
			this.comboBoxPageSize.Location = new System.Drawing.Point(158, 107);
			this.comboBoxPageSize.Name = "comboBoxPageSize";
			this.comboBoxPageSize.Size = new System.Drawing.Size(255, 21);
			this.comboBoxPageSize.TabIndex = 61;
			this.label10.AutoSize = true;
			this.label10.BackColor = System.Drawing.Color.Transparent;
			this.label10.Location = new System.Drawing.Point(49, 56);
			this.label10.Name = "label10";
			this.label10.Size = new System.Drawing.Size(106, 13);
			this.label10.TabIndex = 60;
			this.label10.Text = "Maximum Anisotropy:";
			this.comboBoxMaxAniso.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxMaxAniso.Location = new System.Drawing.Point(158, 53);
			this.comboBoxMaxAniso.Name = "comboBoxMaxAniso";
			this.comboBoxMaxAniso.Size = new System.Drawing.Size(255, 21);
			this.comboBoxMaxAniso.TabIndex = 59;
			this.superTabItem3.AttachedControl = this.superTabControlPanel3;
			this.superTabItem3.GlobalItem = false;
			this.superTabItem3.Name = "superTabItem3";
			this.superTabItem3.Text = "Advanced";
			this.superTabControlPanel4.Controls.Add(this.customLayerLayoutControl1);
			this.superTabControlPanel4.Dock = System.Windows.Forms.DockStyle.Fill;
			this.superTabControlPanel4.Location = new System.Drawing.Point(0, 25);
			this.superTabControlPanel4.Name = "superTabControlPanel4";
			this.superTabControlPanel4.Size = new System.Drawing.Size(736, 254);
			this.superTabControlPanel4.TabIndex = 0;
			this.superTabControlPanel4.TabItem = this.superTabItem4;
			this.superTabItem4.AttachedControl = this.superTabControlPanel4;
			this.superTabItem4.GlobalItem = false;
			this.superTabItem4.Name = "superTabItem4";
			this.superTabItem4.Text = "Layer Configuration";
			this.superTabControlPanel1.Controls.Add(this.labelBuildProfileDescription);
			this.superTabControlPanel1.Controls.Add(this.label4);
			this.superTabControlPanel1.Controls.Add(this.comboBoxProfiles);
			this.superTabControlPanel1.Controls.Add(this.label7);
			this.superTabControlPanel1.Controls.Add(this.textBoxProjectName);
			this.superTabControlPanel1.Dock = System.Windows.Forms.DockStyle.Fill;
			this.superTabControlPanel1.Location = new System.Drawing.Point(0, 25);
			this.superTabControlPanel1.Name = "superTabControlPanel1";
			this.superTabControlPanel1.Size = new System.Drawing.Size(736, 254);
			this.superTabControlPanel1.TabIndex = 1;
			this.superTabControlPanel1.TabItem = this.superTabItem1;
			this.labelBuildProfileDescription.BackColor = System.Drawing.Color.Transparent;
			this.labelBuildProfileDescription.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.labelBuildProfileDescription.Location = new System.Drawing.Point(148, 94);
			this.labelBuildProfileDescription.Name = "labelBuildProfileDescription";
			this.labelBuildProfileDescription.Size = new System.Drawing.Size(268, 124);
			this.labelBuildProfileDescription.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
			this.labelBuildProfileDescription.TabIndex = 44;
			this.labelBuildProfileDescription.Text = "DirectX 9 Build Profile is Active\r\n\r\nProfile allows the use of \r\n- BC1\r\n- BC3\r\n- Quarz";
			this.labelBuildProfileDescription.TextLineAlignment = System.Drawing.StringAlignment.Near;
			this.labelBuildProfileDescription.WordWrap = true;
			this.label4.AutoSize = true;
			this.label4.BackColor = System.Drawing.Color.Transparent;
			this.label4.Location = new System.Drawing.Point(34, 63);
			this.label4.Name = "label4";
			this.label4.Size = new System.Drawing.Size(62, 13);
			this.label4.TabIndex = 43;
			this.label4.Text = "Build Profile";
			this.label7.AutoSize = true;
			this.label7.BackColor = System.Drawing.Color.Transparent;
			this.label7.Location = new System.Drawing.Point(34, 35);
			this.label7.Name = "label7";
			this.label7.Size = new System.Drawing.Size(71, 13);
			this.label7.TabIndex = 39;
			this.label7.Text = "Project Name";
			this.textBoxProjectName.Location = new System.Drawing.Point(148, 32);
			this.textBoxProjectName.Name = "textBoxProjectName";
			this.textBoxProjectName.ReadOnly = true;
			this.textBoxProjectName.Size = new System.Drawing.Size(268, 20);
			this.textBoxProjectName.TabIndex = 38;
			this.superTabItem1.AttachedControl = this.superTabControlPanel1;
			this.superTabItem1.GlobalItem = false;
			this.superTabItem1.Name = "superTabItem1";
			this.superTabItem1.Text = "Project";
			this.pathBoxControlSoupOutput.LoadSave = GrBuildStudio.Controls.PathBoxControl.PathBoxLoadSave.Save;
			this.pathBoxControlSoupOutput.Location = new System.Drawing.Point(148, 59);
			this.pathBoxControlSoupOutput.Margin = new System.Windows.Forms.Padding(0);
			this.pathBoxControlSoupOutput.Name = "pathBoxControlSoupOutput";
			this.pathBoxControlSoupOutput.Path = null;
			this.pathBoxControlSoupOutput.PathType = GrBuildStudio.Controls.PathBoxControl.PathBoxPathType.Folder;
			this.pathBoxControlSoupOutput.Size = new System.Drawing.Size(273, 20);
			this.pathBoxControlSoupOutput.TabIndex = 52;
			this.pathBoxControlOutput.LoadSave = GrBuildStudio.Controls.PathBoxControl.PathBoxLoadSave.Save;
			this.pathBoxControlOutput.Location = new System.Drawing.Point(148, 32);
			this.pathBoxControlOutput.Margin = new System.Windows.Forms.Padding(0);
			this.pathBoxControlOutput.Name = "pathBoxControlOutput";
			this.pathBoxControlOutput.Path = null;
			this.pathBoxControlOutput.PathType = GrBuildStudio.Controls.PathBoxControl.PathBoxPathType.File;
			this.pathBoxControlOutput.Size = new System.Drawing.Size(273, 20);
			this.pathBoxControlOutput.TabIndex = 47;
			this.customLayerLayoutControl1.ActiveBuildProfile = null;
			this.customLayerLayoutControl1.BackColor = System.Drawing.Color.Transparent;
			this.customLayerLayoutControl1.Dock = System.Windows.Forms.DockStyle.Fill;
			this.customLayerLayoutControl1.Location = new System.Drawing.Point(0, 0);
			this.customLayerLayoutControl1.Name = "customLayerLayoutControl1";
			this.customLayerLayoutControl1.Padding = new System.Windows.Forms.Padding(10);
			this.customLayerLayoutControl1.Size = new System.Drawing.Size(736, 254);
			this.customLayerLayoutControl1.TabIndex = 0;
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("", "", "Enter your resource Tag here", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			base.AcceptButton = this.buttonAccept;
			base.CancelButton = this.buttonCancel;
			base.ClientSize = new System.Drawing.Size(760, 343);
			base.Controls.Add(this.superTabControl1);
			base.Controls.Add(this.buttonCancel);
			base.Controls.Add(this.buttonAccept);
			this.DoubleBuffered = true;
			base.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
			base.MaximizeBox = false;
			base.MinimizeBox = false;
			base.Name = "ProjectPropertiesForm";
			base.ShowInTaskbar = false;
			base.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
			this.Text = "ProjectProperties";
			base.Load += new System.EventHandler(ProjectPropertiesForm_Load);
			((System.ComponentModel.ISupportInitialize)this.superTabControl1).EndInit();
			this.superTabControl1.ResumeLayout(false);
			this.superTabControlPanel2.ResumeLayout(false);
			this.superTabControlPanel2.PerformLayout();
			this.superTabControlPanel3.ResumeLayout(false);
			this.superTabControlPanel3.PerformLayout();
			this.superTabControlPanel4.ResumeLayout(false);
			this.superTabControlPanel1.ResumeLayout(false);
			this.superTabControlPanel1.PerformLayout();
			base.ResumeLayout(false);
		}
	}
	public class ProjectProperties
	{
		public string ProjectName { get; set; }

		public string BuildProfile { get; set; }

		public string OutputFilename { get; set; }

		public string SoupOutputFolder { get; set; }

		public string PagesFolder { get; set; }

		public uint MaxAnisotropy { get; set; }

		public uint TileHeight { get; set; }

		public uint TileWidth { get; set; }

		public uint PageSize { get; set; }

		public bool NoUniformCoding { get; set; }

		public bool Patching { get; set; }

		public bool HighQualityCoding { get; set; }

		public bool NoRedirection { get; set; }

		public bool NoSharedMipGeneration { get; set; }

		public bool MipStripping { get; set; }

		public bool CodingProfileChanged { get; set; }

		public bool[] CodingProfileLayerChanged { get; set; }

		public TilingMode TilingMode { get; set; }

		public TargetDisk TargetDisk { get; set; }

		public PagingStrategy PagingStrategy { get; set; }

		public LayerConfig LayerConfiguration { get; set; }

		public bool DataTypesChanged { get; set; }

		public bool[] DataTypeLayerChanged { get; set; }

		public ProjectProperties()
		{
			ProjectName = string.Empty;
			BuildProfile = string.Empty;
			OutputFilename = string.Empty;
			SoupOutputFolder = string.Empty;
			PagesFolder = string.Empty;
			LayerConfiguration = null;
		}
	}
	public class ProjectTree : UserControl
	{
		public enum AssetNodeType
		{
			AssetGroup,
			Asset,
			Layer,
			Texture
		}

		public class NodeContext
		{
			public AssetNodeType Type { get; set; }

			public Asset Asset { get; set; }

			public int Layer { get; set; }

			public Texture Texture { get; set; }

			public NodeContext(AssetNodeType type, Asset asset, int layer, Texture texture)
			{
				Type = type;
				Asset = asset;
				Layer = layer;
				Texture = texture;
			}
		}

		public delegate void TreeSelectedEventHandler(object sender);

		public delegate void AssetNodeDoubleClickedEventHandler(object sender, NodeContext context);

		public delegate void AssetNodeClickedEventHandler(object sender, NodeContext context);

		public delegate void AssetNodeRightClickedEventHandler(object sender, List<NodeContext> contexts, Point location);

		public delegate void AssetNodeDeletePressed(object sender, List<NodeContext> contexts);

		public class RenameAsset
		{
			public Guid assetId = Guid.Empty;

			public string newName;
		}

		public delegate bool AssetNodeRenamePressed(object sender, RenameAsset renameAsset);

		public delegate void AssetMoveRequestHandler(object sender, Guid srcProjectId, List<Asset> assets, Guid destProjectId, bool keepCopy);

		public delegate void SelectionChangedHandler(object sender);

		private bool allowDragDrop;

		private bool isDeleting;

		private IContainer components;

		private AdvTree advTree1;

		private DevComponents.AdvTree.ColumnHeader columnHeader3;

		private DevComponents.AdvTree.ColumnHeader columnHeader4;

		private Node node1;

		private Node node2;

		private Node node5;

		private Node node6;

		private Node node9;

		private Node node10;

		private Node node35;

		private Cell cell4;

		private Node node36;

		private Node node37;

		private Node node38;

		private Node node39;

		private Node node41;

		private Node node42;

		private NodeConnector nodeConnector4;

		private ElementStyle elementStyle2;

		private ImageList imageList1;

		private ToolTip ToolTip;

		private Node node3;

		private Node node4;

		public ProjectBuilder ProjectBuilder { get; set; }

		public List<NodeContext> SelectedAssets
		{
			get
			{
				List<NodeContext> list = new List<NodeContext>();
				foreach (Node selectedNode in advTree1.SelectedNodes)
				{
					NodeContext item = (NodeContext)selectedNode.Tag;
					list.Add(item);
				}
				return list;
			}
		}

		public bool HasSelectedAssets => advTree1.SelectedNodes.Count > 0;

		public NodeContext SelectedAsset { get; private set; }

		public bool AllowDragDrop
		{
			get
			{
				return allowDragDrop;
			}
			set
			{
				allowDragDrop = value;
				advTree1.AllowExternalDrop = true;
				advTree1.AllowDrop = true;
				advTree1.DragDropEnabled = true;
				advTree1.DragDropNodeCopyEnabled = true;
			}
		}

		private Project Project { get; set; }

		public event TreeSelectedEventHandler TreeSelected;

		public event AssetNodeDoubleClickedEventHandler AssetNodeDoubleClicked;

		public event AssetNodeClickedEventHandler AssetNodeClicked;

		public event AssetNodeRightClickedEventHandler AssetNodeRightClicked;

		public event AssetNodeDeletePressed AssetNodeDelete;

		public event AssetNodeRenamePressed AssetNodeRenamed;

		public event AssetMoveRequestHandler AssetMoveRequest;

		public event SelectionChangedHandler SelectionChanged;

		protected virtual void OnTreeSelected()
		{
			this.TreeSelected?.Invoke(this);
		}

		protected virtual void OnAssetNodeDoubleClicked(NodeContext context)
		{
			this.AssetNodeDoubleClicked?.Invoke(this, context);
		}

		protected virtual void OnAssetNodeClicked(NodeContext context)
		{
			this.AssetNodeClicked?.Invoke(this, context);
		}

		protected virtual void OnAssetNodeRightClicked(List<NodeContext> contexts, Point location)
		{
			AssetNodeRightClickedEventHandler assetNodeRightClicked = this.AssetNodeRightClicked;
			if (assetNodeRightClicked != null && contexts.Count > 0 && (contexts[0].Type == AssetNodeType.Asset || contexts[0].Type == AssetNodeType.AssetGroup))
			{
				assetNodeRightClicked(this, contexts, location);
			}
		}

		protected virtual void OnAssetDelete(List<NodeContext> contexts)
		{
			AssetNodeDeletePressed assetNodeDelete = this.AssetNodeDelete;
			if (assetNodeDelete != null && contexts.Count > 0 && (contexts[0].Type == AssetNodeType.Asset || contexts[0].Type == AssetNodeType.AssetGroup))
			{
				assetNodeDelete(this, contexts);
			}
		}

		protected virtual bool OnAssetRenamed(RenameAsset renameAsset)
		{
			return this.AssetNodeRenamed?.Invoke(this, renameAsset) ?? false;
		}

		private void OnAssetMoveRequest(object sender, Guid srcProjectId, List<Asset> assets, Guid destProjectId, bool keepCopy)
		{
			if (this.AssetMoveRequest != null)
			{
				this.AssetMoveRequest(this, srcProjectId, assets, destProjectId, keepCopy);
			}
		}

		private void OnSelectionChanged(object sender)
		{
			if (this.SelectionChanged != null)
			{
				this.SelectionChanged(this);
			}
		}

		public ProjectTree()
		{
			InitializeComponent();
			advTree1.NodeClick += advTree1_MouseClick;
			advTree1.SelectionChanged += advTree1_SelectionChanged;
			advTree1.AfterCellEditComplete += AdvTree1_AfterCellEdit;
			advTree1.MouseWheel += advTree1_MouseWheel;
			advTree1.NodeDragFeedback += advTree1_NodeDragFeedback;
			advTree1.BeforeNodeDrop += advTree1_BeforeNodeDrop;
		}

		private void advTree1_MouseWheel(object sender, MouseEventArgs e)
		{
			if (e is HandledMouseEventArgs handledMouseEventArgs)
			{
				bool flag2 = (handledMouseEventArgs.Handled = advTree1.VScrollBar != null);
			}
		}

		private void advTree1_MouseClick(object sender, TreeNodeMouseEventArgs e)
		{
			if (advTree1.SelectedNode == null)
			{
				SelectedAsset = null;
				return;
			}
			NodeContext nodeContext2 = (SelectedAsset = (NodeContext)advTree1.SelectedNode.Tag);
			if (e.Button == MouseButtons.Right)
			{
				OnAssetNodeRightClicked(SelectedAssets, PointToScreen(new Point(e.X, e.Y)));
			}
		}

		private void AdvTree1_AfterCellEdit(object sender, CellEditEventArgs e)
		{
			if (advTree1.SelectedNode == null)
			{
				SelectedAsset = null;
				return;
			}
			Node selectedNode = advTree1.SelectedNode;
			NodeContext nodeContext = (NodeContext)selectedNode.Tag;
			bool flag = false;
			if ((nodeContext.Asset.AssetGroupId == null) ? (!Various.NameEquals(selectedNode.Text, nodeContext.Asset.Name)) : (!Various.NameEquals(nodeContext.Asset.AssetGroupId, selectedNode.Text) && !Various.NameEquals(nodeContext.Asset.Name, selectedNode.Text)))
			{
				string name = nodeContext.Asset.Name;
				RenameAsset renameAsset = new RenameAsset();
				renameAsset.assetId = nodeContext.Asset.Id;
				renameAsset.newName = selectedNode.Text;
				if (!OnAssetRenamed(renameAsset))
				{
					selectedNode.Text = name;
				}
			}
		}

		private void advTree1_SelectionChanged(object sender, EventArgs e)
		{
			if (advTree1.SelectedNode == null || advTree1.SelectedNodes.Count != 1)
			{
				SelectedAsset = null;
				OnAssetNodeClicked(null);
				OnSelectionChanged(this);
			}
			else
			{
				NodeContext context = (SelectedAsset = (NodeContext)advTree1.SelectedNode.Tag);
				OnAssetNodeClicked(context);
				OnSelectionChanged(this);
			}
		}

		private void advTree1_Click(object sender, EventArgs e)
		{
			OnTreeSelected();
		}

		private string GetAssetStateInfo(Asset asset)
		{
			return State.GetAssetStateInfo(ProjectBuilder.BuildStateSummary.AssetStates[asset.Id]);
		}

		public void DeleteTree()
		{
			SelectedAsset = null;
			advTree1.ClearAndDisposeAllNodes();
			advTree1.Dispose();
			ProjectBuilder = null;
		}

		private Node CreateAssetNode(Asset asset)
		{
			Project activeProject = ProjectBuilder.ActiveProject;
			AssetState assetState = ProjectBuilder.BuildStateSummary.AssetStates[asset.Id];
			string assetState2 = State.GetAssetState(assetState, out var icon);
			Node node = new Node();
			node.Text = asset.Name;
			node.Cells.Add(new Cell(assetState2));
			node.Editable = true;
			node.Tag = new NodeContext(AssetNodeType.Asset, asset, 0, null);
			node.DataKey = asset.Id;
			node.Image = icon;
			ToolTip.SetSuperTooltip(node, new SuperTooltipInfo("", "", GetAssetStateInfo(asset), null, null, ToolTip.DefaultTooltipSettings.Color));
			for (int i = 0; i < asset.AssetLayers.Count; i++)
			{
				_ = asset.AssetLayers[i];
				LayerAssetState layerState = assetState?.LayerStates[i];
				Node node2 = new Node();
				string text = (node2.Text = activeProject.LayerConfiguration.Layers[i].LayerName);
				_ = activeProject.LayerConfiguration.Layers[i].DataType;
				assetState2 = State.GetLayerState(assetState, layerState, out icon);
				node2.Cells.Add(new Cell(assetState2));
				node2.Image = icon;
				node2.Editable = false;
				node2.Tag = new NodeContext(AssetNodeType.Layer, asset, i, null);
				node2.NodeDoubleClick += layerNode_NodeDoubleClick;
				node2.NodeClick += layerNode_NodeClick;
				node.Nodes.Add(node2);
				UpdateTextures(asset, i, node2, icon, assetState);
			}
			node.NodeDoubleClick += assetnode_NodeDoubleClick;
			node.NodeClick += assetnode_NodeClick;
			return node;
		}

		private Node CreateAssetGroupNode(Asset childAsset)
		{
			_ = ProjectBuilder.ActiveProject;
			Bitmap icon;
			string assetState = State.GetAssetState(ProjectBuilder.BuildStateSummary.AssetStates[childAsset.Id], out icon);
			Node node = new Node();
			node.Text = childAsset.AssetGroupId;
			node.Cells.Add(new Cell(assetState));
			node.Tag = new NodeContext(AssetNodeType.AssetGroup, childAsset, 0, null);
			node.Image = icon;
			ToolTip.SetSuperTooltip(node, new SuperTooltipInfo("", "", GetAssetStateInfo(childAsset), null, null, ToolTip.DefaultTooltipSettings.Color));
			node.Style = elementStyle2;
			node.NodeDoubleClick += assetgroupnode_NodeDoubleClick;
			node.NodeClick += assetgroupnode_NodeClick;
			return node;
		}

		private Node FindAssetGroupNode(string assetGroupId)
		{
			foreach (Node node in advTree1.Nodes)
			{
				if (node.Tag != null)
				{
					NodeContext nodeContext = (NodeContext)node.Tag;
					if (nodeContext.Type == AssetNodeType.AssetGroup && nodeContext.Asset.AssetGroupId.Equals(assetGroupId))
					{
						return node;
					}
				}
			}
			return null;
		}

		private Node AddAssetNode(Asset asset)
		{
			Node node = CreateAssetNode(asset);
			if (asset.AssetGroupId != null && asset.AssetGroupId.Length != 0)
			{
				Node node2 = FindAssetGroupNode(asset.AssetGroupId);
				if (node2 == null)
				{
					node2 = CreateAssetGroupNode(asset);
					advTree1.Nodes.Add(node2);
				}
				node2.Nodes.Add(node);
				node2.Nodes.Sort();
			}
			else
			{
				advTree1.Nodes.Add(node);
			}
			return node;
		}

		public void PopulateTree()
		{
			SlowTaskMonitor slowTaskMonitor = new SlowTaskMonitor("Scanning for changes...");
			slowTaskMonitor.Start();
			slowTaskMonitor.UpdateText("Scanning Stacked Textures...");
			advTree1.Nodes.Clear();
			Project project = (Project = ProjectBuilder.ActiveProject);
			_ = ProjectBuilder.BuildStateSummary;
			int count = project.Assets.Values.Count;
			int num = 0;
			foreach (Asset value in project.Assets.Values)
			{
				AddAssetNode(value);
				num++;
				slowTaskMonitor.UpdateProgress(0L, count, num);
			}
			advTree1.Columns[0].Sort(reverse: false);
			slowTaskMonitor.End();
		}

		public void UpdateAssetInTree(Asset asset)
		{
			if (asset == null)
			{
				PopulateTree();
				return;
			}
			Project activeProject = ProjectBuilder.ActiveProject;
			int count = ProjectBuilder.ActiveProject.Assets.Count;
			Node node = advTree1.FindNodeByDataKey(asset.Id);
			if (node == null)
			{
				node = AddAssetNode(asset);
				if (advTree1.SelectedNodes.Count > 1)
				{
					advTree1.SelectedNodes.Clear();
				}
				advTree1.SelectedNode = node;
				advTree1.Columns[0].Sort(reverse: false);
				return;
			}
			node.Text = asset.Name;
			Bitmap icon = null;
			AssetState assetState = ProjectBuilder.BuildStateSummary.AssetStates[asset.Id];
			string assetState2 = State.GetAssetState(assetState, out icon);
			node.Image = icon;
			ToolTip.GetSuperTooltip(node).BodyText = GetAssetStateInfo(asset);
			if (node.Cells.Count > 1)
			{
				node.Cells[1].Text = assetState2;
			}
			int num = 0;
			foreach (Node node4 in node.Nodes)
			{
				if (num >= asset.AssetLayers.Count)
				{
					if (node4.Cells.Count > 1)
					{
						node4.Cells[1].Text = "Deleted";
					}
					node4.Image = null;
					break;
				}
				AssetLayer assetLayer = asset.AssetLayers[num];
				LayerAssetState layerAssetState = assetState?.LayerStates[num];
				_ = activeProject.LayerConfiguration.Layers[num].LayerName;
				_ = activeProject.LayerConfiguration.Layers[num].DataType;
				assetState2 = State.GetLayerState(assetState, layerAssetState, out icon);
				if (node4.Cells.Count > 1)
				{
					node4.Cells[1].Text = assetState2;
				}
				node4.Image = icon;
				int num2 = 0;
				foreach (Node node5 in node4.Nodes)
				{
					if (num2 >= assetLayer.Textures.Count)
					{
						int num3 = num2;
						while (num3 < node4.Nodes.Count)
						{
							node4.Nodes.RemoveAt(num3);
						}
						break;
					}
					if (assetLayer.Textures[num2].Source != node5.Text)
					{
						int num4 = num2;
						while (num4 < node4.Nodes.Count)
						{
							node4.Nodes.RemoveAt(num4);
						}
						break;
					}
					TextureAssetState textureState = layerAssetState?.TextureStates[num2];
					assetState2 = State.GetTextureState(assetState, textureState, out icon);
					if (node5.Cells.Count > 1)
					{
						node5.Cells[1].Text = assetState2;
					}
					node5.Image = icon;
					num2++;
				}
				UpdateTextures(asset, num, node4, icon, assetState);
				num++;
			}
			if (advTree1.Nodes.Count <= count)
			{
				return;
			}
			for (int i = 0; i < advTree1.Nodes.Count; i++)
			{
				bool flag = false;
				foreach (Asset value in activeProject.Assets.Values)
				{
					if (advTree1.Nodes[i].Text == value.Name)
					{
						flag = true;
					}
				}
				if (!flag)
				{
					advTree1.Nodes.RemoveAt(i);
					i--;
				}
			}
		}

		public void UpdateAllAssets()
		{
			Project activeProject = ProjectBuilder.ActiveProject;
			_ = ProjectBuilder.BuildStateSummary;
			foreach (Asset value in activeProject.Assets.Values)
			{
				UpdateAssetInTree(value);
			}
		}

		private void layerTextureNode_NodeClick(object sender, EventArgs e)
		{
			NodeContext context = (NodeContext)((Node)sender).Tag;
			OnAssetNodeClicked(context);
		}

		private void layerTextureNode_NodeDoubleClick(object sender, EventArgs e)
		{
			NodeContext context = (NodeContext)((Node)sender).Tag;
			OnAssetNodeDoubleClicked(context);
		}

		private void layerNode_NodeClick(object sender, EventArgs e)
		{
			NodeContext context = (NodeContext)((Node)sender).Tag;
			OnAssetNodeDoubleClicked(context);
		}

		private void layerNode_NodeDoubleClick(object sender, EventArgs e)
		{
			NodeContext context = (NodeContext)((Node)sender).Tag;
			OnAssetNodeDoubleClicked(context);
		}

		private void assetnode_NodeDoubleClick(object sender, EventArgs e)
		{
			NodeContext context = (NodeContext)((Node)sender).Tag;
			OnAssetNodeDoubleClicked(context);
		}

		private void assetnode_NodeClick(object sender, EventArgs e)
		{
			NodeContext context = (NodeContext)((Node)sender).Tag;
			OnAssetNodeClicked(context);
		}

		private void assetgroupnode_NodeDoubleClick(object sender, EventArgs e)
		{
			NodeContext context = (NodeContext)((Node)sender).Tag;
			OnAssetNodeDoubleClicked(context);
		}

		private void assetgroupnode_NodeClick(object sender, EventArgs e)
		{
			NodeContext context = (NodeContext)((Node)sender).Tag;
			OnAssetNodeClicked(context);
		}

		private void advTree1_KeyUp(object sender, KeyEventArgs e)
		{
			if (e.KeyData == Keys.Delete)
			{
				isDeleting = false;
			}
		}

		private void advTree1_KeyDown(object sender, KeyEventArgs e)
		{
			if (e.KeyData == Keys.Delete && !isDeleting)
			{
				OnAssetDelete(SelectedAssets);
			}
			if (e.KeyData == Keys.F2)
			{
				StartRename();
			}
		}

		private void UpdateTextures(Asset asset, int layerIdx, Node layerNode, Bitmap icon, AssetState assetState)
		{
			LayerAssetState layerAssetState = assetState.LayerStates[layerIdx];
			DataType dataType = ProjectBuilder.ActiveProject.LayerConfiguration.Layers[layerIdx].DataType;
			int numChannels = DataTypeInfo.GetNumChannels(dataType);
			int num = 0;
			AssetLayer assetLayer = asset.AssetLayers[layerIdx];
			bool flag = ChannelMerging.IsCombinedMode(assetLayer.PackingMode);
			int subIdx;
			for (subIdx = 0; subIdx < 4; subIdx++)
			{
				int channelCount = ChannelMerging.GetChannelCount(assetLayer.PackingMode, dataType, layerIdx, subIdx);
				List<Texture> list = assetLayer.Textures.Where((Texture _tex) => _tex.SubIndex == subIdx).ToList();
				if (list.Count == 0)
				{
					if (flag && num < numChannels)
					{
						string text = "(";
						text += ChannelMerging.GetChannelMaskHumanReadable(dataType, assetLayer.PackingMode, subIdx);
						text += ")";
						NodeContext nodeContext = new NodeContext(AssetNodeType.Texture, asset, layerIdx, null);
						string text2 = "Default layer color " + text;
						string stateString = "Ok";
						CreateOrUpdateTextureNode(layerNode, new string[1] { text2 }, text2, stateString, icon, nodeContext, text);
					}
				}
				else
				{
					for (int i = 0; i < list.Count; i++)
					{
						Texture texture = list[i];
						TextureAssetState textureState = layerAssetState?.TextureStates[i];
						string text3 = "";
						if (flag)
						{
							text3 += " (";
							text3 += ChannelMerging.GetChannelMaskHumanReadable(dataType, assetLayer.PackingMode, texture.SubIndex);
							text3 += ")";
						}
						string textureState2 = State.GetTextureState(assetState, textureState, out icon);
						NodeContext nodeContext2 = new NodeContext(AssetNodeType.Texture, asset, layerIdx, texture);
						string text4 = texture.Source + text3;
						CreateOrUpdateTextureNode(layerNode, new string[1] { text4 }, text4, textureState2, icon, nodeContext2, text3);
					}
				}
				num += channelCount;
			}
		}

		private Node FindChildNode(Node parentNode, string text, string mask)
		{
			if (parentNode == null)
			{
				return null;
			}
			foreach (Node node in parentNode.Nodes)
			{
				if (node.Text.Equals(text))
				{
					return node;
				}
				if (!string.IsNullOrEmpty(mask))
				{
					if (node.Text + mask == text)
					{
						return node;
					}
					int num = node.Text.LastIndexOf(mask);
					if (num != -1 && node.Text.Substring(0, num) == text)
					{
						return node;
					}
				}
			}
			return null;
		}

		private void CreateOrUpdateTextureNode(Node layerNode, string[] oldPossibleNames, string name, string stateString, Image icon, NodeContext nodeContext, string mask)
		{
			Node node = null;
			foreach (string text in oldPossibleNames)
			{
				node = FindChildNode(layerNode, text, mask);
				if (node != null)
				{
					break;
				}
			}
			if (node == null)
			{
				Node node2 = new Node();
				node2.Text = name;
				node2.Cells.Add(new Cell(stateString));
				node2.Image = icon;
				node2.NodeDoubleClick += layerTextureNode_NodeDoubleClick;
				node2.NodeClick += layerTextureNode_NodeClick;
				node2.Tag = nodeContext;
				node2.Editable = false;
				layerNode.Nodes.Add(node2);
			}
			else
			{
				node.Text = name;
				node.Cells[1].Text = stateString;
				node.Image = icon;
				node.Tag = nodeContext;
				node.Editable = false;
			}
		}

		public void StartRename()
		{
			if (advTree1.SelectedNode != null && advTree1.SelectedNode.Editable)
			{
				advTree1.SelectedNode.BeginEdit();
			}
		}

		private bool MatchFilter(string text, string filter)
		{
			return text.IndexOf(filter, StringComparison.CurrentCultureIgnoreCase) != -1;
		}

		public bool Filter(NodeCollection nodes, string searchString)
		{
			bool flag = false;
			foreach (Node node in nodes)
			{
				if (node.Tag != null)
				{
					NodeContext obj = (NodeContext)node.Tag;
					if (obj.Type == AssetNodeType.Asset)
					{
						bool flag3 = (node.Visible = MatchFilter(node.Text, searchString));
						flag = flag || flag3;
					}
					if (obj.Type == AssetNodeType.AssetGroup)
					{
						bool flag5 = (node.Visible = Filter(node.Nodes, searchString));
						flag = flag || flag5;
					}
				}
			}
			return flag;
		}

		public void Filter(string searchString)
		{
			Filter(advTree1.Nodes, searchString);
		}

		public void ClearFilter(NodeCollection nodes)
		{
			foreach (Node node in nodes)
			{
				node.Visible = true;
				ClearFilter(node.Nodes);
			}
		}

		public void ClearFilter()
		{
			ClearFilter(advTree1.Nodes);
		}

		private void advTree1_BeforeNodeDrop(object sender, TreeDragDropEventArgs e)
		{
			ProjectTree projectTree = (ProjectTree)e.Node.TreeControl.Parent;
			List<Asset> list = new List<Asset>();
			Node[] nodes = e.Nodes;
			for (int i = 0; i < nodes.Length; i++)
			{
				NodeContext nodeContext = (NodeContext)nodes[i].Tag;
				list.Add(nodeContext.Asset);
			}
			OnAssetMoveRequest(this, projectTree.Project.Id, list, Project.Id, e.IsCopy);
			e.Cancel = true;
		}

		private void advTree1_NodeDragFeedback(object sender, TreeDragFeedbackEventArgs e)
		{
			e.AllowDrop = false;
			if (e.DragNode.TreeControl != advTree1)
			{
				NodeContext nodeContext = (NodeContext)e.DragNode.Tag;
				if (nodeContext.Type == AssetNodeType.Asset || nodeContext.Type == AssetNodeType.AssetGroup)
				{
					e.AllowDrop = true;
				}
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.components = new System.ComponentModel.Container();
			this.advTree1 = new DevComponents.AdvTree.AdvTree();
			this.columnHeader3 = new DevComponents.AdvTree.ColumnHeader();
			this.columnHeader4 = new DevComponents.AdvTree.ColumnHeader();
			this.node1 = new DevComponents.AdvTree.Node();
			this.node2 = new DevComponents.AdvTree.Node();
			this.node5 = new DevComponents.AdvTree.Node();
			this.node6 = new DevComponents.AdvTree.Node();
			this.node9 = new DevComponents.AdvTree.Node();
			this.node10 = new DevComponents.AdvTree.Node();
			this.node35 = new DevComponents.AdvTree.Node();
			this.cell4 = new DevComponents.AdvTree.Cell();
			this.node36 = new DevComponents.AdvTree.Node();
			this.node37 = new DevComponents.AdvTree.Node();
			this.node38 = new DevComponents.AdvTree.Node();
			this.node39 = new DevComponents.AdvTree.Node();
			this.node41 = new DevComponents.AdvTree.Node();
			this.node3 = new DevComponents.AdvTree.Node();
			this.node4 = new DevComponents.AdvTree.Node();
			this.node42 = new DevComponents.AdvTree.Node();
			this.nodeConnector4 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle2 = new DevComponents.DotNetBar.ElementStyle();
			this.imageList1 = new System.Windows.Forms.ImageList(this.components);
			this.ToolTip = new GrBuildStudio.ToolTip();
			((System.ComponentModel.ISupportInitialize)this.advTree1).BeginInit();
			base.SuspendLayout();
			this.advTree1.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.advTree1.AllowDrop = true;
			this.advTree1.AllowExternalDrop = false;
			this.advTree1.BackColor = System.Drawing.SystemColors.Window;
			this.advTree1.BackgroundStyle.Class = "TreeBorderKey";
			this.advTree1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.advTree1.Columns.Add(this.columnHeader3);
			this.advTree1.Columns.Add(this.columnHeader4);
			this.advTree1.Dock = System.Windows.Forms.DockStyle.Fill;
			this.advTree1.DragDropEnabled = false;
			this.advTree1.DragDropNodeCopyEnabled = false;
			this.advTree1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.advTree1.Location = new System.Drawing.Point(0, 0);
			this.advTree1.MultiSelect = true;
			this.advTree1.Name = "advTree1";
			this.advTree1.Nodes.AddRange(new DevComponents.AdvTree.Node[4] { this.node1, this.node6, this.node37, this.node39 });
			this.advTree1.NodesConnector = this.nodeConnector4;
			this.advTree1.NodeStyle = this.elementStyle2;
			this.advTree1.PathSeparator = ";";
			this.advTree1.Size = new System.Drawing.Size(546, 194);
			this.advTree1.Styles.Add(this.elementStyle2);
			this.advTree1.TabIndex = 11;
			this.advTree1.Text = "advTree1";
			this.advTree1.Click += new System.EventHandler(advTree1_Click);
			this.advTree1.KeyDown += new System.Windows.Forms.KeyEventHandler(advTree1_KeyDown);
			this.advTree1.KeyUp += new System.Windows.Forms.KeyEventHandler(advTree1_KeyUp);
			this.columnHeader3.Name = "columnHeader3";
			this.columnHeader3.StretchToFill = true;
			this.columnHeader3.Text = "Stacked Texture";
			this.columnHeader3.Width.Absolute = 150;
			this.columnHeader4.Name = "columnHeader4";
			this.columnHeader4.Text = "State";
			this.columnHeader4.Width.Absolute = 150;
			this.node1.Image = GrBuildStudio.Properties.Resources.exclamation;
			this.node1.Name = "node1";
			this.node1.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node2, this.node5 });
			this.node1.Text = "BlueMarble";
			this.node2.Expanded = true;
			this.node2.Name = "node2";
			this.node2.Text = "Diffuse: bluemarble_d.png";
			this.node5.Expanded = true;
			this.node5.Name = "node5";
			this.node5.Text = "Normals: bluemarble_n.png";
			this.node6.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node6.Name = "node6";
			this.node6.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node9, this.node36 });
			this.node6.Text = "Glider";
			this.node9.Name = "node9";
			this.node9.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node10 });
			this.node9.Text = "Diffuse: UDIM";
			this.node10.Name = "node10";
			this.node10.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node35 });
			this.node10.Text = "102 items found... expand to view";
			this.node35.Cells.Add(this.cell4);
			this.node35.Expanded = true;
			this.node35.Name = "node35";
			this.node35.Text = "world.topo.bathy.200412.3x21600x21600.A0_n.png";
			this.cell4.Name = "cell4";
			this.cell4.StyleMouseOver = null;
			this.cell4.Text = "Built";
			this.node36.Expanded = true;
			this.node36.Name = "node36";
			this.node36.Text = "Normals: UDIM";
			this.node37.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node37.Name = "node37";
			this.node37.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node38 });
			this.node37.Text = "Loft";
			this.node38.Expanded = true;
			this.node38.Name = "node38";
			this.node38.Text = "node16";
			this.node39.Expanded = true;
			this.node39.Image = GrBuildStudio.Properties.Resources.asset_imported;
			this.node39.Name = "node39";
			this.node39.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node41, this.node42 });
			this.node39.Text = "Asset 3";
			this.node41.Expanded = true;
			this.node41.Name = "node41";
			this.node41.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node3 });
			this.node41.Text = "node10";
			this.node3.Expanded = true;
			this.node3.Name = "node3";
			this.node3.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node4 });
			this.node3.Text = "node3";
			this.node4.Expanded = true;
			this.node4.Name = "node4";
			this.node4.Text = "node4";
			this.node42.Expanded = true;
			this.node42.Name = "node42";
			this.node42.Text = "node11";
			this.nodeConnector4.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle2.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle2.Name = "elementStyle2";
			this.elementStyle2.TextColor = System.Drawing.SystemColors.ControlText;
			this.imageList1.ColorDepth = System.Windows.Forms.ColorDepth.Depth32Bit;
			this.imageList1.ImageSize = new System.Drawing.Size(16, 16);
			this.imageList1.TransparentColor = System.Drawing.Color.Transparent;
			this.ToolTip.DefaultTooltipSettings = new DevComponents.DotNetBar.SuperTooltipInfo("Enter your resource Tag here In text", "", "TT_NO_TOOLTIP", null, null, DevComponents.DotNetBar.eTooltipColor.Gray);
			this.ToolTip.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.ToolTip.PositionBelowControl = false;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.advTree1);
			base.Name = "ProjectTree";
			base.Size = new System.Drawing.Size(546, 194);
			((System.ComponentModel.ISupportInitialize)this.advTree1).EndInit();
			base.ResumeLayout(false);
		}
	}
	public class SolutionTree : UserControl
	{
		public class NodeContext
		{
			public Guid ProjectId { get; set; }

			public ProjectTree.AssetNodeType Type { get; set; }

			public Asset Asset { get; set; }

			public int Layer { get; set; }

			public Texture Texture { get; set; }

			public NodeContext(Guid projectId, ProjectTree.AssetNodeType type, Asset asset, int layer, Texture texture)
			{
				ProjectId = projectId;
				Type = type;
				Asset = asset;
				Layer = layer;
				Texture = texture;
			}
		}

		public delegate void ProjectSelectedEventHandler(object sender, Guid projectId);

		public delegate void AssetNodeDoubleClickedEventHandler(object sender, NodeContext context);

		public delegate void AssetNodeClickedEventHandler(object sender, NodeContext context);

		public delegate void AssetNodeRightClickedEventHandler(object sender, List<NodeContext> context, Point location);

		public delegate void RightClickedEventHandler(object sender, Point location);

		public delegate void DeleteEventHandler(List<NodeContext> contexts);

		public delegate bool RenameEventHandler(ProjectTree.RenameAsset renameAsset);

		public delegate void AssetMoveRequestHandler(object sender, Guid srcProjectId, List<Asset> assets, Guid destProjectId, bool keepCopy);

		public delegate void SelectionChangedHandler(object sender);

		public delegate void FilterBarClosedEventHandler(object sender);

		private Dictionary<Guid, ProjectNodeModel> projectNodes;

		private SolutionModel model;

		private IContainer components;

		private AdvTree tree;

		private AdvTree advTree1;

		private DevComponents.AdvTree.ColumnHeader columnHeader3;

		private DevComponents.AdvTree.ColumnHeader columnHeader4;

		private Node node1;

		private Node node2;

		private Node node5;

		private Node node6;

		private Node node9;

		private Node node10;

		private Node node35;

		private Cell cell4;

		private Node node36;

		private Node node37;

		private Node node38;

		private Node node39;

		private Node node41;

		private Node node42;

		private NodeConnector nodeConnector4;

		private ElementStyle elementStyle2;

		private AdvTree advTree2;

		private DevComponents.AdvTree.ColumnHeader columnHeader7;

		private DevComponents.AdvTree.ColumnHeader columnHeader8;

		private Node node11;

		private Node node17;

		private Node node19;

		private Node node12;

		private Node node13;

		private Node node14;

		private Node node15;

		private Cell cell6;

		private Node node16;

		private Node node21;

		private Node node22;

		private Node node40;

		private Node node43;

		private Node node44;

		private NodeConnector nodeConnector1;

		private ElementStyle elementStyle1;

		private Node node45;

		private Node node46;

		private ElementStyle elementStyle4;

		private Node node47;

		private Node node48;

		private NodeConnector nodeConnector2;

		private ElementStyle elementStyle8;

		private FilterBar filterBar;

		public Guid ActiveProject { get; set; }

		public NodeContext SelectedAsset { get; private set; }

		public Dictionary<Guid, List<Asset>> SelectedAssets => GetSelectedAssets();

		public bool HasSelectedAssets
		{
			get
			{
				foreach (Guid key in projectNodes.Keys)
				{
					if (projectNodes[key].Tree.HasSelectedAssets)
					{
						return true;
					}
				}
				return false;
			}
		}

		public event ProjectSelectedEventHandler ProjectSelected;

		public event AssetNodeDoubleClickedEventHandler AssetNodeDoubleClicked;

		public event AssetNodeClickedEventHandler AssetNodeClicked;

		public event AssetNodeRightClickedEventHandler AssetNodeRightClicked;

		public event RightClickedEventHandler RightClicked;

		public event DeleteEventHandler DeletePressed;

		public event RenameEventHandler AssetRenamed;

		public event AssetMoveRequestHandler AssetMoveRequest;

		public event SelectionChangedHandler SelectionChanged;

		public event FilterBarClosedEventHandler FilterBarClosed;

		public SolutionTree()
		{
			InitializeComponent();
			tree.Nodes.Clear();
			projectNodes = new Dictionary<Guid, ProjectNodeModel>();
			tree.TileSize = CalcProjectTreeSize();
			tree.Resize += projectTree_Resize;
			OnResize(EventArgs.Empty);
		}

		private Size CalcProjectTreeSize()
		{
			return new Size(base.Size.Width - 50, base.Size.Height - 200);
		}

		public void Delete()
		{
			tree.ClearAndDisposeAllNodes();
			foreach (ProjectNodeModel value in projectNodes.Values)
			{
				value.Delete();
			}
			projectNodes = new Dictionary<Guid, ProjectNodeModel>();
		}

		private void projectTree_Resize(object sender, EventArgs e)
		{
			tree.TileSize = CalcProjectTreeSize();
		}

		public void Create(SolutionModel model)
		{
			this.model = model;
			model.SolutionBuilder.ProjectLoaded += SolutionBuilder_ProjectLoaded;
			model.SolutionBuilder.ProjectUnloaded += SolutionBuilder_ProjectUnloaded;
			model.SolutionBuilder.SolutionLoading += SolutionBuilder_SolutionLoading;
			model.AssetAdded += model_AssetAdded;
			model.AssetsAdded += model_AssetsAdded;
			model.AssetRemoved += model_AssetRemoved;
			model.ProjectStateChanged += model_ProjectStateChanged;
			model.ProjectAssetChanged += model_ProjectAssetChanged;
			ProjectSelected += SolutionTree_ProjectSelected;
		}

		private void model_ProjectAssetChanged(object sender, Guid projectId, Asset asset)
		{
			projectNodes[projectId].RefreshAsset(asset);
			projectNodes[projectId].UpdateNode();
		}

		private void model_ProjectStateChanged(object sender, Guid projectId)
		{
			projectNodes[projectId].Refresh();
			projectNodes[projectId].UpdateNode();
		}

		private void SolutionBuilder_SolutionLoading(object sender)
		{
			tree.Nodes.Clear();
		}

		private void SolutionTree_ProjectSelected(object sender, Guid projectId)
		{
			model.SetActiveProject(projectId);
		}

		private void model_AssetAdded(object sender, string assetName, Guid projectId)
		{
			GetProjectNode(projectId).UpdateAllAssets();
			projectNodes[projectId].UpdateNode();
		}

		private void model_AssetsAdded(object sender, Guid projectId)
		{
			GetProjectNode(projectId).Refresh();
			projectNodes[projectId].UpdateNode();
		}

		private void model_AssetRemoved(object sender, string assetName, Guid projectId)
		{
			GetProjectNode(projectId).Refresh();
			projectNodes[projectId].UpdateNode();
		}

		private void SolutionBuilder_ProjectLoaded(object sender, SolutionProjectDecriptor project)
		{
			ProjectBuilder projectBuilder = model.SolutionBuilder.ProjectBuilders[project.Id];
			CreateProjectTreeNode(projectBuilder);
			projectBuilder.QueryAssetBuildStates();
			GetProjectNode(project.Id).Refresh();
		}

		private void SolutionBuilder_ProjectUnloaded(object sender, SolutionProjectDecriptor project)
		{
			ProjectNodeModel projectNode = GetProjectNode(project.Id);
			tree.Nodes.Remove(projectNode.Node);
			projectNodes.Remove(project.Id);
			tree.Update();
		}

		public void StartRename()
		{
			projectNodes[ActiveProject].StartRename();
		}

		protected virtual void OnProjectSelected(Guid projectId)
		{
			ActiveProject = projectId;
			this.ProjectSelected?.Invoke(this, projectId);
		}

		protected virtual void OnAssetNodeDoubleClicked(NodeContext context)
		{
			this.AssetNodeDoubleClicked?.Invoke(this, context);
		}

		protected virtual void OnAssetNodeClicked(NodeContext context)
		{
			this.AssetNodeClicked?.Invoke(this, context);
		}

		protected virtual void OnAssetNodeRightClicked(List<NodeContext> contexts, Point location)
		{
			this.AssetNodeRightClicked?.Invoke(this, contexts, location);
		}

		protected virtual void OnRightClicked(Point location)
		{
			this.RightClicked?.Invoke(this, location);
		}

		protected virtual void OnDeletePressed(List<NodeContext> contexts)
		{
			this.DeletePressed?.Invoke(contexts);
		}

		protected virtual bool OnRenamePressed(ProjectTree.RenameAsset renameAsset)
		{
			return this.AssetRenamed?.Invoke(renameAsset) ?? false;
		}

		private void OnAssetMoveRequest(object sender, Guid srcProjectId, List<Asset> assets, Guid destProjectId, bool keepCopy)
		{
			if (this.AssetMoveRequest != null)
			{
				this.AssetMoveRequest(this, srcProjectId, assets, destProjectId, keepCopy);
			}
		}

		private void OnSelectionChanged(object sender)
		{
			if (this.SelectionChanged != null)
			{
				this.SelectionChanged(this);
			}
		}

		public ProjectNodeModel GetProjectNode(Guid projectId)
		{
			return projectNodes[projectId];
		}

		private void CreateProjectTreeNode(ProjectBuilder projectBuilder)
		{
			ProjectNodeModel projectNodeModel = new ProjectNodeModel(projectBuilder);
			projectNodeModel.ProjectNodeClicked += model_ProjectNodeClicked;
			projectNodeModel.ProjectNodeRightClicked += model_ProjectNodeRightClicked;
			projectNodeModel.Tree.AssetNodeClicked += Tree_AssetNodeClicked;
			projectNodeModel.Tree.AssetNodeDoubleClicked += Tree_AssetNodeDoubleClicked;
			projectNodeModel.Tree.AssetNodeRightClicked += Tree_AssetNodeRightClicked;
			projectNodeModel.Tree.AssetNodeDelete += Tree_AssetNodeDelete;
			projectNodeModel.Tree.AssetNodeRenamed += Tree_AssetNodeRenamed;
			projectNodeModel.Tree.SelectionChanged += Tree_SelectionChanged;
			projectNodeModel.Tree.MinimumSize = CalcProjectTreeSize();
			Size size2 = (projectNodeModel.Tree.MaximumSize = (projectNodeModel.Tree.Size = projectNodeModel.Tree.MinimumSize));
			projectNodeModel.Tree.Size = new Size(projectNodeModel.Tree.Size.Width - 50, base.Size.Height - 200);
			projectNodeModel.Tree.AllowDragDrop = true;
			projectNodeModel.Tree.AssetMoveRequest += Tree_AssetMoveRequest;
			tree.Nodes.Add(projectNodeModel.Node);
			projectNodes.Add(projectBuilder.ActiveProject.Id, projectNodeModel);
		}

		private void Tree_SelectionChanged(object sender)
		{
			OnSelectionChanged(this);
		}

		private void Tree_AssetMoveRequest(object sender, Guid srcProjectId, List<Asset> assets, Guid destProjectId, bool keepCopy)
		{
			OnAssetMoveRequest(this, srcProjectId, assets, destProjectId, keepCopy);
		}

		private void Tree_AssetNodeDelete(object sender, List<ProjectTree.NodeContext> contexts)
		{
			Guid id = ((ProjectTree)sender).ProjectBuilder.ActiveProject.Id;
			List<NodeContext> list = new List<NodeContext>();
			foreach (ProjectTree.NodeContext context in contexts)
			{
				list.Add(new NodeContext(id, context.Type, context.Asset, context.Layer, context.Texture));
			}
			OnDeletePressed(list);
		}

		private bool Tree_AssetNodeRenamed(object sender, ProjectTree.RenameAsset renameAsset)
		{
			return OnRenamePressed(renameAsset);
		}

		private void model_ProjectNodeRightClicked(object sender, Point location)
		{
			OnRightClicked(PointToScreen(location));
		}

		private void Tree_AssetNodeRightClicked(object sender, List<ProjectTree.NodeContext> contexts, Point location)
		{
			Guid id = ((ProjectTree)sender).ProjectBuilder.ActiveProject.Id;
			List<NodeContext> list = new List<NodeContext>();
			foreach (ProjectTree.NodeContext context in contexts)
			{
				list.Add(new NodeContext(id, context.Type, context.Asset, context.Layer, context.Texture));
			}
			OnAssetNodeRightClicked(list, location);
		}

		private void Tree_AssetNodeDoubleClicked(object sender, ProjectTree.NodeContext context)
		{
			NodeContext context2 = new NodeContext(((ProjectTree)sender).ProjectBuilder.ActiveProject.Id, context.Type, context.Asset, context.Layer, context.Texture);
			OnAssetNodeDoubleClicked(context2);
		}

		private void Tree_AssetNodeClicked(object sender, ProjectTree.NodeContext context)
		{
			ProjectTree projectTree = (ProjectTree)sender;
			if (context == null)
			{
				OnAssetNodeClicked(null);
				return;
			}
			NodeContext context2 = (SelectedAsset = new NodeContext(projectTree.ProjectBuilder.ActiveProject.Id, context.Type, context.Asset, context.Layer, context.Texture));
			OnAssetNodeClicked(context2);
		}

		private void model_ProjectNodeClicked(object sender, Guid id)
		{
			if (id != Guid.Empty)
			{
				OnProjectSelected(id);
			}
		}

		public void SelectFirstProject()
		{
			if (tree.Nodes.Count > 0)
			{
				tree.SelectedIndex = 0;
				tree.SelectedNode.EnsureVisible();
				tree.Focus();
				model.SetActiveProject(projectNodes.Keys.First());
			}
		}

		private void SolutionTree_SizeChanged(object sender, EventArgs e)
		{
			if (projectNodes == null)
			{
				return;
			}
			Size size = CalcProjectTreeSize();
			foreach (ProjectNodeModel value in projectNodes.Values)
			{
				if (value.Tree != null)
				{
					ProjectTree projectTree = value.Tree;
					ProjectTree projectTree2 = value.Tree;
					Size size3 = (value.Tree.Size = size);
					Size size6 = (projectTree.MinimumSize = (projectTree2.MaximumSize = size3));
				}
			}
		}

		protected virtual void OnFilterBarClosed()
		{
			this.FilterBarClosed?.Invoke(this);
		}

		public void EnableFilter(bool enable)
		{
			filterBar.Visible = enable;
			if (enable)
			{
				filterBar.Activate();
				Filter(filterBar.Filter);
			}
			else
			{
				ClearFilter();
			}
		}

		private void FilterBar_CancelClick(object sender)
		{
			ClearFilter();
			EnableFilter(enable: false);
			OnFilterBarClosed();
		}

		public void Filter(string filterString)
		{
			foreach (ProjectNodeModel value in projectNodes.Values)
			{
				value.Filter(filterString);
			}
		}

		public void ClearFilter()
		{
			foreach (ProjectNodeModel value in projectNodes.Values)
			{
				value.ClearFilter();
			}
		}

		private void filterBar_FilterRequest(object sender)
		{
			if (string.IsNullOrEmpty(filterBar.Filter))
			{
				ClearFilter();
			}
			else
			{
				Filter(filterBar.Filter);
			}
		}

		private Dictionary<Guid, List<Asset>> GetSelectedAssets()
		{
			Dictionary<Guid, List<Asset>> dictionary = new Dictionary<Guid, List<Asset>>();
			foreach (Guid key in projectNodes.Keys)
			{
				List<ProjectTree.NodeContext> selectedAssets = projectNodes[key].Tree.SelectedAssets;
				if (selectedAssets.Count > 0)
				{
					List<Asset> value = new List<Asset>(selectedAssets.Select((ProjectTree.NodeContext x) => x.Asset));
					dictionary.Add(key, value);
				}
			}
			return dictionary;
		}

		private ProjectNodeModel GetProjectModel(Node node)
		{
			Node selectedNode = tree.SelectedNode;
			while (selectedNode != null && selectedNode.Tag == null && selectedNode != null)
			{
				selectedNode = selectedNode.Parent;
			}
			if (selectedNode == null)
			{
				return null;
			}
			if (selectedNode.Tag is ProjectNodeModel)
			{
				return (ProjectNodeModel)selectedNode.Tag;
			}
			return null;
		}

		private Guid GetSelectedProject()
		{
			return GetProjectModel(tree.SelectedNode)?.Tree.ProjectBuilder.ActiveProject.Id ?? Guid.Empty;
		}

		private void tree_NodeDragFeedback(object sender, TreeDragFeedbackEventArgs e)
		{
			e.AllowDrop = false;
		}

		private void tree_SelectionChanged(object sender, EventArgs e)
		{
			OnSelectionChanged(this);
			Guid selectedProject = GetSelectedProject();
			if (ActiveProject != selectedProject)
			{
				OnProjectSelected(selectedProject);
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.tree = new DevComponents.AdvTree.AdvTree();
			this.advTree1 = new DevComponents.AdvTree.AdvTree();
			this.columnHeader3 = new DevComponents.AdvTree.ColumnHeader();
			this.columnHeader4 = new DevComponents.AdvTree.ColumnHeader();
			this.node1 = new DevComponents.AdvTree.Node();
			this.node2 = new DevComponents.AdvTree.Node();
			this.node5 = new DevComponents.AdvTree.Node();
			this.node6 = new DevComponents.AdvTree.Node();
			this.node9 = new DevComponents.AdvTree.Node();
			this.node10 = new DevComponents.AdvTree.Node();
			this.node35 = new DevComponents.AdvTree.Node();
			this.cell4 = new DevComponents.AdvTree.Cell();
			this.node36 = new DevComponents.AdvTree.Node();
			this.node37 = new DevComponents.AdvTree.Node();
			this.node38 = new DevComponents.AdvTree.Node();
			this.node39 = new DevComponents.AdvTree.Node();
			this.node41 = new DevComponents.AdvTree.Node();
			this.node42 = new DevComponents.AdvTree.Node();
			this.nodeConnector4 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle2 = new DevComponents.DotNetBar.ElementStyle();
			this.advTree2 = new DevComponents.AdvTree.AdvTree();
			this.columnHeader7 = new DevComponents.AdvTree.ColumnHeader();
			this.columnHeader8 = new DevComponents.AdvTree.ColumnHeader();
			this.node11 = new DevComponents.AdvTree.Node();
			this.node17 = new DevComponents.AdvTree.Node();
			this.node19 = new DevComponents.AdvTree.Node();
			this.node12 = new DevComponents.AdvTree.Node();
			this.node13 = new DevComponents.AdvTree.Node();
			this.node14 = new DevComponents.AdvTree.Node();
			this.node15 = new DevComponents.AdvTree.Node();
			this.cell6 = new DevComponents.AdvTree.Cell();
			this.node16 = new DevComponents.AdvTree.Node();
			this.node21 = new DevComponents.AdvTree.Node();
			this.node22 = new DevComponents.AdvTree.Node();
			this.node40 = new DevComponents.AdvTree.Node();
			this.node43 = new DevComponents.AdvTree.Node();
			this.node44 = new DevComponents.AdvTree.Node();
			this.nodeConnector1 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle1 = new DevComponents.DotNetBar.ElementStyle();
			this.node45 = new DevComponents.AdvTree.Node();
			this.node46 = new DevComponents.AdvTree.Node();
			this.elementStyle4 = new DevComponents.DotNetBar.ElementStyle();
			this.node47 = new DevComponents.AdvTree.Node();
			this.node48 = new DevComponents.AdvTree.Node();
			this.nodeConnector2 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle8 = new DevComponents.DotNetBar.ElementStyle();
			this.filterBar = new GrBuildStudio.FilterBar();
			((System.ComponentModel.ISupportInitialize)this.tree).BeginInit();
			this.tree.SuspendLayout();
			((System.ComponentModel.ISupportInitialize)this.advTree1).BeginInit();
			((System.ComponentModel.ISupportInitialize)this.advTree2).BeginInit();
			base.SuspendLayout();
			this.tree.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.tree.AllowDrop = true;
			this.tree.BackColor = System.Drawing.SystemColors.Window;
			this.tree.BackgroundStyle.Class = "TreeBorderKey";
			this.tree.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.tree.Controls.Add(this.advTree2);
			this.tree.Dock = System.Windows.Forms.DockStyle.Fill;
			this.tree.ExpandButtonType = DevComponents.AdvTree.eExpandButtonType.Triangle;
			this.tree.FullRowSelect = false;
			this.tree.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.tree.Location = new System.Drawing.Point(0, 45);
			this.tree.Name = "tree";
			this.tree.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node45, this.node47 });
			this.tree.NodesConnector = this.nodeConnector2;
			this.tree.NodeStyle = this.elementStyle8;
			this.tree.PathSeparator = ";";
			this.tree.Size = new System.Drawing.Size(500, 459);
			this.tree.Styles.Add(this.elementStyle8);
			this.tree.Styles.Add(this.elementStyle4);
			this.tree.TabIndex = 10;
			this.tree.TileSize = new System.Drawing.Size(400, 30);
			this.tree.View = DevComponents.AdvTree.eView.Tile;
			this.tree.SelectionChanged += new System.EventHandler(tree_SelectionChanged);
			this.tree.NodeDragFeedback += new DevComponents.AdvTree.TreeDragFeedbackEventHander(tree_NodeDragFeedback);
			this.advTree1.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.advTree1.AllowDrop = true;
			this.advTree1.BackColor = System.Drawing.SystemColors.Window;
			this.advTree1.BackgroundStyle.Class = "TreeBorderKey";
			this.advTree1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.advTree1.Columns.Add(this.columnHeader3);
			this.advTree1.Columns.Add(this.columnHeader4);
			this.advTree1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.advTree1.Location = new System.Drawing.Point(18, 45);
			this.advTree1.Name = "advTree1";
			this.advTree1.Nodes.AddRange(new DevComponents.AdvTree.Node[4] { this.node1, this.node6, this.node37, this.node39 });
			this.advTree1.NodesConnector = this.nodeConnector4;
			this.advTree1.NodeStyle = this.elementStyle2;
			this.advTree1.PathSeparator = ";";
			this.advTree1.Size = new System.Drawing.Size(400, 198);
			this.advTree1.Styles.Add(this.elementStyle2);
			this.advTree1.TabIndex = 10;
			this.advTree1.Text = "advTree1";
			this.columnHeader3.Name = "columnHeader3";
			this.columnHeader3.StretchToFill = true;
			this.columnHeader3.Text = "Stacked Texture";
			this.columnHeader3.Width.Absolute = 150;
			this.columnHeader4.Name = "columnHeader4";
			this.columnHeader4.Text = "State";
			this.columnHeader4.Width.Absolute = 150;
			this.node1.Image = GrBuildStudio.Properties.Resources.exclamation;
			this.node1.Name = "node1";
			this.node1.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node2, this.node5 });
			this.node1.Text = "BlueMarble";
			this.node2.Expanded = true;
			this.node2.Name = "node2";
			this.node2.Text = "Diffuse: bluemarble_d.png";
			this.node5.Expanded = true;
			this.node5.Name = "node5";
			this.node5.Text = "Normals: bluemarble_n.png";
			this.node6.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node6.Name = "node6";
			this.node6.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node9, this.node36 });
			this.node6.Text = "Glider";
			this.node9.Name = "node9";
			this.node9.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node10 });
			this.node9.Text = "Diffuse: UDIM";
			this.node10.Name = "node10";
			this.node10.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node35 });
			this.node10.Text = "102 items found... expand to view";
			this.node35.Cells.Add(this.cell4);
			this.node35.Expanded = true;
			this.node35.Name = "node35";
			this.node35.Text = "world.topo.bathy.200412.3x21600x21600.A0_n.png";
			this.cell4.Name = "cell4";
			this.cell4.StyleMouseOver = null;
			this.cell4.Text = "Built";
			this.node36.Expanded = true;
			this.node36.Name = "node36";
			this.node36.Text = "Normals: UDIM";
			this.node37.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node37.Name = "node37";
			this.node37.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node38 });
			this.node37.Text = "Loft";
			this.node38.Expanded = true;
			this.node38.Name = "node38";
			this.node38.Text = "node16";
			this.node39.Image = GrBuildStudio.Properties.Resources.error_add;
			this.node39.Name = "node39";
			this.node39.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node41, this.node42 });
			this.node39.Text = "Stacked texture 3";
			this.node41.Expanded = true;
			this.node41.Name = "node41";
			this.node41.Text = "node10";
			this.node42.Expanded = true;
			this.node42.Name = "node42";
			this.node42.Text = "node11";
			this.nodeConnector4.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle2.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle2.Name = "elementStyle2";
			this.elementStyle2.TextColor = System.Drawing.SystemColors.ControlText;
			this.advTree2.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.advTree2.AllowDrop = true;
			this.advTree2.BackColor = System.Drawing.SystemColors.Window;
			this.advTree2.BackgroundStyle.Class = "TreeBorderKey";
			this.advTree2.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.advTree2.Columns.Add(this.columnHeader7);
			this.advTree2.Columns.Add(this.columnHeader8);
			this.advTree2.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.advTree2.Location = new System.Drawing.Point(18, 87);
			this.advTree2.Name = "advTree2";
			this.advTree2.Nodes.AddRange(new DevComponents.AdvTree.Node[4] { this.node11, this.node12, this.node21, this.node40 });
			this.advTree2.NodesConnector = this.nodeConnector1;
			this.advTree2.NodeStyle = this.elementStyle1;
			this.advTree2.PathSeparator = ";";
			this.advTree2.Size = new System.Drawing.Size(400, 196);
			this.advTree2.Styles.Add(this.elementStyle1);
			this.advTree2.TabIndex = 9;
			this.advTree2.Text = "advTree1";
			this.columnHeader7.Name = "columnHeader7";
			this.columnHeader7.StretchToFill = true;
			this.columnHeader7.Text = "Stacked Texture";
			this.columnHeader7.Width.Absolute = 150;
			this.columnHeader8.Name = "columnHeader8";
			this.columnHeader8.Text = "State";
			this.columnHeader8.Width.Absolute = 150;
			this.node11.Image = GrBuildStudio.Properties.Resources.exclamation;
			this.node11.Name = "node11";
			this.node11.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node17, this.node19 });
			this.node11.Text = "BlueMarble";
			this.node17.Expanded = true;
			this.node17.Name = "node17";
			this.node17.Text = "Diffuse: bluemarble_d.png";
			this.node19.Expanded = true;
			this.node19.Name = "node19";
			this.node19.Text = "Normals: bluemarble_n.png";
			this.node12.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node12.Name = "node12";
			this.node12.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node13, this.node16 });
			this.node12.Text = "Glider";
			this.node13.Name = "node13";
			this.node13.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node14 });
			this.node13.Text = "Diffuse: UDIM";
			this.node14.Name = "node14";
			this.node14.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node15 });
			this.node14.Text = "102 items found... expand to view";
			this.node15.Cells.Add(this.cell6);
			this.node15.Expanded = true;
			this.node15.Name = "node15";
			this.node15.Text = "world.topo.bathy.200412.3x21600x21600.A0_n.png";
			this.cell6.Name = "cell6";
			this.cell6.StyleMouseOver = null;
			this.cell6.Text = "Built";
			this.node16.Expanded = true;
			this.node16.Name = "node16";
			this.node16.Text = "Normals: UDIM";
			this.node21.Image = GrBuildStudio.Properties.Resources.bullet_green;
			this.node21.Name = "node21";
			this.node21.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node22 });
			this.node21.Text = "Loft";
			this.node22.Expanded = true;
			this.node22.Name = "node22";
			this.node22.Text = "node16";
			this.node40.Image = GrBuildStudio.Properties.Resources.error_add;
			this.node40.Name = "node40";
			this.node40.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node43, this.node44 });
			this.node40.Text = "Stacked texture 3";
			this.node43.Expanded = true;
			this.node43.Name = "node43";
			this.node43.Text = "node10";
			this.node44.Expanded = true;
			this.node44.Name = "node44";
			this.node44.Text = "node11";
			this.nodeConnector1.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle1.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle1.Name = "elementStyle1";
			this.elementStyle1.TextColor = System.Drawing.SystemColors.ControlText;
			this.node45.Name = "node45";
			this.node45.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node46 });
			this.node45.Style = this.elementStyle4;
			this.node45.Text = "<b>Tile Set 'BlueMarble'</b> - 3 layers (RGBA, Norm, RGBA)";
			this.node46.Expanded = true;
			this.node46.HostedControl = this.advTree1;
			this.node46.Name = "node46";
			this.node46.Text = "advTree3";
			this.elementStyle4.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle4.Font = new System.Drawing.Font("Microsoft Sans Serif", 9.75f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			this.elementStyle4.MarginBottom = 6;
			this.elementStyle4.MarginTop = 6;
			this.elementStyle4.Name = "elementStyle4";
			this.node47.Expanded = true;
			this.node47.Name = "node47";
			this.node47.Nodes.AddRange(new DevComponents.AdvTree.Node[1] { this.node48 });
			this.node47.Style = this.elementStyle4;
			this.node47.Text = "<b>Tile Set 'Loft'</b> - 2 layers (RGB, RGBA)";
			this.node48.Expanded = true;
			this.node48.HostedControl = this.advTree2;
			this.node48.Name = "node48";
			this.node48.Text = "advTree1";
			this.nodeConnector2.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle8.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle8.Name = "elementStyle8";
			this.elementStyle8.TextColor = System.Drawing.SystemColors.ControlText;
			this.filterBar.Dock = System.Windows.Forms.DockStyle.Top;
			this.filterBar.Filter = "";
			this.filterBar.Location = new System.Drawing.Point(0, 0);
			this.filterBar.Name = "filterBar";
			this.filterBar.Size = new System.Drawing.Size(500, 45);
			this.filterBar.TabIndex = 11;
			this.filterBar.Visible = false;
			this.filterBar.FilterRequest += new GrBuildStudio.FilterBar.FilterRequestEventHandler(filterBar_FilterRequest);
			this.filterBar.CancelClick += new GrBuildStudio.FilterBar.CancelClickEventHandler(FilterBar_CancelClick);
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.tree);
			base.Controls.Add(this.filterBar);
			base.Name = "SolutionTree";
			base.Size = new System.Drawing.Size(500, 504);
			base.SizeChanged += new System.EventHandler(SolutionTree_SizeChanged);
			((System.ComponentModel.ISupportInitialize)this.tree).EndInit();
			this.tree.ResumeLayout(false);
			((System.ComponentModel.ISupportInitialize)this.advTree1).EndInit();
			((System.ComponentModel.ISupportInitialize)this.advTree2).EndInit();
			base.ResumeLayout(false);
		}
	}
	public class BatchInfo
	{
		public class ChannelBatchInfo
		{
			public string lastImportLocation;

			public const int TemplateHistory = 5;

			public string[] Templates = new string[5];
		}

		public static readonly string NodeName = "BatchInfo";

		private ChannelBatchInfo[] infos = new ChannelBatchInfo[4];

		public ChannelBatchInfo GetChannelInfo(int subIdx)
		{
			if (infos[subIdx] == null)
			{
				infos[subIdx] = new ChannelBatchInfo();
			}
			return infos[subIdx];
		}

		public string GetImportLocation(int subIdx)
		{
			if (infos[subIdx] == null)
			{
				infos[subIdx] = new ChannelBatchInfo();
			}
			if (infos[subIdx].lastImportLocation == null || !Directory.Exists(infos[subIdx].lastImportLocation))
			{
				infos[subIdx].lastImportLocation = Environment.GetFolderPath(Environment.SpecialFolder.Personal);
			}
			return infos[subIdx].lastImportLocation;
		}

		public void SetImportLocation(int subIdx, string value)
		{
			if (infos[subIdx] == null)
			{
				infos[subIdx] = new ChannelBatchInfo();
			}
			if (value != null && Directory.Exists(value))
			{
				infos[subIdx].lastImportLocation = Path.GetFullPath(value);
			}
		}

		public string GetTemplate(int subIdx, int templateIdx)
		{
			if (infos[subIdx] == null)
			{
				infos[subIdx] = new ChannelBatchInfo();
			}
			return infos[subIdx].Templates[templateIdx];
		}

		public void SetTemplate(int subIdx, int templateIdx, string value)
		{
			if (infos[subIdx] == null)
			{
				infos[subIdx] = new ChannelBatchInfo();
			}
			infos[subIdx].Templates[templateIdx] = value;
		}

		public void Save(XmlDocument document, XmlElement projectNode)
		{
			XmlNode xmlNode = document.CreateElement(NodeName);
			projectNode.AppendChild(xmlNode);
			for (int i = 0; i < 4; i++)
			{
				if (infos[i] == null)
				{
					continue;
				}
				XmlElement xmlElement = document.CreateElement("ChannelBatchInfo");
				xmlElement.SetAttribute("TextureIdx", i.ToString());
				xmlNode.AppendChild(xmlElement);
				XmlElement xmlElement2 = document.CreateElement("ImportLocation");
				xmlElement2.InnerText = GetImportLocation(i);
				xmlElement.AppendChild(xmlElement2);
				string[] templates = infos[i].Templates;
				foreach (string text in templates)
				{
					if (!string.IsNullOrEmpty(text))
					{
						XmlNode xmlNode2 = document.CreateElement("ImportTemplate");
						xmlNode2.InnerText = text;
						xmlElement.AppendChild(xmlNode2);
					}
				}
			}
		}

		public static BatchInfo Load(XmlNode node)
		{
			BatchInfo batchInfo = new BatchInfo();
			foreach (XmlNode item in node.SelectNodes("ChannelBatchInfo"))
			{
				if (item.Attributes["TextureIdx"] == null)
				{
					continue;
				}
				int num = Convert.ToInt32(item.Attributes["TextureIdx"].Value);
				if (num >= 0 && num <= 4)
				{
					XmlNode xmlNode2 = item.SelectSingleNode("ImportLocation");
					if (xmlNode2 == null)
					{
						return null;
					}
					batchInfo.SetImportLocation(num, xmlNode2.InnerText);
					XmlNodeList xmlNodeList = item.SelectNodes("ImportTemplate");
					for (int i = 0; i < Math.Min(5, xmlNodeList.Count); i++)
					{
						batchInfo.SetTemplate(num, i, xmlNodeList[i].InnerText);
					}
				}
			}
			return batchInfo;
		}

		public void PushTemplate(int subIdx, string value)
		{
			if (infos[subIdx] == null)
			{
				infos[subIdx] = new ChannelBatchInfo();
			}
			Queue<string> queue = new Queue<string>();
			queue.Enqueue(value);
			string[] templates = infos[subIdx].Templates;
			foreach (string text in templates)
			{
				if (text != null && text != value)
				{
					queue.Enqueue(text);
				}
				if (queue.Count >= 5)
				{
					break;
				}
			}
			int count = queue.Count;
			for (int j = 0; j < count; j++)
			{
				infos[subIdx].Templates[j] = queue.Dequeue();
			}
		}
	}
	public class ProjectSettings
	{
		private static int versionNumber = 2;

		private ProjectBuilder builder;

		private string lastSingleAssetImportLocation;

		private string lastScriptImportLocation;

		private string lastScriptExportLocation;

		private BatchInfo[] batchImportInfo;

		public string SingleAssetImportLocation
		{
			get
			{
				if (lastSingleAssetImportLocation == null || !Directory.Exists(lastSingleAssetImportLocation))
				{
					lastSingleAssetImportLocation = Environment.GetFolderPath(Environment.SpecialFolder.Personal);
				}
				return lastSingleAssetImportLocation;
			}
			set
			{
				if (value != null && Directory.Exists(value))
				{
					lastSingleAssetImportLocation = Path.GetFullPath(value);
				}
			}
		}

		public string ImportScriptLocation
		{
			get
			{
				if (lastScriptImportLocation == null || !Directory.Exists(lastScriptImportLocation))
				{
					lastScriptImportLocation = Environment.GetFolderPath(Environment.SpecialFolder.Personal);
				}
				return lastScriptImportLocation;
			}
			set
			{
				if (value != null && Directory.Exists(value))
				{
					lastScriptImportLocation = Path.GetFullPath(value);
				}
			}
		}

		public string ExportScriptLocation
		{
			get
			{
				if (lastScriptExportLocation == null || !Directory.Exists(lastScriptExportLocation))
				{
					lastScriptExportLocation = Environment.GetFolderPath(Environment.SpecialFolder.Personal);
				}
				return lastScriptExportLocation;
			}
			set
			{
				if (value != null && Directory.Exists(value))
				{
					lastScriptExportLocation = Path.GetFullPath(value);
				}
			}
		}

		public BatchInfo GetBatchInfo(int layerIdx)
		{
			if (layerIdx >= 0 && layerIdx < GrBuildLib.Constants.MaxLayers)
			{
				BatchInfo batchInfo = batchImportInfo[layerIdx];
				if (batchInfo != null)
				{
					return batchInfo;
				}
			}
			return new BatchInfo();
		}

		public void SetBatchInfo(int layerIdx, BatchInfo value)
		{
			if (layerIdx >= 0 && layerIdx < GrBuildLib.Constants.MaxLayers && value != null)
			{
				batchImportInfo[layerIdx] = value;
			}
		}

		private void Reset()
		{
			lastSingleAssetImportLocation = null;
			lastScriptImportLocation = null;
			lastScriptExportLocation = null;
			if (batchImportInfo != null)
			{
				for (int i = 0; i < GrBuildLib.Constants.MaxLayers; i++)
				{
					batchImportInfo[i] = null;
				}
			}
		}

		public ProjectSettings(ProjectBuilder projectBuilder)
		{
			builder = projectBuilder;
			batchImportInfo = new BatchInfo[GrBuildLib.Constants.MaxLayers];
			Reset();
		}

		public void Save()
		{
			try
			{
				string fullPath = Path.GetFullPath(Path.Combine(builder.GetProjectPath(), GrBuildLib.Constants.StateDirName));
				if (!Directory.Exists(fullPath))
				{
					Directory.CreateDirectory(fullPath);
				}
				string filename = Path.Combine(fullPath, Constants.ProjectSettingFile);
				XmlDocument xmlDocument = new XmlDocument();
				xmlDocument.AppendChild(xmlDocument.CreateXmlDeclaration("1.0", "UTF-8", null));
				XmlElement xmlElement = xmlDocument.CreateElement("Project");
				xmlElement.SetAttribute("Guid", builder.ActiveProject.Id.ToString());
				xmlElement.SetAttribute("SettingsVersion", versionNumber.ToString());
				XmlNode xmlNode = xmlDocument.CreateElement("SingleImportAsset");
				xmlNode.InnerText = SingleAssetImportLocation;
				xmlElement.AppendChild(xmlNode);
				XmlNode xmlNode2 = xmlDocument.CreateElement("ImportDialog");
				xmlNode2.InnerText = ImportScriptLocation;
				xmlElement.AppendChild(xmlNode2);
				XmlNode xmlNode3 = xmlDocument.CreateElement("ExportDialog");
				xmlNode3.InnerText = ExportScriptLocation;
				xmlElement.AppendChild(xmlNode3);
				BatchInfo[] array = batchImportInfo;
				for (int i = 0; i < array.Length; i++)
				{
					array[i]?.Save(xmlDocument, xmlElement);
				}
				xmlDocument.AppendChild(xmlElement);
				xmlDocument.Save(filename);
			}
			catch
			{
			}
		}

		public void Load()
		{
			if (builder == null)
			{
				return;
			}
			string fullPath = Path.GetFullPath(Path.Combine(builder.GetProjectPath(), GrBuildLib.Constants.StateDirName));
			if (!Directory.Exists(fullPath))
			{
				return;
			}
			string text = Path.Combine(fullPath, Constants.ProjectSettingFile);
			if (!File.Exists(text))
			{
				return;
			}
			try
			{
				ConfigXmlDocument configXmlDocument = new ConfigXmlDocument();
				configXmlDocument.Load(text);
				int num = -1;
				Guid guid = Guid.Empty;
				XmlNode xmlNode = configXmlDocument.SelectSingleNode("/Project");
				if (xmlNode != null && xmlNode.Attributes["Guid"] != null)
				{
					guid = XMLParsingTools.ParseGuidAttribute("Guid", xmlNode);
				}
				if (xmlNode != null && xmlNode.Attributes["SettingsVersion"] != null)
				{
					num = Convert.ToInt32(xmlNode.Attributes["SettingsVersion"].Value);
				}
				if (guid == Guid.Empty || builder.ActiveProject.Id != guid)
				{
					throw new Exception();
				}
				if (num < 0)
				{
					throw new Exception();
				}
				if (num < 2)
				{
					XmlNodeList xmlNodeList = xmlNode.SelectNodes("LayerDialogLocation");
					if (xmlNodeList.Count < 1)
					{
						throw new Exception();
					}
					SingleAssetImportLocation = xmlNodeList[0].InnerText;
				}
				else
				{
					XmlNode xmlNode2 = xmlNode.SelectSingleNode("SingleImportAsset");
					if (xmlNode2 != null)
					{
						SingleAssetImportLocation = xmlNode2.InnerText;
					}
				}
				XmlNode xmlNode3 = xmlNode.SelectSingleNode("ImportDialog");
				if (xmlNode3 != null)
				{
					ImportScriptLocation = xmlNode3.InnerText;
				}
				XmlNode xmlNode4 = xmlNode.SelectSingleNode("ExportDialog");
				if (xmlNode4 != null)
				{
					ExportScriptLocation = xmlNode4.InnerText;
				}
				XmlNodeList xmlNodeList2 = xmlNode.SelectNodes(BatchInfo.NodeName);
				if (xmlNodeList2.Count != builder.ActiveProject.LayerConfiguration.Layers.Count)
				{
					throw new Exception();
				}
				for (int i = 0; i < Math.Min(GrBuildLib.Constants.MaxLayers, xmlNodeList2.Count); i++)
				{
					batchImportInfo[i] = BatchInfo.Load(xmlNodeList2[i]);
				}
			}
			catch
			{
				Reset();
			}
		}
	}
	public class SolutionSettings
	{
		private Dictionary<Guid, ProjectSettings> projects = new Dictionary<Guid, ProjectSettings>();

		public ProjectSettings this[Guid projectID]
		{
			get
			{
				if (projects.ContainsKey(projectID))
				{
					return projects[projectID];
				}
				return null;
			}
			set
			{
				projects[projectID] = value;
			}
		}

		public SolutionSettings()
		{
		}

		public SolutionSettings(SolutionModel model, Solution solution)
		{
			foreach (SolutionProjectDecriptor value2 in solution.Projects.Values)
			{
				ProjectSettings value = new ProjectSettings(model.SolutionBuilder.ProjectBuilders[value2.Id]);
				projects.Add(value2.Id, value);
			}
		}

		public void Save()
		{
			foreach (ProjectSettings value in projects.Values)
			{
				value.Save();
			}
		}

		public void Load()
		{
			foreach (ProjectSettings value in projects.Values)
			{
				value.Load();
			}
		}

		public void Remove(Guid projectId)
		{
			if (projects.ContainsKey(projectId))
			{
				projects[projectId].Save();
				projects.Remove(projectId);
			}
		}
	}
	public class UserSettings
	{
		private SolutionModel model;

		public SolutionSettings Solution { get; private set; }

		public UserSettings(SolutionModel model)
		{
			this.model = model;
			Solution = null;
		}

		public void OnSolutionClosing(object sender, Solution solution)
		{
			if (Solution != null)
			{
				Solution.Save();
			}
		}

		public void OnSolutionLoaded(object sender, Solution solution)
		{
			Solution = new SolutionSettings(model, solution);
			Solution.Load();
		}

		public void OnProjectAddedToSolution(object sender, SolutionProjectDecriptor project, ProjectBuilder builder, bool isNew)
		{
			Solution[project.Id] = new ProjectSettings(builder);
		}

		public void OnProjectRemovedFromSolution(object sender, SolutionProjectDecriptor project)
		{
			Solution.Remove(project.Id);
		}
	}
}
namespace GrBuildStudio.Tools
{
	internal class AssemblyHelper
	{
		public static string AssemblyTitle
		{
			get
			{
				object[] customAttributes = Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(AssemblyTitleAttribute), inherit: false);
				if (customAttributes.Length != 0)
				{
					AssemblyTitleAttribute assemblyTitleAttribute = (AssemblyTitleAttribute)customAttributes[0];
					if (assemblyTitleAttribute.Title != "")
					{
						return assemblyTitleAttribute.Title;
					}
				}
				return Path.GetFileNameWithoutExtension(Assembly.GetExecutingAssembly().CodeBase);
			}
		}

		public static string AssemblyInformationalVersion
		{
			get
			{
				object[] customAttributes = Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(AssemblyInformationalVersionAttribute), inherit: false);
				if (customAttributes.Length == 0)
				{
					return "";
				}
				return ((AssemblyInformationalVersionAttribute)customAttributes[0]).InformationalVersion;
			}
		}

		public static string AssemblyDescription
		{
			get
			{
				object[] customAttributes = Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(AssemblyDescriptionAttribute), inherit: false);
				if (customAttributes.Length == 0)
				{
					return "";
				}
				return ((AssemblyDescriptionAttribute)customAttributes[0]).Description;
			}
		}

		public static string AssemblyProduct
		{
			get
			{
				object[] customAttributes = Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(AssemblyProductAttribute), inherit: false);
				if (customAttributes.Length == 0)
				{
					return "";
				}
				return ((AssemblyProductAttribute)customAttributes[0]).Product;
			}
		}

		public static string AssemblyCopyright
		{
			get
			{
				object[] customAttributes = Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(AssemblyCopyrightAttribute), inherit: false);
				if (customAttributes.Length == 0)
				{
					return "";
				}
				return ((AssemblyCopyrightAttribute)customAttributes[0]).Copyright;
			}
		}

		public static string AssemblyCompany
		{
			get
			{
				object[] customAttributes = Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(AssemblyCompanyAttribute), inherit: false);
				if (customAttributes.Length == 0)
				{
					return "";
				}
				return ((AssemblyCompanyAttribute)customAttributes[0]).Company;
			}
		}
	}
	internal class ClipboardHelper
	{
		public static void CopyText(string text)
		{
			Thread thread = new Thread((ThreadStart)delegate
			{
				Clipboard.SetText(text);
			});
			thread.SetApartmentState(ApartmentState.STA);
			thread.Start();
			thread.Join();
		}
	}
	public enum FormMode
	{
		ChildWindow,
		Standalone
	}
	public enum SourceMode
	{
		SingleSource,
		MultiSource,
		MultiSource3,
		MultiSource4
	}
	internal class ShellTools
	{
		public static void OpenExplorerAndSelect(string filename)
		{
			string arguments = $"/e, /select, \"{filename}\"";
			System.Diagnostics.Process.Start("explorer", arguments);
		}

		public static void OpenExplorer(string path)
		{
			string arguments = $"\"{path}\"";
			System.Diagnostics.Process.Start("explorer", arguments);
		}

		public static void OpenGTSInViewer(string filename)
		{
			System.Diagnostics.Process.Start(filename);
		}

		public static string GetGtsPath(ProjectBuilder builder)
		{
			if (builder.ActiveProject == null)
			{
				return null;
			}
			string fullPath = Path.GetFullPath(builder.ActiveProject.BuildConfiguration.OutputDirectory);
			string outputFilename = builder.ActiveProject.BuildConfiguration.OutputFilename;
			return Path.Combine(fullPath, outputFilename);
		}

		public static void OpenGTSInViewer(ProjectBuilder builder)
		{
			string gtsPath = GetGtsPath(builder);
			if (gtsPath != null && File.Exists(gtsPath))
			{
				OpenGTSInViewer(gtsPath);
			}
		}

		public static void OpenGtsInExplorer(ProjectBuilder builder)
		{
			string gtsPath = GetGtsPath(builder);
			if (gtsPath != null)
			{
				if (File.Exists(gtsPath))
				{
					OpenExplorerAndSelect(gtsPath);
				}
				else
				{
					OpenExplorer(Paths.GetDirectoryName(gtsPath));
				}
			}
		}

		public static string MakePathRelative(string filePath, string referencePath)
		{
			Uri uri = new Uri(filePath);
			return new Uri(referencePath).MakeRelativeUri(uri).ToString();
		}

		public static string GetAbsolutePath(string path1, string path2)
		{
			string text = Path.DirectorySeparatorChar.ToString();
			string text2 = Path.GetFullPath(path1);
			if (!text2.EndsWith(text))
			{
				text2 += text;
			}
			return Path.GetFullPath(Path.Combine(Paths.GetDirectoryName(text2), path2));
		}

		public static string StringToBytes(string input)
		{
			string text = input.ToLower();
			text.Replace(" ", "");
			text.Replace(",", ".");
			if (Regex.Match(text, "^[0-9]+([.][0-9]+)?(gb|mb|kb|b)$").Success)
			{
				Regex.Match(text, "(gb|mb|kb|b)");
			}
			return text;
		}

		public static string ShortenPathname(string pathname, int maxLength)
		{
			if (pathname.Length <= maxLength)
			{
				return pathname;
			}
			string text = Path.GetPathRoot(pathname);
			if (text.Length > 3)
			{
				text += Path.DirectorySeparatorChar;
			}
			string[] array = pathname.Substring(text.Length).Split(Path.DirectorySeparatorChar, Path.AltDirectorySeparatorChar);
			int num = array.GetLength(0) - 1;
			if (array.GetLength(0) == 1)
			{
				if (array[0].Length > 5)
				{
					if (text.Length + 6 >= maxLength)
					{
						return text + array[0].Substring(0, 3) + "...";
					}
					return pathname.Substring(0, maxLength - 3) + "...";
				}
				return pathname;
			}
			if (text.Length + 4 + array[num].Length > maxLength)
			{
				text += "...\\";
				int length = array[num].Length;
				if (length < 6)
				{
					return text + array[num];
				}
				length = ((text.Length + 6 < maxLength) ? (maxLength - text.Length - 3) : 3);
				return text + array[num].Substring(0, length) + "...";
			}
			if (array.GetLength(0) == 2)
			{
				return text + "...\\" + array[1];
			}
			int num2 = 0;
			int num3 = 0;
			for (int i = 0; i < num; i++)
			{
				if (array[i].Length > num2)
				{
					num3 = i;
					num2 = array[i].Length;
				}
			}
			int num4 = pathname.Length - num2 + 3;
			int num5 = num3 + 1;
			while (num4 > maxLength)
			{
				if (num3 > 0)
				{
					num4 -= array[--num3].Length - 1;
				}
				if (num4 <= maxLength)
				{
					break;
				}
				if (num5 < num)
				{
					num4 -= array[++num5].Length - 1;
				}
				if (num3 == 0 && num5 == num)
				{
					break;
				}
			}
			for (int j = 0; j < num3; j++)
			{
				text = text + array[j] + "\\";
			}
			text += "...\\";
			for (int k = num5; k < num; k++)
			{
				text = text + array[k] + "\\";
			}
			return text + array[num];
		}
	}
	internal class UserExperience
	{
		public static string SuggestProjectName(SolutionModel currentSolution)
		{
			string defaultTileSetName = Constants.DefaultTileSetName;
			string text = defaultTileSetName;
			int num = 0;
			while (currentSolution.HasProject(text))
			{
				text = $"{defaultTileSetName}{++num}";
			}
			return text;
		}

		public static string SuggestProjectNameOnDisk(string path)
		{
			string defaultTileSetName = Constants.DefaultTileSetName;
			int num = 0;
			string text = defaultTileSetName;
			while (Directory.Exists(Path.Combine(Path.GetFullPath(path), text)))
			{
				text = $"{defaultTileSetName}{++num}";
			}
			return text;
		}

		public static string SuggestSolutionName(string path)
		{
			string defaultSolutionName = Constants.DefaultSolutionName;
			int num = 1;
			string text = $"{defaultSolutionName}{num}.{Constants.SolutionExtension}";
			while (File.Exists(Path.Combine(Path.GetFullPath(path), text)))
			{
				text = $"{defaultSolutionName}{++num}.{Constants.SolutionExtension}";
			}
			return text;
		}
	}
	internal class DialogUtil
	{
		private static string lastSolutionLocation;

		public static string SolutionOpenDialogFilter => "GrBuildStudio Solution (*.grsln)|*.grsln";

		public static string ImportScriptOpenDialogFilter => "GrBuild Import Script (*.xml, *.grscript)|*.xml;*.grscript|All Files (*.*)|*.*";

		public static string SolutionLocation
		{
			get
			{
				if (lastSolutionLocation == null || !Directory.Exists(lastSolutionLocation))
				{
					lastSolutionLocation = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Personal), "Graphine");
				}
				return lastSolutionLocation;
			}
			set
			{
				if (Directory.Exists(value))
				{
					lastSolutionLocation = Path.GetFullPath(value);
				}
			}
		}
	}
	internal class GrimTools
	{
		public static string[] GetSupportedExtensions()
		{
			int numSupportedFormats = ImageFactory.GetNumSupportedFormats();
			string[] array = new string[numSupportedFormats];
			for (int i = 0; i < numSupportedFormats; i++)
			{
				array[i] = ImageFactory.GetSupportedFormatExtension(i);
			}
			return array;
		}

		public static string GetExtensionsFilterString()
		{
			string[] supportedExtensions = GetSupportedExtensions();
			return "*" + string.Join(";*", supportedExtensions);
		}

		public static string GetCompleteFilterString()
		{
			return string.Format("Image Files ({0})|{0}|All Files (*.*)|*.*", GetExtensionsFilterString());
		}
	}
	public abstract class ObservableList<T> : IEnumerable<T>, IEnumerable
	{
		public delegate void ItemAddedEventHandler(object sender, T Item);

		public delegate void ItemRemovedEventHandler(object sender, T Item);

		public delegate void ItemsClearedEventHandler(object sender);

		protected List<T> items = new List<T>();

		public event ItemAddedEventHandler ItemAdded;

		public event ItemRemovedEventHandler ItemRemoved;

		public event ItemsClearedEventHandler ItemsCleared;

		protected virtual void OnItemAdded(T r)
		{
			this.ItemAdded?.Invoke(this, r);
		}

		protected virtual void OnItemRemoved(T r)
		{
			this.ItemRemoved?.Invoke(this, r);
		}

		protected virtual void OnItemsCleared()
		{
			this.ItemsCleared?.Invoke(this);
		}

		public IEnumerator<T> GetEnumerator()
		{
			return items.GetEnumerator();
		}

		public T[] ToArray()
		{
			return items.ToArray();
		}

		public void Add(T item)
		{
			items.Add(item);
			OnItemAdded(item);
		}

		public void Remove(T item)
		{
			items.Remove(item);
			OnItemRemoved(item);
		}

		public void Clear()
		{
			items.Clear();
			OnItemsCleared();
		}

		public int IndexOf(T item)
		{
			return items.IndexOf(item);
		}

		IEnumerator IEnumerable.GetEnumerator()
		{
			return items.GetEnumerator();
		}
	}
}
namespace GrBuildStudio.Properties
{
	[GeneratedCode("System.Resources.Tools.StronglyTypedResourceBuilder", "4.0.0.0")]
	[DebuggerNonUserCode]
	[CompilerGenerated]
	public class Resources
	{
		private static ResourceManager resourceMan;

		private static CultureInfo resourceCulture;

		[EditorBrowsable(EditorBrowsableState.Advanced)]
		public static ResourceManager ResourceManager
		{
			get
			{
				if (resourceMan == null)
				{
					resourceMan = new ResourceManager("GrBuildStudio.Properties.Resources", typeof(Resources).Assembly);
				}
				return resourceMan;
			}
		}

		[EditorBrowsable(EditorBrowsableState.Advanced)]
		public static CultureInfo Culture
		{
			get
			{
				return resourceCulture;
			}
			set
			{
				resourceCulture = value;
			}
		}

		public static Bitmap about_logo => (Bitmap)ResourceManager.GetObject("about_logo", resourceCulture);

		public static Bitmap add => (Bitmap)ResourceManager.GetObject("add", resourceCulture);

		public static Bitmap asset_built => (Bitmap)ResourceManager.GetObject("asset_built", resourceCulture);

		public static Bitmap asset_built_info => (Bitmap)ResourceManager.GetObject("asset_built_info", resourceCulture);

		public static Bitmap asset_error => (Bitmap)ResourceManager.GetObject("asset_error", resourceCulture);

		public static Bitmap asset_imported => (Bitmap)ResourceManager.GetObject("asset_imported", resourceCulture);

		public static Bitmap asset_info => (Bitmap)ResourceManager.GetObject("asset_info", resourceCulture);

		public static Bitmap asset_partially_built => (Bitmap)ResourceManager.GetObject("asset_partially_built", resourceCulture);

		public static Bitmap asset_partially_built_info => (Bitmap)ResourceManager.GetObject("asset_partially_built_info", resourceCulture);

		public static Bitmap asset_unknown => (Bitmap)ResourceManager.GetObject("asset_unknown", resourceCulture);

		public static Bitmap asset_warning => (Bitmap)ResourceManager.GetObject("asset_warning", resourceCulture);

		public static Bitmap bar_tilesetviewer => (Bitmap)ResourceManager.GetObject("bar_tilesetviewer", resourceCulture);

		public static Bitmap big_warning => (Bitmap)ResourceManager.GetObject("big_warning", resourceCulture);

		public static Bitmap BlueMarble_tile => (Bitmap)ResourceManager.GetObject("BlueMarble_tile", resourceCulture);

		public static Bitmap build => (Bitmap)ResourceManager.GetObject("build", resourceCulture);

		public static Bitmap bullet_green => (Bitmap)ResourceManager.GetObject("bullet_green", resourceCulture);

		public static Bitmap clean => (Bitmap)ResourceManager.GetObject("clean", resourceCulture);

		public static Bitmap cross => (Bitmap)ResourceManager.GetObject("cross", resourceCulture);

		public static Bitmap database_refresh => (Bitmap)ResourceManager.GetObject("database_refresh", resourceCulture);

		public static Bitmap delete => (Bitmap)ResourceManager.GetObject("delete", resourceCulture);

		public static Bitmap disk => (Bitmap)ResourceManager.GetObject("disk", resourceCulture);

		public static Bitmap error => (Bitmap)ResourceManager.GetObject("error", resourceCulture);

		public static Bitmap error_add => (Bitmap)ResourceManager.GetObject("error_add", resourceCulture);

		public static Bitmap exclamation => (Bitmap)ResourceManager.GetObject("exclamation", resourceCulture);

		public static Bitmap exclamation_octagon_fram => (Bitmap)ResourceManager.GetObject("exclamation_octagon_fram", resourceCulture);

		public static Bitmap folder_picture => (Bitmap)ResourceManager.GetObject("folder_picture", resourceCulture);

		public static Bitmap icon_readonly => (Bitmap)ResourceManager.GetObject("icon_readonly", resourceCulture);

		public static Bitmap image_add => (Bitmap)ResourceManager.GetObject("image_add", resourceCulture);

		public static Bitmap info => (Bitmap)ResourceManager.GetObject("info", resourceCulture);

		public static Bitmap magnifier => (Bitmap)ResourceManager.GetObject("magnifier", resourceCulture);

		public static Bitmap page_white_database => (Bitmap)ResourceManager.GetObject("page_white_database", resourceCulture);

		public static Bitmap page_white_gear => (Bitmap)ResourceManager.GetObject("page_white_gear", resourceCulture);

		public static Bitmap page_white_star => (Bitmap)ResourceManager.GetObject("page_white_star", resourceCulture);

		public static Bitmap Preview => (Bitmap)ResourceManager.GetObject("Preview", resourceCulture);

		public static Bitmap rebuild => (Bitmap)ResourceManager.GetObject("rebuild", resourceCulture);

		public static Bitmap table_delete => (Bitmap)ResourceManager.GetObject("table_delete", resourceCulture);

		public static string TT_A_TAG => ResourceManager.GetString("TT_A_TAG", resourceCulture);

		public static string TT_BATCHIMPORT_FOLDER => ResourceManager.GetString("TT_BATCHIMPORT_FOLDER", resourceCulture);

		public static string TT_BATCHIMPORT_MATCHINGFILES => ResourceManager.GetString("TT_BATCHIMPORT_MATCHINGFILES", resourceCulture);

		public static string TT_BATCHIMPORT_NAMETEMPLATE => ResourceManager.GetString("TT_BATCHIMPORT_NAMETEMPLATE", resourceCulture);

		public static string TT_BATCHIMPORT_TEMPLATE => ResourceManager.GetString("TT_BATCHIMPORT_TEMPLATE", resourceCulture);

		public static string TT_BUILD_ICON => ResourceManager.GetString("TT_BUILD_ICON", resourceCulture);

		public static string TT_BUILDPROFILE_COMBOBOX => ResourceManager.GetString("TT_BUILDPROFILE_COMBOBOX", resourceCulture);

		public static string TT_BUILDSUMMARY_OUTPUTFILES => ResourceManager.GetString("TT_BUILDSUMMARY_OUTPUTFILES", resourceCulture);

		public static string TT_BUILDSUMMARY_OUTPUTPATH => ResourceManager.GetString("TT_BUILDSUMMARY_OUTPUTPATH", resourceCulture);

		public static string TT_BUILDSUMMARY_SIZE => ResourceManager.GetString("TT_BUILDSUMMARY_SIZE", resourceCulture);

		public static string TT_CLEAN_ICON => ResourceManager.GetString("TT_CLEAN_ICON", resourceCulture);

		public static string TT_CODINGPROFILE_COMBOBOX => ResourceManager.GetString("TT_CODINGPROFILE_COMBOBOX", resourceCulture);

		public static string TT_CUSTOMLAYOUT_CHECKLAYER => ResourceManager.GetString("TT_CUSTOMLAYOUT_CHECKLAYER", resourceCulture);

		public static string TT_CUSTOMLAYOUT_CODINGPROFILE => ResourceManager.GetString("TT_CUSTOMLAYOUT_CODINGPROFILE", resourceCulture);

		public static string TT_CUSTOMLAYOUT_DATATYPE => ResourceManager.GetString("TT_CUSTOMLAYOUT_DATATYPE", resourceCulture);

		public static string TT_CUSTOMLAYOUT_DEFAULTCOLOR => ResourceManager.GetString("TT_CUSTOMLAYOUT_DEFAULTCOLOR", resourceCulture);

		public static string TT_CUSTOMLAYOUT_LAYERNAME => ResourceManager.GetString("TT_CUSTOMLAYOUT_LAYERNAME", resourceCulture);

		public static string TT_CUSTOMLAYOUT_QUALITYPROFILE => ResourceManager.GetString("TT_CUSTOMLAYOUT_QUALITYPROFILE", resourceCulture);

		public static string TT_FILTER => ResourceManager.GetString("TT_FILTER", resourceCulture);

		public static string TT_GTEXOUTPUTFOLDER_LABEL => ResourceManager.GetString("TT_GTEXOUTPUTFOLDER_LABEL", resourceCulture);

		public static string TT_IMPORT_ICON => ResourceManager.GetString("TT_IMPORT_ICON", resourceCulture);

		public static string TT_LAYERASSETDETAILS_CONTROL => ResourceManager.GetString("TT_LAYERASSETDETAILS_CONTROL", resourceCulture);

		public static string TT_NEW_ICON => ResourceManager.GetString("TT_NEW_ICON", resourceCulture);

		public static string TT_NEWPROJECT_LAYERLIST => ResourceManager.GetString("TT_NEWPROJECT_LAYERLIST", resourceCulture);

		public static string TT_NEWPROJECT_SOLUTIONLOCATION => ResourceManager.GetString("TT_NEWPROJECT_SOLUTIONLOCATION", resourceCulture);

		public static string TT_NEWPROJECT_SOLUTIONNAME => ResourceManager.GetString("TT_NEWPROJECT_SOLUTIONNAME", resourceCulture);

		public static string TT_NEWPROJECT_TILESETNAME => ResourceManager.GetString("TT_NEWPROJECT_TILESETNAME", resourceCulture);

		public static string TT_NO_TOOLTIP => ResourceManager.GetString("TT_NO_TOOLTIP", resourceCulture);

		public static string TT_OPEN_ICON => ResourceManager.GetString("TT_OPEN_ICON", resourceCulture);

		public static string TT_OPENGTS_ICON => ResourceManager.GetString("TT_OPENGTS_ICON", resourceCulture);

		public static string TT_OPTION_FLIP => ResourceManager.GetString("TT_OPTION_FLIP", resourceCulture);

		public static string TT_OPTION_LAYER_TARGETSIZE => ResourceManager.GetString("TT_OPTION_LAYER_TARGETSIZE", resourceCulture);

		public static string TT_OPTION_MIPMAPSOURCE => ResourceManager.GetString("TT_OPTION_MIPMAPSOURCE", resourceCulture);

		public static string TT_OPTION_QUALITYLEVEL => ResourceManager.GetString("TT_OPTION_QUALITYLEVEL", resourceCulture);

		public static string TT_OPTION_SWIZZLE => ResourceManager.GetString("TT_OPTION_SWIZZLE", resourceCulture);

		public static string TT_OPTION_TILINGMETHOD => ResourceManager.GetString("TT_OPTION_TILINGMETHOD", resourceCulture);

		public static string TT_OUTPUTFILE_LABEL => ResourceManager.GetString("TT_OUTPUTFILE_LABEL", resourceCulture);

		public static string TT_PAGEFOLDER_LABEL => ResourceManager.GetString("TT_PAGEFOLDER_LABEL", resourceCulture);

		public static string TT_PROPERTIES_HIGHQUALCODING => ResourceManager.GetString("TT_PROPERTIES_HIGHQUALCODING", resourceCulture);

		public static string TT_PROPERTIES_INDIE_TILEHEIGHT => ResourceManager.GetString("TT_PROPERTIES_INDIE_TILEHEIGHT", resourceCulture);

		public static string TT_PROPERTIES_INDIE_TILEWIDTH => ResourceManager.GetString("TT_PROPERTIES_INDIE_TILEWIDTH", resourceCulture);

		public static string TT_PROPERTIES_MIPSTRIPPING => ResourceManager.GetString("TT_PROPERTIES_MIPSTRIPPING", resourceCulture);

		public static string TT_PROPERTIES_NOREDIRECTION => ResourceManager.GetString("TT_PROPERTIES_NOREDIRECTION", resourceCulture);

		public static string TT_PROPERTIES_NOSHAREDMIPS => ResourceManager.GetString("TT_PROPERTIES_NOSHAREDMIPS", resourceCulture);

		public static string TT_PROPERTIES_PATCHING => ResourceManager.GetString("TT_PROPERTIES_PATCHING", resourceCulture);

		public static string TT_PROPERTIES_TILEHEIGHT => ResourceManager.GetString("TT_PROPERTIES_TILEHEIGHT", resourceCulture);

		public static string TT_PROPERTIES_TILEWIDTH => ResourceManager.GetString("TT_PROPERTIES_TILEWIDTH", resourceCulture);

		public static string TT_REBUILD_ICON => ResourceManager.GetString("TT_REBUILD_ICON", resourceCulture);

		public static string TT_RESCAN_ICON => ResourceManager.GetString("TT_RESCAN_ICON", resourceCulture);

		public static string TT_SINGLEASSET_DESC_LABEL => ResourceManager.GetString("TT_SINGLEASSET_DESC_LABEL", resourceCulture);

		public static string TT_SINGLEASSET_NAME_COMBOBOX => ResourceManager.GetString("TT_SINGLEASSET_NAME_COMBOBOX", resourceCulture);

		public static string TT_SINGLEASSET_TEMPLATE_TBOX => ResourceManager.GetString("TT_SINGLEASSET_TEMPLATE_TBOX", resourceCulture);

		public static string TT_TARGET_COMBOBOX => ResourceManager.GetString("TT_TARGET_COMBOBOX", resourceCulture);

		public static string TT_UNIFORMCODING_CHECKBOX => ResourceManager.GetString("TT_UNIFORMCODING_CHECKBOX", resourceCulture);

		public static Bitmap warning => (Bitmap)ResourceManager.GetObject("warning", resourceCulture);

		internal Resources()
		{
		}
	}
	[CompilerGenerated]
	[GeneratedCode("Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator", "12.0.0.0")]
	internal sealed class Settings : ApplicationSettingsBase
	{
		private static Settings defaultInstance = (Settings)SettingsBase.Synchronized(new Settings());

		public static Settings Default => defaultInstance;
	}
}
namespace GrBuildStudio.Controls
{
	public class BatchTemplateControl : UserControl
	{
		public delegate void UpdateTemplateHandler(object sender, EventArgs e, int subtextureIndex);

		private readonly string[] defaultTemplates = new string[4] { "*.jpg", "*", "*_n.jpg", "n_*" };

		private ComboBox[] comboBoxes = new ComboBox[4];

		private SourceMode sourceMode;

		private IContainer components;

		private ComboBox channel0ComboBox;

		private ComboBox channel1ComboBox;

		private ComboBox channel3ComboBox;

		private ComboBox channel2ComboBox;

		public SourceMode ActiveSourceMode
		{
			get
			{
				return sourceMode;
			}
			set
			{
				UpdateSourceMode(sourceMode, value);
			}
		}

		public event UpdateTemplateHandler UpdateTemplate;

		public string GetTemplate(int subtextureIndex)
		{
			if (subtextureIndex < 0 || subtextureIndex >= 4)
			{
				return null;
			}
			return comboBoxes[subtextureIndex].Text;
		}

		public BatchTemplateControl()
		{
			InitializeComponent();
			comboBoxes[0] = channel0ComboBox;
			comboBoxes[1] = channel1ComboBox;
			comboBoxes[2] = channel2ComboBox;
			comboBoxes[3] = channel3ComboBox;
			ActiveSourceMode = sourceMode;
		}

		public void Init(ToolTip ToolTip, string p, int layerIndex, BatchInfo batchInfo)
		{
			for (int i = 0; i < comboBoxes.Length; i++)
			{
				string[] array = null;
				List<string> list = batchInfo.GetChannelInfo(i).Templates.Where((string _str) => !string.IsNullOrEmpty(_str)).ToList();
				if (list.Count != 0)
				{
					array = new string[list.Count];
					int num = 0;
					foreach (string item in list)
					{
						array[num++] = item;
					}
				}
				else
				{
					array = defaultTemplates;
				}
				ComboBox comboBox = comboBoxes[i];
				comboBox.TabIndex = 10 * (layerIndex + 1) + 4;
				comboBox.Text = array[0];
				comboBox.DisplayMember = "Text";
				for (int j = 0; j < array.Length; j++)
				{
					ComboItem comboItem = new ComboItem();
					comboItem.Text = array[j];
					comboItem.ForeColor = System.Drawing.Color.Black;
					comboBox.Items.Add(comboItem);
				}
				comboBox.Tag = i;
				comboBox.Leave += onUpdateTemplate;
				comboBox.KeyPress += onKeyPress;
				comboBox.SelectedIndexChanged += onUpdateTemplate;
			}
		}

		private void UpdateSourceMode(SourceMode from, SourceMode to)
		{
			sourceMode = to;
			bool[] array = new bool[4]
			{
				true,
				sourceMode == SourceMode.MultiSource || sourceMode == SourceMode.MultiSource3 || sourceMode == SourceMode.MultiSource4,
				sourceMode == SourceMode.MultiSource3 || sourceMode == SourceMode.MultiSource4,
				sourceMode == SourceMode.MultiSource4
			};
			for (int i = 0; i < 4; i++)
			{
				comboBoxes[i].Visible = array[i];
			}
			int num = 3;
			int num2 = 20;
			int num3 = 6;
			int num4 = 0;
			int num5 = 25;
			base.Size = new Size(height: sourceMode switch
			{
				SourceMode.MultiSource4 => num + num2 * 4 + 3 * num3 + num4, 
				SourceMode.MultiSource3 => num + num2 * 3 + 2 * num3 + num4, 
				SourceMode.MultiSource => num + num2 * 2 + num3 + num4, 
				_ => num + num2 + num4, 
			}, width: base.Size.Width);
		}

		private void onKeyPress(object sender, KeyPressEventArgs e)
		{
			if (e.KeyChar == Convert.ToChar(Keys.Return))
			{
				onUpdateTemplate(sender, e);
			}
		}

		private void onUpdateTemplate(object sender, EventArgs e)
		{
			int subtextureIndex = (int)((ComboBox)sender).Tag;
			if (this.UpdateTemplate != null)
			{
				this.UpdateTemplate(this, e, subtextureIndex);
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.channel0ComboBox = new System.Windows.Forms.ComboBox();
			this.channel1ComboBox = new System.Windows.Forms.ComboBox();
			this.channel3ComboBox = new System.Windows.Forms.ComboBox();
			this.channel2ComboBox = new System.Windows.Forms.ComboBox();
			base.SuspendLayout();
			this.channel0ComboBox.FormattingEnabled = true;
			this.channel0ComboBox.Location = new System.Drawing.Point(5, 3);
			this.channel0ComboBox.Name = "channel0ComboBox";
			this.channel0ComboBox.Size = new System.Drawing.Size(130, 21);
			this.channel0ComboBox.TabIndex = 0;
			this.channel1ComboBox.FormattingEnabled = true;
			this.channel1ComboBox.Location = new System.Drawing.Point(5, 28);
			this.channel1ComboBox.Name = "channel1ComboBox";
			this.channel1ComboBox.Size = new System.Drawing.Size(130, 21);
			this.channel1ComboBox.TabIndex = 1;
			this.channel3ComboBox.FormattingEnabled = true;
			this.channel3ComboBox.Location = new System.Drawing.Point(5, 78);
			this.channel3ComboBox.Name = "channel3ComboBox";
			this.channel3ComboBox.Size = new System.Drawing.Size(130, 21);
			this.channel3ComboBox.TabIndex = 2;
			this.channel2ComboBox.FormattingEnabled = true;
			this.channel2ComboBox.Location = new System.Drawing.Point(5, 53);
			this.channel2ComboBox.Name = "channel2ComboBox";
			this.channel2ComboBox.Size = new System.Drawing.Size(130, 21);
			this.channel2ComboBox.TabIndex = 3;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.channel2ComboBox);
			base.Controls.Add(this.channel3ComboBox);
			base.Controls.Add(this.channel1ComboBox);
			base.Controls.Add(this.channel0ComboBox);
			base.Name = "BatchTemplateControl";
			base.Size = new System.Drawing.Size(140, 103);
			base.ResumeLayout(false);
		}
	}
	public class ChannelPickerControl : UserControl
	{
		public enum FileFolderMode
		{
			File,
			Folder
		}

		public delegate void PickedHandler(object sender, EventArgs e, int subtextureIndex);

		public delegate void PickedResetHandler(object sender, int idx);

		public delegate void PickedUpdateHandler(object sender, EventArgs e, int subtextureIndex);

		public delegate void SourceModeChangedHandler(object sender, SourceMode mode);

		public delegate bool SourceModeChangingDelegate(object sender, SourceMode from, SourceMode to);

		public delegate void PickerFileDroppedHandler(object sender, int subIndex, string filePath);

		private SourceMode sourceMode;

		private ContextMenuStrip contextMenu;

		private Dictionary<AssetPackingMode, ChannelMerging.ChannelMask> allPossibileMasks = new Dictionary<AssetPackingMode, ChannelMerging.ChannelMask>();

		private string fullDatatypeName = string.Empty;

		private bool maskableDatatype;

		private DataType dataType;

		private IContainer components;

		private PickerControl channel1Picker;

		private PickerControl channel0Picker;

		private Button buttonSelectSource;

		private Label channel0Label;

		private Label channel1Label;

		private GroupBox groupLine;

		private PickerControl channel2Picker;

		private PickerControl channel3Picker;

		private Label channel2Label;

		private Label channel3Label;

		public SourceMode ActiveSourceMode
		{
			get
			{
				return sourceMode;
			}
			set
			{
				UpdateSourceMode(sourceMode, value);
			}
		}

		public bool ReadOnly
		{
			set
			{
				channel0Picker.DisplayTextBox.ReadOnly = value;
				channel1Picker.DisplayTextBox.ReadOnly = value;
				channel2Picker.DisplayTextBox.ReadOnly = value;
				channel3Picker.DisplayTextBox.ReadOnly = value;
			}
		}

		public event PickedHandler PickerPicked;

		public event PickedResetHandler PickerReset;

		public event PickedUpdateHandler PickerUpdate;

		public event SourceModeChangedHandler SourceModeChanged;

		public event SourceModeChangingDelegate SourceModeChanging;

		public event PickerFileDroppedHandler PickerFileDropped;

		public void SetDisplayText(int subtexIndex, string text)
		{
			switch (ActiveSourceMode)
			{
			case SourceMode.SingleSource:
				channel0Picker.DisplayTextBox.Text = text;
				break;
			case SourceMode.MultiSource:
				if (subtexIndex == 0)
				{
					channel0Picker.DisplayTextBox.Text = text;
				}
				else
				{
					channel1Picker.DisplayTextBox.Text = text;
				}
				break;
			case SourceMode.MultiSource3:
				switch (subtexIndex)
				{
				case 0:
					channel0Picker.DisplayTextBox.Text = text;
					break;
				case 1:
					channel1Picker.DisplayTextBox.Text = text;
					break;
				case 2:
					channel2Picker.DisplayTextBox.Text = text;
					break;
				}
				break;
			case SourceMode.MultiSource4:
				switch (subtexIndex)
				{
				case 0:
					channel0Picker.DisplayTextBox.Text = text;
					break;
				case 1:
					channel1Picker.DisplayTextBox.Text = text;
					break;
				case 2:
					channel2Picker.DisplayTextBox.Text = text;
					break;
				case 3:
					channel3Picker.DisplayTextBox.Text = text;
					break;
				}
				break;
			}
		}

		public string GetDisplayText(int subTexIndex)
		{
			switch (ActiveSourceMode)
			{
			case SourceMode.SingleSource:
				return channel0Picker.DisplayTextBox.Text;
			case SourceMode.MultiSource:
				if (subTexIndex == 0)
				{
					return channel0Picker.DisplayTextBox.Text;
				}
				return channel1Picker.DisplayTextBox.Text;
			case SourceMode.MultiSource3:
				switch (subTexIndex)
				{
				case 0:
					return channel0Picker.DisplayTextBox.Text;
				case 1:
					return channel1Picker.DisplayTextBox.Text;
				case 2:
					return channel2Picker.DisplayTextBox.Text;
				}
				break;
			case SourceMode.MultiSource4:
				switch (subTexIndex)
				{
				case 0:
					return channel0Picker.DisplayTextBox.Text;
				case 1:
					return channel1Picker.DisplayTextBox.Text;
				case 2:
					return channel2Picker.DisplayTextBox.Text;
				case 3:
					return channel3Picker.DisplayTextBox.Text;
				}
				break;
			}
			return null;
		}

		public ChannelPickerControl(DataType _dataType)
		{
			InitializeComponent();
			dataType = _dataType;
			ChannelMerging.GetAllChannelMasks(dataType, ref allPossibileMasks);
			maskableDatatype = allPossibileMasks.Count > 0;
			if (maskableDatatype)
			{
				fullDatatypeName = ChannelMerging.GetDataTypeChannelNames(dataType);
				CreateContextMenu();
				UpdateLabels();
			}
			ActiveSourceMode = SourceMode.SingleSource;
			UpdateVisibility();
		}

		public void Init(ToolTip ToolTip, string ToolTipBodyText, int layerIndex, FileFolderMode fileFolderMode)
		{
			PickerControl[] array = new PickerControl[4] { channel0Picker, channel1Picker, channel2Picker, channel3Picker };
			for (int i = 0; i < 4; i++)
			{
				ToolTip.SetSuperTooltip(array[i].DisplayTextBox, new SuperTooltipInfo("", "", ToolTipBodyText, null, null, ToolTip.DefaultTooltipSettings.Color));
				array[i].ChooseButton.Text = "Choose";
				array[i].ChooseButton.TabIndex = 10 * (layerIndex + 1) + 2;
				array[i].DisplayTextBox.TabIndex = 10 * (layerIndex + 1);
				array[i].DisplayTextBox.ReadOnly = true;
				array[i].DisplayTextBox.Text = "Empty";
				array[i].DisplayTextBox.KeyPress += channelPicker_KeyPress;
				array[i].AllowFileDrop = fileFolderMode == FileFolderMode.File;
				array[i].AllowFolderDrop = fileFolderMode == FileFolderMode.Folder;
			}
		}

		public void Reset()
		{
			for (int i = 0; i < 4; i++)
			{
				SetDisplayText(i, "Empty");
				pickers_Reset(i);
			}
		}

		private void UpdateVisibility()
		{
			buttonSelectSource.Visible = maskableDatatype;
			bool visible = maskableDatatype && (sourceMode == SourceMode.MultiSource || sourceMode == SourceMode.MultiSource3 || sourceMode == SourceMode.MultiSource4);
			bool visible2 = maskableDatatype && (sourceMode == SourceMode.MultiSource3 || sourceMode == SourceMode.MultiSource4);
			bool visible3 = maskableDatatype && sourceMode == SourceMode.MultiSource4;
			channel1Picker.Visible = visible;
			channel1Label.Visible = visible;
			channel2Picker.Visible = visible2;
			channel2Label.Visible = visible2;
			channel3Picker.Visible = visible3;
			channel3Label.Visible = visible3;
			groupLine.Visible = visible;
			int num = 2;
			int num2 = channel1Picker.Location.X - num;
			Point location = channel0Picker.Location;
			location.X = (maskableDatatype ? channel1Picker.Location.X : num);
			Size size = channel1Picker.Size;
			size.Width = (maskableDatatype ? channel1Picker.Size.Width : (channel1Picker.Size.Width + num2));
			channel0Picker.Location = location;
			channel0Picker.Size = size;
			int num3 = 3;
			int num4 = 20;
			int num5 = 6;
			int num6 = 0;
			int num7 = 25;
			base.Size = new Size(height: sourceMode switch
			{
				SourceMode.MultiSource4 => num3 + num4 * 4 + 3 * num5 + num6, 
				SourceMode.MultiSource3 => num3 + num4 * 3 + 2 * num5 + num6, 
				SourceMode.MultiSource => num3 + num4 * 2 + num5 + num6, 
				_ => num3 + num4 + num6, 
			}, width: base.Size.Width);
		}

		private void UpdateSourceMode(SourceMode from, SourceMode to)
		{
			sourceMode = to;
			OnSourceModeChanged(to);
			UpdateVisibility();
			UpdateLabels();
			UpdateContextMenu();
		}

		private void CreateContextMenu()
		{
			contextMenu = new ContextMenuStrip();
			ToolStripMenuItem toolStripMenuItem = new ToolStripMenuItem();
			toolStripMenuItem.Checked = true;
			toolStripMenuItem.Text = $"Single Source ({fullDatatypeName})";
			toolStripMenuItem.Click += src_Click;
			toolStripMenuItem.Tag = SourceMode.SingleSource;
			contextMenu.Items.Add(toolStripMenuItem);
			if (allPossibileMasks.ContainsKey(AssetPackingMode.Combined))
			{
				ChannelMerging.ChannelMask channelMask = allPossibileMasks[AssetPackingMode.Combined];
				ToolStripMenuItem toolStripMenuItem2 = new ToolStripMenuItem();
				toolStripMenuItem2.Text = string.Format("Multiple Sources ({0} + {1})", new string[2]
				{
					channelMask.humanReadable[0],
					channelMask.humanReadable[1]
				});
				toolStripMenuItem2.Checked = false;
				toolStripMenuItem2.Click += src_Click;
				toolStripMenuItem2.Tag = SourceMode.MultiSource;
				contextMenu.Items.Add(toolStripMenuItem2);
			}
			if (allPossibileMasks.ContainsKey(AssetPackingMode.Combined3))
			{
				ChannelMerging.ChannelMask channelMask2 = allPossibileMasks[AssetPackingMode.Combined3];
				ToolStripMenuItem toolStripMenuItem3 = new ToolStripMenuItem();
				toolStripMenuItem3.Text = string.Format("Multiple Sources ({0} + {1} + {2})", new string[3]
				{
					channelMask2.humanReadable[0],
					channelMask2.humanReadable[1],
					channelMask2.humanReadable[2]
				});
				toolStripMenuItem3.Checked = false;
				toolStripMenuItem3.Click += src_Click;
				toolStripMenuItem3.Tag = SourceMode.MultiSource3;
				contextMenu.Items.Add(toolStripMenuItem3);
			}
			if (allPossibileMasks.ContainsKey(AssetPackingMode.Combined4))
			{
				ChannelMerging.ChannelMask channelMask3 = allPossibileMasks[AssetPackingMode.Combined4];
				ToolStripMenuItem toolStripMenuItem4 = new ToolStripMenuItem();
				toolStripMenuItem4.Text = string.Format("Multiple Sources ({0} + {1} + {2} + {3})", channelMask3.humanReadable);
				toolStripMenuItem4.Checked = false;
				toolStripMenuItem4.Click += src_Click;
				toolStripMenuItem4.Tag = SourceMode.MultiSource4;
				contextMenu.Items.Add(toolStripMenuItem4);
			}
		}

		private void UpdateLabels()
		{
			Label[] array = new Label[4] { channel0Label, channel1Label, channel2Label, channel3Label };
			if (ActiveSourceMode == SourceMode.SingleSource)
			{
				array[0].Text = fullDatatypeName;
				array[1].Text = string.Empty;
			}
			else if (ActiveSourceMode == SourceMode.MultiSource)
			{
				if (allPossibileMasks.ContainsKey(AssetPackingMode.Combined))
				{
					ChannelMerging.ChannelMask channelMask = allPossibileMasks[AssetPackingMode.Combined];
					array[0].Text = channelMask.humanReadable[0];
					array[1].Text = channelMask.humanReadable[1];
				}
			}
			else if (ActiveSourceMode == SourceMode.MultiSource3)
			{
				if (allPossibileMasks.ContainsKey(AssetPackingMode.Combined3))
				{
					ChannelMerging.ChannelMask channelMask2 = allPossibileMasks[AssetPackingMode.Combined3];
					array[0].Text = channelMask2.humanReadable[0];
					array[1].Text = channelMask2.humanReadable[1];
					array[2].Text = channelMask2.humanReadable[2];
				}
			}
			else if (ActiveSourceMode == SourceMode.MultiSource4 && allPossibileMasks.ContainsKey(AssetPackingMode.Combined4))
			{
				ChannelMerging.ChannelMask channelMask3 = allPossibileMasks[AssetPackingMode.Combined4];
				array[0].Text = channelMask3.humanReadable[0];
				array[1].Text = channelMask3.humanReadable[1];
				array[2].Text = channelMask3.humanReadable[2];
				array[3].Text = channelMask3.humanReadable[3];
			}
		}

		private void UpdateContextMenu()
		{
			if (contextMenu == null)
			{
				return;
			}
			SourceMode activeSourceMode = ActiveSourceMode;
			foreach (ToolStripMenuItem item in contextMenu.Items)
			{
				item.Checked = (SourceMode)item.Tag == activeSourceMode;
			}
		}

		private void src_Click(object sender, EventArgs e)
		{
			SourceMode sourceMode = (SourceMode)((ToolStripMenuItem)sender).Tag;
			if (OnSourceModeChanging(this, ActiveSourceMode, sourceMode))
			{
				ActiveSourceMode = sourceMode;
			}
		}

		private void options_Click(object sender, EventArgs e)
		{
			if (contextMenu != null)
			{
				contextMenu.Show(Control.MousePosition);
			}
		}

		private void pickers_Picked(object sender, EventArgs e, int subtextureIndex)
		{
			if (this.PickerPicked != null)
			{
				this.PickerPicked(this, e, subtextureIndex);
			}
		}

		private void pickers_Reset(int idx)
		{
			if (this.PickerReset != null)
			{
				this.PickerReset(this, idx);
			}
		}

		private void pickers_Update(object sender, EventArgs e, int subtextureIndex)
		{
			if (this.PickerUpdate != null)
			{
				this.PickerUpdate(this, e, subtextureIndex);
			}
		}

		private void OnSourceModeChanged(SourceMode mode)
		{
			if (this.SourceModeChanged != null)
			{
				this.SourceModeChanged(this, mode);
			}
		}

		private bool OnSourceModeChanging(object sender, SourceMode from, SourceMode to)
		{
			if (this.SourceModeChanging != null)
			{
				return this.SourceModeChanging(this, from, to);
			}
			return true;
		}

		private void channelPicker_Picked(object sender, EventArgs e)
		{
			PickerControl pickerControl = (PickerControl)sender;
			pickers_Picked(sender, e, (int)pickerControl.Tag);
		}

		private void channelPicker_Leave(object sender, EventArgs e)
		{
			PickerControl pickerControl = (PickerControl)sender;
			pickers_Update(sender, e, (int)pickerControl.Tag);
		}

		private void channelPicker_KeyPress(object sender, KeyPressEventArgs e)
		{
			if (e.KeyChar == Convert.ToChar(Keys.Return))
			{
				PickerControl pickerControl = (PickerControl)sender;
				pickers_Update(sender, e, (int)pickerControl.Tag);
			}
		}

		private void OnPickerFileDropped(object sender, int subIndex, string filePath)
		{
			if (this.PickerFileDropped != null)
			{
				this.PickerFileDropped(this, subIndex, filePath);
			}
		}

		private void channelPicker_FileDropped(object sender, string filePath)
		{
			PickerControl pickerControl = (PickerControl)sender;
			OnPickerFileDropped(this, (int)pickerControl.Tag, filePath);
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.buttonSelectSource = new System.Windows.Forms.Button();
			this.channel0Label = new System.Windows.Forms.Label();
			this.channel1Label = new System.Windows.Forms.Label();
			this.groupLine = new System.Windows.Forms.GroupBox();
			this.channel0Picker = new GrBuildStudio.Controls.PickerControl();
			this.channel1Picker = new GrBuildStudio.Controls.PickerControl();
			this.channel2Picker = new GrBuildStudio.Controls.PickerControl();
			this.channel3Picker = new GrBuildStudio.Controls.PickerControl();
			this.channel2Label = new System.Windows.Forms.Label();
			this.channel3Label = new System.Windows.Forms.Label();
			base.SuspendLayout();
			this.buttonSelectSource.Font = new System.Drawing.Font("Microsoft Sans Serif", 6f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			this.buttonSelectSource.Location = new System.Drawing.Point(1, 5);
			this.buttonSelectSource.Margin = new System.Windows.Forms.Padding(0);
			this.buttonSelectSource.Name = "buttonSelectSource";
			this.buttonSelectSource.Size = new System.Drawing.Size(14, 14);
			this.buttonSelectSource.TabIndex = 0;
			this.buttonSelectSource.Text = "â¼";
			this.buttonSelectSource.UseVisualStyleBackColor = true;
			this.buttonSelectSource.Click += new System.EventHandler(options_Click);
			this.channel0Label.AutoSize = true;
			this.channel0Label.Location = new System.Drawing.Point(23, 7);
			this.channel0Label.Name = "channel0Label";
			this.channel0Label.Size = new System.Drawing.Size(30, 13);
			this.channel0Label.TabIndex = 1;
			this.channel0Label.Text = "RGB";
			this.channel1Label.AutoSize = true;
			this.channel1Label.Location = new System.Drawing.Point(23, 32);
			this.channel1Label.Name = "channel1Label";
			this.channel1Label.Size = new System.Drawing.Size(14, 13);
			this.channel1Label.TabIndex = 3;
			this.channel1Label.Text = "A";
			this.channel2Label.AutoSize = true;
			this.channel2Label.Location = new System.Drawing.Point(23, 57);
			this.channel2Label.Name = "channel2Label";
			this.channel2Label.Size = new System.Drawing.Size(15, 13);
			this.channel2Label.TabIndex = 5;
			this.channel2Label.Text = "G";
			this.channel3Label.AutoSize = true;
			this.channel3Label.Location = new System.Drawing.Point(24, 83);
			this.channel3Label.Name = "channel3Label";
			this.channel3Label.Size = new System.Drawing.Size(14, 13);
			this.channel3Label.TabIndex = 7;
			this.channel3Label.Text = "B";
			this.groupLine.Location = new System.Drawing.Point(18, 0);
			this.groupLine.Name = "groupLine";
			this.groupLine.Size = new System.Drawing.Size(2, 102);
			this.groupLine.TabIndex = 12;
			this.groupLine.TabStop = false;
			this.channel0Picker.AllowFileDrop = true;
			this.channel0Picker.AllowFolderDrop = false;
			this.channel0Picker.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.channel0Picker.Location = new System.Drawing.Point(65, 3);
			this.channel0Picker.Name = "channel0Picker";
			this.channel0Picker.Size = new System.Drawing.Size(210, 20);
			this.channel0Picker.TabIndex = 2;
			this.channel0Picker.Template = null;
			this.channel0Picker.Picked += new System.EventHandler(channelPicker_Picked);
			this.channel0Picker.FileDropped += new GrBuildStudio.Controls.PickerControl.FileDroppedHandler(channelPicker_FileDropped);
			this.channel0Picker.Leave += new System.EventHandler(channelPicker_Leave);
			this.channel0Picker.Tag = 0;
			this.channel1Picker.AllowFileDrop = true;
			this.channel1Picker.AllowFolderDrop = false;
			this.channel1Picker.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.channel1Picker.Location = new System.Drawing.Point(65, 29);
			this.channel1Picker.Name = "channel1Picker";
			this.channel1Picker.Size = new System.Drawing.Size(210, 20);
			this.channel1Picker.TabIndex = 4;
			this.channel1Picker.Template = null;
			this.channel1Picker.Picked += new System.EventHandler(channelPicker_Picked);
			this.channel1Picker.FileDropped += new GrBuildStudio.Controls.PickerControl.FileDroppedHandler(channelPicker_FileDropped);
			this.channel1Picker.Leave += new System.EventHandler(channelPicker_Leave);
			this.channel1Picker.Tag = 1;
			this.channel2Picker.AllowFileDrop = true;
			this.channel2Picker.AllowFolderDrop = false;
			this.channel2Picker.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.channel2Picker.Location = new System.Drawing.Point(65, 55);
			this.channel2Picker.Name = "channel2Picker";
			this.channel2Picker.Size = new System.Drawing.Size(210, 20);
			this.channel2Picker.TabIndex = 6;
			this.channel2Picker.Template = null;
			this.channel2Picker.Picked += new System.EventHandler(channelPicker_Picked);
			this.channel2Picker.FileDropped += new GrBuildStudio.Controls.PickerControl.FileDroppedHandler(channelPicker_FileDropped);
			this.channel2Picker.Leave += new System.EventHandler(channelPicker_Leave);
			this.channel2Picker.Tag = 2;
			this.channel3Picker.AllowFileDrop = true;
			this.channel3Picker.AllowFolderDrop = false;
			this.channel3Picker.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.channel3Picker.Location = new System.Drawing.Point(65, 81);
			this.channel3Picker.Name = "channel3Picker";
			this.channel3Picker.Size = new System.Drawing.Size(210, 20);
			this.channel3Picker.TabIndex = 8;
			this.channel3Picker.Template = null;
			this.channel3Picker.Picked += new System.EventHandler(channelPicker_Picked);
			this.channel3Picker.FileDropped += new GrBuildStudio.Controls.PickerControl.FileDroppedHandler(channelPicker_FileDropped);
			this.channel3Picker.Leave += new System.EventHandler(channelPicker_Leave);
			this.channel3Picker.Tag = 3;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.channel3Label);
			base.Controls.Add(this.channel2Label);
			base.Controls.Add(this.channel3Picker);
			base.Controls.Add(this.channel2Picker);
			base.Controls.Add(this.channel0Picker);
			base.Controls.Add(this.groupLine);
			base.Controls.Add(this.channel1Picker);
			base.Controls.Add(this.channel1Label);
			base.Controls.Add(this.buttonSelectSource);
			base.Controls.Add(this.channel0Label);
			base.Name = "ChannelPickerControl";
			base.Size = new System.Drawing.Size(277, 101);
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	internal class ComboBoxHelper
	{
		private class ComboBoxItem
		{
			public string Text { get; set; }

			public object Tag { get; set; }

			public ComboBoxItem()
			{
				Text = string.Empty;
				Tag = null;
			}

			public ComboBoxItem(string text)
			{
				Text = text;
				Tag = null;
			}

			public ComboBoxItem(string text, object tag)
			{
				Text = text;
				Tag = tag;
			}

			public override string ToString()
			{
				return Text;
			}
		}

		internal static T GetSelectedEnumValue<T>(ComboBox combo)
		{
			ComboBoxItem comboBoxItem = (ComboBoxItem)combo.SelectedItem;
			if (comboBoxItem == null)
			{
				return (T)System.Enum.Parse(typeof(T), combo.SelectedText);
			}
			return (T)comboBoxItem.Tag;
		}

		internal static string GetSelectedValue(ComboBox combo)
		{
			ComboBoxItem comboBoxItem = (ComboBoxItem)combo.SelectedItem;
			if (comboBoxItem == null)
			{
				return combo.SelectedText;
			}
			return (string)comboBoxItem.Tag;
		}

		internal static T GetSelectedValue<T>(ComboBox combo)
		{
			return (T)((ComboBoxItem)combo.SelectedItem).Tag;
		}

		internal static void FillEnumComboBox<T>(ComboBox combo)
		{
			combo.Items.Clear();
			new List<T>();
			Array values = System.Enum.GetValues(typeof(T));
			for (int i = 0; i < values.Length; i++)
			{
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				T val = (T)values.GetValue(i);
				comboBoxItem.Text = val.ToString();
				comboBoxItem.Tag = val;
				combo.Items.Add(comboBoxItem);
			}
		}

		internal static void FillEnumComboBox<T>(ComboBox combo, Func<T, string> toString)
		{
			combo.Items.Clear();
			new List<T>();
			Array values = System.Enum.GetValues(typeof(T));
			for (int i = 0; i < values.Length; i++)
			{
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				T val = (T)values.GetValue(i);
				comboBoxItem.Text = toString(val);
				comboBoxItem.Tag = val;
				combo.Items.Add(comboBoxItem);
			}
		}

		internal static void FillComboBox<T>(ComboBox combo, List<T> list)
		{
			combo.Items.Clear();
			foreach (T item in list)
			{
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				comboBoxItem.Text = item.ToString();
				comboBoxItem.Tag = item;
				combo.Items.Add(comboBoxItem);
			}
		}

		internal static void FillComboBox<T>(ComboBox combo, T[] values, string[] strings)
		{
			if (values.Length != strings.Length)
			{
				throw new Exception("Both lists values and strings need to be equal size");
			}
			combo.Items.Clear();
			for (int i = 0; i < values.Length; i++)
			{
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				comboBoxItem.Text = strings[i];
				comboBoxItem.Tag = values[i];
				combo.Items.Add(comboBoxItem);
			}
		}

		internal static void FillComboBox<T>(ComboBox combo, List<T> values, List<string> strings)
		{
			FillComboBox(combo, values.ToArray(), strings.ToArray());
		}

		internal static void FillComboBox(ComboBox combo, List<string> list)
		{
			combo.Items.Clear();
			foreach (string item in list)
			{
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				comboBoxItem.Text = item;
				comboBoxItem.Tag = item;
				combo.Items.Add(comboBoxItem);
			}
		}

		internal static void FillComboboxValues<T>(ComboBox combo, List<T> values, Func<T, string> toString)
		{
			combo.Items.Clear();
			foreach (T value in values)
			{
				ComboBoxItem comboBoxItem = new ComboBoxItem();
				comboBoxItem.Text = toString(value);
				comboBoxItem.Tag = value;
				combo.Items.Add(comboBoxItem);
			}
		}

		internal static void AddComboboxValue<T>(ComboBox combo, T value, string text)
		{
			ComboBoxItem comboBoxItem = new ComboBoxItem();
			comboBoxItem.Text = text;
			comboBoxItem.Tag = value;
			combo.Items.Add(comboBoxItem);
		}

		internal static void SelectComboBoxItem(ComboBox combo, object tag)
		{
			for (int i = 0; i < combo.Items.Count; i++)
			{
				ComboBoxItem comboBoxItem = (ComboBoxItem)combo.Items[i];
				if (comboBoxItem != null && comboBoxItem.Tag.Equals(tag))
				{
					combo.SelectedIndex = i;
					break;
				}
			}
		}

		internal static void SelectComboBoxItem<T>(ComboBox combo, T tag)
		{
			for (int i = 0; i < combo.Items.Count; i++)
			{
				ComboBoxItem comboBoxItem = (ComboBoxItem)combo.Items[i];
				if (comboBoxItem != null && comboBoxItem.Tag.Equals(tag))
				{
					combo.SelectedIndex = i;
					break;
				}
			}
		}

		internal static void SelectComboBoxItem<T>(ComboBox combo, Func<T, bool> selector)
		{
			for (int i = 0; i < combo.Items.Count; i++)
			{
				ComboBoxItem comboBoxItem = (ComboBoxItem)combo.Items[i];
				if (comboBoxItem != null && selector((T)comboBoxItem.Tag))
				{
					combo.SelectedIndex = i;
					break;
				}
			}
		}
	}
	public class InvertChannelsControl : UserControl
	{
		public delegate void OnValuesChangedDelegate(object sender, EventArgs e);

		private bool loading;

		private IContainer components;

		private CheckBoxX checkBox1;

		private CheckBoxX checkBox2;

		private CheckBoxX checkBox3;

		private CheckBoxX checkBox4;

		public int maxChannels { get; private set; }

		public string InvertValue { get; private set; }

		public event OnValuesChangedDelegate ValuesChanged;

		public InvertChannelsControl()
		{
			InitializeComponent();
		}

		public void Initialize(int numChannelsActive, string captions, string invertValues)
		{
			maxChannels = numChannelsActive;
			loading = true;
			SetValues(invertValues);
			LoadCaptions(captions);
			loading = false;
			checkBox1.Visible = numChannelsActive > 0;
			checkBox2.Visible = numChannelsActive > 1;
			checkBox3.Visible = numChannelsActive > 2;
			checkBox4.Visible = numChannelsActive > 3;
		}

		private bool BitValue(string s, int index)
		{
			if (s.Length <= index)
			{
				return false;
			}
			return s[index].Equals('1');
		}

		private string BitsToString(bool[] bits)
		{
			StringBuilder stringBuilder = new StringBuilder();
			foreach (bool flag in bits)
			{
				stringBuilder.Append(flag ? "1" : "0");
			}
			return stringBuilder.ToString();
		}

		private void LoadCaptions(string captions)
		{
			CheckBoxX[] array = new CheckBoxX[4] { checkBox1, checkBox2, checkBox3, checkBox4 };
			for (int i = 0; i < 4; i++)
			{
				if (captions.Length > i)
				{
					array[i].Text = captions[i].ToString();
				}
			}
		}

		private void SetValues(string invertValues)
		{
			if (string.IsNullOrEmpty(invertValues))
			{
				invertValues = "0000";
			}
			CheckBoxX[] array = new CheckBoxX[4] { checkBox1, checkBox2, checkBox3, checkBox4 };
			for (int i = 0; i < 4; i++)
			{
				array[i].Visible = maxChannels > i;
				if (maxChannels > i)
				{
					array[i].Checked = BitValue(invertValues, i);
				}
			}
			InvertValue = invertValues;
			OnValuesChanged();
		}

		private string GetValues()
		{
			bool[] array = new bool[4];
			CheckBoxX[] array2 = new CheckBoxX[4] { checkBox1, checkBox2, checkBox3, checkBox4 };
			for (int i = 0; i < 4; i++)
			{
				array[i] = array2[i].Checked;
			}
			return BitsToString(array);
		}

		private void checkBox1_CheckedChanged(object sender, EventArgs e)
		{
			if (!loading)
			{
				InvertValue = GetValues();
				OnValuesChanged();
			}
		}

		private void checkBox2_CheckedChanged(object sender, EventArgs e)
		{
			if (!loading)
			{
				InvertValue = GetValues();
				OnValuesChanged();
			}
		}

		private void checkBox3_CheckedChanged(object sender, EventArgs e)
		{
			if (!loading)
			{
				InvertValue = GetValues();
				OnValuesChanged();
			}
		}

		private void checkBox4_CheckedChanged(object sender, EventArgs e)
		{
			if (!loading)
			{
				InvertValue = GetValues();
				OnValuesChanged();
			}
		}

		private void OnValuesChanged()
		{
			this.ValuesChanged?.Invoke(this, new EventArgs());
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.checkBox1 = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.checkBox2 = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.checkBox3 = new DevComponents.DotNetBar.Controls.CheckBoxX();
			this.checkBox4 = new DevComponents.DotNetBar.Controls.CheckBoxX();
			base.SuspendLayout();
			this.checkBox1.AutoSize = true;
			this.checkBox1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.checkBox1.Location = new System.Drawing.Point(0, 0);
			this.checkBox1.Name = "checkBox1";
			this.checkBox1.Size = new System.Drawing.Size(30, 15);
			this.checkBox1.TabIndex = 0;
			this.checkBox1.Text = "R";
			this.checkBox1.CheckedChanged += new System.EventHandler(checkBox1_CheckedChanged);
			this.checkBox2.AutoSize = true;
			this.checkBox2.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.checkBox2.Location = new System.Drawing.Point(40, 0);
			this.checkBox2.Name = "checkBox2";
			this.checkBox2.Size = new System.Drawing.Size(31, 15);
			this.checkBox2.TabIndex = 1;
			this.checkBox2.Text = "G";
			this.checkBox2.CheckedChanged += new System.EventHandler(checkBox2_CheckedChanged);
			this.checkBox3.AutoSize = true;
			this.checkBox3.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.checkBox3.Location = new System.Drawing.Point(80, 0);
			this.checkBox3.Name = "checkBox3";
			this.checkBox3.Size = new System.Drawing.Size(30, 15);
			this.checkBox3.TabIndex = 2;
			this.checkBox3.Text = "B";
			this.checkBox3.CheckedChanged += new System.EventHandler(checkBox3_CheckedChanged);
			this.checkBox4.AutoSize = true;
			this.checkBox4.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.checkBox4.Location = new System.Drawing.Point(120, 0);
			this.checkBox4.Name = "checkBox4";
			this.checkBox4.Size = new System.Drawing.Size(30, 15);
			this.checkBox4.TabIndex = 3;
			this.checkBox4.Text = "A";
			this.checkBox4.CheckedChanged += new System.EventHandler(checkBox4_CheckedChanged);
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.checkBox4);
			base.Controls.Add(this.checkBox3);
			base.Controls.Add(this.checkBox2);
			base.Controls.Add(this.checkBox1);
			base.Name = "InvertChannelsControl";
			base.Size = new System.Drawing.Size(168, 14);
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	public class SwizzleControl : UserControl
	{
		public delegate void OnSwizzleChangedDelegate(object sender, EventArgs e);

		private ContextMenuStrip contextMenu;

		private bool loading;

		private IContainer components;

		private ComboBox comboBoxSwizzle3;

		private ComboBox comboBoxSwizzle2;

		private ComboBox comboBoxSwizzle1;

		private ComboBox comboBoxSwizzle0;

		private Button buttonOptions;

		public int maxChannels { get; set; }

		public string Swizzle { get; private set; }

		private bool ShowPresetButton { get; set; }

		private SwizzlePreset[] Presets { get; set; }

		public event OnSwizzleChangedDelegate OnSwizzleChanged;

		public SwizzleControl()
		{
			InitializeComponent();
		}

		public void Initialize(int numChannelsActive, string swizzleValue, bool showPresetButton = false, SwizzlePreset[] presets = null)
		{
			maxChannels = numChannelsActive;
			loading = true;
			LoadSwizzle(swizzleValue);
			loading = false;
			Presets = presets;
			ShowPresetButton = showPresetButton;
			buttonOptions.Visible = ShowPresetButton;
			if (ShowPresetButton)
			{
				CreateContextMenu();
			}
		}

		public void LoadSwizzle(string swizzleValue)
		{
			comboBoxSwizzle0.Enabled = maxChannels >= 1;
			comboBoxSwizzle1.Enabled = maxChannels >= 2;
			comboBoxSwizzle2.Enabled = maxChannels >= 3;
			comboBoxSwizzle3.Enabled = maxChannels >= 4;
			if (swizzleValue == null || swizzleValue == string.Empty)
			{
				swizzleValue = "0123";
			}
			if (maxChannels >= 1)
			{
				comboBoxSwizzle0.Text = ((swizzleValue.Length >= 1) ? swizzleValue[0].ToString() : "0");
			}
			if (maxChannels >= 2)
			{
				comboBoxSwizzle1.Text = ((swizzleValue.Length >= 2) ? swizzleValue[1].ToString() : "1");
			}
			if (maxChannels >= 3)
			{
				comboBoxSwizzle2.Text = ((swizzleValue.Length >= 3) ? swizzleValue[2].ToString() : "2");
			}
			if (maxChannels >= 4)
			{
				comboBoxSwizzle3.Text = ((swizzleValue.Length >= 4) ? swizzleValue[3].ToString() : "3");
			}
			Swizzle = swizzleValue;
		}

		private void comboBoxSwizzleX_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (!loading)
			{
				Swizzle = "";
				if (maxChannels >= 1)
				{
					Swizzle += comboBoxSwizzle0.SelectedItem.ToString();
				}
				if (maxChannels >= 2)
				{
					Swizzle += comboBoxSwizzle1.SelectedItem.ToString();
				}
				if (maxChannels >= 3)
				{
					Swizzle += comboBoxSwizzle2.SelectedItem.ToString();
				}
				if (maxChannels >= 4)
				{
					Swizzle += comboBoxSwizzle3.SelectedItem.ToString();
				}
				onSwizzleChanged();
			}
		}

		private void onSwizzleChanged()
		{
			this.OnSwizzleChanged?.Invoke(this, new EventArgs());
		}

		private void buttonOptions_Click(object sender, EventArgs e)
		{
			if (contextMenu != null)
			{
				Point position = new Point(buttonOptions.Size.Width - 1, 1);
				contextMenu.Show(buttonOptions, position);
			}
		}

		private void CreateContextMenu()
		{
			contextMenu = new ContextMenuStrip();
			ToolStripMenuItem toolStripMenuItem = new ToolStripMenuItem();
			toolStripMenuItem.Text = "Presets";
			SwizzlePreset[] swizzlePresets = Constants.SwizzlePresets;
			foreach (SwizzlePreset swizzlePreset in swizzlePresets)
			{
				ToolStripMenuItem toolStripMenuItem2 = new ToolStripMenuItem();
				toolStripMenuItem2.Tag = swizzlePreset;
				toolStripMenuItem2.Text = swizzlePreset.Name;
				toolStripMenuItem2.Click += item_Click;
				toolStripMenuItem.DropDownItems.Add(toolStripMenuItem2);
			}
			contextMenu.Items.Add(toolStripMenuItem);
		}

		private void item_Click(object sender, EventArgs e)
		{
			SwizzlePreset swizzlePreset = (SwizzlePreset)((ToolStripMenuItem)sender).Tag;
			LoadSwizzle(swizzlePreset.Pattern);
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.comboBoxSwizzle3 = new System.Windows.Forms.ComboBox();
			this.comboBoxSwizzle2 = new System.Windows.Forms.ComboBox();
			this.comboBoxSwizzle1 = new System.Windows.Forms.ComboBox();
			this.comboBoxSwizzle0 = new System.Windows.Forms.ComboBox();
			this.buttonOptions = new System.Windows.Forms.Button();
			base.SuspendLayout();
			this.comboBoxSwizzle3.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxSwizzle3.FormattingEnabled = true;
			this.comboBoxSwizzle3.Items.AddRange(new object[4] { "0", "1", "2", "3" });
			this.comboBoxSwizzle3.Location = new System.Drawing.Point(108, 0);
			this.comboBoxSwizzle3.Name = "comboBoxSwizzle3";
			this.comboBoxSwizzle3.Size = new System.Drawing.Size(30, 21);
			this.comboBoxSwizzle3.TabIndex = 56;
			this.comboBoxSwizzle3.SelectedIndexChanged += new System.EventHandler(comboBoxSwizzleX_SelectedIndexChanged);
			this.comboBoxSwizzle2.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxSwizzle2.FormattingEnabled = true;
			this.comboBoxSwizzle2.Items.AddRange(new object[4] { "0", "1", "2", "3" });
			this.comboBoxSwizzle2.Location = new System.Drawing.Point(72, 0);
			this.comboBoxSwizzle2.Name = "comboBoxSwizzle2";
			this.comboBoxSwizzle2.Size = new System.Drawing.Size(30, 21);
			this.comboBoxSwizzle2.TabIndex = 55;
			this.comboBoxSwizzle2.SelectedIndexChanged += new System.EventHandler(comboBoxSwizzleX_SelectedIndexChanged);
			this.comboBoxSwizzle1.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxSwizzle1.FormattingEnabled = true;
			this.comboBoxSwizzle1.Items.AddRange(new object[4] { "0", "1", "2", "3" });
			this.comboBoxSwizzle1.Location = new System.Drawing.Point(36, 0);
			this.comboBoxSwizzle1.Name = "comboBoxSwizzle1";
			this.comboBoxSwizzle1.Size = new System.Drawing.Size(30, 21);
			this.comboBoxSwizzle1.TabIndex = 54;
			this.comboBoxSwizzle1.SelectedIndexChanged += new System.EventHandler(comboBoxSwizzleX_SelectedIndexChanged);
			this.comboBoxSwizzle0.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
			this.comboBoxSwizzle0.FormattingEnabled = true;
			this.comboBoxSwizzle0.Items.AddRange(new object[4] { "0", "1", "2", "3" });
			this.comboBoxSwizzle0.Location = new System.Drawing.Point(0, 0);
			this.comboBoxSwizzle0.Name = "comboBoxSwizzle0";
			this.comboBoxSwizzle0.Size = new System.Drawing.Size(30, 21);
			this.comboBoxSwizzle0.TabIndex = 53;
			this.comboBoxSwizzle0.SelectedIndexChanged += new System.EventHandler(comboBoxSwizzleX_SelectedIndexChanged);
			this.buttonOptions.Font = new System.Drawing.Font("Microsoft Sans Serif", 6f, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, 0);
			this.buttonOptions.Location = new System.Drawing.Point(144, 0);
			this.buttonOptions.Margin = new System.Windows.Forms.Padding(0);
			this.buttonOptions.Name = "buttonOptions";
			this.buttonOptions.Size = new System.Drawing.Size(14, 14);
			this.buttonOptions.TabIndex = 58;
			this.buttonOptions.Text = "â¼";
			this.buttonOptions.Click += new System.EventHandler(buttonOptions_Click);
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.buttonOptions);
			base.Controls.Add(this.comboBoxSwizzle3);
			base.Controls.Add(this.comboBoxSwizzle2);
			base.Controls.Add(this.comboBoxSwizzle1);
			base.Controls.Add(this.comboBoxSwizzle0);
			base.Name = "SwizzleControl";
			base.Size = new System.Drawing.Size(165, 21);
			base.ResumeLayout(false);
		}
	}
	public class SwizzlePreset
	{
		public string Name { get; set; }

		public string Pattern { get; set; }

		public static SwizzlePreset Default => new SwizzlePreset("Default", "0123");

		public static SwizzlePreset RtoA => new SwizzlePreset("Red to Alpha", "0000");

		public static SwizzlePreset BtoA => new SwizzlePreset("Blue to Alpha", "1111");

		public static SwizzlePreset GtoA => new SwizzlePreset("Green to Alpha", "2222");

		public static SwizzlePreset AtoRGB => new SwizzlePreset("Alpha to RGB", "3333");

		public static SwizzlePreset RGBA => new SwizzlePreset("RGBA", "0123");

		public static SwizzlePreset BGRA => new SwizzlePreset("BGRA", "2103");

		public static SwizzlePreset AAAA => new SwizzlePreset("AAAA", "3333");

		public SwizzlePreset(string name, string pattern)
		{
			Name = name;
			Pattern = pattern;
		}
	}
	public class PickerControl : UserControl
	{
		public delegate void FileDroppedHandler(object sender, string filePath);

		private IContainer components;

		private TextBox textBoxDisplay;

		private Button buttonChoose;

		public ImportTemplateInfo Template { get; set; }

		public TextBox DisplayTextBox => textBoxDisplay;

		public Button ChooseButton => buttonChoose;

		public bool AllowFileDrop { get; set; }

		public bool AllowFolderDrop { get; set; }

		public event EventHandler Picked;

		public event FileDroppedHandler FileDropped;

		public PickerControl()
		{
			InitializeComponent();
			textBoxDisplay.ReadOnly = true;
		}

		private void buttonChoose_Click(object sender, EventArgs e)
		{
			OnPicked();
		}

		protected virtual void OnPicked()
		{
			this.Picked?.Invoke(this, new EventArgs());
		}

		private void textBoxDisplay_DragDrop(object sender, DragEventArgs e)
		{
			if (!AllowFileDrop && !AllowFolderDrop)
			{
				return;
			}
			string[] array = (string[])e.Data.GetData(DataFormats.FileDrop, autoConvert: false);
			if (array.Length != 0)
			{
				string text = array[0];
				if (AllowFolderDrop && Directory.Exists(text))
				{
					OnFileDropped(this, text);
				}
				if (AllowFileDrop && File.Exists(text))
				{
					OnFileDropped(this, text);
				}
			}
		}

		private void OnFileDropped(object sender, string filePath)
		{
			if (this.FileDropped != null)
			{
				this.FileDropped(this, filePath);
			}
		}

		private void textBoxDisplay_DragEnter(object sender, DragEventArgs e)
		{
			e.Effect = DragDropEffects.None;
			if (!AllowFileDrop && !AllowFolderDrop)
			{
				return;
			}
			string[] array = (string[])e.Data.GetData(DataFormats.FileDrop, autoConvert: false);
			if (array.Length != 0)
			{
				string path = array[0];
				if (AllowFolderDrop && Directory.Exists(path))
				{
					e.Effect = DragDropEffects.Copy;
				}
				if (AllowFileDrop && File.Exists(path))
				{
					e.Effect = DragDropEffects.Copy;
				}
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.textBoxDisplay = new System.Windows.Forms.TextBox();
			this.buttonChoose = new System.Windows.Forms.Button();
			base.SuspendLayout();
			this.textBoxDisplay.AllowDrop = true;
			this.textBoxDisplay.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.textBoxDisplay.Location = new System.Drawing.Point(0, 0);
			this.textBoxDisplay.Name = "textBoxDisplay";
			this.textBoxDisplay.Size = new System.Drawing.Size(155, 20);
			this.textBoxDisplay.TabIndex = 0;
			this.textBoxDisplay.DragDrop += new System.Windows.Forms.DragEventHandler(textBoxDisplay_DragDrop);
			this.textBoxDisplay.DragEnter += new System.Windows.Forms.DragEventHandler(textBoxDisplay_DragEnter);
			this.buttonChoose.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right;
			this.buttonChoose.Location = new System.Drawing.Point(156, -1);
			this.buttonChoose.Name = "buttonChoose";
			this.buttonChoose.Size = new System.Drawing.Size(60, 22);
			this.buttonChoose.TabIndex = 1;
			this.buttonChoose.Text = "Choose...";
			this.buttonChoose.UseVisualStyleBackColor = true;
			this.buttonChoose.Click += new System.EventHandler(buttonChoose_Click);
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.buttonChoose);
			base.Controls.Add(this.textBoxDisplay);
			base.Name = "PickerControl";
			base.Size = new System.Drawing.Size(215, 20);
			base.ResumeLayout(false);
			base.PerformLayout();
		}
	}
	public class PathBoxControl : UserControl, INotifyPropertyChanged
	{
		public enum PathBoxPathType
		{
			File,
			Folder
		}

		public enum PathBoxLoadSave
		{
			Load,
			Save
		}

		public delegate void PreprocessSelectedPathHandler(object sender, string filePath, out string processedFilePath, out bool accept);

		private string path;

		private IContainer components;

		private TextBoxX textBoxX1;

		public PathBoxPathType PathType { get; set; }

		public PathBoxLoadSave LoadSave { get; set; }

		public FileDialog OpenSaveFileDialog { get; private set; }

		public FolderBrowserDialog FolderBrowserDialog { get; private set; }

		public string Path
		{
			get
			{
				return path;
			}
			set
			{
				path = value;
				NotifyPropertyChanged("Path");
			}
		}

		public event PreprocessSelectedPathHandler PreprocessSelectedPath;

		public event PropertyChangedEventHandler PropertyChanged;

		public PathBoxControl()
			: this(PathBoxPathType.Folder, PathBoxLoadSave.Load)
		{
		}

		public PathBoxControl(PathBoxPathType pathType)
			: this(pathType, PathBoxLoadSave.Load)
		{
		}

		public PathBoxControl(PathBoxLoadSave loadSave)
			: this(PathBoxPathType.Folder, loadSave)
		{
		}

		public PathBoxControl(PathBoxPathType pathType, PathBoxLoadSave loadSave)
		{
			InitializeComponent();
			textBoxX1.DataBindings.Add("Text", this, "Path");
			PathType = pathType;
			LoadSave = loadSave;
			if (loadSave == PathBoxLoadSave.Load)
			{
				OpenSaveFileDialog = new OpenFileDialog();
			}
			else
			{
				OpenSaveFileDialog = new SaveFileDialog();
			}
			FolderBrowserDialog = new FolderBrowserDialog();
		}

		private void OnPreprocessSelectedPath(object sender, string filePath, out string processedFilePath, out bool accept)
		{
			if (this.PreprocessSelectedPath != null)
			{
				this.PreprocessSelectedPath(this, filePath, out processedFilePath, out accept);
				return;
			}
			processedFilePath = filePath;
			accept = true;
		}

		private string PreprocessPath(string path)
		{
			OnPreprocessSelectedPath(this, path, out var processedFilePath, out var accept);
			if (accept)
			{
				return processedFilePath;
			}
			return path;
		}

		private void textBoxX1_ButtonCustomClick(object sender, EventArgs e)
		{
			if (PathType == PathBoxPathType.File)
			{
				FileDialog openSaveFileDialog = OpenSaveFileDialog;
				if (openSaveFileDialog.ShowDialog() == DialogResult.OK)
				{
					textBoxX1.Text = PreprocessPath(openSaveFileDialog.FileName);
					textBoxX1.DataBindings["Text"].WriteValue();
				}
			}
			else if (PathType == PathBoxPathType.Folder)
			{
				FolderBrowserDialog folderBrowserDialog = FolderBrowserDialog;
				folderBrowserDialog.SelectedPath = textBoxX1.Text;
				if (folderBrowserDialog.ShowDialog() == DialogResult.OK)
				{
					textBoxX1.Text = PreprocessPath(folderBrowserDialog.SelectedPath);
					textBoxX1.DataBindings["Text"].WriteValue();
				}
			}
		}

		protected void NotifyPropertyChanged(string propertyName)
		{
			if (this.PropertyChanged != null)
			{
				this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
			}
		}

		protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
		{
			if (keyData == Keys.Return)
			{
				TextBoxBase textBoxBase = base.ActiveControl as TextBoxBase;
				if (textBoxBase == null || !textBoxBase.Multiline)
				{
					textBoxBase.DataBindings["Text"].WriteValue();
					return true;
				}
			}
			return base.ProcessCmdKey(ref msg, keyData);
		}

		private void PathBox_EnabledChanged(object sender, EventArgs e)
		{
			textBoxX1.Enabled = base.Enabled;
			textBoxX1.BackColor = (base.Enabled ? System.Drawing.Color.White : BackColor);
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.textBoxX1 = new DevComponents.DotNetBar.Controls.TextBoxX();
			base.SuspendLayout();
			this.textBoxX1.Anchor = System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right;
			this.textBoxX1.BackColor = System.Drawing.Color.White;
			this.textBoxX1.Border.Class = "TextBoxBorder";
			this.textBoxX1.Border.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.textBoxX1.ButtonCustom.Text = "...";
			this.textBoxX1.ButtonCustom.Visible = true;
			this.textBoxX1.ForeColor = System.Drawing.Color.Black;
			this.textBoxX1.Location = new System.Drawing.Point(0, 0);
			this.textBoxX1.Margin = new System.Windows.Forms.Padding(0);
			this.textBoxX1.Name = "textBoxX1";
			this.textBoxX1.PreventEnterBeep = true;
			this.textBoxX1.Size = new System.Drawing.Size(51, 20);
			this.textBoxX1.TabIndex = 1;
			this.textBoxX1.Text = "Test";
			this.textBoxX1.ButtonCustomClick += new System.EventHandler(textBoxX1_ButtonCustomClick);
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.textBoxX1);
			base.Margin = new System.Windows.Forms.Padding(0);
			base.Name = "PathBox";
			base.Size = new System.Drawing.Size(51, 20);
			base.EnabledChanged += new System.EventHandler(PathBox_EnabledChanged);
			base.ResumeLayout(false);
		}
	}
	public class ScrollableEditList : UserControl
	{
		public class RowItem
		{
			public Control Control { get; private set; }

			public string Text { get; private set; }

			public RowItem(Control control, string text)
			{
				Control = control;
				Text = text;
			}

			public RowItem(Control control)
			{
				Control = control;
				Text = null;
			}

			public RowItem(string text)
			{
				Control = null;
				Text = text;
			}
		}

		public class ColumnItem
		{
			public int Width { get; private set; }

			public string Caption { get; private set; }

			public ColumnItem(string caption, int width)
			{
				Caption = caption;
				Width = width;
			}
		}

		public class Row
		{
			public List<RowItem> RowItems { get; private set; }

			public int Width => RowItems.Count;

			public Row()
			{
				RowItems = new List<RowItem>();
			}
		}

		public class RowCollection : ObservableList<Row>
		{
		}

		public class ColumnCollection : ObservableList<ColumnItem>
		{
		}

		private IContainer components;

		private ButtonItem buttonItem2;

		private ButtonItem buttonItem3;

		private ButtonItem buttonItem4;

		private ButtonItem buttonItem5;

		private ControlContainerItem controlContainerItem3;

		private ButtonItem buttonItem7;

		private ButtonItem buttonItem8;

		private ButtonItem buttonItem9;

		private ButtonItem buttonItem10;

		private ControlContainerItem controlContainerItem1;

		private AdvTree advTree1;

		private DevComponents.AdvTree.ColumnHeader columnHeader5;

		private DevComponents.AdvTree.ColumnHeader columnHeader6;

		private Node node1;

		private Cell cell1;

		private NodeConnector nodeConnector1;

		private ElementStyle elementStyle1;

		private Node node2;

		private Cell cell2;

		private Cell cell3;

		private Cell cell4;

		private DevComponents.AdvTree.ColumnHeader columnHeader7;

		public RowCollection Rows { get; private set; }

		public int ColumnCount { get; private set; }

		public ColumnCollection Columns { get; private set; }

		private void SetColumnHeaders(ColumnItem[] columns)
		{
			advTree1.Columns.Clear();
			for (int i = 0; i < columns.Length; i++)
			{
				DevComponents.AdvTree.ColumnHeader columnHeader = new DevComponents.AdvTree.ColumnHeader();
				columnHeader.Text = columns[i].Caption;
				columnHeader.Name = columns[i].Caption;
				columnHeader.Width.Absolute = columns[i].Width;
				columnHeader.SortingEnabled = false;
				advTree1.Columns.Add(columnHeader);
			}
		}

		public ScrollableEditList()
		{
			InitializeComponent();
			advTree1.Nodes.Clear();
			advTree1.Columns.Clear();
			Rows = new RowCollection();
			Rows.ItemAdded += Rows_RowAdded;
			Rows.ItemRemoved += Rows_RowRemoved;
			Rows.ItemsCleared += Rows_RowsCleared;
			Columns = new ColumnCollection();
			Columns.ItemAdded += Columns_ItemAdded;
			Columns.ItemRemoved += Columns_ItemRemoved;
			Columns.ItemsCleared += Columns_ItemsCleared;
		}

		public void Clear()
		{
			advTree1.Nodes.Clear();
		}

		private void Columns_ItemsCleared(object sender)
		{
			SetColumnHeaders(Columns.ToArray());
		}

		private void Columns_ItemRemoved(object sender, ColumnItem Item)
		{
			SetColumnHeaders(Columns.ToArray());
		}

		private void Columns_ItemAdded(object sender, ColumnItem Item)
		{
			SetColumnHeaders(Columns.ToArray());
		}

		private Node FindNode(Row row)
		{
			foreach (Node node in advTree1.Nodes)
			{
				if ((Row)node.Tag == row)
				{
					return node;
				}
			}
			return null;
		}

		private void Rows_RowRemoved(object sender, Row row)
		{
			Node node = FindNode(row);
			if (node != null)
			{
				advTree1.Nodes.Remove(node);
			}
		}

		private void Rows_RowsCleared(object sender)
		{
			advTree1.Nodes.Clear();
		}

		private void Rows_RowAdded(object sender, Row row)
		{
			Node node = new Node();
			if (row.RowItems.Count > 0)
			{
				for (int i = 0; i < row.Width; i++)
				{
					if (i == 0)
					{
						node.Text = row.RowItems[0].Text;
						if (row.RowItems[i].Control != null)
						{
							node.HostedControl = row.RowItems[i].Control;
						}
						continue;
					}
					Cell cell = new Cell();
					cell.Text = row.RowItems[i].Text;
					if (row.RowItems[i].Control != null)
					{
						cell.HostedControl = row.RowItems[i].Control;
					}
					node.Cells.Add(cell);
				}
			}
			advTree1.Nodes.Add(node);
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			this.buttonItem2 = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItem3 = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItem4 = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItem5 = new DevComponents.DotNetBar.ButtonItem();
			this.controlContainerItem3 = new DevComponents.DotNetBar.ControlContainerItem();
			this.buttonItem7 = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItem8 = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItem9 = new DevComponents.DotNetBar.ButtonItem();
			this.buttonItem10 = new DevComponents.DotNetBar.ButtonItem();
			this.controlContainerItem1 = new DevComponents.DotNetBar.ControlContainerItem();
			this.advTree1 = new DevComponents.AdvTree.AdvTree();
			this.columnHeader5 = new DevComponents.AdvTree.ColumnHeader();
			this.columnHeader6 = new DevComponents.AdvTree.ColumnHeader();
			this.columnHeader7 = new DevComponents.AdvTree.ColumnHeader();
			this.node1 = new DevComponents.AdvTree.Node();
			this.cell1 = new DevComponents.AdvTree.Cell();
			this.cell3 = new DevComponents.AdvTree.Cell();
			this.node2 = new DevComponents.AdvTree.Node();
			this.cell2 = new DevComponents.AdvTree.Cell();
			this.cell4 = new DevComponents.AdvTree.Cell();
			this.nodeConnector1 = new DevComponents.AdvTree.NodeConnector();
			this.elementStyle1 = new DevComponents.DotNetBar.ElementStyle();
			((System.ComponentModel.ISupportInitialize)this.advTree1).BeginInit();
			base.SuspendLayout();
			this.buttonItem2.Checked = true;
			this.buttonItem2.Name = "buttonItem2";
			this.buttonItem2.Text = "None";
			this.buttonItem3.Name = "buttonItem3";
			this.buttonItem3.Text = "Horizontal";
			this.buttonItem4.Name = "buttonItem4";
			this.buttonItem4.Text = "Vertical";
			this.buttonItem5.Name = "buttonItem5";
			this.buttonItem5.Text = "Both";
			this.controlContainerItem3.AllowItemResize = true;
			this.controlContainerItem3.MenuVisibility = DevComponents.DotNetBar.eMenuVisibility.VisibleAlways;
			this.controlContainerItem3.Name = "controlContainerItem3";
			this.controlContainerItem3.Text = "controlContainerItem1";
			this.buttonItem7.Checked = true;
			this.buttonItem7.Name = "buttonItem7";
			this.buttonItem7.Text = "None";
			this.buttonItem8.Name = "buttonItem8";
			this.buttonItem8.Text = "Horizontal";
			this.buttonItem9.Name = "buttonItem9";
			this.buttonItem9.Text = "Vertical";
			this.buttonItem10.Name = "buttonItem10";
			this.buttonItem10.Text = "Both";
			this.controlContainerItem1.AllowItemResize = true;
			this.controlContainerItem1.MenuVisibility = DevComponents.DotNetBar.eMenuVisibility.VisibleAlways;
			this.controlContainerItem1.Name = "controlContainerItem1";
			this.controlContainerItem1.Text = "controlContainerItem1";
			this.advTree1.AccessibleRole = System.Windows.Forms.AccessibleRole.Outline;
			this.advTree1.AllowExternalDrop = false;
			this.advTree1.AllowUserToResizeColumns = false;
			this.advTree1.BackColor = System.Drawing.SystemColors.Window;
			this.advTree1.BackgroundStyle.Class = "TreeBorderKey";
			this.advTree1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.advTree1.Columns.Add(this.columnHeader5);
			this.advTree1.Columns.Add(this.columnHeader6);
			this.advTree1.Columns.Add(this.columnHeader7);
			this.advTree1.Dock = System.Windows.Forms.DockStyle.Fill;
			this.advTree1.DragDropEnabled = false;
			this.advTree1.DragDropNodeCopyEnabled = false;
			this.advTree1.ExpandWidth = 0;
			this.advTree1.FullRowSelect = false;
			this.advTree1.GridColumnLines = false;
			this.advTree1.HideSelection = true;
			this.advTree1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			this.advTree1.Location = new System.Drawing.Point(0, 0);
			this.advTree1.Name = "advTree1";
			this.advTree1.Nodes.AddRange(new DevComponents.AdvTree.Node[2] { this.node1, this.node2 });
			this.advTree1.NodesConnector = this.nodeConnector1;
			this.advTree1.NodeStyle = this.elementStyle1;
			this.advTree1.NodeStyleSelected = this.elementStyle1;
			this.advTree1.PathSeparator = ";";
			this.advTree1.SelectionBox = false;
			this.advTree1.SelectionBoxStyle = DevComponents.AdvTree.eSelectionStyle.FullRowSelect;
			this.advTree1.Size = new System.Drawing.Size(501, 88);
			this.advTree1.Styles.Add(this.elementStyle1);
			this.advTree1.TabIndex = 52;
			this.advTree1.Text = "advTree1";
			this.columnHeader5.Name = "columnHeader5";
			this.columnHeader5.Text = "Layer";
			this.columnHeader5.Width.Absolute = 150;
			this.columnHeader6.Name = "columnHeader6";
			this.columnHeader6.Text = "Path";
			this.columnHeader6.Width.Absolute = 150;
			this.columnHeader7.Name = "columnHeader7";
			this.columnHeader7.Text = "File";
			this.columnHeader7.Width.Absolute = 150;
			this.node1.Cells.Add(this.cell1);
			this.node1.Cells.Add(this.cell3);
			this.node1.Expanded = true;
			this.node1.Name = "node1";
			this.node1.Text = "color";
			this.cell1.Name = "cell1";
			this.cell1.StyleMouseOver = null;
			this.cell1.Text = "Test";
			this.cell3.Name = "cell3";
			this.cell3.StyleMouseOver = null;
			this.node2.Cells.Add(this.cell2);
			this.node2.Cells.Add(this.cell4);
			this.node2.Expanded = true;
			this.node2.Name = "node2";
			this.node2.Text = "normals";
			this.cell2.Name = "cell2";
			this.cell2.StyleMouseOver = null;
			this.cell4.Name = "cell4";
			this.cell4.StyleMouseOver = null;
			this.nodeConnector1.LineColor = System.Drawing.SystemColors.ControlText;
			this.elementStyle1.CornerType = DevComponents.DotNetBar.eCornerType.Square;
			this.elementStyle1.Name = "elementStyle1";
			this.elementStyle1.TextColor = System.Drawing.SystemColors.ControlText;
			base.AutoScaleDimensions = new System.Drawing.SizeF(6f, 13f);
			base.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
			base.Controls.Add(this.advTree1);
			base.Name = "ScrollableEditList";
			base.Size = new System.Drawing.Size(501, 88);
			((System.ComponentModel.ISupportInitialize)this.advTree1).EndInit();
			base.ResumeLayout(false);
		}
	}
}
namespace GraphineLicenseManager
{
	internal class Activation
	{
		private static string LicenceManagerExe = "GraphineLicenseManager.exe";

		public static readonly string[] activationServers = new string[1] { "http://graphineactivation.appspot.com/graphine_activation" };

		public static string HardwareKey
		{
			get
			{
				string s = FindMACAddresses();
				byte[] bytes = Encoding.UTF8.GetBytes(s);
				return LicenseStringHelpers.EncodeToString(SHA512.Create().ComputeHash(bytes));
			}
		}

		public static string ActivateLicense(string licence, LicenseStringHelpers.GetProxyCredentialsDelegate proxyCredentialsGetter)
		{
			for (int i = 0; i < activationServers.Length; i++)
			{
				string server = activationServers[i];
				try
				{
					string text = ActivateLicense(server, licence, null);
					if (text != null)
					{
						return text;
					}
				}
				catch (LicenseStringHelpers.NeedProxyCredentialsException ex)
				{
					if (proxyCredentialsGetter != null)
					{
						NetworkCredential credential = new NetworkCredential();
						if (!proxyCredentialsGetter(ex.Realm, credential))
						{
							throw new Exception("Could not retrieve proxy server credentials!");
						}
						string text2 = ActivateLicense(server, licence, credential);
						if (text2 != null)
						{
							return text2;
						}
					}
				}
				catch (Exception ex2)
				{
					if (i == activationServers.Length - 1)
					{
						throw ex2;
					}
				}
			}
			return null;
		}

		private static string ActivateLicense(string server, string license, NetworkCredential credential)
		{
			string text = LicenseStringHelpers.RetrieveString(server + "?method=activate&license=" + Uri.EscapeDataString(license) + "&hardware_id=" + Uri.EscapeDataString(HardwareKey) + "&machine_name=" + Uri.EscapeDataString(Environment.MachineName), credential);
			CheckActivation(license, text);
			PersistActivation(license, text);
			return text;
		}

		public static void CheckActivation(string license, string activation)
		{
			if (!LicenseStringHelpers.IsSignatureValid(activation, GraphineKeys.publicActivationKey))
			{
				throw new Exception("The provided activation key is invalid or has been tampred with.");
			}
			string keyField = LicenseStringHelpers.GetKeyField(activation, "hardware");
			string keyField2 = LicenseStringHelpers.GetKeyField(license, "signature");
			string keyField3 = LicenseStringHelpers.GetKeyField(activation, "key");
			if (string.Compare(HardwareKey, keyField, ignoreCase: false) != 0)
			{
				throw new Exception("The provided activation key is for this hardware.");
			}
			if (string.Compare(keyField2, keyField3, ignoreCase: false) != 0)
			{
				throw new Exception("The provided activation key is not for this license.");
			}
			string keyField4 = LicenseStringHelpers.GetKeyField(activation, "expires");
			if (LicenseStringHelpers.GetNow() > LicenseStringHelpers.ParseDate(keyField4))
			{
				throw new Exception("The provided activation has expired.");
			}
		}

		public static void PersistActivation(string license, string activation)
		{
			string[] array = LicenseStringHelpers.GetKeyField(license, "product").Split(',');
			foreach (string text in array)
			{
				LicenseStringHelpers.WriteRegistryValue("SOFTWARE\\Graphine\\" + text, "Activation", activation);
			}
		}

		public static void DeleteActivation(string license)
		{
			string[] array = LicenseStringHelpers.GetKeyField(license, "product").Split(',');
			foreach (string text in array)
			{
				LicenseStringHelpers.DeleteRegistryValue("SOFTWARE\\Graphine\\" + text, "Activation");
			}
		}

		public static string DetectActivation(string license)
		{
			string text = null;
			string[] array = LicenseStringHelpers.GetKeyField(license, "product").Split(',');
			foreach (string text2 in array)
			{
				try
				{
					text = LicenseStringHelpers.ReadRegistryValue("SOFTWARE\\Graphine\\" + text2, "Activation");
				}
				catch (Exception)
				{
					continue;
				}
				if (text != null)
				{
					try
					{
						CheckActivation(license, text);
						return text;
					}
					catch (Exception)
					{
					}
				}
			}
			return null;
		}

		public static int ExpireDays(string activation)
		{
			if (activation == null)
			{
				return 0;
			}
			string keyField = LicenseStringHelpers.GetKeyField(activation, "expires");
			DateTime now = LicenseStringHelpers.GetNow();
			if (keyField != null)
			{
				return (int)(LicenseStringHelpers.ParseDate(keyField) - now).TotalDays;
			}
			return 0;
		}

		private static string FindMACAddresses()
		{
			string text = "";
			foreach (ManagementObject item in new ManagementObjectSearcher("SELECT * FROM Win32_NetworkAdapter WHERE(AdapterType = 'Ethernet 802.3') AND (MACAddress IS NOT NULL) AND PNPDeviceId LIKE '%PCI%'").Get())
			{
				text += item["MACAddress"].ToString();
			}
			return text;
		}

		private static string GetHDDSerialNumbers()
		{
			string text = "";
			foreach (ManagementObject item in new ManagementObjectSearcher("SELECT * FROM Win32_PhysicalMedia WHERE SerialNumber IS NOT NULL").Get())
			{
				text += item["SerialNumber"].ToString();
			}
			return text;
		}

		private static string FindLicenseManagerBesideAssembly()
		{
			string location = Assembly.GetExecutingAssembly().Location;
			if (location == null)
			{
				return null;
			}
			string text = Path.Combine(Path.GetDirectoryName(location), LicenceManagerExe);
			if (File.Exists(text))
			{
				return text;
			}
			return null;
		}

		private static string FindLicenseManagerUnityPluginsFolder()
		{
			return null;
		}

		private static string FindLicenseManagerBesideExecutable()
		{
			string baseDirectory = AppDomain.CurrentDomain.BaseDirectory;
			if (baseDirectory == null)
			{
				return null;
			}
			string text = Path.Combine(baseDirectory, LicenceManagerExe);
			if (File.Exists(text))
			{
				return text;
			}
			return null;
		}

		private static string FindLicenseManagerInSdkDirectory()
		{
			string environmentVariable = Environment.GetEnvironmentVariable("GRANITESDK_PATH");
			if (environmentVariable == null)
			{
				return null;
			}
			string text = Path.Combine(Path.Combine(Path.Combine(environmentVariable, "Binaries"), "x64"), LicenceManagerExe);
			if (File.Exists(text))
			{
				return text;
			}
			return null;
		}

		private static string FindLicenseManagerInToolsDirectory()
		{
			string environmentVariable = Environment.GetEnvironmentVariable("GRANITE_TOOLS_PATH");
			if (environmentVariable == null)
			{
				return null;
			}
			string text = Path.Combine(environmentVariable, LicenceManagerExe);
			if (File.Exists(text))
			{
				return text;
			}
			return null;
		}

		private static string FindLicenseManagerInCWD()
		{
			string fullPath = Path.GetFullPath(LicenceManagerExe);
			if (File.Exists(fullPath))
			{
				return fullPath;
			}
			return null;
		}

		public static bool RunLicenseManager(string productDescription, string[] acceptableProductLicenses, string extraCmdArgs, bool trySilent)
		{
			System.Diagnostics.Process process = new System.Diagnostics.Process();
			string text = null;
			text = FindLicenseManagerBesideAssembly();
			if (text == null)
			{
				text = FindLicenseManagerBesideExecutable();
			}
			if (text == null)
			{
				text = FindLicenseManagerUnityPluginsFolder();
			}
			if (text == null)
			{
				text = FindLicenseManagerInToolsDirectory();
			}
			if (text == null)
			{
				text = FindLicenseManagerInSdkDirectory();
			}
			if (text == null)
			{
				text = FindLicenseManagerInCWD();
			}
			if (text != null)
			{
				try
				{
					process.StartInfo.UseShellExecute = true;
					process.StartInfo.FileName = text;
					process.StartInfo.Arguments = "\"" + productDescription + "\"";
					if (extraCmdArgs != null)
					{
						ProcessStartInfo startInfo = process.StartInfo;
						startInfo.Arguments = startInfo.Arguments + " " + extraCmdArgs;
					}
					if (trySilent)
					{
						process.StartInfo.Arguments += " -trysilent";
					}
					foreach (string text2 in acceptableProductLicenses)
					{
						ProcessStartInfo startInfo2 = process.StartInfo;
						startInfo2.Arguments = startInfo2.Arguments + " \"" + text2 + "\"";
					}
					process.Start();
					process.WaitForExit();
				}
				catch (Exception)
				{
					return false;
				}
				return true;
			}
			return false;
		}
	}
	internal class GraphineKeys
	{
		public static byte[] publicKey = new byte[32]
		{
			71, 233, 65, 252, 115, 90, 173, 9, 126, 115,
			60, 156, 190, 180, 25, 68, 145, 246, 44, 42,
			67, 22, 192, 1, 18, 195, 215, 126, 179, 37,
			35, 191
		};

		public static byte[] publicActivationKey = new byte[32]
		{
			127, 219, 104, 49, 168, 5, 222, 208, 36, 31,
			198, 211, 110, 248, 132, 205, 199, 53, 1, 145,
			243, 46, 67, 186, 44, 200, 222, 250, 72, 120,
			249, 101
		};
	}
	internal class License
	{
		public static void CheckLicense(string licence, string product)
		{
			if (!LicenseStringHelpers.IsSignatureValid(licence, GraphineKeys.publicKey))
			{
				throw new Exception("The provided license is invalid or has been tampred with.");
			}
			string[] array = LicenseStringHelpers.GetKeyField(licence, "product").Split(',');
			bool flag = false;
			string[] array2 = array;
			foreach (string strB in array2)
			{
				if (string.Compare(product, strB, ignoreCase: true) == 0)
				{
					flag = true;
					break;
				}
			}
			if (!flag)
			{
				throw new Exception("The provided license key is not a valid " + product + " license.");
			}
			string keyField = LicenseStringHelpers.GetKeyField(licence, "expires");
			if (LicenseStringHelpers.GetNow() > LicenseStringHelpers.ParseDate(keyField))
			{
				throw new Exception("The provided license has expired.");
			}
		}

		public static string DetectLicense(string[] products, out int productIndex)
		{
			string text = null;
			for (int i = 0; i < products.Length; i++)
			{
				try
				{
					text = LicenseStringHelpers.ReadRegistryValue("SOFTWARE\\Graphine\\" + products[i], "License");
				}
				catch (Exception)
				{
					continue;
				}
				if (text != null)
				{
					try
					{
						CheckLicense(text, products[i]);
						productIndex = i;
						return text;
					}
					catch (Exception)
					{
					}
				}
			}
			productIndex = -1;
			return null;
		}

		public static void PersistLicense(string license)
		{
			string[] array = LicenseStringHelpers.GetKeyField(license, "product").Split(',');
			foreach (string text in array)
			{
				LicenseStringHelpers.WriteRegistryValue("SOFTWARE\\Graphine\\" + text, "License", license);
			}
		}

		public static void DeleteLicense(string license)
		{
			string[] array = LicenseStringHelpers.GetKeyField(license, "product").Split(',');
			foreach (string text in array)
			{
				LicenseStringHelpers.DeleteRegistryValue("SOFTWARE\\Graphine\\" + text, "License");
			}
		}

		public static void CheckLicenseAndActivate(string productDescription, string[] products, out int licenseId, out int subLicenseId, string extraManagerCmdArgs = null)
		{
			int productIndex = 0;
			string text = DetectLicense(products, out productIndex);
			if (text != null)
			{
				if (Activation.DetectActivation(text) == null)
				{
					Activation.RunLicenseManager(productDescription, products, extraManagerCmdArgs, trySilent: true);
					if (Activation.DetectActivation(text) == null)
					{
						throw new ArgumentException("Invalid License (1)");
					}
				}
			}
			else
			{
				Activation.RunLicenseManager(productDescription, products, extraManagerCmdArgs, trySilent: true);
				text = DetectLicense(products, out productIndex);
				if (text == null)
				{
					throw new ArgumentException("Invalid License (2)");
				}
				if (Activation.DetectActivation(text) == null)
				{
					throw new ArgumentException("Invalid License (3)");
				}
			}
			licenseId = productIndex;
			string keyField = LicenseStringHelpers.GetKeyField(text, "sub");
			if (keyField != null)
			{
				subLicenseId = 0;
				int.TryParse(keyField, out subLicenseId);
			}
			else
			{
				subLicenseId = 0;
			}
		}
	}
	internal class LicenseStringHelpers
	{
		public class ActivationUserException : Exception
		{
			public string DisplayHtml;
		}

		public class NeedProxyCredentialsException : Exception
		{
			public string Realm;
		}

		public delegate bool GetProxyCredentialsDelegate(string realm, NetworkCredential credential);

		private static readonly string HEXES = "0123456789abcdef";

		private const int KEY_QUERY_VALUE = 1;

		private const int KEY_SET_VALUE = 2;

		private const int KEY_WRITE = 131078;

		private const int KEY_READ = 131097;

		private const int KEY_WOW64_64KEY = 256;

		private const int REG_SZ = 1;

		private const int ERROR_SUCCESS = 0;

		private const int KEY_ALL_ACCESS = 983103;

		public static bool IsSignatureValid(string licence, byte[] publicKey)
		{
			int num = licence.LastIndexOf('|');
			if (num < 0)
			{
				return false;
			}
			int num2 = licence.IndexOf(':', num);
			if (num2 < 0)
			{
				return false;
			}
			byte[] signature = DecodeFromString(licence.Substring(num2 + 1));
			byte[] bytes = Encoding.UTF8.GetBytes(licence.Substring(0, num));
			return Signature.Verify(signature, bytes, publicKey);
		}

		public static string GetKeyField(string key, string field)
		{
			int num = key.IndexOf(field);
			if (num < 0)
			{
				return null;
			}
			int length = field.Length;
			if (num + length < key.Length && key[num + length] == ':')
			{
				int num2 = key.IndexOf('|', num + length + 1);
				if (num2 < 0)
				{
					return key.Substring(num + length + 1).Replace('+', ' ');
				}
				int num3 = num + length + 1;
				return key.Substring(num3, num2 - num3).Replace('+', ' ');
			}
			return null;
		}

		private static int CharToNibble(char c)
		{
			if (c >= '0' && c <= '9')
			{
				return c - 48;
			}
			if (c >= 'a' && c <= 'f')
			{
				return c - 97 + 10;
			}
			throw new ArgumentException("Invalid hex character.");
		}

		public static byte[] DecodeFromString(string s)
		{
			if (s.Length % 2 != 0)
			{
				throw new ArgumentException("Invalid hex string length");
			}
			int num = s.Length / 2;
			byte[] array = new byte[num];
			for (int i = 0; i < num; i++)
			{
				array[i] = (byte)((CharToNibble(s[i * 2]) << 4) | CharToNibble(s[i * 2 + 1]));
			}
			return array;
		}

		public static string EncodeToString(byte[] raw)
		{
			if (raw == null)
			{
				return null;
			}
			return EncodeToString(raw, 0, raw.Length);
		}

		public static string EncodeToString(byte[] raw, int first, int count)
		{
			if (raw == null)
			{
				return null;
			}
			StringBuilder stringBuilder = new StringBuilder(2 * count);
			for (int i = 0; i < count; i++)
			{
				byte b = raw[first + i];
				stringBuilder.Append(HEXES[(b & 0xF0) >> 4]);
				stringBuilder.Append(HEXES[b & 0xF]);
			}
			return stringBuilder.ToString();
		}

		public static string EncodeToCString(byte[] raw)
		{
			if (raw == null)
			{
				return null;
			}
			StringBuilder stringBuilder = new StringBuilder(2 * raw.Length);
			for (int i = 0; i < raw.Length; i++)
			{
				stringBuilder.Append("0x");
				stringBuilder.Append(HEXES[(raw[i] & 0xF0) >> 4]);
				stringBuilder.Append(HEXES[raw[i] & 0xF]);
				if (i != raw.Length - 1)
				{
					stringBuilder.Append(", ");
				}
			}
			return stringBuilder.ToString();
		}

		public static Dictionary<string, string> SplitKey(string key)
		{
			string[] array = key.Split('|');
			Dictionary<string, string> dictionary = new Dictionary<string, string>();
			string[] array2 = array;
			for (int i = 0; i < array2.Length; i++)
			{
				string[] array3 = array2[i].Split(':');
				if (array3.Length == 2)
				{
					dictionary.Add(array3[0], array3[1]);
				}
			}
			return dictionary;
		}

		public static DateTime ParseDate(string licenceDate)
		{
			return DateTime.ParseExact(licenceDate, "dd-MM-yyyy", CultureInfo.InvariantCulture, DateTimeStyles.None);
		}

		public static DateTime GetNow()
		{
			return DateTime.Now;
		}

		public static string EncodeBase32(byte[] data)
		{
			if (data.Length > 268435456)
			{
				return null;
			}
			int num = 0;
			char[] array = new char[(data.Length * 8 + 5 - 1) / 5];
			if (data.Length != 0)
			{
				int num2 = data[0];
				int num3 = 1;
				int num4 = 8;
				while (num4 > 0 || num3 < data.Length)
				{
					if (num4 < 5)
					{
						if (num3 < data.Length)
						{
							num2 <<= 8;
							num2 |= data[num3++] & 0xFF;
							num4 += 8;
						}
						else
						{
							int num5 = 5 - num4;
							num2 <<= num5;
							num4 += num5;
						}
					}
					int index = 0x1F & (num2 >> num4 - 5);
					num4 -= 5;
					array[num++] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"[index];
				}
			}
			return new string(array);
		}

		public static byte[] DecodeBase32(string coded)
		{
			int num = 0;
			int num2 = 0;
			int num3 = 0;
			int num4 = 0;
			for (int i = 0; i < coded.Length; i++)
			{
				char c = coded[i];
				if (c == ' ' || c == '\t' || c == '\r' || c == '\n' || c == '-' || c == 'â' || c == 'â' || c == 'â' || c == 'â')
				{
					continue;
				}
				switch (c)
				{
				case '0':
					c = 'O';
					break;
				case '1':
					c = 'L';
					break;
				case '8':
					c = 'B';
					break;
				}
				if ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'))
				{
					c = (char)((c & 0x1F) - 1);
				}
				else
				{
					if (c < '2' || c > '7')
					{
						throw new Exception("Invalid character: '" + c.ToString() + "' #" + (int)c);
					}
					c = (char)(c - 24);
				}
				num4++;
			}
			byte[] array = new byte[num4 * 5 / 8];
			for (int j = 0; j < coded.Length; j++)
			{
				char c2 = coded[j];
				if (c2 == ' ' || c2 == '\t' || c2 == '\r' || c2 == '\n' || c2 == '-')
				{
					continue;
				}
				num <<= 5;
				switch (c2)
				{
				case '0':
					c2 = 'O';
					break;
				case '1':
					c2 = 'L';
					break;
				case '8':
					c2 = 'B';
					break;
				}
				if ((c2 >= 'A' && c2 <= 'Z') || (c2 >= 'a' && c2 <= 'z'))
				{
					c2 = (char)((c2 & 0x1F) - 1);
				}
				else
				{
					if (c2 < '2' || c2 > '7')
					{
						return null;
					}
					c2 = (char)(c2 - 24);
				}
				num |= c2;
				num2 += 5;
				if (num2 >= 8)
				{
					array[num3++] = (byte)(num >> num2 - 8);
					num2 -= 8;
				}
			}
			return array;
		}

		[DllImport("Advapi32.dll")]
		private static extern uint RegOpenKeyExW(UIntPtr hKey, [MarshalAs(UnmanagedType.LPWStr)] string lpSubKey, uint ulOptions, int samDesired, out UIntPtr phkResult);

		[DllImport("Advapi32.dll")]
		private static extern uint RegCloseKey(UIntPtr hKey);

		[DllImport("Advapi32.dll")]
		private static extern uint RegQueryValueExW(UIntPtr hKey, [MarshalAs(UnmanagedType.LPWStr)] string lpValueName, int lpReserved, ref uint lpType, [MarshalAs(UnmanagedType.LPWStr)] StringBuilder lpData, ref uint lpcbData);

		[DllImport("Advapi32.dll")]
		private static extern uint RegSetValueExW(UIntPtr hKey, [MarshalAs(UnmanagedType.LPWStr)] string lpValueName, uint Reserved, uint dwType, [MarshalAs(UnmanagedType.LPWStr)] string lpData, uint cbData);

		[DllImport("Advapi32.dll")]
		private static extern uint RegCreateKeyExW(UIntPtr hKey, [MarshalAs(UnmanagedType.LPWStr)] string lpSubKey, uint Reserved, [MarshalAs(UnmanagedType.LPWStr)] string lpClass, uint dwOptions, uint samDesired, UIntPtr lpSecurityAttributes, ref UIntPtr phkResult, ref uint lpdwDisposition);

		[DllImport("Advapi32.dll")]
		private static extern uint RegDeleteValueW(UIntPtr hKey, [MarshalAs(UnmanagedType.LPWStr)] string valueName);

		public static string ReadRegistryValue(string key, string value)
		{
			UIntPtr hKey = (UIntPtr)2147483650u;
			UIntPtr phkResult = UIntPtr.Zero;
			try
			{
				if (RegOpenKeyExW(hKey, key, 0u, 131353, out phkResult) != 0)
				{
					return null;
				}
				uint lpType = 0u;
				StringBuilder stringBuilder = new StringBuilder(2048);
				uint lpcbData = (uint)(stringBuilder.Capacity * 2);
				if (RegQueryValueExW(phkResult, value, 0, ref lpType, stringBuilder, ref lpcbData) != 0)
				{
					return null;
				}
				if (lpType != 1)
				{
					return null;
				}
				return stringBuilder.ToString();
			}
			finally
			{
				if (UIntPtr.Zero != phkResult)
				{
					RegCloseKey(phkResult);
				}
			}
		}

		public static void WriteRegistryValue(string keyName, string valueName, string value)
		{
			UIntPtr hKey = (UIntPtr)2147483650u;
			UIntPtr phkResult = UIntPtr.Zero;
			try
			{
				uint lpdwDisposition = 0u;
				if (RegCreateKeyExW(hKey, keyName, 0u, null, 0u, 131334u, UIntPtr.Zero, ref phkResult, ref lpdwDisposition) != 0)
				{
					throw new Exception("RegCreateKeyExW failed");
				}
				if (RegSetValueExW(phkResult, valueName, 0u, 1u, value, (uint)(2 * (value.Length + 1))) != 0)
				{
					throw new Exception("RegSetValueExW failed");
				}
			}
			finally
			{
				if (UIntPtr.Zero != phkResult)
				{
					RegCloseKey(phkResult);
				}
			}
		}

		public static void DeleteRegistryValue(string keyName, string valueName)
		{
			UIntPtr hKey = (UIntPtr)2147483650u;
			UIntPtr phkResult = UIntPtr.Zero;
			try
			{
				if (RegOpenKeyExW(hKey, keyName, 0u, 983359, out phkResult) != 0)
				{
					throw new Exception("RegOpenKeyEx error");
				}
				if (RegDeleteValueW(phkResult, valueName) != 0)
				{
					throw new Exception("RegOpenKeyEx error");
				}
			}
			finally
			{
				if (UIntPtr.Zero != phkResult)
				{
					RegCloseKey(phkResult);
				}
			}
		}

		public static string RetrieveString(string fullRequestUrl, NetworkCredential credential)
		{
			HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(fullRequestUrl);
			if (credential != null && httpWebRequest.Proxy != null)
			{
				httpWebRequest.Proxy.Credentials = credential;
			}
			HttpWebResponse httpWebResponse = null;
			try
			{
				httpWebResponse = (HttpWebResponse)httpWebRequest.GetResponse();
			}
			catch (WebException ex)
			{
				if (ex.Status == WebExceptionStatus.ProtocolError)
				{
					if (ex.Response is HttpWebResponse httpWebResponse2)
					{
						if (httpWebResponse2.StatusCode == HttpStatusCode.ProxyAuthenticationRequired)
						{
							throw new NeedProxyCredentialsException
							{
								Realm = httpWebResponse2.GetResponseHeader("Proxy-Authenticate")
							};
						}
						StreamReader streamReader = new StreamReader(httpWebResponse2.GetResponseStream());
						throw new ActivationUserException
						{
							DisplayHtml = streamReader.ReadToEnd()
						};
					}
					throw ex;
				}
				throw ex;
			}
			Console.WriteLine(httpWebResponse.StatusDescription);
			Stream responseStream = httpWebResponse.GetResponseStream();
			StreamReader streamReader2 = new StreamReader(responseStream);
			string text = streamReader2.ReadToEnd();
			text = text.Trim();
			streamReader2.Close();
			responseStream.Close();
			httpWebResponse.Close();
			return text;
		}

		private static string RetrieveLicense(string server, string tempraryLicenseString, string company, string userName, string email, NetworkCredential credential)
		{
			return RetrieveString(server + "?method=retrieve&license=" + Uri.EscapeDataString(tempraryLicenseString) + "&company=" + Uri.EscapeDataString(company) + "&name=" + Uri.EscapeDataString(userName) + "&email=" + Uri.EscapeDataString(email), credential);
		}

		public static string RetrieveLicense(string temoraryLicenseString, string company, string userName, string email, GetProxyCredentialsDelegate proxyCredentialsGetter)
		{
			for (int i = 0; i < Activation.activationServers.Length; i++)
			{
				string server = Activation.activationServers[i];
				try
				{
					string text = RetrieveLicense(server, temoraryLicenseString, company, userName, email, null);
					if (text != null)
					{
						return text;
					}
				}
				catch (NeedProxyCredentialsException ex)
				{
					if (proxyCredentialsGetter != null)
					{
						NetworkCredential credential = new NetworkCredential();
						if (!proxyCredentialsGetter(ex.Realm, credential))
						{
							throw new Exception("Could not retrieve proxy server credentials!");
						}
						string text2 = RetrieveLicense(server, temoraryLicenseString, company, userName, email, credential);
						if (text2 != null)
						{
							return text2;
						}
					}
				}
				catch (Exception ex2)
				{
					if (i == Activation.activationServers.Length - 1)
					{
						throw ex2;
					}
				}
			}
			return null;
		}

		public static string DecodeUserLicense(string baseCodedLicense)
		{
			byte[] array = DecodeBase32(baseCodedLicense);
			if (array == null)
			{
				throw new Exception("Invalid license format.");
			}
			int num = -1;
			for (int i = 0; i < array.Length; i++)
			{
				if (array[i] == 0)
				{
					num = i;
					break;
				}
			}
			if (num < 0)
			{
				throw new Exception("Invalid license format. Could not extract a signature from the provided license.");
			}
			return Encoding.UTF8.GetString(array, 0, num) + "|signature:" + EncodeToString(array, num + 1, array.Length - num - 1);
		}
	}
}
namespace GraphineLicenseManager.Ed25519b
{
	internal class Extra
	{
		public static int readUnsigned(byte b)
		{
			return b & 0xFF;
		}

		public static long load_3(byte[] inp, int ofs, int shift)
		{
			return (long)((ulong)(readUnsigned(inp[ofs]) | ((long)readUnsigned(inp[1 + ofs]) << 8) | ((long)readUnsigned(inp[2 + ofs]) << 16)) >> shift);
		}

		public static long load_4(byte[] inp, int ofs, int shift)
		{
			return (long)((ulong)(readUnsigned(inp[ofs]) | ((long)readUnsigned(inp[1 + ofs]) << 8) | ((long)readUnsigned(inp[2 + ofs]) << 16) | ((long)readUnsigned(inp[3 + ofs]) << 24)) >> shift);
		}

		public static void sc_reduce(byte[] s)
		{
			long num = 0x1FFFFF & load_3(s, 0, 0);
			long num2 = 0x1FFFFF & load_4(s, 2, 5);
			long num3 = 0x1FFFFF & load_3(s, 5, 2);
			long num4 = 0x1FFFFF & load_4(s, 7, 7);
			long num5 = 0x1FFFFF & load_4(s, 10, 4);
			long num6 = 0x1FFFFF & load_3(s, 13, 1);
			long num7 = 0x1FFFFF & load_4(s, 15, 6);
			long num8 = 0x1FFFFF & load_3(s, 18, 3);
			long num9 = 0x1FFFFF & load_3(s, 21, 0);
			long num10 = 0x1FFFFF & load_4(s, 23, 5);
			long num11 = 0x1FFFFF & load_3(s, 26, 2);
			long num12 = 0x1FFFFF & load_4(s, 28, 7);
			long num13 = 0x1FFFFF & load_4(s, 31, 4);
			long num14 = 0x1FFFFF & load_3(s, 34, 1);
			long num15 = 0x1FFFFF & load_4(s, 36, 6);
			long num16 = 0x1FFFFF & load_3(s, 39, 3);
			long num17 = 0x1FFFFF & load_3(s, 42, 0);
			long num18 = 0x1FFFFF & load_4(s, 44, 5);
			long num19 = 0x1FFFFF & load_3(s, 47, 2);
			long num20 = 0x1FFFFF & load_4(s, 49, 7);
			long num21 = 0x1FFFFF & load_4(s, 52, 4);
			long num22 = 0x1FFFFF & load_3(s, 55, 1);
			long num23 = 0x1FFFFF & load_4(s, 57, 6);
			long num24 = load_4(s, 60, 3);
			num12 += num24 * 666643;
			num13 += num24 * 470296;
			num14 += num24 * 654183;
			num15 -= num24 * 997805;
			num16 += num24 * 136657;
			num17 -= num24 * 683901;
			num24 = 0L;
			num11 += num23 * 666643;
			num12 += num23 * 470296;
			num13 += num23 * 654183;
			num14 -= num23 * 997805;
			num15 += num23 * 136657;
			num16 -= num23 * 683901;
			num23 = 0L;
			num10 += num22 * 666643;
			num11 += num22 * 470296;
			num12 += num22 * 654183;
			num13 -= num22 * 997805;
			num14 += num22 * 136657;
			num15 -= num22 * 683901;
			num22 = 0L;
			num9 += num21 * 666643;
			num10 += num21 * 470296;
			num11 += num21 * 654183;
			num12 -= num21 * 997805;
			num13 += num21 * 136657;
			num14 -= num21 * 683901;
			num21 = 0L;
			num8 += num20 * 666643;
			num9 += num20 * 470296;
			num10 += num20 * 654183;
			num11 -= num20 * 997805;
			num12 += num20 * 136657;
			num13 -= num20 * 683901;
			num20 = 0L;
			num7 += num19 * 666643;
			num8 += num19 * 470296;
			num9 += num19 * 654183;
			num10 -= num19 * 997805;
			num11 += num19 * 136657;
			num12 -= num19 * 683901;
			num19 = 0L;
			long num25 = num7 + 1048576 >> 21;
			num8 += num25;
			num7 -= num25 << 21;
			long num26 = num9 + 1048576 >> 21;
			num10 += num26;
			num9 -= num26 << 21;
			long num27 = num11 + 1048576 >> 21;
			num12 += num27;
			num11 -= num27 << 21;
			long num28 = num13 + 1048576 >> 21;
			num14 += num28;
			num13 -= num28 << 21;
			long num29 = num15 + 1048576 >> 21;
			num16 += num29;
			num15 -= num29 << 21;
			long num30 = num17 + 1048576 >> 21;
			num18 += num30;
			num17 -= num30 << 21;
			long num31 = num8 + 1048576 >> 21;
			num9 += num31;
			num8 -= num31 << 21;
			long num32 = num10 + 1048576 >> 21;
			num11 += num32;
			num10 -= num32 << 21;
			long num33 = num12 + 1048576 >> 21;
			num13 += num33;
			num12 -= num33 << 21;
			long num34 = num14 + 1048576 >> 21;
			num15 += num34;
			num14 -= num34 << 21;
			long num35 = num16 + 1048576 >> 21;
			num17 += num35;
			num16 -= num35 << 21;
			num6 += num18 * 666643;
			num7 += num18 * 470296;
			num8 += num18 * 654183;
			num9 -= num18 * 997805;
			num10 += num18 * 136657;
			num11 -= num18 * 683901;
			num18 = 0L;
			num5 += num17 * 666643;
			num6 += num17 * 470296;
			num7 += num17 * 654183;
			num8 -= num17 * 997805;
			num9 += num17 * 136657;
			num10 -= num17 * 683901;
			num17 = 0L;
			num4 += num16 * 666643;
			num5 += num16 * 470296;
			num6 += num16 * 654183;
			num7 -= num16 * 997805;
			num8 += num16 * 136657;
			num9 -= num16 * 683901;
			num16 = 0L;
			num3 += num15 * 666643;
			num4 += num15 * 470296;
			num5 += num15 * 654183;
			num6 -= num15 * 997805;
			num7 += num15 * 136657;
			num8 -= num15 * 683901;
			num15 = 0L;
			num2 += num14 * 666643;
			num3 += num14 * 470296;
			num4 += num14 * 654183;
			num5 -= num14 * 997805;
			num6 += num14 * 136657;
			num7 -= num14 * 683901;
			num14 = 0L;
			num += num13 * 666643;
			num2 += num13 * 470296;
			num3 += num13 * 654183;
			num4 -= num13 * 997805;
			num5 += num13 * 136657;
			num6 -= num13 * 683901;
			num13 = 0L;
			long num36 = num + 1048576 >> 21;
			num2 += num36;
			num -= num36 << 21;
			long num37 = num3 + 1048576 >> 21;
			num4 += num37;
			num3 -= num37 << 21;
			long num38 = num5 + 1048576 >> 21;
			num6 += num38;
			num5 -= num38 << 21;
			num25 = num7 + 1048576 >> 21;
			num8 += num25;
			num7 -= num25 << 21;
			num26 = num9 + 1048576 >> 21;
			num10 += num26;
			num9 -= num26 << 21;
			num27 = num11 + 1048576 >> 21;
			num12 += num27;
			num11 -= num27 << 21;
			long num39 = num2 + 1048576 >> 21;
			num3 += num39;
			num2 -= num39 << 21;
			long num40 = num4 + 1048576 >> 21;
			num5 += num40;
			num4 -= num40 << 21;
			long num41 = num6 + 1048576 >> 21;
			num7 += num41;
			num6 -= num41 << 21;
			num31 = num8 + 1048576 >> 21;
			num9 += num31;
			num8 -= num31 << 21;
			num32 = num10 + 1048576 >> 21;
			num11 += num32;
			num10 -= num32 << 21;
			num33 = num12 + 1048576 >> 21;
			num13 += num33;
			num12 -= num33 << 21;
			num += num13 * 666643;
			num2 += num13 * 470296;
			num3 += num13 * 654183;
			num4 -= num13 * 997805;
			num5 += num13 * 136657;
			num6 -= num13 * 683901;
			num13 = 0L;
			num36 = num >> 21;
			num2 += num36;
			num -= num36 << 21;
			num39 = num2 >> 21;
			num3 += num39;
			num2 -= num39 << 21;
			num37 = num3 >> 21;
			num4 += num37;
			num3 -= num37 << 21;
			num40 = num4 >> 21;
			num5 += num40;
			num4 -= num40 << 21;
			num38 = num5 >> 21;
			num6 += num38;
			num5 -= num38 << 21;
			num41 = num6 >> 21;
			num7 += num41;
			num6 -= num41 << 21;
			num25 = num7 >> 21;
			num8 += num25;
			num7 -= num25 << 21;
			num31 = num8 >> 21;
			num9 += num31;
			num8 -= num31 << 21;
			num26 = num9 >> 21;
			num10 += num26;
			num9 -= num26 << 21;
			num32 = num10 >> 21;
			num11 += num32;
			num10 -= num32 << 21;
			num27 = num11 >> 21;
			num12 += num27;
			num11 -= num27 << 21;
			num33 = num12 >> 21;
			num13 += num33;
			num12 -= num33 << 21;
			num += num13 * 666643;
			num2 += num13 * 470296;
			num3 += num13 * 654183;
			num4 -= num13 * 997805;
			num5 += num13 * 136657;
			num6 -= num13 * 683901;
			num13 = 0L;
			num36 = num >> 21;
			num2 += num36;
			num -= num36 << 21;
			num39 = num2 >> 21;
			num3 += num39;
			num2 -= num39 << 21;
			num37 = num3 >> 21;
			num4 += num37;
			num3 -= num37 << 21;
			num40 = num4 >> 21;
			num5 += num40;
			num4 -= num40 << 21;
			num38 = num5 >> 21;
			num6 += num38;
			num5 -= num38 << 21;
			num41 = num6 >> 21;
			num7 += num41;
			num6 -= num41 << 21;
			num25 = num7 >> 21;
			num8 += num25;
			num7 -= num25 << 21;
			num31 = num8 >> 21;
			num9 += num31;
			num8 -= num31 << 21;
			num26 = num9 >> 21;
			num10 += num26;
			num9 -= num26 << 21;
			num32 = num10 >> 21;
			num11 += num32;
			num10 -= num32 << 21;
			num27 = num11 >> 21;
			num12 += num27;
			num11 -= num27 << 21;
			s[0] = (byte)num;
			s[1] = (byte)(num >> 8);
			s[2] = (byte)((num >> 16) | (num2 << 5));
			s[3] = (byte)(num2 >> 3);
			s[4] = (byte)(num2 >> 11);
			s[5] = (byte)((num2 >> 19) | (num3 << 2));
			s[6] = (byte)(num3 >> 6);
			s[7] = (byte)((num3 >> 14) | (num4 << 7));
			s[8] = (byte)(num4 >> 1);
			s[9] = (byte)(num4 >> 9);
			s[10] = (byte)((num4 >> 17) | (num5 << 4));
			s[11] = (byte)(num5 >> 4);
			s[12] = (byte)(num5 >> 12);
			s[13] = (byte)((num5 >> 20) | (num6 << 1));
			s[14] = (byte)(num6 >> 7);
			s[15] = (byte)((num6 >> 15) | (num7 << 6));
			s[16] = (byte)(num7 >> 2);
			s[17] = (byte)(num7 >> 10);
			s[18] = (byte)((num7 >> 18) | (num8 << 3));
			s[19] = (byte)(num8 >> 5);
			s[20] = (byte)(num8 >> 13);
			s[21] = (byte)num9;
			s[22] = (byte)(num9 >> 8);
			s[23] = (byte)((num9 >> 16) | (num10 << 5));
			s[24] = (byte)(num10 >> 3);
			s[25] = (byte)(num10 >> 11);
			s[26] = (byte)((num10 >> 19) | (num11 << 2));
			s[27] = (byte)(num11 >> 6);
			s[28] = (byte)((num11 >> 14) | (num12 << 7));
			s[29] = (byte)(num12 >> 1);
			s[30] = (byte)(num12 >> 9);
			s[31] = (byte)(num12 >> 17);
		}

		public static void sc_muladd(byte[] s, byte[] a, byte[] b, byte[] c)
		{
			long num = 0x1FFFFF & load_3(a, 0, 0);
			long num2 = 0x1FFFFF & load_4(a, 2, 5);
			long num3 = 0x1FFFFF & load_3(a, 5, 2);
			long num4 = 0x1FFFFF & load_4(a, 7, 7);
			long num5 = 0x1FFFFF & load_4(a, 10, 4);
			long num6 = 0x1FFFFF & load_3(a, 13, 1);
			long num7 = 0x1FFFFF & load_4(a, 15, 6);
			long num8 = 0x1FFFFF & load_3(a, 18, 3);
			long num9 = 0x1FFFFF & load_3(a, 21, 0);
			long num10 = 0x1FFFFF & load_4(a, 23, 5);
			long num11 = 0x1FFFFF & load_3(a, 26, 2);
			long num12 = load_4(a, 28, 7);
			long num13 = 0x1FFFFF & load_3(b, 0, 0);
			long num14 = 0x1FFFFF & load_4(b, 2, 5);
			long num15 = 0x1FFFFF & load_3(b, 5, 2);
			long num16 = 0x1FFFFF & load_4(b, 7, 7);
			long num17 = 0x1FFFFF & load_4(b, 10, 4);
			long num18 = 0x1FFFFF & load_3(b, 13, 1);
			long num19 = 0x1FFFFF & load_4(b, 15, 6);
			long num20 = 0x1FFFFF & load_3(b, 18, 3);
			long num21 = 0x1FFFFF & load_3(b, 21, 0);
			long num22 = 0x1FFFFF & load_4(b, 23, 5);
			long num23 = 0x1FFFFF & load_3(b, 26, 2);
			long num24 = load_4(b, 28, 7);
			long num25 = 0x1FFFFF & load_3(c, 0, 0);
			long num26 = 0x1FFFFF & load_4(c, 2, 5);
			long num27 = 0x1FFFFF & load_3(c, 5, 2);
			long num28 = 0x1FFFFF & load_4(c, 7, 7);
			long num29 = 0x1FFFFF & load_4(c, 10, 4);
			long num30 = 0x1FFFFF & load_3(c, 13, 1);
			long num31 = 0x1FFFFF & load_4(c, 15, 6);
			long num32 = 0x1FFFFF & load_3(c, 18, 3);
			long num33 = 0x1FFFFF & load_3(c, 21, 0);
			long num34 = 0x1FFFFF & load_4(c, 23, 5);
			long num35 = 0x1FFFFF & load_3(c, 26, 2);
			long num36 = load_4(c, 28, 7);
			long num37 = num25 + num * num13;
			long num38 = num26 + num * num14 + num2 * num13;
			long num39 = num27 + num * num15 + num2 * num14 + num3 * num13;
			long num40 = num28 + num * num16 + num2 * num15 + num3 * num14 + num4 * num13;
			long num41 = num29 + num * num17 + num2 * num16 + num3 * num15 + num4 * num14 + num5 * num13;
			long num42 = num30 + num * num18 + num2 * num17 + num3 * num16 + num4 * num15 + num5 * num14 + num6 * num13;
			long num43 = num31 + num * num19 + num2 * num18 + num3 * num17 + num4 * num16 + num5 * num15 + num6 * num14 + num7 * num13;
			long num44 = num32 + num * num20 + num2 * num19 + num3 * num18 + num4 * num17 + num5 * num16 + num6 * num15 + num7 * num14 + num8 * num13;
			long num45 = num33 + num * num21 + num2 * num20 + num3 * num19 + num4 * num18 + num5 * num17 + num6 * num16 + num7 * num15 + num8 * num14 + num9 * num13;
			long num46 = num34 + num * num22 + num2 * num21 + num3 * num20 + num4 * num19 + num5 * num18 + num6 * num17 + num7 * num16 + num8 * num15 + num9 * num14 + num10 * num13;
			long num47 = num35 + num * num23 + num2 * num22 + num3 * num21 + num4 * num20 + num5 * num19 + num6 * num18 + num7 * num17 + num8 * num16 + num9 * num15 + num10 * num14 + num11 * num13;
			long num48 = num36 + num * num24 + num2 * num23 + num3 * num22 + num4 * num21 + num5 * num20 + num6 * num19 + num7 * num18 + num8 * num17 + num9 * num16 + num10 * num15 + num11 * num14 + num12 * num13;
			long num49 = num2 * num24 + num3 * num23 + num4 * num22 + num5 * num21 + num6 * num20 + num7 * num19 + num8 * num18 + num9 * num17 + num10 * num16 + num11 * num15 + num12 * num14;
			long num50 = num3 * num24 + num4 * num23 + num5 * num22 + num6 * num21 + num7 * num20 + num8 * num19 + num9 * num18 + num10 * num17 + num11 * num16 + num12 * num15;
			long num51 = num4 * num24 + num5 * num23 + num6 * num22 + num7 * num21 + num8 * num20 + num9 * num19 + num10 * num18 + num11 * num17 + num12 * num16;
			long num52 = num5 * num24 + num6 * num23 + num7 * num22 + num8 * num21 + num9 * num20 + num10 * num19 + num11 * num18 + num12 * num17;
			long num53 = num6 * num24 + num7 * num23 + num8 * num22 + num9 * num21 + num10 * num20 + num11 * num19 + num12 * num18;
			long num54 = num7 * num24 + num8 * num23 + num9 * num22 + num10 * num21 + num11 * num20 + num12 * num19;
			long num55 = num8 * num24 + num9 * num23 + num10 * num22 + num11 * num21 + num12 * num20;
			long num56 = num9 * num24 + num10 * num23 + num11 * num22 + num12 * num21;
			long num57 = num10 * num24 + num11 * num23 + num12 * num22;
			long num58 = num11 * num24 + num12 * num23;
			long num59 = num12 * num24;
			long num60 = 0L;
			long num61 = num37 + 1048576 >> 21;
			num38 += num61;
			num37 -= num61 << 21;
			long num62 = num39 + 1048576 >> 21;
			num40 += num62;
			num39 -= num62 << 21;
			long num63 = num41 + 1048576 >> 21;
			num42 += num63;
			num41 -= num63 << 21;
			long num64 = num43 + 1048576 >> 21;
			num44 += num64;
			num43 -= num64 << 21;
			long num65 = num45 + 1048576 >> 21;
			num46 += num65;
			num45 -= num65 << 21;
			long num66 = num47 + 1048576 >> 21;
			num48 += num66;
			num47 -= num66 << 21;
			long num67 = num49 + 1048576 >> 21;
			num50 += num67;
			num49 -= num67 << 21;
			long num68 = num51 + 1048576 >> 21;
			num52 += num68;
			num51 -= num68 << 21;
			long num69 = num53 + 1048576 >> 21;
			num54 += num69;
			num53 -= num69 << 21;
			long num70 = num55 + 1048576 >> 21;
			num56 += num70;
			num55 -= num70 << 21;
			long num71 = num57 + 1048576 >> 21;
			num58 += num71;
			num57 -= num71 << 21;
			long num72 = num59 + 1048576 >> 21;
			num60 += num72;
			num59 -= num72 << 21;
			long num73 = num38 + 1048576 >> 21;
			num39 += num73;
			num38 -= num73 << 21;
			long num74 = num40 + 1048576 >> 21;
			num41 += num74;
			num40 -= num74 << 21;
			long num75 = num42 + 1048576 >> 21;
			num43 += num75;
			num42 -= num75 << 21;
			long num76 = num44 + 1048576 >> 21;
			num45 += num76;
			num44 -= num76 << 21;
			long num77 = num46 + 1048576 >> 21;
			num47 += num77;
			num46 -= num77 << 21;
			long num78 = num48 + 1048576 >> 21;
			num49 += num78;
			num48 -= num78 << 21;
			long num79 = num50 + 1048576 >> 21;
			num51 += num79;
			num50 -= num79 << 21;
			long num80 = num52 + 1048576 >> 21;
			num53 += num80;
			num52 -= num80 << 21;
			long num81 = num54 + 1048576 >> 21;
			num55 += num81;
			num54 -= num81 << 21;
			long num82 = num56 + 1048576 >> 21;
			num57 += num82;
			num56 -= num82 << 21;
			long num83 = num58 + 1048576 >> 21;
			num59 += num83;
			num58 -= num83 << 21;
			num48 += num60 * 666643;
			num49 += num60 * 470296;
			num50 += num60 * 654183;
			num51 -= num60 * 997805;
			num52 += num60 * 136657;
			num53 -= num60 * 683901;
			num60 = 0L;
			num47 += num59 * 666643;
			num48 += num59 * 470296;
			num49 += num59 * 654183;
			num50 -= num59 * 997805;
			num51 += num59 * 136657;
			num52 -= num59 * 683901;
			num59 = 0L;
			num46 += num58 * 666643;
			num47 += num58 * 470296;
			num48 += num58 * 654183;
			num49 -= num58 * 997805;
			num50 += num58 * 136657;
			num51 -= num58 * 683901;
			num58 = 0L;
			num45 += num57 * 666643;
			num46 += num57 * 470296;
			num47 += num57 * 654183;
			num48 -= num57 * 997805;
			num49 += num57 * 136657;
			num50 -= num57 * 683901;
			num57 = 0L;
			num44 += num56 * 666643;
			num45 += num56 * 470296;
			num46 += num56 * 654183;
			num47 -= num56 * 997805;
			num48 += num56 * 136657;
			num49 -= num56 * 683901;
			num56 = 0L;
			num43 += num55 * 666643;
			num44 += num55 * 470296;
			num45 += num55 * 654183;
			num46 -= num55 * 997805;
			num47 += num55 * 136657;
			num48 -= num55 * 683901;
			num55 = 0L;
			num64 = num43 + 1048576 >> 21;
			num44 += num64;
			num43 -= num64 << 21;
			num65 = num45 + 1048576 >> 21;
			num46 += num65;
			num45 -= num65 << 21;
			num66 = num47 + 1048576 >> 21;
			num48 += num66;
			num47 -= num66 << 21;
			num67 = num49 + 1048576 >> 21;
			num50 += num67;
			num49 -= num67 << 21;
			num68 = num51 + 1048576 >> 21;
			num52 += num68;
			num51 -= num68 << 21;
			num69 = num53 + 1048576 >> 21;
			num54 += num69;
			num53 -= num69 << 21;
			num76 = num44 + 1048576 >> 21;
			num45 += num76;
			num44 -= num76 << 21;
			num77 = num46 + 1048576 >> 21;
			num47 += num77;
			num46 -= num77 << 21;
			num78 = num48 + 1048576 >> 21;
			num49 += num78;
			num48 -= num78 << 21;
			num79 = num50 + 1048576 >> 21;
			num51 += num79;
			num50 -= num79 << 21;
			num80 = num52 + 1048576 >> 21;
			num53 += num80;
			num52 -= num80 << 21;
			num42 += num54 * 666643;
			num43 += num54 * 470296;
			num44 += num54 * 654183;
			num45 -= num54 * 997805;
			num46 += num54 * 136657;
			num47 -= num54 * 683901;
			num54 = 0L;
			num41 += num53 * 666643;
			num42 += num53 * 470296;
			num43 += num53 * 654183;
			num44 -= num53 * 997805;
			num45 += num53 * 136657;
			num46 -= num53 * 683901;
			num53 = 0L;
			num40 += num52 * 666643;
			num41 += num52 * 470296;
			num42 += num52 * 654183;
			num43 -= num52 * 997805;
			num44 += num52 * 136657;
			num45 -= num52 * 683901;
			num52 = 0L;
			num39 += num51 * 666643;
			num40 += num51 * 470296;
			num41 += num51 * 654183;
			num42 -= num51 * 997805;
			num43 += num51 * 136657;
			num44 -= num51 * 683901;
			num51 = 0L;
			num38 += num50 * 666643;
			num39 += num50 * 470296;
			num40 += num50 * 654183;
			num41 -= num50 * 997805;
			num42 += num50 * 136657;
			num43 -= num50 * 683901;
			num50 = 0L;
			num37 += num49 * 666643;
			num38 += num49 * 470296;
			num39 += num49 * 654183;
			num40 -= num49 * 997805;
			num41 += num49 * 136657;
			num42 -= num49 * 683901;
			num49 = 0L;
			num61 = num37 + 1048576 >> 21;
			num38 += num61;
			num37 -= num61 << 21;
			num62 = num39 + 1048576 >> 21;
			num40 += num62;
			num39 -= num62 << 21;
			num63 = num41 + 1048576 >> 21;
			num42 += num63;
			num41 -= num63 << 21;
			num64 = num43 + 1048576 >> 21;
			num44 += num64;
			num43 -= num64 << 21;
			num65 = num45 + 1048576 >> 21;
			num46 += num65;
			num45 -= num65 << 21;
			num66 = num47 + 1048576 >> 21;
			num48 += num66;
			num47 -= num66 << 21;
			num73 = num38 + 1048576 >> 21;
			num39 += num73;
			num38 -= num73 << 21;
			num74 = num40 + 1048576 >> 21;
			num41 += num74;
			num40 -= num74 << 21;
			num75 = num42 + 1048576 >> 21;
			num43 += num75;
			num42 -= num75 << 21;
			num76 = num44 + 1048576 >> 21;
			num45 += num76;
			num44 -= num76 << 21;
			num77 = num46 + 1048576 >> 21;
			num47 += num77;
			num46 -= num77 << 21;
			num78 = num48 + 1048576 >> 21;
			num49 += num78;
			num48 -= num78 << 21;
			num37 += num49 * 666643;
			num38 += num49 * 470296;
			num39 += num49 * 654183;
			num40 -= num49 * 997805;
			num41 += num49 * 136657;
			num42 -= num49 * 683901;
			num49 = 0L;
			num61 = num37 >> 21;
			num38 += num61;
			num37 -= num61 << 21;
			num73 = num38 >> 21;
			num39 += num73;
			num38 -= num73 << 21;
			num62 = num39 >> 21;
			num40 += num62;
			num39 -= num62 << 21;
			num74 = num40 >> 21;
			num41 += num74;
			num40 -= num74 << 21;
			num63 = num41 >> 21;
			num42 += num63;
			num41 -= num63 << 21;
			num75 = num42 >> 21;
			num43 += num75;
			num42 -= num75 << 21;
			num64 = num43 >> 21;
			num44 += num64;
			num43 -= num64 << 21;
			num76 = num44 >> 21;
			num45 += num76;
			num44 -= num76 << 21;
			num65 = num45 >> 21;
			num46 += num65;
			num45 -= num65 << 21;
			num77 = num46 >> 21;
			num47 += num77;
			num46 -= num77 << 21;
			num66 = num47 >> 21;
			num48 += num66;
			num47 -= num66 << 21;
			num78 = num48 >> 21;
			num49 += num78;
			num48 -= num78 << 21;
			num37 += num49 * 666643;
			num38 += num49 * 470296;
			num39 += num49 * 654183;
			num40 -= num49 * 997805;
			num41 += num49 * 136657;
			num42 -= num49 * 683901;
			num49 = 0L;
			num61 = num37 >> 21;
			num38 += num61;
			num37 -= num61 << 21;
			num73 = num38 >> 21;
			num39 += num73;
			num38 -= num73 << 21;
			num62 = num39 >> 21;
			num40 += num62;
			num39 -= num62 << 21;
			num74 = num40 >> 21;
			num41 += num74;
			num40 -= num74 << 21;
			num63 = num41 >> 21;
			num42 += num63;
			num41 -= num63 << 21;
			num75 = num42 >> 21;
			num43 += num75;
			num42 -= num75 << 21;
			num64 = num43 >> 21;
			num44 += num64;
			num43 -= num64 << 21;
			num76 = num44 >> 21;
			num45 += num76;
			num44 -= num76 << 21;
			num65 = num45 >> 21;
			num46 += num65;
			num45 -= num65 << 21;
			num77 = num46 >> 21;
			num47 += num77;
			num46 -= num77 << 21;
			num66 = num47 >> 21;
			num48 += num66;
			num47 -= num66 << 21;
			s[0] = (byte)num37;
			s[1] = (byte)(num37 >> 8);
			s[2] = (byte)((num37 >> 16) | (num38 << 5));
			s[3] = (byte)(num38 >> 3);
			s[4] = (byte)(num38 >> 11);
			s[5] = (byte)((num38 >> 19) | (num39 << 2));
			s[6] = (byte)(num39 >> 6);
			s[7] = (byte)((num39 >> 14) | (num40 << 7));
			s[8] = (byte)(num40 >> 1);
			s[9] = (byte)(num40 >> 9);
			s[10] = (byte)((num40 >> 17) | (num41 << 4));
			s[11] = (byte)(num41 >> 4);
			s[12] = (byte)(num41 >> 12);
			s[13] = (byte)((num41 >> 20) | (num42 << 1));
			s[14] = (byte)(num42 >> 7);
			s[15] = (byte)((num42 >> 15) | (num43 << 6));
			s[16] = (byte)(num43 >> 2);
			s[17] = (byte)(num43 >> 10);
			s[18] = (byte)((num43 >> 18) | (num44 << 3));
			s[19] = (byte)(num44 >> 5);
			s[20] = (byte)(num44 >> 13);
			s[21] = (byte)num45;
			s[22] = (byte)(num45 >> 8);
			s[23] = (byte)((num45 >> 16) | (num46 << 5));
			s[24] = (byte)(num46 >> 3);
			s[25] = (byte)(num46 >> 11);
			s[26] = (byte)((num46 >> 19) | (num47 << 2));
			s[27] = (byte)(num47 >> 6);
			s[28] = (byte)((num47 >> 14) | (num48 << 7));
			s[29] = (byte)(num48 >> 1);
			s[30] = (byte)(num48 >> 9);
			s[31] = (byte)(num48 >> 17);
		}
	}
	internal class FieldElement
	{
		public static int[] New()
		{
			return new int[10];
		}

		public static int[] New(int a, int b, int c, int d, int e, int f, int g, int h, int i, int j)
		{
			return new int[10] { a, b, c, d, e, f, g, h, i, j };
		}

		public static int readUnsigned(byte b)
		{
			return b & 0xFF;
		}

		public static long load_3(byte[] inp, int ofs)
		{
			return readUnsigned(inp[ofs]) | ((long)readUnsigned(inp[1 + ofs]) << 8) | ((long)readUnsigned(inp[2 + ofs]) << 16);
		}

		public static long load_4(byte[] inp, int ofs)
		{
			return readUnsigned(inp[ofs]) | ((long)readUnsigned(inp[1 + ofs]) << 8) | ((long)readUnsigned(inp[2 + ofs]) << 16) | ((long)readUnsigned(inp[3 + ofs]) << 24);
		}

		public static void fe_0(int[] h)
		{
			h[0] = 0;
			h[1] = 0;
			h[2] = 0;
			h[3] = 0;
			h[4] = 0;
			h[5] = 0;
			h[6] = 0;
			h[7] = 0;
			h[8] = 0;
			h[9] = 0;
		}

		public static void fe_1(int[] h)
		{
			h[0] = 1;
			h[1] = 0;
			h[2] = 0;
			h[3] = 0;
			h[4] = 0;
			h[5] = 0;
			h[6] = 0;
			h[7] = 0;
			h[8] = 0;
			h[9] = 0;
		}

		public static void fe_add(int[] h, int[] f, int[] g)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			int num11 = g[0];
			int num12 = g[1];
			int num13 = g[2];
			int num14 = g[3];
			int num15 = g[4];
			int num16 = g[5];
			int num17 = g[6];
			int num18 = g[7];
			int num19 = g[8];
			int num20 = g[9];
			int num21 = num + num11;
			int num22 = num2 + num12;
			int num23 = num3 + num13;
			int num24 = num4 + num14;
			int num25 = num5 + num15;
			int num26 = num6 + num16;
			int num27 = num7 + num17;
			int num28 = num8 + num18;
			int num29 = num9 + num19;
			int num30 = num10 + num20;
			h[0] = num21;
			h[1] = num22;
			h[2] = num23;
			h[3] = num24;
			h[4] = num25;
			h[5] = num26;
			h[6] = num27;
			h[7] = num28;
			h[8] = num29;
			h[9] = num30;
		}

		public static void fe_cmov(int[] f, int[] g, int b)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			int num11 = g[0];
			int num12 = g[1];
			int num13 = g[2];
			int num14 = g[3];
			int num15 = g[4];
			int num16 = g[5];
			int num17 = g[6];
			int num18 = g[7];
			int num19 = g[8];
			int num20 = g[9];
			int num21 = num ^ num11;
			int num22 = num2 ^ num12;
			int num23 = num3 ^ num13;
			int num24 = num4 ^ num14;
			int num25 = num5 ^ num15;
			int num26 = num6 ^ num16;
			int num27 = num7 ^ num17;
			int num28 = num8 ^ num18;
			int num29 = num9 ^ num19;
			int num30 = num10 ^ num20;
			b = -b;
			num21 &= b;
			num22 &= b;
			num23 &= b;
			num24 &= b;
			num25 &= b;
			num26 &= b;
			num27 &= b;
			num28 &= b;
			num29 &= b;
			num30 &= b;
			f[0] = num ^ num21;
			f[1] = num2 ^ num22;
			f[2] = num3 ^ num23;
			f[3] = num4 ^ num24;
			f[4] = num5 ^ num25;
			f[5] = num6 ^ num26;
			f[6] = num7 ^ num27;
			f[7] = num8 ^ num28;
			f[8] = num9 ^ num29;
			f[9] = num10 ^ num30;
		}

		public static void fe_cswap(int[] f, int[] g, int b)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			int num11 = g[0];
			int num12 = g[1];
			int num13 = g[2];
			int num14 = g[3];
			int num15 = g[4];
			int num16 = g[5];
			int num17 = g[6];
			int num18 = g[7];
			int num19 = g[8];
			int num20 = g[9];
			int num21 = num ^ num11;
			int num22 = num2 ^ num12;
			int num23 = num3 ^ num13;
			int num24 = num4 ^ num14;
			int num25 = num5 ^ num15;
			int num26 = num6 ^ num16;
			int num27 = num7 ^ num17;
			int num28 = num8 ^ num18;
			int num29 = num9 ^ num19;
			int num30 = num10 ^ num20;
			b = -b;
			num21 &= b;
			num22 &= b;
			num23 &= b;
			num24 &= b;
			num25 &= b;
			num26 &= b;
			num27 &= b;
			num28 &= b;
			num29 &= b;
			num30 &= b;
			f[0] = num ^ num21;
			f[1] = num2 ^ num22;
			f[2] = num3 ^ num23;
			f[3] = num4 ^ num24;
			f[4] = num5 ^ num25;
			f[5] = num6 ^ num26;
			f[6] = num7 ^ num27;
			f[7] = num8 ^ num28;
			f[8] = num9 ^ num29;
			f[9] = num10 ^ num30;
			g[0] = num11 ^ num21;
			g[1] = num12 ^ num22;
			g[2] = num13 ^ num23;
			g[3] = num14 ^ num24;
			g[4] = num15 ^ num25;
			g[5] = num16 ^ num26;
			g[6] = num17 ^ num27;
			g[7] = num18 ^ num28;
			g[8] = num19 ^ num29;
			g[9] = num20 ^ num30;
		}

		public static void fe_copy(int[] h, int[] f)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			h[0] = num;
			h[1] = num2;
			h[2] = num3;
			h[3] = num4;
			h[4] = num5;
			h[5] = num6;
			h[6] = num7;
			h[7] = num8;
			h[8] = num9;
			h[9] = num10;
		}

		public static void fe_frombytes(int[] h, byte[] s)
		{
			long num = load_4(s, 0);
			long num2 = load_3(s, 4) << 6;
			long num3 = load_3(s, 7) << 5;
			long num4 = load_3(s, 10) << 3;
			long num5 = load_3(s, 13) << 2;
			long num6 = load_4(s, 16);
			long num7 = load_3(s, 20) << 7;
			long num8 = load_3(s, 23) << 5;
			long num9 = load_3(s, 26) << 4;
			long num10 = (load_3(s, 29) & 0x7FFFFF) << 2;
			long num11 = num10 + 16777216 >> 25;
			num += num11 * 19;
			num10 -= num11 << 25;
			long num12 = num2 + 16777216 >> 25;
			num3 += num12;
			num2 -= num12 << 25;
			long num13 = num4 + 16777216 >> 25;
			num5 += num13;
			num4 -= num13 << 25;
			long num14 = num6 + 16777216 >> 25;
			num7 += num14;
			num6 -= num14 << 25;
			long num15 = num8 + 16777216 >> 25;
			num9 += num15;
			num8 -= num15 << 25;
			long num16 = num + 33554432 >> 26;
			num2 += num16;
			num -= num16 << 26;
			long num17 = num3 + 33554432 >> 26;
			num4 += num17;
			num3 -= num17 << 26;
			long num18 = num5 + 33554432 >> 26;
			num6 += num18;
			num5 -= num18 << 26;
			long num19 = num7 + 33554432 >> 26;
			num8 += num19;
			num7 -= num19 << 26;
			long num20 = num9 + 33554432 >> 26;
			num10 += num20;
			num9 -= num20 << 26;
			h[0] = (int)num;
			h[1] = (int)num2;
			h[2] = (int)num3;
			h[3] = (int)num4;
			h[4] = (int)num5;
			h[5] = (int)num6;
			h[6] = (int)num7;
			h[7] = (int)num8;
			h[8] = (int)num9;
			h[9] = (int)num10;
		}

		public static void fe_invert(int[] outp, int[] z)
		{
			int[] array = New();
			int[] array2 = New();
			int[] array3 = New();
			int[] array4 = New();
			fe_sq(array, z);
			for (int i = 1; i < 1; i++)
			{
				fe_sq(array, array);
			}
			fe_sq(array2, array);
			for (int i = 1; i < 2; i++)
			{
				fe_sq(array2, array2);
			}
			fe_mul(array2, z, array2);
			fe_mul(array, array, array2);
			fe_sq(array3, array);
			for (int i = 1; i < 1; i++)
			{
				fe_sq(array3, array3);
			}
			fe_mul(array2, array2, array3);
			fe_sq(array3, array2);
			for (int i = 1; i < 5; i++)
			{
				fe_sq(array3, array3);
			}
			fe_mul(array2, array3, array2);
			fe_sq(array3, array2);
			for (int i = 1; i < 10; i++)
			{
				fe_sq(array3, array3);
			}
			fe_mul(array3, array3, array2);
			fe_sq(array4, array3);
			for (int i = 1; i < 20; i++)
			{
				fe_sq(array4, array4);
			}
			fe_mul(array3, array4, array3);
			fe_sq(array3, array3);
			for (int i = 1; i < 10; i++)
			{
				fe_sq(array3, array3);
			}
			fe_mul(array2, array3, array2);
			fe_sq(array3, array2);
			for (int i = 1; i < 50; i++)
			{
				fe_sq(array3, array3);
			}
			fe_mul(array3, array3, array2);
			fe_sq(array4, array3);
			for (int i = 1; i < 100; i++)
			{
				fe_sq(array4, array4);
			}
			fe_mul(array3, array4, array3);
			fe_sq(array3, array3);
			for (int i = 1; i < 50; i++)
			{
				fe_sq(array3, array3);
			}
			fe_mul(array2, array3, array2);
			fe_sq(array2, array2);
			for (int i = 1; i < 5; i++)
			{
				fe_sq(array2, array2);
			}
			fe_mul(outp, array2, array);
		}

		public static int fe_isnegative(int[] f)
		{
			byte[] array = new byte[32];
			fe_tobytes(array, f);
			return array[0] & 1;
		}

		public static int fe_isnonzero(int[] f)
		{
			byte[] array = new byte[32];
			fe_tobytes(array, f);
			if ((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)((byte)(array[0] | array[1]) | array[2]) | array[3]) | array[4]) | array[5]) | array[6]) | array[7]) | array[8]) | array[9]) | array[10]) | array[11]) | array[12]) | array[13]) | array[14]) | array[15]) | array[16]) | array[17]) | array[18]) | array[19]) | array[20]) | array[21]) | array[22]) | array[23]) | array[24]) | array[25]) | array[26]) | array[27]) | array[28]) | array[29]) | array[30]) | array[31]) == 0)
			{
				return 0;
			}
			return 1;
		}

		public static void fe_mul(int[] h, int[] f, int[] g)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			int num11 = g[0];
			int num12 = g[1];
			int num13 = g[2];
			int num14 = g[3];
			int num15 = g[4];
			int num16 = g[5];
			int num17 = g[6];
			int num18 = g[7];
			int num19 = g[8];
			int num20 = g[9];
			int num21 = 19 * num12;
			int num22 = 19 * num13;
			int num23 = 19 * num14;
			int num24 = 19 * num15;
			int num25 = 19 * num16;
			int num26 = 19 * num17;
			int num27 = 19 * num18;
			int num28 = 19 * num19;
			int num29 = 19 * num20;
			int num30 = 2 * num2;
			int num31 = 2 * num4;
			int num32 = 2 * num6;
			int num33 = 2 * num8;
			int num34 = 2 * num10;
			long num35 = (long)num * (long)num11;
			long num36 = (long)num * (long)num12;
			long num37 = (long)num * (long)num13;
			long num38 = (long)num * (long)num14;
			long num39 = (long)num * (long)num15;
			long num40 = (long)num * (long)num16;
			long num41 = (long)num * (long)num17;
			long num42 = (long)num * (long)num18;
			long num43 = (long)num * (long)num19;
			long num44 = (long)num * (long)num20;
			long num45 = (long)num2 * (long)num11;
			long num46 = (long)num30 * (long)num12;
			long num47 = (long)num2 * (long)num13;
			long num48 = (long)num30 * (long)num14;
			long num49 = (long)num2 * (long)num15;
			long num50 = (long)num30 * (long)num16;
			long num51 = (long)num2 * (long)num17;
			long num52 = (long)num30 * (long)num18;
			long num53 = (long)num2 * (long)num19;
			long num54 = (long)num30 * (long)num29;
			long num55 = (long)num3 * (long)num11;
			long num56 = (long)num3 * (long)num12;
			long num57 = (long)num3 * (long)num13;
			long num58 = (long)num3 * (long)num14;
			long num59 = (long)num3 * (long)num15;
			long num60 = (long)num3 * (long)num16;
			long num61 = (long)num3 * (long)num17;
			long num62 = (long)num3 * (long)num18;
			long num63 = (long)num3 * (long)num28;
			long num64 = (long)num3 * (long)num29;
			long num65 = (long)num4 * (long)num11;
			long num66 = (long)num31 * (long)num12;
			long num67 = (long)num4 * (long)num13;
			long num68 = (long)num31 * (long)num14;
			long num69 = (long)num4 * (long)num15;
			long num70 = (long)num31 * (long)num16;
			long num71 = (long)num4 * (long)num17;
			long num72 = (long)num31 * (long)num27;
			long num73 = (long)num4 * (long)num28;
			long num74 = (long)num31 * (long)num29;
			long num75 = (long)num5 * (long)num11;
			long num76 = (long)num5 * (long)num12;
			long num77 = (long)num5 * (long)num13;
			long num78 = (long)num5 * (long)num14;
			long num79 = (long)num5 * (long)num15;
			long num80 = (long)num5 * (long)num16;
			long num81 = (long)num5 * (long)num26;
			long num82 = (long)num5 * (long)num27;
			long num83 = (long)num5 * (long)num28;
			long num84 = (long)num5 * (long)num29;
			long num85 = (long)num6 * (long)num11;
			long num86 = (long)num32 * (long)num12;
			long num87 = (long)num6 * (long)num13;
			long num88 = (long)num32 * (long)num14;
			long num89 = (long)num6 * (long)num15;
			long num90 = (long)num32 * (long)num25;
			long num91 = (long)num6 * (long)num26;
			long num92 = (long)num32 * (long)num27;
			long num93 = (long)num6 * (long)num28;
			long num94 = (long)num32 * (long)num29;
			long num95 = (long)num7 * (long)num11;
			long num96 = (long)num7 * (long)num12;
			long num97 = (long)num7 * (long)num13;
			long num98 = (long)num7 * (long)num14;
			long num99 = (long)num7 * (long)num24;
			long num100 = (long)num7 * (long)num25;
			long num101 = (long)num7 * (long)num26;
			long num102 = (long)num7 * (long)num27;
			long num103 = (long)num7 * (long)num28;
			long num104 = (long)num7 * (long)num29;
			long num105 = (long)num8 * (long)num11;
			long num106 = (long)num33 * (long)num12;
			long num107 = (long)num8 * (long)num13;
			long num108 = (long)num33 * (long)num23;
			long num109 = (long)num8 * (long)num24;
			long num110 = (long)num33 * (long)num25;
			long num111 = (long)num8 * (long)num26;
			long num112 = (long)num33 * (long)num27;
			long num113 = (long)num8 * (long)num28;
			long num114 = (long)num33 * (long)num29;
			long num115 = (long)num9 * (long)num11;
			long num116 = (long)num9 * (long)num12;
			long num117 = (long)num9 * (long)num22;
			long num118 = (long)num9 * (long)num23;
			long num119 = (long)num9 * (long)num24;
			long num120 = (long)num9 * (long)num25;
			long num121 = (long)num9 * (long)num26;
			long num122 = (long)num9 * (long)num27;
			long num123 = (long)num9 * (long)num28;
			long num124 = (long)num9 * (long)num29;
			long num125 = (long)num10 * (long)num11;
			long num126 = (long)num34 * (long)num21;
			long num127 = (long)num10 * (long)num22;
			long num128 = (long)num34 * (long)num23;
			long num129 = (long)num10 * (long)num24;
			long num130 = (long)num34 * (long)num25;
			long num131 = (long)num10 * (long)num26;
			long num132 = (long)num34 * (long)num27;
			long num133 = (long)num10 * (long)num28;
			long num134 = (long)num34 * (long)num29;
			long num135 = num35 + num54 + num63 + num72 + num81 + num90 + num99 + num108 + num117 + num126;
			long num136 = num36 + num45 + num64 + num73 + num82 + num91 + num100 + num109 + num118 + num127;
			long num137 = num37 + num46 + num55 + num74 + num83 + num92 + num101 + num110 + num119 + num128;
			long num138 = num38 + num47 + num56 + num65 + num84 + num93 + num102 + num111 + num120 + num129;
			long num139 = num39 + num48 + num57 + num66 + num75 + num94 + num103 + num112 + num121 + num130;
			long num140 = num40 + num49 + num58 + num67 + num76 + num85 + num104 + num113 + num122 + num131;
			long num141 = num41 + num50 + num59 + num68 + num77 + num86 + num95 + num114 + num123 + num132;
			long num142 = num42 + num51 + num60 + num69 + num78 + num87 + num96 + num105 + num124 + num133;
			long num143 = num43 + num52 + num61 + num70 + num79 + num88 + num97 + num106 + num115 + num134;
			long num144 = num44 + num53 + num62 + num71 + num80 + num89 + num98 + num107 + num116 + num125;
			long num145 = num135 + 33554432 >> 26;
			num136 += num145;
			num135 -= num145 << 26;
			long num146 = num139 + 33554432 >> 26;
			num140 += num146;
			num139 -= num146 << 26;
			long num147 = num136 + 16777216 >> 25;
			num137 += num147;
			num136 -= num147 << 25;
			long num148 = num140 + 16777216 >> 25;
			num141 += num148;
			num140 -= num148 << 25;
			long num149 = num137 + 33554432 >> 26;
			num138 += num149;
			num137 -= num149 << 26;
			long num150 = num141 + 33554432 >> 26;
			num142 += num150;
			num141 -= num150 << 26;
			long num151 = num138 + 16777216 >> 25;
			num139 += num151;
			num138 -= num151 << 25;
			long num152 = num142 + 16777216 >> 25;
			num143 += num152;
			num142 -= num152 << 25;
			num146 = num139 + 33554432 >> 26;
			num140 += num146;
			num139 -= num146 << 26;
			long num153 = num143 + 33554432 >> 26;
			num144 += num153;
			num143 -= num153 << 26;
			long num154 = num144 + 16777216 >> 25;
			num135 += num154 * 19;
			num144 -= num154 << 25;
			num145 = num135 + 33554432 >> 26;
			num136 += num145;
			num135 -= num145 << 26;
			h[0] = (int)num135;
			h[1] = (int)num136;
			h[2] = (int)num137;
			h[3] = (int)num138;
			h[4] = (int)num139;
			h[5] = (int)num140;
			h[6] = (int)num141;
			h[7] = (int)num142;
			h[8] = (int)num143;
			h[9] = (int)num144;
		}

		public static void fe_mul121666(int[] h, int[] f)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			long num11 = (long)num * 121666L;
			long num12 = (long)num2 * 121666L;
			long num13 = (long)num3 * 121666L;
			long num14 = (long)num4 * 121666L;
			long num15 = (long)num5 * 121666L;
			long num16 = (long)num6 * 121666L;
			long num17 = (long)num7 * 121666L;
			long num18 = (long)num8 * 121666L;
			long num19 = (long)num9 * 121666L;
			long num20 = (long)num10 * 121666L;
			long num21 = num20 + 16777216 >> 25;
			num11 += num21 * 19;
			num20 -= num21 << 25;
			long num22 = num12 + 16777216 >> 25;
			num13 += num22;
			num12 -= num22 << 25;
			long num23 = num14 + 16777216 >> 25;
			num15 += num23;
			num14 -= num23 << 25;
			long num24 = num16 + 16777216 >> 25;
			num17 += num24;
			num16 -= num24 << 25;
			long num25 = num18 + 16777216 >> 25;
			num19 += num25;
			num18 -= num25 << 25;
			long num26 = num11 + 33554432 >> 26;
			num12 += num26;
			num11 -= num26 << 26;
			long num27 = num13 + 33554432 >> 26;
			num14 += num27;
			num13 -= num27 << 26;
			long num28 = num15 + 33554432 >> 26;
			num16 += num28;
			num15 -= num28 << 26;
			long num29 = num17 + 33554432 >> 26;
			num18 += num29;
			num17 -= num29 << 26;
			long num30 = num19 + 33554432 >> 26;
			num20 += num30;
			num19 -= num30 << 26;
			h[0] = (int)num11;
			h[1] = (int)num12;
			h[2] = (int)num13;
			h[3] = (int)num14;
			h[4] = (int)num15;
			h[5] = (int)num16;
			h[6] = (int)num17;
			h[7] = (int)num18;
			h[8] = (int)num19;
			h[9] = (int)num20;
		}

		public static void fe_neg(int[] h, int[] f)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			int num11 = -num;
			int num12 = -num2;
			int num13 = -num3;
			int num14 = -num4;
			int num15 = -num5;
			int num16 = -num6;
			int num17 = -num7;
			int num18 = -num8;
			int num19 = -num9;
			int num20 = -num10;
			h[0] = num11;
			h[1] = num12;
			h[2] = num13;
			h[3] = num14;
			h[4] = num15;
			h[5] = num16;
			h[6] = num17;
			h[7] = num18;
			h[8] = num19;
			h[9] = num20;
		}

		public static void fe_pow22523(int[] outp, int[] z)
		{
			int[] array = New();
			int[] array2 = New();
			int[] array3 = New();
			fe_sq(array, z);
			for (int i = 1; i < 1; i++)
			{
				fe_sq(array, array);
			}
			fe_sq(array2, array);
			for (int i = 1; i < 2; i++)
			{
				fe_sq(array2, array2);
			}
			fe_mul(array2, z, array2);
			fe_mul(array, array, array2);
			fe_sq(array, array);
			for (int i = 1; i < 1; i++)
			{
				fe_sq(array, array);
			}
			fe_mul(array, array2, array);
			fe_sq(array2, array);
			for (int i = 1; i < 5; i++)
			{
				fe_sq(array2, array2);
			}
			fe_mul(array, array2, array);
			fe_sq(array2, array);
			for (int i = 1; i < 10; i++)
			{
				fe_sq(array2, array2);
			}
			fe_mul(array2, array2, array);
			fe_sq(array3, array2);
			for (int i = 1; i < 20; i++)
			{
				fe_sq(array3, array3);
			}
			fe_mul(array2, array3, array2);
			fe_sq(array2, array2);
			for (int i = 1; i < 10; i++)
			{
				fe_sq(array2, array2);
			}
			fe_mul(array, array2, array);
			fe_sq(array2, array);
			for (int i = 1; i < 50; i++)
			{
				fe_sq(array2, array2);
			}
			fe_mul(array2, array2, array);
			fe_sq(array3, array2);
			for (int i = 1; i < 100; i++)
			{
				fe_sq(array3, array3);
			}
			fe_mul(array2, array3, array2);
			fe_sq(array2, array2);
			for (int i = 1; i < 50; i++)
			{
				fe_sq(array2, array2);
			}
			fe_mul(array, array2, array);
			fe_sq(array, array);
			for (int i = 1; i < 2; i++)
			{
				fe_sq(array, array);
			}
			fe_mul(outp, array, z);
		}

		public static void fe_sq(int[] h, int[] f)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			int num11 = 2 * num;
			int num12 = 2 * num2;
			int num13 = 2 * num3;
			int num14 = 2 * num4;
			int num15 = 2 * num5;
			int num16 = 2 * num6;
			int num17 = 2 * num7;
			int num18 = 2 * num8;
			int num19 = 38 * num6;
			int num20 = 19 * num7;
			int num21 = 38 * num8;
			int num22 = 19 * num9;
			int num23 = 38 * num10;
			long num24 = (long)num * (long)num;
			long num25 = (long)num11 * (long)num2;
			long num26 = (long)num11 * (long)num3;
			long num27 = (long)num11 * (long)num4;
			long num28 = (long)num11 * (long)num5;
			long num29 = (long)num11 * (long)num6;
			long num30 = (long)num11 * (long)num7;
			long num31 = (long)num11 * (long)num8;
			long num32 = (long)num11 * (long)num9;
			long num33 = (long)num11 * (long)num10;
			long num34 = (long)num12 * (long)num2;
			long num35 = (long)num12 * (long)num3;
			long num36 = (long)num12 * (long)num14;
			long num37 = (long)num12 * (long)num5;
			long num38 = (long)num12 * (long)num16;
			long num39 = (long)num12 * (long)num7;
			long num40 = (long)num12 * (long)num18;
			long num41 = (long)num12 * (long)num9;
			long num42 = (long)num12 * (long)num23;
			long num43 = (long)num3 * (long)num3;
			long num44 = (long)num13 * (long)num4;
			long num45 = (long)num13 * (long)num5;
			long num46 = (long)num13 * (long)num6;
			long num47 = (long)num13 * (long)num7;
			long num48 = (long)num13 * (long)num8;
			long num49 = (long)num13 * (long)num22;
			long num50 = (long)num3 * (long)num23;
			long num51 = (long)num14 * (long)num4;
			long num52 = (long)num14 * (long)num5;
			long num53 = (long)num14 * (long)num16;
			long num54 = (long)num14 * (long)num7;
			long num55 = (long)num14 * (long)num21;
			long num56 = (long)num14 * (long)num22;
			long num57 = (long)num14 * (long)num23;
			long num58 = (long)num5 * (long)num5;
			long num59 = (long)num15 * (long)num6;
			long num60 = (long)num15 * (long)num20;
			long num61 = (long)num5 * (long)num21;
			long num62 = (long)num15 * (long)num22;
			long num63 = (long)num5 * (long)num23;
			long num64 = (long)num6 * (long)num19;
			long num65 = (long)num16 * (long)num20;
			long num66 = (long)num16 * (long)num21;
			long num67 = (long)num16 * (long)num22;
			long num68 = (long)num16 * (long)num23;
			long num69 = (long)num7 * (long)num20;
			long num70 = (long)num7 * (long)num21;
			long num71 = (long)num17 * (long)num22;
			long num72 = (long)num7 * (long)num23;
			long num73 = (long)num8 * (long)num21;
			long num74 = (long)num18 * (long)num22;
			long num75 = (long)num18 * (long)num23;
			long num76 = (long)num9 * (long)num22;
			long num77 = (long)num9 * (long)num23;
			long num78 = (long)num10 * (long)num23;
			long num79 = num24 + num42 + num49 + num55 + num60 + num64;
			long num80 = num25 + num50 + num56 + num61 + num65;
			long num81 = num26 + num34 + num57 + num62 + num66 + num69;
			long num82 = num27 + num35 + num63 + num67 + num70;
			long num83 = num28 + num36 + num43 + num68 + num71 + num73;
			long num84 = num29 + num37 + num44 + num72 + num74;
			long num85 = num30 + num38 + num45 + num51 + num75 + num76;
			long num86 = num31 + num39 + num46 + num52 + num77;
			long num87 = num32 + num40 + num47 + num53 + num58 + num78;
			long num88 = num33 + num41 + num48 + num54 + num59;
			long num89 = num79 + 33554432 >> 26;
			num80 += num89;
			num79 -= num89 << 26;
			long num90 = num83 + 33554432 >> 26;
			num84 += num90;
			num83 -= num90 << 26;
			long num91 = num80 + 16777216 >> 25;
			num81 += num91;
			num80 -= num91 << 25;
			long num92 = num84 + 16777216 >> 25;
			num85 += num92;
			num84 -= num92 << 25;
			long num93 = num81 + 33554432 >> 26;
			num82 += num93;
			num81 -= num93 << 26;
			long num94 = num85 + 33554432 >> 26;
			num86 += num94;
			num85 -= num94 << 26;
			long num95 = num82 + 16777216 >> 25;
			num83 += num95;
			num82 -= num95 << 25;
			long num96 = num86 + 16777216 >> 25;
			num87 += num96;
			num86 -= num96 << 25;
			num90 = num83 + 33554432 >> 26;
			num84 += num90;
			num83 -= num90 << 26;
			long num97 = num87 + 33554432 >> 26;
			num88 += num97;
			num87 -= num97 << 26;
			long num98 = num88 + 16777216 >> 25;
			num79 += num98 * 19;
			num88 -= num98 << 25;
			num89 = num79 + 33554432 >> 26;
			num80 += num89;
			num79 -= num89 << 26;
			h[0] = (int)num79;
			h[1] = (int)num80;
			h[2] = (int)num81;
			h[3] = (int)num82;
			h[4] = (int)num83;
			h[5] = (int)num84;
			h[6] = (int)num85;
			h[7] = (int)num86;
			h[8] = (int)num87;
			h[9] = (int)num88;
		}

		public static void fe_sq2(int[] h, int[] f)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			int num11 = 2 * num;
			int num12 = 2 * num2;
			int num13 = 2 * num3;
			int num14 = 2 * num4;
			int num15 = 2 * num5;
			int num16 = 2 * num6;
			int num17 = 2 * num7;
			int num18 = 2 * num8;
			int num19 = 38 * num6;
			int num20 = 19 * num7;
			int num21 = 38 * num8;
			int num22 = 19 * num9;
			int num23 = 38 * num10;
			long num24 = (long)num * (long)num;
			long num25 = (long)num11 * (long)num2;
			long num26 = (long)num11 * (long)num3;
			long num27 = (long)num11 * (long)num4;
			long num28 = (long)num11 * (long)num5;
			long num29 = (long)num11 * (long)num6;
			long num30 = (long)num11 * (long)num7;
			long num31 = (long)num11 * (long)num8;
			long num32 = (long)num11 * (long)num9;
			long num33 = (long)num11 * (long)num10;
			long num34 = (long)num12 * (long)num2;
			long num35 = (long)num12 * (long)num3;
			long num36 = (long)num12 * (long)num14;
			long num37 = (long)num12 * (long)num5;
			long num38 = (long)num12 * (long)num16;
			long num39 = (long)num12 * (long)num7;
			long num40 = (long)num12 * (long)num18;
			long num41 = (long)num12 * (long)num9;
			long num42 = (long)num12 * (long)num23;
			long num43 = (long)num3 * (long)num3;
			long num44 = (long)num13 * (long)num4;
			long num45 = (long)num13 * (long)num5;
			long num46 = (long)num13 * (long)num6;
			long num47 = (long)num13 * (long)num7;
			long num48 = (long)num13 * (long)num8;
			long num49 = (long)num13 * (long)num22;
			long num50 = (long)num3 * (long)num23;
			long num51 = (long)num14 * (long)num4;
			long num52 = (long)num14 * (long)num5;
			long num53 = (long)num14 * (long)num16;
			long num54 = (long)num14 * (long)num7;
			long num55 = (long)num14 * (long)num21;
			long num56 = (long)num14 * (long)num22;
			long num57 = (long)num14 * (long)num23;
			long num58 = (long)num5 * (long)num5;
			long num59 = (long)num15 * (long)num6;
			long num60 = (long)num15 * (long)num20;
			long num61 = (long)num5 * (long)num21;
			long num62 = (long)num15 * (long)num22;
			long num63 = (long)num5 * (long)num23;
			long num64 = (long)num6 * (long)num19;
			long num65 = (long)num16 * (long)num20;
			long num66 = (long)num16 * (long)num21;
			long num67 = (long)num16 * (long)num22;
			long num68 = (long)num16 * (long)num23;
			long num69 = (long)num7 * (long)num20;
			long num70 = (long)num7 * (long)num21;
			long num71 = (long)num17 * (long)num22;
			long num72 = (long)num7 * (long)num23;
			long num73 = (long)num8 * (long)num21;
			long num74 = (long)num18 * (long)num22;
			long num75 = (long)num18 * (long)num23;
			long num76 = (long)num9 * (long)num22;
			long num77 = (long)num9 * (long)num23;
			long num78 = (long)num10 * (long)num23;
			long num79 = num24 + num42 + num49 + num55 + num60 + num64;
			long num80 = num25 + num50 + num56 + num61 + num65;
			long num81 = num26 + num34 + num57 + num62 + num66 + num69;
			long num82 = num27 + num35 + num63 + num67 + num70;
			long num83 = num28 + num36 + num43 + num68 + num71 + num73;
			long num84 = num29 + num37 + num44 + num72 + num74;
			long num85 = num30 + num38 + num45 + num51 + num75 + num76;
			long num86 = num31 + num39 + num46 + num52 + num77;
			long num87 = num32 + num40 + num47 + num53 + num58 + num78;
			long num88 = num33 + num41 + num48 + num54 + num59;
			num79 += num79;
			num80 += num80;
			num81 += num81;
			num82 += num82;
			num83 += num83;
			num84 += num84;
			num85 += num85;
			num86 += num86;
			num87 += num87;
			num88 += num88;
			long num89 = num79 + 33554432 >> 26;
			num80 += num89;
			num79 -= num89 << 26;
			long num90 = num83 + 33554432 >> 26;
			num84 += num90;
			num83 -= num90 << 26;
			long num91 = num80 + 16777216 >> 25;
			num81 += num91;
			num80 -= num91 << 25;
			long num92 = num84 + 16777216 >> 25;
			num85 += num92;
			num84 -= num92 << 25;
			long num93 = num81 + 33554432 >> 26;
			num82 += num93;
			num81 -= num93 << 26;
			long num94 = num85 + 33554432 >> 26;
			num86 += num94;
			num85 -= num94 << 26;
			long num95 = num82 + 16777216 >> 25;
			num83 += num95;
			num82 -= num95 << 25;
			long num96 = num86 + 16777216 >> 25;
			num87 += num96;
			num86 -= num96 << 25;
			num90 = num83 + 33554432 >> 26;
			num84 += num90;
			num83 -= num90 << 26;
			long num97 = num87 + 33554432 >> 26;
			num88 += num97;
			num87 -= num97 << 26;
			long num98 = num88 + 16777216 >> 25;
			num79 += num98 * 19;
			num88 -= num98 << 25;
			num89 = num79 + 33554432 >> 26;
			num80 += num89;
			num79 -= num89 << 26;
			h[0] = (int)num79;
			h[1] = (int)num80;
			h[2] = (int)num81;
			h[3] = (int)num82;
			h[4] = (int)num83;
			h[5] = (int)num84;
			h[6] = (int)num85;
			h[7] = (int)num86;
			h[8] = (int)num87;
			h[9] = (int)num88;
		}

		public static void fe_sub(int[] h, int[] f, int[] g)
		{
			int num = f[0];
			int num2 = f[1];
			int num3 = f[2];
			int num4 = f[3];
			int num5 = f[4];
			int num6 = f[5];
			int num7 = f[6];
			int num8 = f[7];
			int num9 = f[8];
			int num10 = f[9];
			int num11 = g[0];
			int num12 = g[1];
			int num13 = g[2];
			int num14 = g[3];
			int num15 = g[4];
			int num16 = g[5];
			int num17 = g[6];
			int num18 = g[7];
			int num19 = g[8];
			int num20 = g[9];
			int num21 = num - num11;
			int num22 = num2 - num12;
			int num23 = num3 - num13;
			int num24 = num4 - num14;
			int num25 = num5 - num15;
			int num26 = num6 - num16;
			int num27 = num7 - num17;
			int num28 = num8 - num18;
			int num29 = num9 - num19;
			int num30 = num10 - num20;
			h[0] = num21;
			h[1] = num22;
			h[2] = num23;
			h[3] = num24;
			h[4] = num25;
			h[5] = num26;
			h[6] = num27;
			h[7] = num28;
			h[8] = num29;
			h[9] = num30;
		}

		public static void fe_tobytes(byte[] s, int[] h)
		{
			int num = h[0];
			int num2 = h[1];
			int num3 = h[2];
			int num4 = h[3];
			int num5 = h[4];
			int num6 = h[5];
			int num7 = h[6];
			int num8 = h[7];
			int num9 = h[8];
			int num10 = h[9];
			int num11 = 19 * num10 + 16777216 >> 25;
			num11 = num + num11 >> 26;
			num11 = num2 + num11 >> 25;
			num11 = num3 + num11 >> 26;
			num11 = num4 + num11 >> 25;
			num11 = num5 + num11 >> 26;
			num11 = num6 + num11 >> 25;
			num11 = num7 + num11 >> 26;
			num11 = num8 + num11 >> 25;
			num11 = num9 + num11 >> 26;
			num11 = num10 + num11 >> 25;
			num += 19 * num11;
			int num12 = num >> 26;
			num2 += num12;
			num -= num12 << 26;
			int num13 = num2 >> 25;
			num3 += num13;
			num2 -= num13 << 25;
			int num14 = num3 >> 26;
			num4 += num14;
			num3 -= num14 << 26;
			int num15 = num4 >> 25;
			num5 += num15;
			num4 -= num15 << 25;
			int num16 = num5 >> 26;
			num6 += num16;
			num5 -= num16 << 26;
			int num17 = num6 >> 25;
			num7 += num17;
			num6 -= num17 << 25;
			int num18 = num7 >> 26;
			num8 += num18;
			num7 -= num18 << 26;
			int num19 = num8 >> 25;
			num9 += num19;
			num8 -= num19 << 25;
			int num20 = num9 >> 26;
			num10 += num20;
			num9 -= num20 << 26;
			int num21 = num10 >> 25;
			num10 -= num21 << 25;
			s[0] = (byte)num;
			s[1] = (byte)(num >> 8);
			s[2] = (byte)(num >> 16);
			s[3] = (byte)((num >> 24) | (num2 << 2));
			s[4] = (byte)(num2 >> 6);
			s[5] = (byte)(num2 >> 14);
			s[6] = (byte)((num2 >> 22) | (num3 << 3));
			s[7] = (byte)(num3 >> 5);
			s[8] = (byte)(num3 >> 13);
			s[9] = (byte)((num3 >> 21) | (num4 << 5));
			s[10] = (byte)(num4 >> 3);
			s[11] = (byte)(num4 >> 11);
			s[12] = (byte)((num4 >> 19) | (num5 << 6));
			s[13] = (byte)(num5 >> 2);
			s[14] = (byte)(num5 >> 10);
			s[15] = (byte)(num5 >> 18);
			s[16] = (byte)num6;
			s[17] = (byte)(num6 >> 8);
			s[18] = (byte)(num6 >> 16);
			s[19] = (byte)((num6 >> 24) | (num7 << 1));
			s[20] = (byte)(num7 >> 7);
			s[21] = (byte)(num7 >> 15);
			s[22] = (byte)((num7 >> 23) | (num8 << 3));
			s[23] = (byte)(num8 >> 5);
			s[24] = (byte)(num8 >> 13);
			s[25] = (byte)((num8 >> 21) | (num9 << 4));
			s[26] = (byte)(num9 >> 4);
			s[27] = (byte)(num9 >> 12);
			s[28] = (byte)((num9 >> 20) | (num10 << 6));
			s[29] = (byte)(num10 >> 2);
			s[30] = (byte)(num10 >> 10);
			s[31] = (byte)(num10 >> 18);
		}
	}
	internal class GroupElement
	{
		internal class ge_p2
		{
			public int[] X = FieldElement.New();

			public int[] Y = FieldElement.New();

			public int[] Z = FieldElement.New();
		}

		internal class ge_p3
		{
			public int[] X = FieldElement.New();

			public int[] Y = FieldElement.New();

			public int[] Z = FieldElement.New();

			public int[] T = FieldElement.New();
		}

		internal class ge_p1p1
		{
			public int[] X = FieldElement.New();

			public int[] Y = FieldElement.New();

			public int[] Z = FieldElement.New();

			public int[] T = FieldElement.New();
		}

		internal class ge_precomp
		{
			public int[] yplusx = FieldElement.New();

			public int[] yminusx = FieldElement.New();

			public int[] xy2d = FieldElement.New();

			public ge_precomp(int[] yplusx, int[] yminusx, int[] xy2d)
			{
				this.yplusx = yplusx;
				this.yminusx = yminusx;
				this.xy2d = xy2d;
			}
		}

		internal class ge_cached
		{
			public int[] YplusX = FieldElement.New();

			public int[] YminusX = FieldElement.New();

			public int[] Z = FieldElement.New();

			public int[] T2d = FieldElement.New();
		}

		private static int[] d = new int[10] { -10913610, 13857413, -15372611, 6949391, 114729, -8787816, -6275908, -3247719, -18696448, -12055116 };

		private static int[] sqrtm1 = new int[10] { -32595792, -7943725, 9377950, 3500415, 12389472, -272473, -25146209, -2005654, 326686, 11406482 };

		private static int[] d2 = new int[10] { -21827239, -5839606, -30745221, 13898782, 229458, 15978800, -12551817, -6495438, 29715968, 9444199 };

		private static ge_precomp[] Bi = new ge_precomp[8]
		{
			new ge_precomp(new int[10] { 25967493, -14356035, 29566456, 3660896, -12694345, 4014787, 27544626, -11754271, -6079156, 2047605 }, new int[10] { -12545711, 934262, -2722910, 3049990, -727428, 9406986, 12720692, 5043384, 19500929, -15469378 }, new int[10] { -8738181, 4489570, 9688441, -14785194, 10184609, -12363380, 29287919, 11864899, -24514362, -4438546 }),
			new ge_precomp(new int[10] { 15636291, -9688557, 24204773, -7912398, 616977, -16685262, 27787600, -14772189, 28944400, -1550024 }, new int[10] { 16568933, 4717097, -11556148, -1102322, 15682896, -11807043, 16354577, -11775962, 7689662, 11199574 }, new int[10] { 30464156, -5976125, -11779434, -15670865, 23220365, 15915852, 7512774, 10017326, -17749093, -9920357 }),
			new ge_precomp(new int[10] { 10861363, 11473154, 27284546, 1981175, -30064349, 12577861, 32867885, 14515107, -15438304, 10819380 }, new int[10] { 4708026, 6336745, 20377586, 9066809, -11272109, 6594696, -25653668, 12483688, -12668491, 5581306 }, new int[10] { 19563160, 16186464, -29386857, 4097519, 10237984, -4348115, 28542350, 13850243, -23678021, -15815942 }),
			new ge_precomp(new int[10] { 5153746, 9909285, 1723747, -2777874, 30523605, 5516873, 19480852, 5230134, -23952439, -15175766 }, new int[10] { -30269007, -3463509, 7665486, 10083793, 28475525, 1649722, 20654025, 16520125, 30598449, 7715701 }, new int[10] { 28881845, 14381568, 9657904, 3680757, -20181635, 7843316, -31400660, 1370708, 29794553, -1409300 }),
			new ge_precomp(new int[10] { -22518993, -6692182, 14201702, -8745502, -23510406, 8844726, 18474211, -1361450, -13062696, 13821877 }, new int[10] { -6455177, -7839871, 3374702, -4740862, -27098617, -10571707, 31655028, -7212327, 18853322, -14220951 }, new int[10] { 4566830, -12963868, -28974889, -12240689, -7602672, -2830569, -8514358, -10431137, 2207753, -3209784 }),
			new ge_precomp(new int[10] { -25154831, -4185821, 29681144, 7868801, -6854661, -9423865, -12437364, -663000, -31111463, -16132436 }, new int[10] { 25576264, -2703214, 7349804, -11814844, 16472782, 9300885, 3844789, 15725684, 171356, 6466918 }, new int[10] { 23103977, 13316479, 9739013, -16149481, 817875, -15038942, 8965339, -14088058, -30714912, 16193877 }),
			new ge_precomp(new int[10] { -33521811, 3180713, -2394130, 14003687, -16903474, -16270840, 17238398, 4729455, -18074513, 9256800 }, new int[10] { -25182317, -4174131, 32336398, 5036987, -21236817, 11360617, 22616405, 9761698, -19827198, 630305 }, new int[10] { -13720693, 2639453, -24237460, -7406481, 9494427, -5774029, -6554551, -15960994, -2449256, -14291300 }),
			new ge_precomp(new int[10] { -3151181, -5046075, 9282714, 6866145, -31907062, -863023, -18940575, 15033784, 25105118, -7894876 }, new int[10] { -24326370, 15950226, -31801215, -14592823, -11662737, -5090925, 1573892, -2625887, 2198790, -15804619 }, new int[10] { -3099351, 10324967, -2241613, 7453183, -5446979, -2735503, -13812022, -16236442, -32461234, -12290683 })
		};

		private static ge_precomp[][] Base = new ge_precomp[32][]
		{
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(25967493, -14356035, 29566456, 3660896, -12694345, 4014787, 27544626, -11754271, -6079156, 2047605), FieldElement.New(-12545711, 934262, -2722910, 3049990, -727428, 9406986, 12720692, 5043384, 19500929, -15469378), FieldElement.New(-8738181, 4489570, 9688441, -14785194, 10184609, -12363380, 29287919, 11864899, -24514362, -4438546)),
				new ge_precomp(FieldElement.New(-12815894, -12976347, -21581243, 11784320, -25355658, -2750717, -11717903, -3814571, -358445, -10211303), FieldElement.New(-21703237, 6903825, 27185491, 6451973, -29577724, -9554005, -15616551, 11189268, -26829678, -5319081), FieldElement.New(26966642, 11152617, 32442495, 15396054, 14353839, -12752335, -3128826, -9541118, -15472047, -4166697)),
				new ge_precomp(FieldElement.New(15636291, -9688557, 24204773, -7912398, 616977, -16685262, 27787600, -14772189, 28944400, -1550024), FieldElement.New(16568933, 4717097, -11556148, -1102322, 15682896, -11807043, 16354577, -11775962, 7689662, 11199574), FieldElement.New(30464156, -5976125, -11779434, -15670865, 23220365, 15915852, 7512774, 10017326, -17749093, -9920357)),
				new ge_precomp(FieldElement.New(-17036878, 13921892, 10945806, -6033431, 27105052, -16084379, -28926210, 15006023, 3284568, -6276540), FieldElement.New(23599295, -8306047, -11193664, -7687416, 13236774, 10506355, 7464579, 9656445, 13059162, 10374397), FieldElement.New(7798556, 16710257, 3033922, 2874086, 28997861, 2835604, 32406664, -3839045, -641708, -101325)),
				new ge_precomp(FieldElement.New(10861363, 11473154, 27284546, 1981175, -30064349, 12577861, 32867885, 14515107, -15438304, 10819380), FieldElement.New(4708026, 6336745, 20377586, 9066809, -11272109, 6594696, -25653668, 12483688, -12668491, 5581306), FieldElement.New(19563160, 16186464, -29386857, 4097519, 10237984, -4348115, 28542350, 13850243, -23678021, -15815942)),
				new ge_precomp(FieldElement.New(-15371964, -12862754, 32573250, 4720197, -26436522, 5875511, -19188627, -15224819, -9818940, -12085777), FieldElement.New(-8549212, 109983, 15149363, 2178705, 22900618, 4543417, 3044240, -15689887, 1762328, 14866737), FieldElement.New(-18199695, -15951423, -10473290, 1707278, -17185920, 3916101, -28236412, 3959421, 27914454, 4383652)),
				new ge_precomp(FieldElement.New(5153746, 9909285, 1723747, -2777874, 30523605, 5516873, 19480852, 5230134, -23952439, -15175766), FieldElement.New(-30269007, -3463509, 7665486, 10083793, 28475525, 1649722, 20654025, 16520125, 30598449, 7715701), FieldElement.New(28881845, 14381568, 9657904, 3680757, -20181635, 7843316, -31400660, 1370708, 29794553, -1409300)),
				new ge_precomp(FieldElement.New(14499471, -2729599, -33191113, -4254652, 28494862, 14271267, 30290735, 10876454, -33154098, 2381726), FieldElement.New(-7195431, -2655363, -14730155, 462251, -27724326, 3941372, -6236617, 3696005, -32300832, 15351955), FieldElement.New(27431194, 8222322, 16448760, -3907995, -18707002, 11938355, -32961401, -2970515, 29551813, 10109425))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-13657040, -13155431, -31283750, 11777098, 21447386, 6519384, -2378284, -1627556, 10092783, -4764171), FieldElement.New(27939166, 14210322, 4677035, 16277044, -22964462, -12398139, -32508754, 12005538, -17810127, 12803510), FieldElement.New(17228999, -15661624, -1233527, 300140, -1224870, -11714777, 30364213, -9038194, 18016357, 4397660)),
				new ge_precomp(FieldElement.New(-10958843, -7690207, 4776341, -14954238, 27850028, -15602212, -26619106, 14544525, -17477504, 982639), FieldElement.New(29253598, 15796703, -2863982, -9908884, 10057023, 3163536, 7332899, -4120128, -21047696, 9934963), FieldElement.New(5793303, 16271923, -24131614, -10116404, 29188560, 1206517, -14747930, 4559895, -30123922, -10897950)),
				new ge_precomp(FieldElement.New(-27643952, -11493006, 16282657, -11036493, 28414021, -15012264, 24191034, 4541697, -13338309, 5500568), FieldElement.New(12650548, -1497113, 9052871, 11355358, -17680037, -8400164, -17430592, 12264343, 10874051, 13524335), FieldElement.New(25556948, -3045990, 714651, 2510400, 23394682, -10415330, 33119038, 5080568, -22528059, 5376628)),
				new ge_precomp(FieldElement.New(-26088264, -4011052, -17013699, -3537628, -6726793, 1920897, -22321305, -9447443, 4535768, 1569007), FieldElement.New(-2255422, 14606630, -21692440, -8039818, 28430649, 8775819, -30494562, 3044290, 31848280, 12543772), FieldElement.New(-22028579, 2943893, -31857513, 6777306, 13784462, -4292203, -27377195, -2062731, 7718482, 14474653)),
				new ge_precomp(FieldElement.New(2385315, 2454213, -22631320, 46603, -4437935, -15680415, 656965, -7236665, 24316168, -5253567), FieldElement.New(13741529, 10911568, -33233417, -8603737, -20177830, -1033297, 33040651, -13424532, -20729456, 8321686), FieldElement.New(21060490, -2212744, 15712757, -4336099, 1639040, 10656336, 23845965, -11874838, -9984458, 608372)),
				new ge_precomp(FieldElement.New(-13672732, -15087586, -10889693, -7557059, -6036909, 11305547, 1123968, -6780577, 27229399, 23887), FieldElement.New(-23244140, -294205, -11744728, 14712571, -29465699, -2029617, 12797024, -6440308, -1633405, 16678954), FieldElement.New(-29500620, 4770662, -16054387, 14001338, 7830047, 9564805, -1508144, -4795045, -17169265, 4904953)),
				new ge_precomp(FieldElement.New(24059557, 14617003, 19037157, -15039908, 19766093, -14906429, 5169211, 16191880, 2128236, -4326833), FieldElement.New(-16981152, 4124966, -8540610, -10653797, 30336522, -14105247, -29806336, 916033, -6882542, -2986532), FieldElement.New(-22630907, 12419372, -7134229, -7473371, -16478904, 16739175, 285431, 2763829, 15736322, 4143876)),
				new ge_precomp(FieldElement.New(2379352, 11839345, -4110402, -5988665, 11274298, 794957, 212801, -14594663, 23527084, -16458268), FieldElement.New(33431127, -11130478, -17838966, -15626900, 8909499, 8376530, -32625340, 4087881, -15188911, -14416214), FieldElement.New(1767683, 7197987, -13205226, -2022635, -13091350, 448826, 5799055, 4357868, -4774191, -16323038))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(6721966, 13833823, -23523388, -1551314, 26354293, -11863321, 23365147, -3949732, 7390890, 2759800), FieldElement.New(4409041, 2052381, 23373853, 10530217, 7676779, -12885954, 21302353, -4264057, 1244380, -12919645), FieldElement.New(-4421239, 7169619, 4982368, -2957590, 30256825, -2777540, 14086413, 9208236, 15886429, 16489664)),
				new ge_precomp(FieldElement.New(1996075, 10375649, 14346367, 13311202, -6874135, -16438411, -13693198, 398369, -30606455, -712933), FieldElement.New(-25307465, 9795880, -2777414, 14878809, -33531835, 14780363, 13348553, 12076947, -30836462, 5113182), FieldElement.New(-17770784, 11797796, 31950843, 13929123, -25888302, 12288344, -30341101, -7336386, 13847711, 5387222)),
				new ge_precomp(FieldElement.New(-18582163, -3416217, 17824843, -2340966, 22744343, -10442611, 8763061, 3617786, -19600662, 10370991), FieldElement.New(20246567, -14369378, 22358229, -543712, 18507283, -10413996, 14554437, -8746092, 32232924, 16763880), FieldElement.New(9648505, 10094563, 26416693, 14745928, -30374318, -6472621, 11094161, 15689506, 3140038, -16510092)),
				new ge_precomp(FieldElement.New(-16160072, 5472695, 31895588, 4744994, 8823515, 10365685, -27224800, 9448613, -28774454, 366295), FieldElement.New(19153450, 11523972, -11096490, -6503142, -24647631, 5420647, 28344573, 8041113, 719605, 11671788), FieldElement.New(8678025, 2694440, -6808014, 2517372, 4964326, 11152271, -15432916, -15266516, 27000813, -10195553)),
				new ge_precomp(FieldElement.New(-15157904, 7134312, 8639287, -2814877, -7235688, 10421742, 564065, 5336097, 6750977, -14521026), FieldElement.New(11836410, -3979488, 26297894, 16080799, 23455045, 15735944, 1695823, -8819122, 8169720, 16220347), FieldElement.New(-18115838, 8653647, 17578566, -6092619, -8025777, -16012763, -11144307, -2627664, -5990708, -14166033)),
				new ge_precomp(FieldElement.New(-23308498, -10968312, 15213228, -10081214, -30853605, -11050004, 27884329, 2847284, 2655861, 1738395), FieldElement.New(-27537433, -14253021, -25336301, -8002780, -9370762, 8129821, 21651608, -3239336, -19087449, -11005278), FieldElement.New(1533110, 3437855, 23735889, 459276, 29970501, 11335377, 26030092, 5821408, 10478196, 8544890)),
				new ge_precomp(FieldElement.New(32173121, -16129311, 24896207, 3921497, 22579056, -3410854, 19270449, 12217473, 17789017, -3395995), FieldElement.New(-30552961, -2228401, -15578829, -10147201, 13243889, 517024, 15479401, -3853233, 30460520, 1052596), FieldElement.New(-11614875, 13323618, 32618793, 8175907, -15230173, 12596687, 27491595, -4612359, 3179268, -9478891)),
				new ge_precomp(FieldElement.New(31947069, -14366651, -4640583, -15339921, -15125977, -6039709, -14756777, -16411740, 19072640, -9511060), FieldElement.New(11685058, 11822410, 3158003, -13952594, 33402194, -4165066, 5977896, -5215017, 473099, 5040608), FieldElement.New(-20290863, 8198642, -27410132, 11602123, 1290375, -2799760, 28326862, 1721092, -19558642, -3131606))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(7881532, 10687937, 7578723, 7738378, -18951012, -2553952, 21820786, 8076149, -27868496, 11538389), FieldElement.New(-19935666, 3899861, 18283497, -6801568, -15728660, -11249211, 8754525, 7446702, -5676054, 5797016), FieldElement.New(-11295600, -3793569, -15782110, -7964573, 12708869, -8456199, 2014099, -9050574, -2369172, -5877341)),
				new ge_precomp(FieldElement.New(-22472376, -11568741, -27682020, 1146375, 18956691, 16640559, 1192730, -3714199, 15123619, 10811505), FieldElement.New(14352098, -3419715, -18942044, 10822655, 32750596, 4699007, -70363, 15776356, -28886779, -11974553), FieldElement.New(-28241164, -8072475, -4978962, -5315317, 29416931, 1847569, -20654173, -16484855, 4714547, -9600655)),
				new ge_precomp(FieldElement.New(15200332, 8368572, 19679101, 15970074, -31872674, 1959451, 24611599, -4543832, -11745876, 12340220), FieldElement.New(12876937, -10480056, 33134381, 6590940, -6307776, 14872440, 9613953, 8241152, 15370987, 9608631), FieldElement.New(-4143277, -12014408, 8446281, -391603, 4407738, 13629032, -7724868, 15866074, -28210621, -8814099)),
				new ge_precomp(FieldElement.New(26660628, -15677655, 8393734, 358047, -7401291, 992988, -23904233, 858697, 20571223, 8420556), FieldElement.New(14620715, 13067227, -15447274, 8264467, 14106269, 15080814, 33531827, 12516406, -21574435, -12476749), FieldElement.New(236881, 10476226, 57258, -14677024, 6472998, 2466984, 17258519, 7256740, 8791136, 15069930)),
				new ge_precomp(FieldElement.New(1276410, -9371918, 22949635, -16322807, -23493039, -5702186, 14711875, 4874229, -30663140, -2331391), FieldElement.New(5855666, 4990204, -13711848, 7294284, -7804282, 1924647, -1423175, -7912378, -33069337, 9234253), FieldElement.New(20590503, -9018988, 31529744, -7352666, -2706834, 10650548, 31559055, -11609587, 18979186, 13396066)),
				new ge_precomp(FieldElement.New(24474287, 4968103, 22267082, 4407354, 24063882, -8325180, -18816887, 13594782, 33514650, 7021958), FieldElement.New(-11566906, -6565505, -21365085, 15928892, -26158305, 4315421, -25948728, -3916677, -21480480, 12868082), FieldElement.New(-28635013, 13504661, 19988037, -2132761, 21078225, 6443208, -21446107, 2244500, -12455797, -8089383)),
				new ge_precomp(FieldElement.New(-30595528, 13793479, -5852820, 319136, -25723172, -6263899, 33086546, 8957937, -15233648, 5540521), FieldElement.New(-11630176, -11503902, -8119500, -7643073, 2620056, 1022908, -23710744, -1568984, -16128528, -14962807), FieldElement.New(23152971, 775386, 27395463, 14006635, -9701118, 4649512, 1689819, 892185, -11513277, -15205948)),
				new ge_precomp(FieldElement.New(9770129, 9586738, 26496094, 4324120, 1556511, -3550024, 27453819, 4763127, -19179614, 5867134), FieldElement.New(-32765025, 1927590, 31726409, -4753295, 23962434, -16019500, 27846559, 5931263, -29749703, -16108455), FieldElement.New(27461885, -2977536, 22380810, 1815854, -23033753, -3031938, 7283490, -15148073, -19526700, 7734629))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-8010264, -9590817, -11120403, 6196038, 29344158, -13430885, 7585295, -3176626, 18549497, 15302069), FieldElement.New(-32658337, -6171222, -7672793, -11051681, 6258878, 13504381, 10458790, -6418461, -8872242, 8424746), FieldElement.New(24687205, 8613276, -30667046, -3233545, 1863892, -1830544, 19206234, 7134917, -11284482, -828919)),
				new ge_precomp(FieldElement.New(11334899, -9218022, 8025293, 12707519, 17523892, -10476071, 10243738, -14685461, -5066034, 16498837), FieldElement.New(8911542, 6887158, -9584260, -6958590, 11145641, -9543680, 17303925, -14124238, 6536641, 10543906), FieldElement.New(-28946384, 15479763, -17466835, 568876, -1497683, 11223454, -2669190, -16625574, -27235709, 8876771)),
				new ge_precomp(FieldElement.New(-25742899, -12566864, -15649966, -846607, -33026686, -796288, -33481822, 15824474, -604426, -9039817), FieldElement.New(10330056, 70051, 7957388, -9002667, 9764902, 15609756, 27698697, -4890037, 1657394, 3084098), FieldElement.New(10477963, -7470260, 12119566, -13250805, 29016247, -5365589, 31280319, 14396151, -30233575, 15272409)),
				new ge_precomp(FieldElement.New(-12288309, 3169463, 28813183, 16658753, 25116432, -5630466, -25173957, -12636138, -25014757, 1950504), FieldElement.New(-26180358, 9489187, 11053416, -14746161, -31053720, 5825630, -8384306, -8767532, 15341279, 8373727), FieldElement.New(28685821, 7759505, -14378516, -12002860, -31971820, 4079242, 298136, -10232602, -2878207, 15190420)),
				new ge_precomp(FieldElement.New(-32932876, 13806336, -14337485, -15794431, -24004620, 10940928, 8669718, 2742393, -26033313, -6875003), FieldElement.New(-1580388, -11729417, -25979658, -11445023, -17411874, -10912854, 9291594, -16247779, -12154742, 6048605), FieldElement.New(-30305315, 14843444, 1539301, 11864366, 20201677, 1900163, 13934231, 5128323, 11213262, 9168384)),
				new ge_precomp(FieldElement.New(-26280513, 11007847, 19408960, -940758, -18592965, -4328580, -5088060, -11105150, 20470157, -16398701), FieldElement.New(-23136053, 9282192, 14855179, -15390078, -7362815, -14408560, -22783952, 14461608, 14042978, 5230683), FieldElement.New(29969567, -2741594, -16711867, -8552442, 9175486, -2468974, 21556951, 3506042, -5933891, -12449708)),
				new ge_precomp(FieldElement.New(-3144746, 8744661, 19704003, 4581278, -20430686, 6830683, -21284170, 8971513, -28539189, 15326563), FieldElement.New(-19464629, 10110288, -17262528, -3503892, -23500387, 1355669, -15523050, 15300988, -20514118, 9168260), FieldElement.New(-5353335, 4488613, -23803248, 16314347, 7780487, -15638939, -28948358, 9601605, 33087103, -9011387)),
				new ge_precomp(FieldElement.New(-19443170, -15512900, -20797467, -12445323, -29824447, 10229461, -27444329, -15000531, -5996870, 15664672), FieldElement.New(23294591, -16632613, -22650781, -8470978, 27844204, 11461195, 13099750, -2460356, 18151676, 13417686), FieldElement.New(-24722913, -4176517, -31150679, 5988919, -26858785, 6685065, 1661597, -12551441, 15271676, -15452665))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(11433042, -13228665, 8239631, -5279517, -1985436, -725718, -18698764, 2167544, -6921301, -13440182), FieldElement.New(-31436171, 15575146, 30436815, 12192228, -22463353, 9395379, -9917708, -8638997, 12215110, 12028277), FieldElement.New(14098400, 6555944, 23007258, 5757252, -15427832, -12950502, 30123440, 4617780, -16900089, -655628)),
				new ge_precomp(FieldElement.New(-4026201, -15240835, 11893168, 13718664, -14809462, 1847385, -15819999, 10154009, 23973261, -12684474), FieldElement.New(-26531820, -3695990, -1908898, 2534301, -31870557, -16550355, 18341390, -11419951, 32013174, -10103539), FieldElement.New(-25479301, 10876443, -11771086, -14625140, -12369567, 1838104, 21911214, 6354752, 4425632, -837822)),
				new ge_precomp(FieldElement.New(-10433389, -14612966, 22229858, -3091047, -13191166, 776729, -17415375, -12020462, 4725005, 14044970), FieldElement.New(19268650, -7304421, 1555349, 8692754, -21474059, -9910664, 6347390, -1411784, -19522291, -16109756), FieldElement.New(-24864089, 12986008, -10898878, -5558584, -11312371, -148526, 19541418, 8180106, 9282262, 10282508)),
				new ge_precomp(FieldElement.New(-26205082, 4428547, -8661196, -13194263, 4098402, -14165257, 15522535, 8372215, 5542595, -10702683), FieldElement.New(-10562541, 14895633, 26814552, -16673850, -17480754, -2489360, -2781891, 6993761, -18093885, 10114655), FieldElement.New(-20107055, -929418, 31422704, 10427861, -7110749, 6150669, -29091755, -11529146, 25953725, -106158)),
				new ge_precomp(FieldElement.New(-4234397, -8039292, -9119125, 3046000, 2101609, -12607294, 19390020, 6094296, -3315279, 12831125), FieldElement.New(-15998678, 7578152, 5310217, 14408357, -33548620, -224739, 31575954, 6326196, 7381791, -2421839), FieldElement.New(-20902779, 3296811, 24736065, -16328389, 18374254, 7318640, 6295303, 8082724, -15362489, 12339664)),
				new ge_precomp(FieldElement.New(27724736, 2291157, 6088201, -14184798, 1792727, 5857634, 13848414, 15768922, 25091167, 14856294), FieldElement.New(-18866652, 8331043, 24373479, 8541013, -701998, -9269457, 12927300, -12695493, -22182473, -9012899), FieldElement.New(-11423429, -5421590, 11632845, 3405020, 30536730, -11674039, -27260765, 13866390, 30146206, 9142070)),
				new ge_precomp(FieldElement.New(3924129, -15307516, -13817122, -10054960, 12291820, -668366, -27702774, 9326384, -8237858, 4171294), FieldElement.New(-15921940, 16037937, 6713787, 16606682, -21612135, 2790944, 26396185, 3731949, 345228, -5462949), FieldElement.New(-21327538, 13448259, 25284571, 1143661, 20614966, -8849387, 2031539, -12391231, -16253183, -13582083)),
				new ge_precomp(FieldElement.New(31016211, -16722429, 26371392, -14451233, -5027349, 14854137, 17477601, 3842657, 28012650, -16405420), FieldElement.New(-5075835, 9368966, -8562079, -4600902, -15249953, 6970560, -9189873, 16292057, -8867157, 3507940), FieldElement.New(29439664, 3537914, 23333589, 6997794, -17555561, -11018068, -15209202, -15051267, -9164929, 6580396))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-12185861, -7679788, 16438269, 10826160, -8696817, -6235611, 17860444, -9273846, -2095802, 9304567), FieldElement.New(20714564, -4336911, 29088195, 7406487, 11426967, -5095705, 14792667, -14608617, 5289421, -477127), FieldElement.New(-16665533, -10650790, -6160345, -13305760, 9192020, -1802462, 17271490, 12349094, 26939669, -3752294)),
				new ge_precomp(FieldElement.New(-12889898, 9373458, 31595848, 16374215, 21471720, 13221525, -27283495, -12348559, -3698806, 117887), FieldElement.New(22263325, -6560050, 3984570, -11174646, -15114008, -566785, 28311253, 5358056, -23319780, 541964), FieldElement.New(16259219, 3261970, 2309254, -15534474, -16885711, -4581916, 24134070, -16705829, -13337066, -13552195)),
				new ge_precomp(FieldElement.New(9378160, -13140186, -22845982, -12745264, 28198281, -7244098, -2399684, -717351, 690426, 14876244), FieldElement.New(24977353, -314384, -8223969, -13465086, 28432343, -1176353, -13068804, -12297348, -22380984, 6618999), FieldElement.New(-1538174, 11685646, 12944378, 13682314, -24389511, -14413193, 8044829, -13817328, 32239829, -5652762)),
				new ge_precomp(FieldElement.New(-18603066, 4762990, -926250, 8885304, -28412480, -3187315, 9781647, -10350059, 32779359, 5095274), FieldElement.New(-33008130, -5214506, -32264887, -3685216, 9460461, -9327423, -24601656, 14506724, 21639561, -2630236), FieldElement.New(-16400943, -13112215, 25239338, 15531969, 3987758, -4499318, -1289502, -6863535, 17874574, 558605)),
				new ge_precomp(FieldElement.New(-13600129, 10240081, 9171883, 16131053, -20869254, 9599700, 33499487, 5080151, 2085892, 5119761), FieldElement.New(-22205145, -2519528, -16381601, 414691, -25019550, 2170430, 30634760, -8363614, -31999993, -5759884), FieldElement.New(-6845704, 15791202, 8550074, -1312654, 29928809, -12092256, 27534430, -7192145, -22351378, 12961482)),
				new ge_precomp(FieldElement.New(-24492060, -9570771, 10368194, 11582341, -23397293, -2245287, 16533930, 8206996, -30194652, -5159638), FieldElement.New(-11121496, -3382234, 2307366, 6362031, -135455, 8868177, -16835630, 7031275, 7589640, 8945490), FieldElement.New(-32152748, 8917967, 6661220, -11677616, -1192060, -15793393, 7251489, -11182180, 24099109, -14456170)),
				new ge_precomp(FieldElement.New(5019558, -7907470, 4244127, -14714356, -26933272, 6453165, -19118182, -13289025, -6231896, -10280736), FieldElement.New(10853594, 10721687, 26480089, 5861829, -22995819, 1972175, -1866647, -10557898, -3363451, -6441124), FieldElement.New(-17002408, 5906790, 221599, -6563147, 7828208, -13248918, 24362661, -2008168, -13866408, 7421392)),
				new ge_precomp(FieldElement.New(8139927, -6546497, 32257646, -5890546, 30375719, 1886181, -21175108, 15441252, 28826358, -4123029), FieldElement.New(6267086, 9695052, 7709135, -16603597, -32869068, -1886135, 14795160, -7840124, 13746021, -1742048), FieldElement.New(28584902, 7787108, -6732942, -15050729, 22846041, -7571236, -3181936, -363524, 4771362, -8419958))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(24949256, 6376279, -27466481, -8174608, -18646154, -9930606, 33543569, -12141695, 3569627, 11342593), FieldElement.New(26514989, 4740088, 27912651, 3697550, 19331575, -11472339, 6809886, 4608608, 7325975, -14801071), FieldElement.New(-11618399, -14554430, -24321212, 7655128, -1369274, 5214312, -27400540, 10258390, -17646694, -8186692)),
				new ge_precomp(FieldElement.New(11431204, 15823007, 26570245, 14329124, 18029990, 4796082, -31446179, 15580664, 9280358, -3973687), FieldElement.New(-160783, -10326257, -22855316, -4304997, -20861367, -13621002, -32810901, -11181622, -15545091, 4387441), FieldElement.New(-20799378, 12194512, 3937617, -5805892, -27154820, 9340370, -24513992, 8548137, 20617071, -7482001)),
				new ge_precomp(FieldElement.New(-938825, -3930586, -8714311, 16124718, 24603125, -6225393, -13775352, -11875822, 24345683, 10325460), FieldElement.New(-19855277, -1568885, -22202708, 8714034, 14007766, 6928528, 16318175, -1010689, 4766743, 3552007), FieldElement.New(-21751364, -16730916, 1351763, -803421, -4009670, 3950935, 3217514, 14481909, 10988822, -3994762)),
				new ge_precomp(FieldElement.New(15564307, -14311570, 3101243, 5684148, 30446780, -8051356, 12677127, -6505343, -8295852, 13296005), FieldElement.New(-9442290, 6624296, -30298964, -11913677, -4670981, -2057379, 31521204, 9614054, -30000824, 12074674), FieldElement.New(4771191, -135239, 14290749, -13089852, 27992298, 14998318, -1413936, -1556716, 29832613, -16391035)),
				new ge_precomp(FieldElement.New(7064884, -7541174, -19161962, -5067537, -18891269, -2912736, 25825242, 5293297, -27122660, 13101590), FieldElement.New(-2298563, 2439670, -7466610, 1719965, -27267541, -16328445, 32512469, -5317593, -30356070, -4190957), FieldElement.New(-30006540, 10162316, -33180176, 3981723, -16482138, -13070044, 14413974, 9515896, 19568978, 9628812)),
				new ge_precomp(FieldElement.New(33053803, 199357, 15894591, 1583059, 27380243, -4580435, -17838894, -6106839, -6291786, 3437740), FieldElement.New(-18978877, 3884493, 19469877, 12726490, 15913552, 13614290, -22961733, 70104, 7463304, 4176122), FieldElement.New(-27124001, 10659917, 11482427, -16070381, 12771467, -6635117, -32719404, -5322751, 24216882, 5944158)),
				new ge_precomp(FieldElement.New(8894125, 7450974, -2664149, -9765752, -28080517, -12389115, 19345746, 14680796, 11632993, 5847885), FieldElement.New(26942781, -2315317, 9129564, -4906607, 26024105, 11769399, -11518837, 6367194, -9727230, 4782140), FieldElement.New(19916461, -4828410, -22910704, -11414391, 25606324, -5972441, 33253853, 8220911, 6358847, -1873857)),
				new ge_precomp(FieldElement.New(801428, -2081702, 16569428, 11065167, 29875704, 96627, 7908388, -4480480, -13538503, 1387155), FieldElement.New(19646058, 5720633, -11416706, 12814209, 11607948, 12749789, 14147075, 15156355, -21866831, 11835260), FieldElement.New(19299512, 1155910, 28703737, 14890794, 2925026, 7269399, 26121523, 15467869, -26560550, 5052483))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-3017432, 10058206, 1980837, 3964243, 22160966, 12322533, -6431123, -12618185, 12228557, -7003677), FieldElement.New(32944382, 14922211, -22844894, 5188528, 21913450, -8719943, 4001465, 13238564, -6114803, 8653815), FieldElement.New(22865569, -4652735, 27603668, -12545395, 14348958, 8234005, 24808405, 5719875, 28483275, 2841751)),
				new ge_precomp(FieldElement.New(-16420968, -1113305, -327719, -12107856, 21886282, -15552774, -1887966, -315658, 19932058, -12739203), FieldElement.New(-11656086, 10087521, -8864888, -5536143, -19278573, -3055912, 3999228, 13239134, -4777469, -13910208), FieldElement.New(1382174, -11694719, 17266790, 9194690, -13324356, 9720081, 20403944, 11284705, -14013818, 3093230)),
				new ge_precomp(FieldElement.New(16650921, -11037932, -1064178, 1570629, -8329746, 7352753, -302424, 16271225, -24049421, -6691850), FieldElement.New(-21911077, -5927941, -4611316, -5560156, -31744103, -10785293, 24123614, 15193618, -21652117, -16739389), FieldElement.New(-9935934, -4289447, -25279823, 4372842, 2087473, 10399484, 31870908, 14690798, 17361620, 11864968)),
				new ge_precomp(FieldElement.New(-11307610, 6210372, 13206574, 5806320, -29017692, -13967200, -12331205, -7486601, -25578460, -16240689), FieldElement.New(14668462, -12270235, 26039039, 15305210, 25515617, 4542480, 10453892, 6577524, 9145645, -6443880), FieldElement.New(5974874, 3053895, -9433049, -10385191, -31865124, 3225009, -7972642, 3936128, -5652273, -3050304)),
				new ge_precomp(FieldElement.New(30625386, -4729400, -25555961, -12792866, -20484575, 7695099, 17097188, -16303496, -27999779, 1803632), FieldElement.New(-3553091, 9865099, -5228566, 4272701, -5673832, -16689700, 14911344, 12196514, -21405489, 7047412), FieldElement.New(20093277, 9920966, -11138194, -5343857, 13161587, 12044805, -32856851, 4124601, -32343828, -10257566)),
				new ge_precomp(FieldElement.New(-20788824, 14084654, -13531713, 7842147, 19119038, -13822605, 4752377, -8714640, -21679658, 2288038), FieldElement.New(-26819236, -3283715, 29965059, 3039786, -14473765, 2540457, 29457502, 14625692, -24819617, 12570232), FieldElement.New(-1063558, -11551823, 16920318, 12494842, 1278292, -5869109, -21159943, -3498680, -11974704, 4724943)),
				new ge_precomp(FieldElement.New(17960970, -11775534, -4140968, -9702530, -8876562, -1410617, -12907383, -8659932, -29576300, 1903856), FieldElement.New(23134274, -14279132, -10681997, -1611936, 20684485, 15770816, -12989750, 3190296, 26955097, 14109738), FieldElement.New(15308788, 5320727, -30113809, -14318877, 22902008, 7767164, 29425325, -11277562, 31960942, 11934971)),
				new ge_precomp(FieldElement.New(-27395711, 8435796, 4109644, 12222639, -24627868, 14818669, 20638173, 4875028, 10491392, 1379718), FieldElement.New(-13159415, 9197841, 3875503, -8936108, -1383712, -5879801, 33518459, 16176658, 21432314, 12180697), FieldElement.New(-11787308, 11500838, 13787581, -13832590, -22430679, 10140205, 1465425, 12689540, -10301319, -13872883))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(5414091, -15386041, -21007664, 9643570, 12834970, 1186149, -2622916, -1342231, 26128231, 6032912), FieldElement.New(-26337395, -13766162, 32496025, -13653919, 17847801, -12669156, 3604025, 8316894, -25875034, -10437358), FieldElement.New(3296484, 6223048, 24680646, -12246460, -23052020, 5903205, -8862297, -4639164, 12376617, 3188849)),
				new ge_precomp(FieldElement.New(29190488, -14659046, 27549113, -1183516, 3520066, -10697301, 32049515, -7309113, -16109234, -9852307), FieldElement.New(-14744486, -9309156, 735818, -598978, -20407687, -5057904, 25246078, -15795669, 18640741, -960977), FieldElement.New(-6928835, -16430795, 10361374, 5642961, 4910474, 12345252, -31638386, -494430, 10530747, 1053335)),
				new ge_precomp(FieldElement.New(-29265967, -14186805, -13538216, -12117373, -19457059, -10655384, -31462369, -2948985, 24018831, 15026644), FieldElement.New(-22592535, -3145277, -2289276, 5953843, -13440189, 9425631, 25310643, 13003497, -2314791, -15145616), FieldElement.New(-27419985, -603321, -8043984, -1669117, -26092265, 13987819, -27297622, 187899, -23166419, -2531735)),
				new ge_precomp(FieldElement.New(-21744398, -13810475, 1844840, 5021428, -10434399, -15911473, 9716667, 16266922, -5070217, 726099), FieldElement.New(29370922, -6053998, 7334071, -15342259, 9385287, 2247707, -13661962, -4839461, 30007388, -15823341), FieldElement.New(-936379, 16086691, 23751945, -543318, -1167538, -5189036, 9137109, 730663, 9835848, 4555336)),
				new ge_precomp(FieldElement.New(-23376435, 1410446, -22253753, -12899614, 30867635, 15826977, 17693930, 544696, -11985298, 12422646), FieldElement.New(31117226, -12215734, -13502838, 6561947, -9876867, -12757670, -5118685, -4096706, 29120153, 13924425), FieldElement.New(-17400879, -14233209, 19675799, -2734756, -11006962, -5858820, -9383939, -11317700, 7240931, -237388)),
				new ge_precomp(FieldElement.New(-31361739, -11346780, -15007447, -5856218, -22453340, -12152771, 1222336, 4389483, 3293637, -15551743), FieldElement.New(-16684801, -14444245, 11038544, 11054958, -13801175, -3338533, -24319580, 7733547, 12796905, -6335822), FieldElement.New(-8759414, -10817836, -25418864, 10783769, -30615557, -9746811, -28253339, 3647836, 3222231, -11160462)),
				new ge_precomp(FieldElement.New(18606113, 1693100, -25448386, -15170272, 4112353, 10045021, 23603893, -2048234, -7550776, 2484985), FieldElement.New(9255317, -3131197, -12156162, -1004256, 13098013, -9214866, 16377220, -2102812, -19802075, -3034702), FieldElement.New(-22729289, 7496160, -5742199, 11329249, 19991973, -3347502, -31718148, 9936966, -30097688, -10618797)),
				new ge_precomp(FieldElement.New(21878590, -5001297, 4338336, 13643897, -3036865, 13160960, 19708896, 5415497, -7360503, -4109293), FieldElement.New(27736861, 10103576, 12500508, 8502413, -3413016, -9633558, 10436918, -1550276, -23659143, -8132100), FieldElement.New(19492550, -12104365, -29681976, -852630, -3208171, 12403437, 30066266, 8367329, 13243957, 8709688))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(12015105, 2801261, 28198131, 10151021, 24818120, -4743133, -11194191, -5645734, 5150968, 7274186), FieldElement.New(2831366, -12492146, 1478975, 6122054, 23825128, -12733586, 31097299, 6083058, 31021603, -9793610), FieldElement.New(-2529932, -2229646, 445613, 10720828, -13849527, -11505937, -23507731, 16354465, 15067285, -14147707)),
				new ge_precomp(FieldElement.New(7840942, 14037873, -33364863, 15934016, -728213, -3642706, 21403988, 1057586, -19379462, -12403220), FieldElement.New(915865, -16469274, 15608285, -8789130, -24357026, 6060030, -17371319, 8410997, -7220461, 16527025), FieldElement.New(32922597, -556987, 20336074, -16184568, 10903705, -5384487, 16957574, 52992, 23834301, 6588044)),
				new ge_precomp(FieldElement.New(32752030, 11232950, 3381995, -8714866, 22652988, -10744103, 17159699, 16689107, -20314580, -1305992), FieldElement.New(-4689649, 9166776, -25710296, -10847306, 11576752, 12733943, 7924251, -2752281, 1976123, -7249027), FieldElement.New(21251222, 16309901, -2983015, -6783122, 30810597, 12967303, 156041, -3371252, 12331345, -8237197)),
				new ge_precomp(FieldElement.New(8651614, -4477032, -16085636, -4996994, 13002507, 2950805, 29054427, -5106970, 10008136, -4667901), FieldElement.New(31486080, 15114593, -14261250, 12951354, 14369431, -7387845, 16347321, -13662089, 8684155, -10532952), FieldElement.New(19443825, 11385320, 24468943, -9659068, -23919258, 2187569, -26263207, -6086921, 31316348, 14219878)),
				new ge_precomp(FieldElement.New(-28594490, 1193785, 32245219, 11392485, 31092169, 15722801, 27146014, 6992409, 29126555, 9207390), FieldElement.New(32382935, 1110093, 18477781, 11028262, -27411763, -7548111, -4980517, 10843782, -7957600, -14435730), FieldElement.New(2814918, 7836403, 27519878, -7868156, -20894015, -11553689, -21494559, 8550130, 28346258, 1994730)),
				new ge_precomp(FieldElement.New(-19578299, 8085545, -14000519, -3948622, 2785838, -16231307, -19516951, 7174894, 22628102, 8115180), FieldElement.New(-30405132, 955511, -11133838, -15078069, -32447087, -13278079, -25651578, 3317160, -9943017, 930272), FieldElement.New(-15303681, -6833769, 28856490, 1357446, 23421993, 1057177, 24091212, -1388970, -22765376, -10650715)),
				new ge_precomp(FieldElement.New(-22751231, -5303997, -12907607, -12768866, -15811511, -7797053, -14839018, -16554220, -1867018, 8398970), FieldElement.New(-31969310, 2106403, -4736360, 1362501, 12813763, 16200670, 22981545, -6291273, 18009408, -15772772), FieldElement.New(-17220923, -9545221, -27784654, 14166835, 29815394, 7444469, 29551787, -3727419, 19288549, 1325865)),
				new ge_precomp(FieldElement.New(15100157, -15835752, -23923978, -1005098, -26450192, 15509408, 12376730, -3479146, 33166107, -8042750), FieldElement.New(20909231, 13023121, -9209752, 16251778, -5778415, -8094914, 12412151, 10018715, 2213263, -13878373), FieldElement.New(32529814, -11074689, 30361439, -16689753, -9135940, 1513226, 22922121, 6382134, -5766928, 8371348))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(9923462, 11271500, 12616794, 3544722, -29998368, -1721626, 12891687, -8193132, -26442943, 10486144), FieldElement.New(-22597207, -7012665, 8587003, -8257861, 4084309, -12970062, 361726, 2610596, -23921530, -11455195), FieldElement.New(5408411, -1136691, -4969122, 10561668, 24145918, 14240566, 31319731, -4235541, 19985175, -3436086)),
				new ge_precomp(FieldElement.New(-13994457, 16616821, 14549246, 3341099, 32155958, 13648976, -17577068, 8849297, 65030, 8370684), FieldElement.New(-8320926, -12049626, 31204563, 5839400, -20627288, -1057277, -19442942, 6922164, 12743482, -9800518), FieldElement.New(-2361371, 12678785, 28815050, 4759974, -23893047, 4884717, 23783145, 11038569, 18800704, 255233)),
				new ge_precomp(FieldElement.New(-5269658, -1773886, 13957886, 7990715, 23132995, 728773, 13393847, 9066957, 19258688, -14753793), FieldElement.New(-2936654, -10827535, -10432089, 14516793, -3640786, 4372541, -31934921, 2209390, -1524053, 2055794), FieldElement.New(580882, 16705327, 5468415, -2683018, -30926419, -14696000, -7203346, -8994389, -30021019, 7394435)),
				new ge_precomp(FieldElement.New(23838809, 1822728, -15738443, 15242727, 8318092, -3733104, -21672180, -3492205, -4821741, 14799921), FieldElement.New(13345610, 9759151, 3371034, -16137791, 16353039, 8577942, 31129804, 13496856, -9056018, 7402518), FieldElement.New(2286874, -4435931, -20042458, -2008336, -13696227, 5038122, 11006906, -15760352, 8205061, 1607563)),
				new ge_precomp(FieldElement.New(14414086, -8002132, 3331830, -3208217, 22249151, -5594188, 18364661, -2906958, 30019587, -9029278), FieldElement.New(-27688051, 1585953, -10775053, 931069, -29120221, -11002319, -14410829, 12029093, 9944378, 8024), FieldElement.New(4368715, -3709630, 29874200, -15022983, -20230386, -11410704, -16114594, -999085, -8142388, 5640030)),
				new ge_precomp(FieldElement.New(10299610, 13746483, 11661824, 16234854, 7630238, 5998374, 9809887, -16694564, 15219798, -14327783), FieldElement.New(27425505, -5719081, 3055006, 10660664, 23458024, 595578, -15398605, -1173195, -18342183, 9742717), FieldElement.New(6744077, 2427284, 26042789, 2720740, -847906, 1118974, 32324614, 7406442, 12420155, 1994844)),
				new ge_precomp(FieldElement.New(14012521, -5024720, -18384453, -9578469, -26485342, -3936439, -13033478, -10909803, 24319929, -6446333), FieldElement.New(16412690, -4507367, 10772641, 15929391, -17068788, -4658621, 10555945, -10484049, -30102368, -4739048), FieldElement.New(22397382, -7767684, -9293161, -12792868, 17166287, -9755136, -27333065, 6199366, 21880021, -12250760)),
				new ge_precomp(FieldElement.New(-4283307, 5368523, -31117018, 8163389, -30323063, 3209128, 16557151, 8890729, 8840445, 4957760), FieldElement.New(-15447727, 709327, -6919446, -10870178, -29777922, 6522332, -21720181, 12130072, -14796503, 5005757), FieldElement.New(-2114751, -14308128, 23019042, 15765735, -25269683, 6002752, 10183197, -13239326, -16395286, -2176112))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-19025756, 1632005, 13466291, -7995100, -23640451, 16573537, -32013908, -3057104, 22208662, 2000468), FieldElement.New(3065073, -1412761, -25598674, -361432, -17683065, -5703415, -8164212, 11248527, -3691214, -7414184), FieldElement.New(10379208, -6045554, 8877319, 1473647, -29291284, -12507580, 16690915, 2553332, -3132688, 16400289)),
				new ge_precomp(FieldElement.New(15716668, 1254266, -18472690, 7446274, -8448918, 6344164, -22097271, -7285580, 26894937, 9132066), FieldElement.New(24158887, 12938817, 11085297, -8177598, -28063478, -4457083, -30576463, 64452, -6817084, -2692882), FieldElement.New(13488534, 7794716, 22236231, 5989356, 25426474, -12578208, 2350710, -3418511, -4688006, 2364226)),
				new ge_precomp(FieldElement.New(16335052, 9132434, 25640582, 6678888, 1725628, 8517937, -11807024, -11697457, 15445875, -7798101), FieldElement.New(29004207, -7867081, 28661402, -640412, -12794003, -7943086, 31863255, -4135540, -278050, -15759279), FieldElement.New(-6122061, -14866665, -28614905, 14569919, -10857999, -3591829, 10343412, -6976290, -29828287, -10815811)),
				new ge_precomp(FieldElement.New(27081650, 3463984, 14099042, -4517604, 1616303, -6205604, 29542636, 15372179, 17293797, 960709), FieldElement.New(20263915, 11434237, -5765435, 11236810, 13505955, -10857102, -16111345, 6493122, -19384511, 7639714), FieldElement.New(-2830798, -14839232, 25403038, -8215196, -8317012, -16173699, 18006287, -16043750, 29994677, -15808121)),
				new ge_precomp(FieldElement.New(9769828, 5202651, -24157398, -13631392, -28051003, -11561624, -24613141, -13860782, -31184575, 709464), FieldElement.New(12286395, 13076066, -21775189, -1176622, -25003198, 4057652, -32018128, -8890874, 16102007, 13205847), FieldElement.New(13733362, 5599946, 10557076, 3195751, -5557991, 8536970, -25540170, 8525972, 10151379, 10394400)),
				new ge_precomp(FieldElement.New(4024660, -16137551, 22436262, 12276534, -9099015, -2686099, 19698229, 11743039, -33302334, 8934414), FieldElement.New(-15879800, -4525240, -8580747, -2934061, 14634845, -698278, -9449077, 3137094, -11536886, 11721158), FieldElement.New(17555939, -5013938, 8268606, 2331751, -22738815, 9761013, 9319229, 8835153, -9205489, -1280045)),
				new ge_precomp(FieldElement.New(-461409, -7830014, 20614118, 16688288, -7514766, -4807119, 22300304, 505429, 6108462, -6183415), FieldElement.New(-5070281, 12367917, -30663534, 3234473, 32617080, -8422642, 29880583, -13483331, -26898490, -7867459), FieldElement.New(-31975283, 5726539, 26934134, 10237677, -3173717, -605053, 24199304, 3795095, 7592688, -14992079)),
				new ge_precomp(FieldElement.New(21594432, -14964228, 17466408, -4077222, 32537084, 2739898, 6407723, 12018833, -28256052, 4298412), FieldElement.New(-20650503, -11961496, -27236275, 570498, 3767144, -1717540, 13891942, -1569194, 13717174, 10805743), FieldElement.New(-14676630, -15644296, 15287174, 11927123, 24177847, -8175568, -796431, 14860609, -26938930, -5863836))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(12962541, 5311799, -10060768, 11658280, 18855286, -7954201, 13286263, -12808704, -4381056, 9882022), FieldElement.New(18512079, 11319350, -20123124, 15090309, 18818594, 5271736, -22727904, 3666879, -23967430, -3299429), FieldElement.New(-6789020, -3146043, 16192429, 13241070, 15898607, -14206114, -10084880, -6661110, -2403099, 5276065)),
				new ge_precomp(FieldElement.New(30169808, -5317648, 26306206, -11750859, 27814964, 7069267, 7152851, 3684982, 1449224, 13082861), FieldElement.New(10342826, 3098505, 2119311, 193222, 25702612, 12233820, 23697382, 15056736, -21016438, -8202000), FieldElement.New(-33150110, 3261608, 22745853, 7948688, 19370557, -15177665, -26171976, 6482814, -10300080, -11060101)),
				new ge_precomp(FieldElement.New(32869458, -5408545, 25609743, 15678670, -10687769, -15471071, 26112421, 2521008, -22664288, 6904815), FieldElement.New(29506923, 4457497, 3377935, -9796444, -30510046, 12935080, 1561737, 3841096, -29003639, -6657642), FieldElement.New(10340844, -6630377, -18656632, -2278430, 12621151, -13339055, 30878497, -11824370, -25584551, 5181966)),
				new ge_precomp(FieldElement.New(25940115, -12658025, 17324188, -10307374, -8671468, 15029094, 24396252, -16450922, -2322852, -12388574), FieldElement.New(-21765684, 9916823, -1300409, 4079498, -1028346, 11909559, 1782390, 12641087, 20603771, -6561742), FieldElement.New(-18882287, -11673380, 24849422, 11501709, 13161720, -4768874, 1925523, 11914390, 4662781, 7820689)),
				new ge_precomp(FieldElement.New(12241050, -425982, 8132691, 9393934, 32846760, -1599620, 29749456, 12172924, 16136752, 15264020), FieldElement.New(-10349955, -14680563, -8211979, 2330220, -17662549, -14545780, 10658213, 6671822, 19012087, 3772772), FieldElement.New(3753511, -3421066, 10617074, 2028709, 14841030, -6721664, 28718732, -15762884, 20527771, 12988982)),
				new ge_precomp(FieldElement.New(-14822485, -5797269, -3707987, 12689773, -898983, -10914866, -24183046, -10564943, 3299665, -12424953), FieldElement.New(-16777703, -15253301, -9642417, 4978983, 3308785, 8755439, 6943197, 6461331, -25583147, 8991218), FieldElement.New(-17226263, 1816362, -1673288, -6086439, 31783888, -8175991, -32948145, 7417950, -30242287, 1507265)),
				new ge_precomp(FieldElement.New(29692663, 6829891, -10498800, 4334896, 20945975, -11906496, -28887608, 8209391, 14606362, -10647073), FieldElement.New(-3481570, 8707081, 32188102, 5672294, 22096700, 1711240, -33020695, 9761487, 4170404, -2085325), FieldElement.New(-11587470, 14855945, -4127778, -1531857, -26649089, 15084046, 22186522, 16002000, -14276837, -8400798)),
				new ge_precomp(FieldElement.New(-4811456, 13761029, -31703877, -2483919, -3312471, 7869047, -7113572, -9620092, 13240845, 10965870), FieldElement.New(-7742563, -8256762, -14768334, -13656260, -23232383, 12387166, 4498947, 14147411, 29514390, 4302863), FieldElement.New(-13413405, -12407859, 20757302, -13801832, 14785143, 8976368, -5061276, -2144373, 17846988, -13971927))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-2244452, -754728, -4597030, -1066309, -6247172, 1455299, -21647728, -9214789, -5222701, 12650267), FieldElement.New(-9906797, -16070310, 21134160, 12198166, -27064575, 708126, 387813, 13770293, -19134326, 10958663), FieldElement.New(22470984, 12369526, 23446014, -5441109, -21520802, -9698723, -11772496, -11574455, -25083830, 4271862)),
				new ge_precomp(FieldElement.New(-25169565, -10053642, -19909332, 15361595, -5984358, 2159192, 75375, -4278529, -32526221, 8469673), FieldElement.New(15854970, 4148314, -8893890, 7259002, 11666551, 13824734, -30531198, 2697372, 24154791, -9460943), FieldElement.New(15446137, -15806644, 29759747, 14019369, 30811221, -9610191, -31582008, 12840104, 24913809, 9815020)),
				new ge_precomp(FieldElement.New(-4709286, -5614269, -31841498, -12288893, -14443537, 10799414, -9103676, 13438769, 18735128, 9466238), FieldElement.New(11933045, 9281483, 5081055, -5183824, -2628162, -4905629, -7727821, -10896103, -22728655, 16199064), FieldElement.New(14576810, 379472, -26786533, -8317236, -29426508, -10812974, -102766, 1876699, 30801119, 2164795)),
				new ge_precomp(FieldElement.New(15995086, 3199873, 13672555, 13712240, -19378835, -4647646, -13081610, -15496269, -13492807, 1268052), FieldElement.New(-10290614, -3659039, -3286592, 10948818, 23037027, 3794475, -3470338, -12600221, -17055369, 3565904), FieldElement.New(29210088, -9419337, -5919792, -4952785, 10834811, -13327726, -16512102, -10820713, -27162222, -14030531)),
				new ge_precomp(FieldElement.New(-13161890, 15508588, 16663704, -8156150, -28349942, 9019123, -29183421, -3769423, 2244111, -14001979), FieldElement.New(-5152875, -3800936, -9306475, -6071583, 16243069, 14684434, -25673088, -16180800, 13491506, 4641841), FieldElement.New(10813417, 643330, -19188515, -728916, 30292062, -16600078, 27548447, -7721242, 14476989, -12767431)),
				new ge_precomp(FieldElement.New(10292079, 9984945, 6481436, 8279905, -7251514, 7032743, 27282937, -1644259, -27912810, 12651324), FieldElement.New(-31185513, -813383, 22271204, 11835308, 10201545, 15351028, 17099662, 3988035, 21721536, -3148940), FieldElement.New(10202177, -6545839, -31373232, -9574638, -32150642, -8119683, -12906320, 3852694, 13216206, 14842320)),
				new ge_precomp(FieldElement.New(-15815640, -10601066, -6538952, -7258995, -6984659, -6581778, -31500847, 13765824, -27434397, 9900184), FieldElement.New(14465505, -13833331, -32133984, -14738873, -27443187, 12990492, 33046193, 15796406, -7051866, -8040114), FieldElement.New(30924417, -8279620, 6359016, -12816335, 16508377, 9071735, -25488601, 15413635, 9524356, -7018878)),
				new ge_precomp(FieldElement.New(12274201, -13175547, 32627641, -1785326, 6736625, 13267305, 5237659, -5109483, 15663516, 4035784), FieldElement.New(-2951309, 8903985, 17349946, 601635, -16432815, -4612556, -13732739, -15889334, -22258478, 4659091), FieldElement.New(-16916263, -4952973, -30393711, -15158821, 20774812, 15897498, 5736189, 15026997, -2178256, -13455585))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-8858980, -2219056, 28571666, -10155518, -474467, -10105698, -3801496, 278095, 23440562, -290208), FieldElement.New(10226241, -5928702, 15139956, 120818, -14867693, 5218603, 32937275, 11551483, -16571960, -7442864), FieldElement.New(17932739, -12437276, -24039557, 10749060, 11316803, 7535897, 22503767, 5561594, -3646624, 3898661)),
				new ge_precomp(FieldElement.New(7749907, -969567, -16339731, -16464, -25018111, 15122143, -1573531, 7152530, 21831162, 1245233), FieldElement.New(26958459, -14658026, 4314586, 8346991, -5677764, 11960072, -32589295, -620035, -30402091, -16716212), FieldElement.New(-12165896, 9166947, 33491384, 13673479, 29787085, 13096535, 6280834, 14587357, -22338025, 13987525)),
				new ge_precomp(FieldElement.New(-24349909, 7778775, 21116000, 15572597, -4833266, -5357778, -4300898, -5124639, -7469781, -2858068), FieldElement.New(9681908, -6737123, -31951644, 13591838, -6883821, 386950, 31622781, 6439245, -14581012, 4091397), FieldElement.New(-8426427, 1470727, -28109679, -1596990, 3978627, -5123623, -19622683, 12092163, 29077877, -14741988)),
				new ge_precomp(FieldElement.New(5269168, -6859726, -13230211, -8020715, 25932563, 1763552, -5606110, -5505881, -20017847, 2357889), FieldElement.New(32264008, -15407652, -5387735, -1160093, -2091322, -3946900, 23104804, -12869908, 5727338, 189038), FieldElement.New(14609123, -8954470, -6000566, -16622781, -14577387, -7743898, -26745169, 10942115, -25888931, -14884697)),
				new ge_precomp(FieldElement.New(20513500, 5557931, -15604613, 7829531, 26413943, -2019404, -21378968, 7471781, 13913677, -5137875), FieldElement.New(-25574376, 11967826, 29233242, 12948236, -6754465, 4713227, -8940970, 14059180, 12878652, 8511905), FieldElement.New(-25656801, 3393631, -2955415, -7075526, -2250709, 9366908, -30223418, 6812974, 5568676, -3127656)),
				new ge_precomp(FieldElement.New(11630004, 12144454, 2116339, 13606037, 27378885, 15676917, -17408753, -13504373, -14395196, 8070818), FieldElement.New(27117696, -10007378, -31282771, -5570088, 1127282, 12772488, -29845906, 10483306, -11552749, -1028714), FieldElement.New(10637467, -5688064, 5674781, 1072708, -26343588, -6982302, -1683975, 9177853, -27493162, 15431203)),
				new ge_precomp(FieldElement.New(20525145, 10892566, -12742472, 12779443, -29493034, 16150075, -28240519, 14943142, -15056790, -7935931), FieldElement.New(-30024462, 5626926, -551567, -9981087, 753598, 11981191, 25244767, -3239766, -3356550, 9594024), FieldElement.New(-23752644, 2636870, -5163910, -10103818, 585134, 7877383, 11345683, -6492290, 13352335, -10977084)),
				new ge_precomp(FieldElement.New(-1931799, -5407458, 3304649, -12884869, 17015806, -4877091, -29783850, -7752482, -13215537, -319204), FieldElement.New(20239939, 6607058, 6203985, 3483793, -18386976, -779229, -20723742, 15077870, -22750759, 14523817), FieldElement.New(27406042, -6041657, 27423596, -4497394, 4996214, 10002360, -28842031, -4545494, -30172742, -4805667))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(11374242, 12660715, 17861383, -12540833, 10935568, 1099227, -13886076, -9091740, -27727044, 11358504), FieldElement.New(-12730809, 10311867, 1510375, 10778093, -2119455, -9145702, 32676003, 11149336, -26123651, 4985768), FieldElement.New(-19096303, 341147, -6197485, -239033, 15756973, -8796662, -983043, 13794114, -19414307, -15621255)),
				new ge_precomp(FieldElement.New(6490081, 11940286, 25495923, -7726360, 8668373, -8751316, 3367603, 6970005, -1691065, -9004790), FieldElement.New(1656497, 13457317, 15370807, 6364910, 13605745, 8362338, -19174622, -5475723, -16796596, -5031438), FieldElement.New(-22273315, -13524424, -64685, -4334223, -18605636, -10921968, -20571065, -7007978, -99853, -10237333)),
				new ge_precomp(FieldElement.New(17747465, 10039260, 19368299, -4050591, -20630635, -16041286, 31992683, -15857976, -29260363, -5511971), FieldElement.New(31932027, -4986141, -19612382, 16366580, 22023614, 88450, 11371999, -3744247, 4882242, -10626905), FieldElement.New(29796507, 37186, 19818052, 10115756, -11829032, 3352736, 18551198, 3272828, -5190932, -4162409)),
				new ge_precomp(FieldElement.New(12501286, 4044383, -8612957, -13392385, -32430052, 5136599, -19230378, -3529697, 330070, -3659409), FieldElement.New(6384877, 2899513, 17807477, 7663917, -2358888, 12363165, 25366522, -8573892, -271295, 12071499), FieldElement.New(-8365515, -4042521, 25133448, -4517355, -6211027, 2265927, -32769618, 1936675, -5159697, 3829363)),
				new ge_precomp(FieldElement.New(28425966, -5835433, -577090, -4697198, -14217555, 6870930, 7921550, -6567787, 26333140, 14267664), FieldElement.New(-11067219, 11871231, 27385719, -10559544, -4585914, -11189312, 10004786, -8709488, -21761224, 8930324), FieldElement.New(-21197785, -16396035, 25654216, -1725397, 12282012, 11008919, 1541940, 4757911, -26491501, -16408940)),
				new ge_precomp(FieldElement.New(13537262, -7759490, -20604840, 10961927, -5922820, -13218065, -13156584, 6217254, -15943699, 13814990), FieldElement.New(-17422573, 15157790, 18705543, 29619, 24409717, -260476, 27361681, 9257833, -1956526, -1776914), FieldElement.New(-25045300, -10191966, 15366585, 15166509, -13105086, 8423556, -29171540, 12361135, -18685978, 4578290)),
				new ge_precomp(FieldElement.New(24579768, 3711570, 1342322, -11180126, -27005135, 14124956, -22544529, 14074919, 21964432, 8235257), FieldElement.New(-6528613, -2411497, 9442966, -5925588, 12025640, -1487420, -2981514, -1669206, 13006806, 2355433), FieldElement.New(-16304899, -13605259, -6632427, -5142349, 16974359, -10911083, 27202044, 1719366, 1141648, -12796236)),
				new ge_precomp(FieldElement.New(-12863944, -13219986, -8318266, -11018091, -6810145, -4843894, 13475066, -3133972, 32674895, 13715045), FieldElement.New(11423335, -5468059, 32344216, 8962751, 24989809, 9241752, -13265253, 16086212, -28740881, -15642093), FieldElement.New(-1409668, 12530728, -6368726, 10847387, 19531186, -14132160, -11709148, 7791794, -27245943, 4383347))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-28970898, 5271447, -1266009, -9736989, -12455236, 16732599, -4862407, -4906449, 27193557, 6245191), FieldElement.New(-15193956, 5362278, -1783893, 2695834, 4960227, 12840725, 23061898, 3260492, 22510453, 8577507), FieldElement.New(-12632451, 11257346, -32692994, 13548177, -721004, 10879011, 31168030, 13952092, -29571492, -3635906)),
				new ge_precomp(FieldElement.New(3877321, -9572739, 32416692, 5405324, -11004407, -13656635, 3759769, 11935320, 5611860, 8164018), FieldElement.New(-16275802, 14667797, 15906460, 12155291, -22111149, -9039718, 32003002, -8832289, 5773085, -8422109), FieldElement.New(-23788118, -8254300, 1950875, 8937633, 18686727, 16459170, -905725, 12376320, 31632953, 190926)),
				new ge_precomp(FieldElement.New(-24593607, -16138885, -8423991, 13378746, 14162407, 6901328, -8288749, 4508564, -25341555, -3627528), FieldElement.New(8884438, -5884009, 6023974, 10104341, -6881569, -4941533, 18722941, -14786005, -1672488, 827625), FieldElement.New(-32720583, -16289296, -32503547, 7101210, 13354605, 2659080, -1800575, -14108036, -24878478, 1541286)),
				new ge_precomp(FieldElement.New(2901347, -1117687, 3880376, -10059388, -17620940, -3612781, -21802117, -3567481, 20456845, -1885033), FieldElement.New(27019610, 12299467, -13658288, -1603234, -12861660, -4861471, -19540150, -5016058, 29439641, 15138866), FieldElement.New(21536104, -6626420, -32447818, -10690208, -22408077, 5175814, -5420040, -16361163, 7779328, 109896)),
				new ge_precomp(FieldElement.New(30279744, 14648750, -8044871, 6425558, 13639621, -743509, 28698390, 12180118, 23177719, -554075), FieldElement.New(26572847, 3405927, -31701700, 12890905, -19265668, 5335866, -6493768, 2378492, 4439158, -13279347), FieldElement.New(-22716706, 3489070, -9225266, -332753, 18875722, -1140095, 14819434, -12731527, -17717757, -5461437)),
				new ge_precomp(FieldElement.New(-5056483, 16566551, 15953661, 3767752, -10436499, 15627060, -820954, 2177225, 8550082, -15114165), FieldElement.New(-18473302, 16596775, -381660, 15663611, 22860960, 15585581, -27844109, -3582739, -23260460, -8428588), FieldElement.New(-32480551, 15707275, -8205912, -5652081, 29464558, 2713815, -22725137, 15860482, -21902570, 1494193)),
				new ge_precomp(FieldElement.New(-19562091, -14087393, -25583872, -9299552, 13127842, 759709, 21923482, 16529112, 8742704, 12967017), FieldElement.New(-28464899, 1553205, 32536856, -10473729, -24691605, -406174, -8914625, -2933896, -29903758, 15553883), FieldElement.New(21877909, 3230008, 9881174, 10539357, -4797115, 2841332, 11543572, 14513274, 19375923, -12647961)),
				new ge_precomp(FieldElement.New(8832269, -14495485, 13253511, 5137575, 5037871, 4078777, 24880818, -6222716, 2862653, 9455043), FieldElement.New(29306751, 5123106, 20245049, -14149889, 9592566, 8447059, -2077124, -2990080, 15511449, 4789663), FieldElement.New(-20679756, 7004547, 8824831, -9434977, -4045704, -3750736, -5754762, 108893, 23513200, 16652362))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-33256173, 4144782, -4476029, -6579123, 10770039, -7155542, -6650416, -12936300, -18319198, 10212860), FieldElement.New(2756081, 8598110, 7383731, -6859892, 22312759, -1105012, 21179801, 2600940, -9988298, -12506466), FieldElement.New(-24645692, 13317462, -30449259, -15653928, 21365574, -10869657, 11344424, 864440, -2499677, -16710063)),
				new ge_precomp(FieldElement.New(-26432803, 6148329, -17184412, -14474154, 18782929, -275997, -22561534, 211300, 2719757, 4940997), FieldElement.New(-1323882, 3911313, -6948744, 14759765, -30027150, 7851207, 21690126, 8518463, 26699843, 5276295), FieldElement.New(-13149873, -6429067, 9396249, 365013, 24703301, -10488939, 1321586, 149635, -15452774, 7159369)),
				new ge_precomp(FieldElement.New(9987780, -3404759, 17507962, 9505530, 9731535, -2165514, 22356009, 8312176, 22477218, -8403385), FieldElement.New(18155857, -16504990, 19744716, 9006923, 15154154, -10538976, 24256460, -4864995, -22548173, 9334109), FieldElement.New(2986088, -4911893, 10776628, -3473844, 10620590, -7083203, -21413845, 14253545, -22587149, 536906)),
				new ge_precomp(FieldElement.New(4377756, 8115836, 24567078, 15495314, 11625074, 13064599, 7390551, 10589625, 10838060, -15420424), FieldElement.New(-19342404, 867880, 9277171, -3218459, -14431572, -1986443, 19295826, -15796950, 6378260, 699185), FieldElement.New(7895026, 4057113, -7081772, -13077756, -17886831, -323126, -716039, 15693155, -5045064, -13373962)),
				new ge_precomp(FieldElement.New(-7737563, -5869402, -14566319, -7406919, 11385654, 13201616, 31730678, -10962840, -3918636, -9669325), FieldElement.New(10188286, -15770834, -7336361, 13427543, 22223443, 14896287, 30743455, 7116568, -21786507, 5427593), FieldElement.New(696102, 13206899, 27047647, -10632082, 15285305, -9853179, 10798490, -4578720, 19236243, 12477404)),
				new ge_precomp(FieldElement.New(-11229439, 11243796, -17054270, -8040865, -788228, -8167967, -3897669, 11180504, -23169516, 7733644), FieldElement.New(17800790, -14036179, -27000429, -11766671, 23887827, 3149671, 23466177, -10538171, 10322027, 15313801), FieldElement.New(26246234, 11968874, 32263343, -5468728, 6830755, -13323031, -15794704, -101982, -24449242, 10890804)),
				new ge_precomp(FieldElement.New(-31365647, 10271363, -12660625, -6267268, 16690207, -13062544, -14982212, 16484931, 25180797, -5334884), FieldElement.New(-586574, 10376444, -32586414, -11286356, 19801893, 10997610, 2276632, 9482883, 316878, 13820577), FieldElement.New(-9882808, -4510367, -2115506, 16457136, -11100081, 11674996, 30756178, -7515054, 30696930, -3712849)),
				new ge_precomp(FieldElement.New(32988917, -9603412, 12499366, 7910787, -10617257, -11931514, -7342816, -9985397, -32349517, 7392473), FieldElement.New(-8855661, 15927861, 9866406, -3649411, -2396914, -16655781, -30409476, -9134995, 25112947, -2926644), FieldElement.New(-2504044, -436966, 25621774, -5678772, 15085042, -5479877, -24884878, -13526194, 5537438, -13914319))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-11225584, 2320285, -9584280, 10149187, -33444663, 5808648, -14876251, -1729667, 31234590, 6090599), FieldElement.New(-9633316, 116426, 26083934, 2897444, -6364437, -2688086, 609721, 15878753, -6970405, -9034768), FieldElement.New(-27757857, 247744, -15194774, -9002551, 23288161, -10011936, -23869595, 6503646, 20650474, 1804084)),
				new ge_precomp(FieldElement.New(-27589786, 15456424, 8972517, 8469608, 15640622, 4439847, 3121995, -10329713, 27842616, -202328), FieldElement.New(-15306973, 2839644, 22530074, 10026331, 4602058, 5048462, 28248656, 5031932, -11375082, 12714369), FieldElement.New(20807691, -7270825, 29286141, 11421711, -27876523, -13868230, -21227475, 1035546, -19733229, 12796920)),
				new ge_precomp(FieldElement.New(12076899, -14301286, -8785001, -11848922, -25012791, 16400684, -17591495, -12899438, 3480665, -15182815), FieldElement.New(-32361549, 5457597, 28548107, 7833186, 7303070, -11953545, -24363064, -15921875, -33374054, 2771025), FieldElement.New(-21389266, 421932, 26597266, 6860826, 22486084, -6737172, -17137485, -4210226, -24552282, 15673397)),
				new ge_precomp(FieldElement.New(-20184622, 2338216, 19788685, -9620956, -4001265, -8740893, -20271184, 4733254, 3727144, -12934448), FieldElement.New(6120119, 814863, -11794402, -622716, 6812205, -15747771, 2019594, 7975683, 31123697, -10958981), FieldElement.New(30069250, -11435332, 30434654, 2958439, 18399564, -976289, 12296869, 9204260, -16432438, 9648165)),
				new ge_precomp(FieldElement.New(32705432, -1550977, 30705658, 7451065, -11805606, 9631813, 3305266, 5248604, -26008332, -11377501), FieldElement.New(17219865, 2375039, -31570947, -5575615, -19459679, 9219903, 294711, 15298639, 2662509, -16297073), FieldElement.New(-1172927, -7558695, -4366770, -4287744, -21346413, -8434326, 32087529, -1222777, 32247248, -14389861)),
				new ge_precomp(FieldElement.New(14312628, 1221556, 17395390, -8700143, -4945741, -8684635, -28197744, -9637817, -16027623, -13378845), FieldElement.New(-1428825, -9678990, -9235681, 6549687, -7383069, -468664, 23046502, 9803137, 17597934, 2346211), FieldElement.New(18510800, 15337574, 26171504, 981392, -22241552, 7827556, -23491134, -11323352, 3059833, -11782870)),
				new ge_precomp(FieldElement.New(10141598, 6082907, 17829293, -1947643, 9830092, 13613136, -25556636, -5544586, -33502212, 3592096), FieldElement.New(33114168, -15889352, -26525686, -13343397, 33076705, 8716171, 1151462, 1521897, -982665, -6837803), FieldElement.New(-32939165, -4255815, 23947181, -324178, -33072974, -12305637, -16637686, 3891704, 26353178, 693168)),
				new ge_precomp(FieldElement.New(30374239, 1595580, -16884039, 13186931, 4600344, 406904, 9585294, -400668, 31375464, 14369965), FieldElement.New(-14370654, -7772529, 1510301, 6434173, -18784789, -6262728, 32732230, -13108839, 17901441, 16011505), FieldElement.New(18171223, -11934626, -12500402, 15197122, -11038147, -15230035, -19172240, -16046376, 8764035, 12309598))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(5975908, -5243188, -19459362, -9681747, -11541277, 14015782, -23665757, 1228319, 17544096, -10593782), FieldElement.New(5811932, -1715293, 3442887, -2269310, -18367348, -8359541, -18044043, -15410127, -5565381, 12348900), FieldElement.New(-31399660, 11407555, 25755363, 6891399, -3256938, 14872274, -24849353, 8141295, -10632534, -585479)),
				new ge_precomp(FieldElement.New(-12675304, 694026, -5076145, 13300344, 14015258, -14451394, -9698672, -11329050, 30944593, 1130208), FieldElement.New(8247766, -6710942, -26562381, -7709309, -14401939, -14648910, 4652152, 2488540, 23550156, -271232), FieldElement.New(17294316, -3788438, 7026748, 15626851, 22990044, 113481, 2267737, -5908146, -408818, -137719)),
				new ge_precomp(FieldElement.New(16091085, -16253926, 18599252, 7340678, 2137637, -1221657, -3364161, 14550936, 3260525, -7166271), FieldElement.New(-4910104, -13332887, 18550887, 10864893, -16459325, -7291596, -23028869, -13204905, -12748722, 2701326), FieldElement.New(-8574695, 16099415, 4629974, -16340524, -20786213, -6005432, -10018363, 9276971, 11329923, 1862132)),
				new ge_precomp(FieldElement.New(14763076, -15903608, -30918270, 3689867, 3511892, 10313526, -21951088, 12219231, -9037963, -940300), FieldElement.New(8894987, -3446094, 6150753, 3013931, 301220, 15693451, -31981216, -2909717, -15438168, 11595570), FieldElement.New(15214962, 3537601, -26238722, -14058872, 4418657, -15230761, 13947276, 10730794, -13489462, -4363670)),
				new ge_precomp(FieldElement.New(-2538306, 7682793, 32759013, 263109, -29984731, -7955452, -22332124, -10188635, 977108, 699994), FieldElement.New(-12466472, 4195084, -9211532, 550904, -15565337, 12917920, 19118110, -439841, -30534533, -14337913), FieldElement.New(31788461, -14507657, 4799989, 7372237, 8808585, -14747943, 9408237, -10051775, 12493932, -5409317)),
				new ge_precomp(FieldElement.New(-25680606, 5260744, -19235809, -6284470, -3695942, 16566087, 27218280, 2607121, 29375955, 6024730), FieldElement.New(842132, -2794693, -4763381, -8722815, 26332018, -12405641, 11831880, 6985184, -9940361, 2854096), FieldElement.New(-4847262, -7969331, 2516242, -5847713, 9695691, -7221186, 16512645, 960770, 12121869, 16648078)),
				new ge_precomp(FieldElement.New(-15218652, 14667096, -13336229, 2013717, 30598287, -464137, -31504922, -7882064, 20237806, 2838411), FieldElement.New(-19288047, 4453152, 15298546, -16178388, 22115043, -15972604, 12544294, -13470457, 1068881, -12499905), FieldElement.New(-9558883, -16518835, 33238498, 13506958, 30505848, -1114596, -8486907, -2630053, 12521378, 4845654)),
				new ge_precomp(FieldElement.New(-28198521, 10744108, -2958380, 10199664, 7759311, -13088600, 3409348, -873400, -6482306, -12885870), FieldElement.New(-23561822, 6230156, -20382013, 10655314, -24040585, -11621172, 10477734, -1240216, -3113227, 13974498), FieldElement.New(12966261, 15550616, -32038948, -1615346, 21025980, -629444, 5642325, 7188737, 18895762, 12629579))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(14741879, -14946887, 22177208, -11721237, 1279741, 8058600, 11758140, 789443, 32195181, 3895677), FieldElement.New(10758205, 15755439, -4509950, 9243698, -4879422, 6879879, -2204575, -3566119, -8982069, 4429647), FieldElement.New(-2453894, 15725973, -20436342, -10410672, -5803908, -11040220, -7135870, -11642895, 18047436, -15281743)),
				new ge_precomp(FieldElement.New(-25173001, -11307165, 29759956, 11776784, -22262383, -15820455, 10993114, -12850837, -17620701, -9408468), FieldElement.New(21987233, 700364, -24505048, 14972008, -7774265, -5718395, 32155026, 2581431, -29958985, 8773375), FieldElement.New(-25568350, 454463, -13211935, 16126715, 25240068, 8594567, 20656846, 12017935, -7874389, -13920155)),
				new ge_precomp(FieldElement.New(6028182, 6263078, -31011806, -11301710, -818919, 2461772, -31841174, -5468042, -1721788, -2776725), FieldElement.New(-12278994, 16624277, 987579, -5922598, 32908203, 1248608, 7719845, -4166698, 28408820, 6816612), FieldElement.New(-10358094, -8237829, 19549651, -12169222, 22082623, 16147817, 20613181, 13982702, -10339570, 5067943)),
				new ge_precomp(FieldElement.New(-30505967, -3821767, 12074681, 13582412, -19877972, 2443951, -19719286, 12746132, 5331210, -10105944), FieldElement.New(30528811, 3601899, -1957090, 4619785, -27361822, -15436388, 24180793, -12570394, 27679908, -1648928), FieldElement.New(9402404, -13957065, 32834043, 10838634, -26580150, -13237195, 26653274, -8685565, 22611444, -12715406)),
				new ge_precomp(FieldElement.New(22190590, 1118029, 22736441, 15130463, -30460692, -5991321, 19189625, -4648942, 4854859, 6622139), FieldElement.New(-8310738, -2953450, -8262579, -3388049, -10401731, -271929, 13424426, -3567227, 26404409, 13001963), FieldElement.New(-31241838, -15415700, -2994250, 8939346, 11562230, -12840670, -26064365, -11621720, -15405155, 11020693)),
				new ge_precomp(FieldElement.New(1866042, -7949489, -7898649, -10301010, 12483315, 13477547, 3175636, -12424163, 28761762, 1406734), FieldElement.New(-448555, -1777666, 13018551, 3194501, -9580420, -11161737, 24760585, -4347088, 25577411, -13378680), FieldElement.New(-24290378, 4759345, -690653, -1852816, 2066747, 10693769, -29595790, 9884936, -9368926, 4745410)),
				new ge_precomp(FieldElement.New(-9141284, 6049714, -19531061, -4341411, -31260798, 9944276, -15462008, -11311852, 10931924, -11931931), FieldElement.New(-16561513, 14112680, -8012645, 4817318, -8040464, -11414606, -22853429, 10856641, -20470770, 13434654), FieldElement.New(22759489, -10073434, -16766264, -1871422, 13637442, -10168091, 1765144, -12654326, 28445307, -5364710)),
				new ge_precomp(FieldElement.New(29875063, 12493613, 2795536, -3786330, 1710620, 15181182, -10195717, -8788675, 9074234, 1167180), FieldElement.New(-26205683, 11014233, -9842651, -2635485, -26908120, 7532294, -18716888, -9535498, 3843903, 9367684), FieldElement.New(-10969595, -6403711, 9591134, 9582310, 11349256, 108879, 16235123, 8601684, -139197, 4242895))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(22092954, -13191123, -2042793, -11968512, 32186753, -11517388, -6574341, 2470660, -27417366, 16625501), FieldElement.New(-11057722, 3042016, 13770083, -9257922, 584236, -544855, -7770857, 2602725, -27351616, 14247413), FieldElement.New(6314175, -10264892, -32772502, 15957557, -10157730, 168750, -8618807, 14290061, 27108877, -1180880)),
				new ge_precomp(FieldElement.New(-8586597, -7170966, 13241782, 10960156, -32991015, -13794596, 33547976, -11058889, -27148451, 981874), FieldElement.New(22833440, 9293594, -32649448, -13618667, -9136966, 14756819, -22928859, -13970780, -10479804, -16197962), FieldElement.New(-7768587, 3326786, -28111797, 10783824, 19178761, 14905060, 22680049, 13906969, -15933690, 3797899)),
				new ge_precomp(FieldElement.New(21721356, -4212746, -12206123, 9310182, -3882239, -13653110, 23740224, -2709232, 20491983, -8042152), FieldElement.New(9209270, -15135055, -13256557, -6167798, -731016, 15289673, 25947805, 15286587, 30997318, -6703063), FieldElement.New(7392032, 16618386, 23946583, -8039892, -13265164, -1533858, -14197445, -2321576, 17649998, -250080)),
				new ge_precomp(FieldElement.New(-9301088, -14193827, 30609526, -3049543, -25175069, -1283752, -15241566, -9525724, -2233253, 7662146), FieldElement.New(-17558673, 1763594, -33114336, 15908610, -30040870, -12174295, 7335080, -8472199, -3174674, 3440183), FieldElement.New(-19889700, -5977008, -24111293, -9688870, 10799743, -16571957, 40450, -4431835, 4862400, 1133)),
				new ge_precomp(FieldElement.New(-32856209, -7873957, -5422389, 14860950, -16319031, 7956142, 7258061, 311861, -30594991, -7379421), FieldElement.New(-3773428, -1565936, 28985340, 7499440, 24445838, 9325937, 29727763, 16527196, 18278453, 15405622), FieldElement.New(-4381906, 8508652, -19898366, -3674424, -5984453, 15149970, -13313598, 843523, -21875062, 13626197)),
				new ge_precomp(FieldElement.New(2281448, -13487055, -10915418, -2609910, 1879358, 16164207, -10783882, 3953792, 13340839, 15928663), FieldElement.New(31727126, -7179855, -18437503, -8283652, 2875793, -16390330, -25269894, -7014826, -23452306, 5964753), FieldElement.New(4100420, -5959452, -17179337, 6017714, -18705837, 12227141, -26684835, 11344144, 2538215, -7570755)),
				new ge_precomp(FieldElement.New(-9433605, 6123113, 11159803, -2156608, 30016280, 14966241, -20474983, 1485421, -629256, -15958862), FieldElement.New(-26804558, 4260919, 11851389, 9658551, -32017107, 16367492, -20205425, -13191288, 11659922, -11115118), FieldElement.New(26180396, 10015009, -30844224, -8581293, 5418197, 9480663, 2231568, -10170080, 33100372, -1306171)),
				new ge_precomp(FieldElement.New(15121113, -5201871, -10389905, 15427821, -27509937, -15992507, 21670947, 4486675, -5931810, -14466380), FieldElement.New(16166486, -9483733, -11104130, 6023908, -31926798, -1364923, 2340060, -16254968, -10735770, -10039824), FieldElement.New(28042865, -3557089, -12126526, 12259706, -3717498, -6945899, 6766453, -8689599, 18036436, 5803270))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-817581, 6763912, 11803561, 1585585, 10958447, -2671165, 23855391, 4598332, -6159431, -14117438), FieldElement.New(-31031306, -14256194, 17332029, -2383520, 31312682, -5967183, 696309, 50292, -20095739, 11763584), FieldElement.New(-594563, -2514283, -32234153, 12643980, 12650761, 14811489, 665117, -12613632, -19773211, -10713562)),
				new ge_precomp(FieldElement.New(30464590, -11262872, -4127476, -12734478, 19835327, -7105613, -24396175, 2075773, -17020157, 992471), FieldElement.New(18357185, -6994433, 7766382, 16342475, -29324918, 411174, 14578841, 8080033, -11574335, -10601610), FieldElement.New(19598397, 10334610, 12555054, 2555664, 18821899, -10339780, 21873263, 16014234, 26224780, 16452269)),
				new ge_precomp(FieldElement.New(-30223925, 5145196, 5944548, 16385966, 3976735, 2009897, -11377804, -7618186, -20533829, 3698650), FieldElement.New(14187449, 3448569, -10636236, -10810935, -22663880, -3433596, 7268410, -10890444, 27394301, 12015369), FieldElement.New(19695761, 16087646, 28032085, 12999827, 6817792, 11427614, 20244189, -1312777, -13259127, -3402461)),
				new ge_precomp(FieldElement.New(30860103, 12735208, -1888245, -4699734, -16974906, 2256940, -8166013, 12298312, -8550524, -10393462), FieldElement.New(-5719826, -11245325, -1910649, 15569035, 26642876, -7587760, -5789354, -15118654, -4976164, 12651793), FieldElement.New(-2848395, 9953421, 11531313, -5282879, 26895123, -12697089, -13118820, -16517902, 9768698, -2533218)),
				new ge_precomp(FieldElement.New(-24719459, 1894651, -287698, -4704085, 15348719, -8156530, 32767513, 12765450, 4940095, 10678226), FieldElement.New(18860224, 15980149, -18987240, -1562570, -26233012, -11071856, -7843882, 13944024, -24372348, 16582019), FieldElement.New(-15504260, 4970268, -29893044, 4175593, -20993212, -2199756, -11704054, 15444560, -11003761, 7989037)),
				new ge_precomp(FieldElement.New(31490452, 5568061, -2412803, 2182383, -32336847, 4531686, -32078269, 6200206, -19686113, -14800171), FieldElement.New(-17308668, -15879940, -31522777, -2831, -32887382, 16375549, 8680158, -16371713, 28550068, -6857132), FieldElement.New(-28126887, -5688091, 16837845, -1820458, -6850681, 12700016, -30039981, 4364038, 1155602, 5988841)),
				new ge_precomp(FieldElement.New(21890435, -13272907, -12624011, 12154349, -7831873, 15300496, 23148983, -4470481, 24618407, 8283181), FieldElement.New(-33136107, -10512751, 9975416, 6841041, -31559793, 16356536, 3070187, -7025928, 1466169, 10740210), FieldElement.New(-1509399, -15488185, -13503385, -10655916, 32799044, 909394, -13938903, -5779719, -32164649, -15327040)),
				new ge_precomp(FieldElement.New(3960823, -14267803, -28026090, -15918051, -19404858, 13146868, 15567327, 951507, -3260321, -573935), FieldElement.New(24740841, 5052253, -30094131, 8961361, 25877428, 6165135, -24368180, 14397372, -7380369, -6144105), FieldElement.New(-28888365, 3510803, -28103278, -1158478, -11238128, -10631454, -15441463, -14453128, -1625486, -6494814))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(793299, -9230478, 8836302, -6235707, -27360908, -2369593, 33152843, -4885251, -9906200, -621852), FieldElement.New(5666233, 525582, 20782575, -8038419, -24538499, 14657740, 16099374, 1468826, -6171428, -15186581), FieldElement.New(-4859255, -3779343, -2917758, -6748019, 7778750, 11688288, -30404353, -9871238, -1558923, -9863646)),
				new ge_precomp(FieldElement.New(10896332, -7719704, 824275, 472601, -19460308, 3009587, 25248958, 14783338, -30581476, -15757844), FieldElement.New(10566929, 12612572, -31944212, 11118703, -12633376, 12362879, 21752402, 8822496, 24003793, 14264025), FieldElement.New(27713862, -7355973, -11008240, 9227530, 27050101, 2504721, 23886875, -13117525, 13958495, -5732453)),
				new ge_precomp(FieldElement.New(-23481610, 4867226, -27247128, 3900521, 29838369, -8212291, -31889399, -10041781, 7340521, -15410068), FieldElement.New(4646514, -8011124, -22766023, -11532654, 23184553, 8566613, 31366726, -1381061, -15066784, -10375192), FieldElement.New(-17270517, 12723032, -16993061, 14878794, 21619651, -6197576, 27584817, 3093888, -8843694, 3849921)),
				new ge_precomp(FieldElement.New(-9064912, 2103172, 25561640, -15125738, -5239824, 9582958, 32477045, -9017955, 5002294, -15550259), FieldElement.New(-12057553, -11177906, 21115585, -13365155, 8808712, -12030708, 16489530, 13378448, -25845716, 12741426), FieldElement.New(-5946367, 10645103, -30911586, 15390284, -3286982, -7118677, 24306472, 15852464, 28834118, -7646072)),
				new ge_precomp(FieldElement.New(-17335748, -9107057, -24531279, 9434953, -8472084, -583362, -13090771, 455841, 20461858, 5491305), FieldElement.New(13669248, -16095482, -12481974, -10203039, -14569770, -11893198, -24995986, 11293807, -28588204, -9421832), FieldElement.New(28497928, 6272777, -33022994, 14470570, 8906179, -1225630, 18504674, -14165166, 29867745, -8795943)),
				new ge_precomp(FieldElement.New(-16207023, 13517196, -27799630, -13697798, 24009064, -6373891, -6367600, -13175392, 22853429, -4012011), FieldElement.New(24191378, 16712145, -13931797, 15217831, 14542237, 1646131, 18603514, -11037887, 12876623, -2112447), FieldElement.New(17902668, 4518229, -411702, -2829247, 26878217, 5258055, -12860753, 608397, 16031844, 3723494)),
				new ge_precomp(FieldElement.New(-28632773, 12763728, -20446446, 7577504, 33001348, -13017745, 17558842, -7872890, 23896954, -4314245), FieldElement.New(-20005381, -12011952, 31520464, 605201, 2543521, 5991821, -2945064, 7229064, -9919646, -8826859), FieldElement.New(28816045, 298879, -28165016, -15920938, 19000928, -1665890, -12680833, -2949325, -18051778, -2082915)),
				new ge_precomp(FieldElement.New(16000882, -344896, 3493092, -11447198, -29504595, -13159789, 12577740, 16041268, -19715240, 7847707), FieldElement.New(10151868, 10572098, 27312476, 7922682, 14825339, 4723128, -32855931, -6519018, -10020567, 3852848), FieldElement.New(-11430470, 15697596, -21121557, -4420647, 5386314, 15063598, 16514493, -15932110, 29330899, -15076224))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-25499735, -4378794, -15222908, -6901211, 16615731, 2051784, 3303702, 15490, -27548796, 12314391), FieldElement.New(15683520, -6003043, 18109120, -9980648, 15337968, -5997823, -16717435, 15921866, 16103996, -3731215), FieldElement.New(-23169824, -10781249, 13588192, -1628807, -3798557, -1074929, -19273607, 5402699, -29815713, -9841101)),
				new ge_precomp(FieldElement.New(23190676, 2384583, -32714340, 3462154, -29903655, -1529132, -11266856, 8911517, -25205859, 2739713), FieldElement.New(21374101, -3554250, -33524649, 9874411, 15377179, 11831242, -33529904, 6134907, 4931255, 11987849), FieldElement.New(-7732, -2978858, -16223486, 7277597, 105524, -322051, -31480539, 13861388, -30076310, 10117930)),
				new ge_precomp(FieldElement.New(-29501170, -10744872, -26163768, 13051539, -25625564, 5089643, -6325503, 6704079, 12890019, 15728940), FieldElement.New(-21972360, -11771379, -951059, -4418840, 14704840, 2695116, 903376, -10428139, 12885167, 8311031), FieldElement.New(-17516482, 5352194, 10384213, -13811658, 7506451, 13453191, 26423267, 4384730, 1888765, -5435404)),
				new ge_precomp(FieldElement.New(-25817338, -3107312, -13494599, -3182506, 30896459, -13921729, -32251644, -12707869, -19464434, -3340243), FieldElement.New(-23607977, -2665774, -526091, 4651136, 5765089, 4618330, 6092245, 14845197, 17151279, -9854116), FieldElement.New(-24830458, -12733720, -15165978, 10367250, -29530908, -265356, 22825805, -7087279, -16866484, 16176525)),
				new ge_precomp(FieldElement.New(-23583256, 6564961, 20063689, 3798228, -4740178, 7359225, 2006182, -10363426, -28746253, -10197509), FieldElement.New(-10626600, -4486402, -13320562, -5125317, 3432136, -6393229, 23632037, -1940610, 32808310, 1099883), FieldElement.New(15030977, 5768825, -27451236, -2887299, -6427378, -15361371, -15277896, -6809350, 2051441, -15225865)),
				new ge_precomp(FieldElement.New(-3362323, -7239372, 7517890, 9824992, 23555850, 295369, 5148398, -14154188, -22686354, 16633660), FieldElement.New(4577086, -16752288, 13249841, -15304328, 19958763, -14537274, 18559670, -10759549, 8402478, -9864273), FieldElement.New(-28406330, -1051581, -26790155, -907698, -17212414, -11030789, 9453451, -14980072, 17983010, 9967138)),
				new ge_precomp(FieldElement.New(-25762494, 6524722, 26585488, 9969270, 24709298, 1220360, -1677990, 7806337, 17507396, 3651560), FieldElement.New(-10420457, -4118111, 14584639, 15971087, -15768321, 8861010, 26556809, -5574557, -18553322, -11357135), FieldElement.New(2839101, 14284142, 4029895, 3472686, 14402957, 12689363, -26642121, 8459447, -5605463, -7621941)),
				new ge_precomp(FieldElement.New(-4839289, -3535444, 9744961, 2871048, 25113978, 3187018, -25110813, -849066, 17258084, -7977739), FieldElement.New(18164541, -10595176, -17154882, -1542417, 19237078, -9745295, 23357533, -15217008, 26908270, 12150756), FieldElement.New(-30264870, -7647865, 5112249, -7036672, -1499807, -6974257, 43168, -5537701, -32302074, 16215819))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-6898905, 9824394, -12304779, -4401089, -31397141, -6276835, 32574489, 12532905, -7503072, -8675347), FieldElement.New(-27343522, -16515468, -27151524, -10722951, 946346, 16291093, 254968, 7168080, 21676107, -1943028), FieldElement.New(21260961, -8424752, -16831886, -11920822, -23677961, 3968121, -3651949, -6215466, -3556191, -7913075)),
				new ge_precomp(FieldElement.New(16544754, 13250366, -16804428, 15546242, -4583003, 12757258, -2462308, -8680336, -18907032, -9662799), FieldElement.New(-2415239, -15577728, 18312303, 4964443, -15272530, -12653564, 26820651, 16690659, 25459437, -4564609), FieldElement.New(-25144690, 11425020, 28423002, -11020557, -6144921, -15826224, 9142795, -2391602, -6432418, -1644817)),
				new ge_precomp(FieldElement.New(-23104652, 6253476, 16964147, -3768872, -25113972, -12296437, -27457225, -16344658, 6335692, 7249989), FieldElement.New(-30333227, 13979675, 7503222, -12368314, -11956721, -4621693, -30272269, 2682242, 25993170, -12478523), FieldElement.New(4364628, 5930691, 32304656, -10044554, -8054781, 15091131, 22857016, -10598955, 31820368, 15075278)),
				new ge_precomp(FieldElement.New(31879134, -8918693, 17258761, 90626, -8041836, -4917709, 24162788, -9650886, -17970238, 12833045), FieldElement.New(19073683, 14851414, -24403169, -11860168, 7625278, 11091125, -19619190, 2074449, -9413939, 14905377), FieldElement.New(24483667, -11935567, -2518866, -11547418, -1553130, 15355506, -25282080, 9253129, 27628530, -7555480)),
				new ge_precomp(FieldElement.New(17597607, 8340603, 19355617, 552187, 26198470, -3176583, 4593324, -9157582, -14110875, 15297016), FieldElement.New(510886, 14337390, -31785257, 16638632, 6328095, 2713355, -20217417, -11864220, 8683221, 2921426), FieldElement.New(18606791, 11874196, 27155355, -5281482, -24031742, 6265446, -25178240, -1278924, 4674690, 13890525)),
				new ge_precomp(FieldElement.New(13609624, 13069022, -27372361, -13055908, 24360586, 9592974, 14977157, 9835105, 4389687, 288396), FieldElement.New(9922506, -519394, 13613107, 5883594, -18758345, -434263, -12304062, 8317628, 23388070, 16052080), FieldElement.New(12720016, 11937594, -31970060, -5028689, 26900120, 8561328, -20155687, -11632979, -14754271, -10812892)),
				new ge_precomp(FieldElement.New(15961858, 14150409, 26716931, -665832, -22794328, 13603569, 11829573, 7467844, -28822128, 929275), FieldElement.New(11038231, -11582396, -27310482, -7316562, -10498527, -16307831, -23479533, -9371869, -21393143, 2465074), FieldElement.New(20017163, -4323226, 27915242, 1529148, 12396362, 15675764, 13817261, -9658066, 2463391, -4622140)),
				new ge_precomp(FieldElement.New(-16358878, -12663911, -12065183, 4996454, -1256422, 1073572, 9583558, 12851107, 4003896, 12673717), FieldElement.New(-1731589, -15155870, -3262930, 16143082, 19294135, 13385325, 14741514, -9103726, 7903886, 2348101), FieldElement.New(24536016, -16515207, 12715592, -3862155, 1511293, 10047386, -3842346, -7129159, -28377538, 10048127))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-12622226, -6204820, 30718825, 2591312, -10617028, 12192840, 18873298, -7297090, -32297756, 15221632), FieldElement.New(-26478122, -11103864, 11546244, -1852483, 9180880, 7656409, -21343950, 2095755, 29769758, 6593415), FieldElement.New(-31994208, -2907461, 4176912, 3264766, 12538965, -868111, 26312345, -6118678, 30958054, 8292160)),
				new ge_precomp(FieldElement.New(31429822, -13959116, 29173532, 15632448, 12174511, -2760094, 32808831, 3977186, 26143136, -3148876), FieldElement.New(22648901, 1402143, -22799984, 13746059, 7936347, 365344, -8668633, -1674433, -3758243, -2304625), FieldElement.New(-15491917, 8012313, -2514730, -12702462, -23965846, -10254029, -1612713, -1535569, -16664475, 8194478)),
				new ge_precomp(FieldElement.New(27338066, -7507420, -7414224, 10140405, -19026427, -6589889, 27277191, 8855376, 28572286, 3005164), FieldElement.New(26287124, 4821776, 25476601, -4145903, -3764513, -15788984, -18008582, 1182479, -26094821, -13079595), FieldElement.New(-7171154, 3178080, 23970071, 6201893, -17195577, -4489192, -21876275, -13982627, 32208683, -1198248)),
				new ge_precomp(FieldElement.New(-16657702, 2817643, -10286362, 14811298, 6024667, 13349505, -27315504, -10497842, -27672585, -11539858), FieldElement.New(15941029, -9405932, -21367050, 8062055, 31876073, -238629, -15278393, -1444429, 15397331, -4130193), FieldElement.New(8934485, -13485467, -23286397, -13423241, -32446090, 14047986, 31170398, -1441021, -27505566, 15087184)),
				new ge_precomp(FieldElement.New(-18357243, -2156491, 24524913, -16677868, 15520427, -6360776, -15502406, 11461896, 16788528, -5868942), FieldElement.New(-1947386, 16013773, 21750665, 3714552, -17401782, -16055433, -3770287, -10323320, 31322514, -11615635), FieldElement.New(21426655, -5650218, -13648287, -5347537, -28812189, -4920970, -18275391, -14621414, 13040862, -12112948)),
				new ge_precomp(FieldElement.New(11293895, 12478086, -27136401, 15083750, -29307421, 14748872, 14555558, -13417103, 1613711, 4896935), FieldElement.New(-25894883, 15323294, -8489791, -8057900, 25967126, -13425460, 2825960, -4897045, -23971776, -11267415), FieldElement.New(-15924766, -5229880, -17443532, 6410664, 3622847, 10243618, 20615400, 12405433, -23753030, -8436416)),
				new ge_precomp(FieldElement.New(-7091295, 12556208, -20191352, 9025187, -17072479, 4333801, 4378436, 2432030, 23097949, -566018), FieldElement.New(4565804, -16025654, 20084412, -7842817, 1724999, 189254, 24767264, 10103221, -18512313, 2424778), FieldElement.New(366633, -11976806, 8173090, -6890119, 30788634, 5745705, -7168678, 1344109, -3642553, 12412659)),
				new ge_precomp(FieldElement.New(-24001791, 7690286, 14929416, -168257, -32210835, -13412986, 24162697, -15326504, -3141501, 11179385), FieldElement.New(18289522, -14724954, 8056945, 16430056, -21729724, 7842514, -6001441, -1486897, -18684645, -11443503), FieldElement.New(476239, 6601091, -6152790, -9723375, 17503545, -4863900, 27672959, 13403813, 11052904, 5219329))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(20678546, -8375738, -32671898, 8849123, -5009758, 14574752, 31186971, -3973730, 9014762, -8579056), FieldElement.New(-13644050, -10350239, -15962508, 5075808, -1514661, -11534600, -33102500, 9160280, 8473550, -3256838), FieldElement.New(24900749, 14435722, 17209120, -15292541, -22592275, 9878983, -7689309, -16335821, -24568481, 11788948)),
				new ge_precomp(FieldElement.New(-3118155, -11395194, -13802089, 14797441, 9652448, -6845904, -20037437, 10410733, -24568470, -1458691), FieldElement.New(-15659161, 16736706, -22467150, 10215878, -9097177, 7563911, 11871841, -12505194, -18513325, 8464118), FieldElement.New(-23400612, 8348507, -14585951, -861714, -3950205, -6373419, 14325289, 8628612, 33313881, -8370517)),
				new ge_precomp(FieldElement.New(-20186973, -4967935, 22367356, 5271547, -1097117, -4788838, -24805667, -10236854, -8940735, -5818269), FieldElement.New(-6948785, -1795212, -32625683, -16021179, 32635414, -7374245, 15989197, -12838188, 28358192, -4253904), FieldElement.New(-23561781, -2799059, -32351682, -1661963, -9147719, 10429267, -16637684, 4072016, -5351664, 5596589)),
				new ge_precomp(FieldElement.New(-28236598, -3390048, 12312896, 6213178, 3117142, 16078565, 29266239, 2557221, 1768301, 15373193), FieldElement.New(-7243358, -3246960, -4593467, -7553353, -127927, -912245, -1090902, -4504991, -24660491, 3442910), FieldElement.New(-30210571, 5124043, 14181784, 8197961, 18964734, -11939093, 22597931, 7176455, -18585478, 13365930)),
				new ge_precomp(FieldElement.New(-7877390, -1499958, 8324673, 4690079, 6261860, 890446, 24538107, -8570186, -9689599, -3031667), FieldElement.New(25008904, -10771599, -4305031, -9638010, 16265036, 15721635, 683793, -11823784, 15723479, -15163481), FieldElement.New(-9660625, 12374379, -27006999, -7026148, -7724114, -12314514, 11879682, 5400171, 519526, -1235876)),
				new ge_precomp(FieldElement.New(22258397, -16332233, -7869817, 14613016, -22520255, -2950923, -20353881, 7315967, 16648397, 7605640), FieldElement.New(-8081308, -8464597, -8223311, 9719710, 19259459, -15348212, 23994942, -5281555, -9468848, 4763278), FieldElement.New(-21699244, 9220969, -15730624, 1084137, -25476107, -2852390, 31088447, -7764523, -11356529, 728112)),
				new ge_precomp(FieldElement.New(26047220, -11751471, -6900323, -16521798, 24092068, 9158119, -4273545, -12555558, -29365436, -5498272), FieldElement.New(17510331, -322857, 5854289, 8403524, 17133918, -3112612, -28111007, 12327945, 10750447, 10014012), FieldElement.New(-10312768, 3936952, 9156313, -8897683, 16498692, -994647, -27481051, -666732, 3424691, 7540221)),
				new ge_precomp(FieldElement.New(30322361, -6964110, 11361005, -4143317, 7433304, 4989748, -7071422, -16317219, -9244265, 15258046), FieldElement.New(13054562, -2779497, 19155474, 469045, -12482797, 4566042, 5631406, 2711395, 1062915, -5136345), FieldElement.New(-19240248, -11254599, -29509029, -7499965, -5835763, 13005411, -6066489, 12194497, 32960380, 1459310))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(19852034, 7027924, 23669353, 10020366, 8586503, -6657907, 394197, -6101885, 18638003, -11174937), FieldElement.New(31395534, 15098109, 26581030, 8030562, -16527914, -5007134, 9012486, -7584354, -6643087, -5442636), FieldElement.New(-9192165, -2347377, -1997099, 4529534, 25766844, 607986, -13222, 9677543, -32294889, -6456008)),
				new ge_precomp(FieldElement.New(-2444496, -149937, 29348902, 8186665, 1873760, 12489863, -30934579, -7839692, -7852844, -8138429), FieldElement.New(-15236356, -15433509, 7766470, 746860, 26346930, -10221762, -27333451, 10754588, -9431476, 5203576), FieldElement.New(31834314, 14135496, -770007, 5159118, 20917671, -16768096, -7467973, -7337524, 31809243, 7347066)),
				new ge_precomp(FieldElement.New(-9606723, -11874240, 20414459, 13033986, 13716524, -11691881, 19797970, -12211255, 15192876, -2087490), FieldElement.New(-12663563, -2181719, 1168162, -3804809, 26747877, -14138091, 10609330, 12694420, 33473243, -13382104), FieldElement.New(33184999, 11180355, 15832085, -11385430, -1633671, 225884, 15089336, -11023903, -6135662, 14480053)),
				new ge_precomp(FieldElement.New(31308717, -5619998, 31030840, -1897099, 15674547, -6582883, 5496208, 13685227, 27595050, 8737275), FieldElement.New(-20318852, -15150239, 10933843, -16178022, 8335352, -7546022, -31008351, -12610604, 26498114, 66511), FieldElement.New(22644454, -8761729, -16671776, 4884562, -3105614, -13559366, 30540766, -4286747, -13327787, -7515095)),
				new ge_precomp(FieldElement.New(-28017847, 9834845, 18617207, -2681312, -3401956, -13307506, 8205540, 13585437, -17127465, 15115439), FieldElement.New(23711543, -672915, 31206561, -8362711, 6164647, -9709987, -33535882, -1426096, 8236921, 16492939), FieldElement.New(-23910559, -13515526, -26299483, -4503841, 25005590, -7687270, 19574902, 10071562, 6708380, -6222424)),
				new ge_precomp(FieldElement.New(2101391, -4930054, 19702731, 2367575, -15427167, 1047675, 5301017, 9328700, 29955601, -11678310), FieldElement.New(3096359, 9271816, -21620864, -15521844, -14847996, -7592937, -25892142, -12635595, -9917575, 6216608), FieldElement.New(-32615849, 338663, -25195611, 2510422, -29213566, -13820213, 24822830, -6146567, -26767480, 7525079)),
				new ge_precomp(FieldElement.New(-23066649, -13985623, 16133487, -7896178, -3389565, 778788, -910336, -2782495, -19386633, 11994101), FieldElement.New(21691500, -13624626, -641331, -14367021, 3285881, -3483596, -25064666, 9718258, -7477437, 13381418), FieldElement.New(18445390, -4202236, 14979846, 11622458, -1727110, -3582980, 23111648, -6375247, 28535282, 15779576)),
				new ge_precomp(FieldElement.New(30098053, 3089662, -9234387, 16662135, -21306940, 11308411, -14068454, 12021730, 9955285, -16303356), FieldElement.New(9734894, -14576830, -7473633, -9138735, 2060392, 11313496, -18426029, 9924399, 20194861, 13380996), FieldElement.New(-26378102, -7965207, -22167821, 15789297, -18055342, -6168792, -1984914, 15707771, 26342023, 10146099))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(-26016874, -219943, 21339191, -41388, 19745256, -2878700, -29637280, 2227040, 21612326, -545728), FieldElement.New(-13077387, 1184228, 23562814, -5970442, -20351244, -6348714, 25764461, 12243797, -20856566, 11649658), FieldElement.New(-10031494, 11262626, 27384172, 2271902, 26947504, -15997771, 39944, 6114064, 33514190, 2333242)),
				new ge_precomp(FieldElement.New(-21433588, -12421821, 8119782, 7219913, -21830522, -9016134, -6679750, -12670638, 24350578, -13450001), FieldElement.New(-4116307, -11271533, -23886186, 4843615, -30088339, 690623, -31536088, -10406836, 8317860, 12352766), FieldElement.New(18200138, -14475911, -33087759, -2696619, -23702521, -9102511, -23552096, -2287550, 20712163, 6719373)),
				new ge_precomp(FieldElement.New(26656208, 6075253, -7858556, 1886072, -28344043, 4262326, 11117530, -3763210, 26224235, -3297458), FieldElement.New(-17168938, -14854097, -3395676, -16369877, -19954045, 14050420, 21728352, 9493610, 18620611, -16428628), FieldElement.New(-13323321, 13325349, 11432106, 5964811, 18609221, 6062965, -5269471, -9725556, -30701573, -16479657)),
				new ge_precomp(FieldElement.New(-23860538, -11233159, 26961357, 1640861, -32413112, -16737940, 12248509, -5240639, 13735342, 1934062), FieldElement.New(25089769, 6742589, 17081145, -13406266, 21909293, -16067981, -15136294, -3765346, -21277997, 5473616), FieldElement.New(31883677, -7961101, 1083432, -11572403, 22828471, 13290673, -7125085, 12469656, 29111212, -5451014)),
				new ge_precomp(FieldElement.New(24244947, -15050407, -26262976, 2791540, -14997599, 16666678, 24367466, 6388839, -10295587, 452383), FieldElement.New(-25640782, -3417841, 5217916, 16224624, 19987036, -4082269, -24236251, -5915248, 15766062, 8407814), FieldElement.New(-20406999, 13990231, 15495425, 16395525, 5377168, 15166495, -8917023, -4388953, -8067909, 2276718)),
				new ge_precomp(FieldElement.New(30157918, 12924066, -17712050, 9245753, 19895028, 3368142, -23827587, 5096219, 22740376, -7303417), FieldElement.New(2041139, -14256350, 7783687, 13876377, -25946985, -13352459, 24051124, 13742383, -15637599, 13295222), FieldElement.New(33338237, -8505733, 12532113, 7977527, 9106186, -1715251, -17720195, -4612972, -4451357, -14669444)),
				new ge_precomp(FieldElement.New(-20045281, 5454097, -14346548, 6447146, 28862071, 1883651, -2469266, -4141880, 7770569, 9620597), FieldElement.New(23208068, 7979712, 33071466, 8149229, 1758231, -10834995, 30945528, -1694323, -33502340, -14767970), FieldElement.New(1439958, -16270480, -1079989, -793782, 4625402, 10647766, -5043801, 1220118, 30494170, -11440799)),
				new ge_precomp(FieldElement.New(-5037580, -13028295, -2970559, -3061767, 15640974, -6701666, -26739026, 926050, -1684339, -13333647), FieldElement.New(13908495, -3549272, 30919928, -6273825, -21521863, 7989039, 9021034, 9078865, 3353509, 4033511), FieldElement.New(-29663431, -15113610, 32259991, -344482, 24295849, -12912123, 23161163, 8839127, 27485041, 7356032))
			},
			new ge_precomp[8]
			{
				new ge_precomp(FieldElement.New(9661027, 705443, 11980065, -5370154, -1628543, 14661173, -6346142, 2625015, 28431036, -16771834), FieldElement.New(-23839233, -8311415, -25945511, 7480958, -17681669, -8354183, -22545972, 14150565, 15970762, 4099461), FieldElement.New(29262576, 16756590, 26350592, -8793563, 8529671, -11208050, 13617293, -9937143, 11465739, 8317062)),
				new ge_precomp(FieldElement.New(-25493081, -6962928, 32500200, -9419051, -23038724, -2302222, 14898637, 3848455, 20969334, -5157516), FieldElement.New(-20384450, -14347713, -18336405, 13884722, -33039454, 2842114, -21610826, -3649888, 11177095, 14989547), FieldElement.New(-24496721, -11716016, 16959896, 2278463, 12066309, 10137771, 13515641, 2581286, -28487508, 9930240)),
				new ge_precomp(FieldElement.New(-17751622, -2097826, 16544300, -13009300, -15914807, -14949081, 18345767, -13403753, 16291481, -5314038), FieldElement.New(-33229194, 2553288, 32678213, 9875984, 8534129, 6889387, -9676774, 6957617, 4368891, 9788741), FieldElement.New(16660756, 7281060, -10830758, 12911820, 20108584, -8101676, -21722536, -8613148, 16250552, -11111103)),
				new ge_precomp(FieldElement.New(-19765507, 2390526, -16551031, 14161980, 1905286, 6414907, 4689584, 10604807, -30190403, 4782747), FieldElement.New(-1354539, 14736941, -7367442, -13292886, 7710542, -14155590, -9981571, 4383045, 22546403, 437323), FieldElement.New(31665577, -12180464, -16186830, 1491339, -18368625, 3294682, 27343084, 2786261, -30633590, -14097016)),
				new ge_precomp(FieldElement.New(-14467279, -683715, -33374107, 7448552, 19294360, 14334329, -19690631, 2355319, -19284671, -6114373), FieldElement.New(15121312, -15796162, 6377020, -6031361, -10798111, -12957845, 18952177, 15496498, -29380133, 11754228), FieldElement.New(-2637277, -13483075, 8488727, -14303896, 12728761, -1622493, 7141596, 11724556, 22761615, -10134141)),
				new ge_precomp(FieldElement.New(16918416, 11729663, -18083579, 3022987, -31015732, -13339659, -28741185, -12227393, 32851222, 11717399), FieldElement.New(11166634, 7338049, -6722523, 4531520, -29468672, -7302055, 31474879, 3483633, -1193175, -4030831), FieldElement.New(-185635, 9921305, 31456609, -13536438, -12013818, 13348923, 33142652, 6546660, -19985279, -3948376)),
				new ge_precomp(FieldElement.New(-32460596, 11266712, -11197107, -7899103, 31703694, 3855903, -8537131, -12833048, -30772034, -15486313), FieldElement.New(-18006477, 12709068, 3991746, -6479188, -21491523, -10550425, -31135347, -16049879, 10928917, 3011958), FieldElement.New(-6957757, -15594337, 31696059, 334240, 29576716, 14796075, -30831056, -12805180, 18008031, 10258577)),
				new ge_precomp(FieldElement.New(-22448644, 15655569, 7018479, -4410003, -30314266, -1201591, -1853465, 1367120, 25127874, 6671743), FieldElement.New(29701166, -14373934, -10878120, 9279288, -17568, 13127210, 21382910, 11042292, 25838796, 4642684), FieldElement.New(-20430234, 14955537, -24126347, 8124619, -5369288, -5990470, 30468147, -13900640, 18423289, 4177476))
			}
		};

		private static void ge_add(ge_p1p1 r, ge_p3 p, ge_cached q)
		{
			int[] array = FieldElement.New();
			FieldElement.fe_add(r.X, p.Y, p.X);
			FieldElement.fe_sub(r.Y, p.Y, p.X);
			FieldElement.fe_mul(r.Z, r.X, q.YplusX);
			FieldElement.fe_mul(r.Y, r.Y, q.YminusX);
			FieldElement.fe_mul(r.T, q.T2d, p.T);
			FieldElement.fe_mul(r.X, p.Z, q.Z);
			FieldElement.fe_add(array, r.X, r.X);
			FieldElement.fe_sub(r.X, r.Z, r.Y);
			FieldElement.fe_add(r.Y, r.Z, r.Y);
			FieldElement.fe_add(r.Z, array, r.T);
			FieldElement.fe_sub(r.T, array, r.T);
		}

		private static void slide(sbyte[] r, byte[] a)
		{
			for (int i = 0; i < 256; i++)
			{
				r[i] = (sbyte)(1 & (a[i >> 3] >> (i & 7)));
			}
			for (int i = 0; i < 256; i++)
			{
				if (r[i] == 0)
				{
					continue;
				}
				for (int j = 1; j <= 6 && i + j < 256; j++)
				{
					if (r[i + j] == 0)
					{
						continue;
					}
					if (r[i] + (r[i + j] << j) <= 15)
					{
						r[i] += (sbyte)(r[i + j] << j);
						r[i + j] = 0;
						continue;
					}
					if (r[i] - (r[i + j] << j) < -15)
					{
						break;
					}
					r[i] -= (sbyte)(r[i + j] << j);
					for (int k = i + j; k < 256; k++)
					{
						if (r[k] == 0)
						{
							r[k] = 1;
							break;
						}
						r[k] = 0;
					}
				}
			}
		}

		public static void ge_double_scalarmult_vartime(ge_p2 r, byte[] a, ge_p3 A, byte[] b)
		{
			sbyte[] array = new sbyte[256];
			sbyte[] array2 = new sbyte[256];
			ge_cached[] array3 = new ge_cached[8];
			for (int i = 0; i < array3.Length; i++)
			{
				array3[i] = new ge_cached();
			}
			ge_p1p1 ge_p1p = new ge_p1p1();
			ge_p3 ge_p = new ge_p3();
			ge_p3 ge_p2 = new ge_p3();
			slide(array, a);
			slide(array2, b);
			ge_p3_to_cached(array3[0], A);
			ge_p3_dbl(ge_p1p, A);
			ge_p1p1_to_p3(ge_p2, ge_p1p);
			ge_add(ge_p1p, ge_p2, array3[0]);
			ge_p1p1_to_p3(ge_p, ge_p1p);
			ge_p3_to_cached(array3[1], ge_p);
			ge_add(ge_p1p, ge_p2, array3[1]);
			ge_p1p1_to_p3(ge_p, ge_p1p);
			ge_p3_to_cached(array3[2], ge_p);
			ge_add(ge_p1p, ge_p2, array3[2]);
			ge_p1p1_to_p3(ge_p, ge_p1p);
			ge_p3_to_cached(array3[3], ge_p);
			ge_add(ge_p1p, ge_p2, array3[3]);
			ge_p1p1_to_p3(ge_p, ge_p1p);
			ge_p3_to_cached(array3[4], ge_p);
			ge_add(ge_p1p, ge_p2, array3[4]);
			ge_p1p1_to_p3(ge_p, ge_p1p);
			ge_p3_to_cached(array3[5], ge_p);
			ge_add(ge_p1p, ge_p2, array3[5]);
			ge_p1p1_to_p3(ge_p, ge_p1p);
			ge_p3_to_cached(array3[6], ge_p);
			ge_add(ge_p1p, ge_p2, array3[6]);
			ge_p1p1_to_p3(ge_p, ge_p1p);
			ge_p3_to_cached(array3[7], ge_p);
			ge_p2_0(r);
			int num = 255;
			while (num >= 0 && array[num] == 0 && array2[num] == 0)
			{
				num--;
			}
			while (num >= 0)
			{
				ge_p2_dbl(ge_p1p, r);
				if (array[num] > 0)
				{
					ge_p1p1_to_p3(ge_p, ge_p1p);
					ge_add(ge_p1p, ge_p, array3[array[num] / 2]);
				}
				else if (array[num] < 0)
				{
					ge_p1p1_to_p3(ge_p, ge_p1p);
					ge_sub(ge_p1p, ge_p, array3[-array[num] / 2]);
				}
				if (array2[num] > 0)
				{
					ge_p1p1_to_p3(ge_p, ge_p1p);
					ge_madd(ge_p1p, ge_p, Bi[array2[num] / 2]);
				}
				else if (array2[num] < 0)
				{
					ge_p1p1_to_p3(ge_p, ge_p1p);
					ge_msub(ge_p1p, ge_p, Bi[-array2[num] / 2]);
				}
				ge_p1p1_to_p2(r, ge_p1p);
				num--;
			}
		}

		public static int ge_frombytes_negate_vartime(ge_p3 h, byte[] s)
		{
			int[] array = FieldElement.New();
			int[] array2 = FieldElement.New();
			int[] array3 = FieldElement.New();
			int[] array4 = FieldElement.New();
			int[] array5 = FieldElement.New();
			FieldElement.fe_frombytes(h.Y, s);
			FieldElement.fe_1(h.Z);
			FieldElement.fe_sq(array, h.Y);
			FieldElement.fe_mul(array2, array, d);
			FieldElement.fe_sub(array, array, h.Z);
			FieldElement.fe_add(array2, array2, h.Z);
			FieldElement.fe_sq(array3, array2);
			FieldElement.fe_mul(array3, array3, array2);
			FieldElement.fe_sq(h.X, array3);
			FieldElement.fe_mul(h.X, h.X, array2);
			FieldElement.fe_mul(h.X, h.X, array);
			FieldElement.fe_pow22523(h.X, h.X);
			FieldElement.fe_mul(h.X, h.X, array3);
			FieldElement.fe_mul(h.X, h.X, array);
			FieldElement.fe_sq(array4, h.X);
			FieldElement.fe_mul(array4, array4, array2);
			FieldElement.fe_sub(array5, array4, array);
			if (FieldElement.fe_isnonzero(array5) != 0)
			{
				FieldElement.fe_add(array5, array4, array);
				if (FieldElement.fe_isnonzero(array5) != 0)
				{
					return -1;
				}
				FieldElement.fe_mul(h.X, h.X, sqrtm1);
			}
			if (FieldElement.fe_isnegative(h.X) == s[31] >> 7)
			{
				FieldElement.fe_neg(h.X, h.X);
			}
			FieldElement.fe_mul(h.T, h.X, h.Y);
			return 0;
		}

		private static void ge_madd(ge_p1p1 result, ge_p3 p, ge_precomp q)
		{
			int[] array = FieldElement.New();
			FieldElement.fe_add(result.X, p.Y, p.X);
			FieldElement.fe_sub(result.Y, p.Y, p.X);
			FieldElement.fe_mul(result.Z, result.X, q.yplusx);
			FieldElement.fe_mul(result.Y, result.Y, q.yminusx);
			FieldElement.fe_mul(result.T, q.xy2d, p.T);
			FieldElement.fe_add(array, p.Z, p.Z);
			FieldElement.fe_sub(result.X, result.Z, result.Y);
			FieldElement.fe_add(result.Y, result.Z, result.Y);
			FieldElement.fe_add(result.Z, array, result.T);
			FieldElement.fe_sub(result.T, array, result.T);
		}

		private static void ge_msub(ge_p1p1 result, ge_p3 p, ge_precomp q)
		{
			int[] array = FieldElement.New();
			FieldElement.fe_add(result.X, p.Y, p.X);
			FieldElement.fe_sub(result.Y, p.Y, p.X);
			FieldElement.fe_mul(result.Z, result.X, q.yminusx);
			FieldElement.fe_mul(result.Y, result.Y, q.yplusx);
			FieldElement.fe_mul(result.T, q.xy2d, p.T);
			FieldElement.fe_add(array, p.Z, p.Z);
			FieldElement.fe_sub(result.X, result.Z, result.Y);
			FieldElement.fe_add(result.Y, result.Z, result.Y);
			FieldElement.fe_sub(result.Z, array, result.T);
			FieldElement.fe_add(result.T, array, result.T);
		}

		private static void ge_p1p1_to_p2(ge_p2 result, ge_p1p1 p)
		{
			FieldElement.fe_mul(result.X, p.X, p.T);
			FieldElement.fe_mul(result.Y, p.Y, p.Z);
			FieldElement.fe_mul(result.Z, p.Z, p.T);
		}

		private static void ge_p1p1_to_p3(ge_p3 result, ge_p1p1 p)
		{
			FieldElement.fe_mul(result.X, p.X, p.T);
			FieldElement.fe_mul(result.Y, p.Y, p.Z);
			FieldElement.fe_mul(result.Z, p.Z, p.T);
			FieldElement.fe_mul(result.T, p.X, p.Y);
		}

		private static void ge_p2_0(ge_p2 h)
		{
			FieldElement.fe_0(h.X);
			FieldElement.fe_1(h.Y);
			FieldElement.fe_1(h.Z);
		}

		private static void ge_p2_dbl(ge_p1p1 result, ge_p2 p)
		{
			int[] array = FieldElement.New();
			FieldElement.fe_sq(result.X, p.X);
			FieldElement.fe_sq(result.Z, p.Y);
			FieldElement.fe_sq2(result.T, p.Z);
			FieldElement.fe_add(result.Y, p.X, p.Y);
			FieldElement.fe_sq(array, result.Y);
			FieldElement.fe_add(result.Y, result.Z, result.X);
			FieldElement.fe_sub(result.Z, result.Z, result.X);
			FieldElement.fe_sub(result.X, array, result.Y);
			FieldElement.fe_sub(result.T, result.T, result.Z);
		}

		private static void ge_p3_0(ge_p3 h)
		{
			FieldElement.fe_0(h.X);
			FieldElement.fe_1(h.Y);
			FieldElement.fe_1(h.Z);
			FieldElement.fe_0(h.T);
		}

		private static void ge_p3_dbl(ge_p1p1 result, ge_p3 p)
		{
			ge_p2 ge_p = new ge_p2();
			ge_p3_to_p2(ge_p, p);
			ge_p2_dbl(result, ge_p);
		}

		private static void ge_p3_to_cached(ge_cached result, ge_p3 p)
		{
			FieldElement.fe_add(result.YplusX, p.Y, p.X);
			FieldElement.fe_sub(result.YminusX, p.Y, p.X);
			FieldElement.fe_copy(result.Z, p.Z);
			FieldElement.fe_mul(result.T2d, p.T, d2);
		}

		private static void ge_p3_to_p2(ge_p2 result, ge_p3 p)
		{
			FieldElement.fe_copy(result.X, p.X);
			FieldElement.fe_copy(result.Y, p.Y);
			FieldElement.fe_copy(result.Z, p.Z);
		}

		public static void ge_p3_tobytes(byte[] s, ge_p3 h)
		{
			int[] array = FieldElement.New();
			int[] array2 = FieldElement.New();
			int[] h2 = FieldElement.New();
			FieldElement.fe_invert(array, h.Z);
			FieldElement.fe_mul(array2, h.X, array);
			FieldElement.fe_mul(h2, h.Y, array);
			FieldElement.fe_tobytes(s, h2);
			s[31] ^= (byte)(FieldElement.fe_isnegative(array2) << 7);
		}

		private static byte equal(byte b, byte c)
		{
			return (byte)((uint)((b ^ c) - 1) >> 31);
		}

		private static byte negative(sbyte b)
		{
			return (byte)((ulong)b >> 63);
		}

		private static void cmov(ge_precomp t, ge_precomp u, byte b)
		{
			FieldElement.fe_cmov(t.yplusx, u.yplusx, b);
			FieldElement.fe_cmov(t.yminusx, u.yminusx, b);
			FieldElement.fe_cmov(t.xy2d, u.xy2d, b);
		}

		private static void select(ge_precomp t, int pos, sbyte b)
		{
			ge_precomp ge_precomp = new ge_precomp(FieldElement.New(), FieldElement.New(), FieldElement.New());
			byte b2 = negative(b);
			byte b3 = (byte)(b - ((-b2 & b) << 1));
			FieldElement.fe_1(t.yplusx);
			FieldElement.fe_1(t.yminusx);
			FieldElement.fe_0(t.xy2d);
			cmov(t, Base[pos][0], equal(b3, 1));
			cmov(t, Base[pos][1], equal(b3, 2));
			cmov(t, Base[pos][2], equal(b3, 3));
			cmov(t, Base[pos][3], equal(b3, 4));
			cmov(t, Base[pos][4], equal(b3, 5));
			cmov(t, Base[pos][5], equal(b3, 6));
			cmov(t, Base[pos][6], equal(b3, 7));
			cmov(t, Base[pos][7], equal(b3, 8));
			FieldElement.fe_copy(ge_precomp.yplusx, t.yminusx);
			FieldElement.fe_copy(ge_precomp.yminusx, t.yplusx);
			FieldElement.fe_neg(ge_precomp.xy2d, t.xy2d);
			cmov(t, ge_precomp, b2);
		}

		public static void ge_scalarmult_base(ge_p3 h, byte[] a)
		{
			sbyte[] array = new sbyte[64];
			ge_p1p1 ge_p1p = new ge_p1p1();
			ge_p2 ge_p = new ge_p2();
			ge_precomp ge_precomp = new ge_precomp(FieldElement.New(), FieldElement.New(), FieldElement.New());
			for (int i = 0; i < 32; i++)
			{
				array[2 * i] = (sbyte)(a[i] & 0xF);
				array[2 * i + 1] = (sbyte)((a[i] >> 4) & 0xF);
			}
			sbyte b = 0;
			for (int i = 0; i < 63; i++)
			{
				array[i] += b;
				b = (sbyte)(array[i] + 8);
				b = (sbyte)(b >> 4);
				array[i] -= (sbyte)(b << 4);
			}
			array[63] += b;
			ge_p3_0(h);
			for (int i = 1; i < 64; i += 2)
			{
				select(ge_precomp, i / 2, array[i]);
				ge_madd(ge_p1p, h, ge_precomp);
				ge_p1p1_to_p3(h, ge_p1p);
			}
			ge_p3_dbl(ge_p1p, h);
			ge_p1p1_to_p2(ge_p, ge_p1p);
			ge_p2_dbl(ge_p1p, ge_p);
			ge_p1p1_to_p2(ge_p, ge_p1p);
			ge_p2_dbl(ge_p1p, ge_p);
			ge_p1p1_to_p2(ge_p, ge_p1p);
			ge_p2_dbl(ge_p1p, ge_p);
			ge_p1p1_to_p3(h, ge_p1p);
			for (int i = 0; i < 64; i += 2)
			{
				select(ge_precomp, i / 2, array[i]);
				ge_madd(ge_p1p, h, ge_precomp);
				ge_p1p1_to_p3(h, ge_p1p);
			}
		}

		private static void ge_sub(ge_p1p1 r, ge_p3 p, ge_cached q)
		{
			int[] array = FieldElement.New();
			FieldElement.fe_add(r.X, p.Y, p.X);
			FieldElement.fe_sub(r.Y, p.Y, p.X);
			FieldElement.fe_mul(r.Z, r.X, q.YminusX);
			FieldElement.fe_mul(r.Y, r.Y, q.YplusX);
			FieldElement.fe_mul(r.T, q.T2d, p.T);
			FieldElement.fe_mul(r.X, p.Z, q.Z);
			FieldElement.fe_add(array, r.X, r.X);
			FieldElement.fe_sub(r.X, r.Z, r.Y);
			FieldElement.fe_add(r.Y, r.Z, r.Y);
			FieldElement.fe_sub(r.Z, array, r.T);
			FieldElement.fe_add(r.T, array, r.T);
		}

		public static void ge_tobytes(byte[] s, ge_p2 h)
		{
			int[] array = FieldElement.New();
			int[] array2 = FieldElement.New();
			int[] h2 = FieldElement.New();
			FieldElement.fe_invert(array, h.Z);
			FieldElement.fe_mul(array2, h.X, array);
			FieldElement.fe_mul(h2, h.Y, array);
			FieldElement.fe_tobytes(s, h2);
			s[31] ^= (byte)(FieldElement.fe_isnegative(array2) << 7);
		}
	}
	internal class Signature
	{
		private static byte[] copyOfRange(byte[] src, int start, int end)
		{
			int num = end - start;
			byte[] array = new byte[num];
			Array.Copy(src, start, array, 0, num);
			return array;
		}

		private static bool consttime_equal(byte[] x, byte[] y)
		{
			byte b = 0;
			b = (byte)(x[0] ^ y[0]);
			for (int i = 1; i < 32; i++)
			{
				b = (byte)(b | (byte)(x[i] ^ y[i]));
			}
			return b == 0;
		}

		private static byte[] H(byte[] m)
		{
			return SHA512.Create().ComputeHash(m);
		}

		public static void CreateKeypair(byte[] public_key, byte[] private_key, byte[] seed)
		{
			if (public_key.Length != 32)
			{
				throw new Exception("public-key length is wrong");
			}
			if (private_key.Length != 64)
			{
				throw new Exception("private key length is wrong");
			}
			if (seed.Length != 32)
			{
				throw new Exception("seed length is wrong");
			}
			GroupElement.ge_p3 h = new GroupElement.ge_p3();
			byte[] array = H(seed);
			array[0] &= 248;
			array[31] &= 63;
			array[31] |= 64;
			for (int i = 0; i < 64; i++)
			{
				private_key[i] = array[i];
			}
			GroupElement.ge_scalarmult_base(h, private_key);
			GroupElement.ge_p3_tobytes(public_key, h);
		}

		public static void Sign(byte[] signature, byte[] message, byte[] public_key, byte[] private_key)
		{
			if (signature.Length != 64)
			{
				throw new Exception("signature length is wrong");
			}
			if (public_key.Length != 32)
			{
				throw new Exception("public-key length is wrong");
			}
			if (private_key.Length != 64)
			{
				throw new Exception("private key length is wrong");
			}
			byte[] array = new byte[64];
			byte[] array2 = new byte[64];
			GroupElement.ge_p3 h = new GroupElement.ge_p3();
			MemoryStream memoryStream = new MemoryStream(new byte[32 + message.Length]);
			memoryStream.Write(private_key, 32, 32);
			memoryStream.Write(message, 0, message.Length);
			array2 = H(memoryStream.ToArray());
			Extra.sc_reduce(array2);
			GroupElement.ge_scalarmult_base(h, array2);
			GroupElement.ge_p3_tobytes(signature, h);
			MemoryStream memoryStream2 = new MemoryStream(new byte[64 + message.Length]);
			memoryStream2.Write(signature, 0, 32);
			memoryStream2.Write(public_key, 0, 32);
			memoryStream2.Write(message, 0, message.Length);
			array = H(memoryStream2.ToArray());
			Extra.sc_reduce(array);
			byte[] array3 = new byte[32];
			Extra.sc_muladd(array3, array, private_key, array2);
			for (int i = 0; i < 32; i++)
			{
				signature[i + 32] = array3[i];
			}
		}

		public static bool Verify(byte[] signature, byte[] message, byte[] public_key)
		{
			if (signature.Length != 64)
			{
				throw new Exception("signature length is wrong");
			}
			if (public_key.Length != 32)
			{
				throw new Exception("public-key length is wrong");
			}
			byte[] array = new byte[64];
			byte[] array2 = new byte[32];
			GroupElement.ge_p3 ge_p = new GroupElement.ge_p3();
			GroupElement.ge_p2 ge_p2 = new GroupElement.ge_p2();
			if ((signature[63] & 0xE0u) != 0)
			{
				return false;
			}
			if (GroupElement.ge_frombytes_negate_vartime(ge_p, public_key) != 0)
			{
				return false;
			}
			MemoryStream memoryStream = new MemoryStream(new byte[32 + public_key.Length + message.Length]);
			memoryStream.Write(signature, 0, 32);
			memoryStream.Write(public_key, 0, public_key.Length);
			memoryStream.Write(message, 0, message.Length);
			array = H(memoryStream.ToArray());
			byte[] array3 = new byte[32];
			for (int i = 0; i < 32; i++)
			{
				array3[i] = signature[i + 32];
			}
			Extra.sc_reduce(array);
			GroupElement.ge_double_scalarmult_vartime(ge_p2, array, ge_p, array3);
			GroupElement.ge_tobytes(array2, ge_p2);
			if (!consttime_equal(array2, signature))
			{
				return false;
			}
			return true;
		}

		public static void Test()
		{
			byte[] seed = new byte[32];
			byte[] public_key = new byte[32];
			byte[] private_key = new byte[64];
			CreateKeypair(public_key, private_key, seed);
			string s = "This is a secret message";
			byte[] bytes = Encoding.UTF8.GetBytes(s);
			byte[] signature = new byte[64];
			Sign(signature, bytes, public_key, private_key);
			if (!Verify(signature, bytes, public_key))
			{
				throw new Exception("Crypto test failed!!");
			}
		}
	}
}
